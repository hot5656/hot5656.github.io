<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hot5656.github.io","root":"/","images":"/images","scheme":"Gemini","version":"8.2.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜尋...","empty":"我們無法找到任何有關 ${query} 的搜索結果","hits_time":"${hits} 找到 ${time} 個結果","hits":"找到 ${hits} 個結果"},"path":"/search.json","localsearch":{"enable":"enable","trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false}};
  </script>
<meta name="description" content="基本 scikit-learn 是一個開源的 python 機器學習庫,提供一系列監督及非監督學習算法 提供大量用於分類,迴歸,群集,降維,模型選擇和預處理工具 廣泛運用於數據挖掘和數據分析">
<meta property="og:type" content="article">
<meta property="og:title" content="scikit-learn">
<meta property="og:url" content="https://hot5656.github.io/2024/06/13/python-32/index.html">
<meta property="og:site_name" content="Robert 雜記">
<meta property="og:description" content="基本 scikit-learn 是一個開源的 python 機器學習庫,提供一系列監督及非監督學習算法 提供大量用於分類,迴歸,群集,降維,模型選擇和預處理工具 廣泛運用於數據挖掘和數據分析">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://hot5656.github.io/2024/06/13/python-32/pic1.png">
<meta property="og:image" content="https://hot5656.github.io/2024/06/13/python-32/pic2.png">
<meta property="og:image" content="https://hot5656.github.io/2024/06/13/python-32/pic3.png">
<meta property="og:image" content="https://hot5656.github.io/2024/06/13/python-32/pic4.png">
<meta property="og:image" content="https://hot5656.github.io/2024/06/13/python-32/pic5.png">
<meta property="og:image" content="https://hot5656.github.io/2024/06/13/python-32/pic6.png">
<meta property="og:image" content="https://hot5656.github.io/2024/06/13/python-32/pic7.png">
<meta property="og:image" content="https://hot5656.github.io/2024/06/13/python-32/pic8.png">
<meta property="og:image" content="https://hot5656.github.io/2024/06/13/python-32/pic9.png">
<meta property="og:image" content="https://hot5656.github.io/2024/06/13/python-32/pic10.png">
<meta property="og:image" content="https://hot5656.github.io/2024/06/13/python-32/pic11.png">
<meta property="og:image" content="https://hot5656.github.io/2024/06/13/python-32/pic12.png">
<meta property="og:image" content="https://hot5656.github.io/2024/06/13/python-32/pic13.png">
<meta property="og:image" content="https://hot5656.github.io/2024/06/13/python-32/pic13.png">
<meta property="og:image" content="https://hot5656.github.io/2024/06/13/python-32/pic15.png">
<meta property="og:image" content="https://hot5656.github.io/2024/06/13/python-32/pic16.png">
<meta property="article:published_time" content="2024-06-13T07:52:32.000Z">
<meta property="article:modified_time" content="2024-08-02T07:47:05.488Z">
<meta property="article:author" content="Robert Kao">
<meta property="article:tag" content="python">
<meta property="article:tag" content="ML">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hot5656.github.io/2024/06/13/python-32/pic1.png">


<link rel="canonical" href="https://hot5656.github.io/2024/06/13/python-32/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-TW'
  };
</script>
<title>scikit-learn | Robert 雜記</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Robert 雜記</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首頁</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>標籤</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分類</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>歸檔列表</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜尋
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜尋..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC"><span class="nav-number">1.</span> <span class="nav-text">基本</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#install"><span class="nav-number">1.1.</span> <span class="nav-text">install</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A9%95%E4%BC%B0%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.2.</span> <span class="nav-text">評估模型</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9D%87%E6%96%B9%E8%AA%A4%E5%B7%AE-Mean-Square-Error-MSE"><span class="nav-number">1.2.1.</span> <span class="nav-text">均方誤差(Mean Square Error, MSE)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9D%87%E6%96%B9%E6%A0%B9%E8%AA%A4%E5%B7%AE-Root-Mean-Square-Error-RMSE"><span class="nav-number">1.2.2.</span> <span class="nav-text">均方根誤差(Root Mean Square Error, RMSE)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B9%B3%E5%9D%87%E7%B5%95%E5%B0%8D%E8%AA%A4%E5%B7%AE-Mean-Absolute-Error-MAE"><span class="nav-number">1.2.3.</span> <span class="nav-text">平均絕對誤差(Mean Absolute Error, MAE)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#R%E5%B9%B3%E6%96%B9%E5%88%A4%E5%AE%9A%E4%BF%82%E6%95%B8-Coefficient-of-Determination-RMSE"><span class="nav-number">1.2.4.</span> <span class="nav-text">R平方判定係數(Coefficient of Determination RMSE)</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92%E6%95%B8%E6%93%9A%E9%9B%86"><span class="nav-number">1.3.</span> <span class="nav-text">機器學習數據集</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#scikit-learn-%E5%85%A7%E5%BB%BA%E6%95%B8%E6%93%9A%E9%9B%86"><span class="nav-number">1.3.1.</span> <span class="nav-text">scikit-learn 內建數據集</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Kaggle-%E6%95%B8%E6%93%9A%E9%9B%86"><span class="nav-number">1.3.2.</span> <span class="nav-text">Kaggle 數據集</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#UCI-%E6%95%B8%E6%93%9A%E9%9B%86"><span class="nav-number">1.3.3.</span> <span class="nav-text">UCI 數據集</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%87%BD%E6%95%B8%E7%94%9F%E6%88%90%E6%95%B8%E6%93%9A%E9%9B%86-scikit-learn-%E5%87%BD%E6%95%B8%E7%94%9F%E6%88%90%E6%95%B8%E6%93%9A"><span class="nav-number">1.3.4.</span> <span class="nav-text">函數生成數據集(scikit-learn 函數生成數據)</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#scikit-learn-%E7%94%9F%E6%88%90%E6%95%B8%E6%93%9A%E5%AF%A6%E4%BD%9C"><span class="nav-number">1.4.</span> <span class="nav-text">scikit-learn 生成數據實作</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%B7%9A%E6%80%A7%E5%88%86%E4%BD%88%E6%95%B8%E6%93%9A"><span class="nav-number">1.4.1.</span> <span class="nav-text">線性分佈數據</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BE%A4%E9%9B%86%E5%88%86%E4%BD%88%E6%95%B8%E6%93%9A"><span class="nav-number">1.4.2.</span> <span class="nav-text">群集分佈數據</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BA%A4%E9%8C%AF%E5%8D%8A%E6%9C%88%E7%BE%A4%E9%9B%86%E6%95%B8%E6%93%9A"><span class="nav-number">1.4.3.</span> <span class="nav-text">交錯半月群集數據</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%92%B0%E5%BD%A2%E7%B5%90%E6%A7%8B%E5%88%86%E4%BD%88%E7%9A%84%E7%BE%A4%E9%9B%86%E6%95%B8%E6%93%9A"><span class="nav-number">1.4.4.</span> <span class="nav-text">環形結構分佈的群集數據</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#n-class-%E5%88%86%E9%A1%9E%E6%95%B8%E6%93%9A%E9%9B%86"><span class="nav-number">1.4.5.</span> <span class="nav-text">n-class 分類數據集</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#scikit-learn-%E6%95%B8%E6%93%9A%E9%A0%90%E8%99%95%E7%90%86"><span class="nav-number">1.5.</span> <span class="nav-text">scikit-learn 數據預處理</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A8%99%E6%BA%96%E5%8C%96%E6%95%B8%E6%93%9A-StandardScaler"><span class="nav-number">1.5.1.</span> <span class="nav-text">標準化數據 StandardScaler</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A8%AD%E5%AE%9A%E6%95%B8%E6%93%9A%E5%8D%80%E9%96%93-MinMaxScaler"><span class="nav-number">1.5.2.</span> <span class="nav-text">設定數據區間 MinMaxScaler</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%89%B9%E6%AE%8A%E6%95%B8%E6%93%9A%E7%B8%AE%E6%94%BE-RobusterScaler"><span class="nav-number">1.5.3.</span> <span class="nav-text">特殊數據縮放 RobusterScaler</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92-scikit-learn-%E5%85%A5%E9%96%80"><span class="nav-number">1.6.</span> <span class="nav-text">機器學習 scikit-learn 入門</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-scikit-learn-LinearRegression-%E5%BB%BA%E7%AB%8B%E7%B7%9A%E6%80%A7%E5%9B%9E%E6%AD%B8%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.6.1.</span> <span class="nav-text">使用 scikit-learn LinearRegression 建立線性回歸模型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%B3%87%E6%96%99%E9%A0%90%E6%B8%AC"><span class="nav-number">1.6.2.</span> <span class="nav-text">資料預測</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%84%B2%E5%AD%98%E8%88%87%E8%BC%89%E5%85%A5"><span class="nav-number">1.6.3.</span> <span class="nav-text">模型的儲存與載入</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#pickle"><span class="nav-number">1.6.3.1.</span> <span class="nav-text">pickle</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#joblib-scikit-learn-%E5%BB%BA%E8%AD%B0-%E5%8F%AF%E6%9C%89%E8%BC%83%E5%A5%BD%E7%9A%84%E6%95%88%E7%8E%87"><span class="nav-number">1.6.3.2.</span> <span class="nav-text">joblib (scikit-learn 建議,可有較好的效率)</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A8%88%E7%AE%97%E7%B7%9A%E6%80%A7%E8%BF%B4%E6%AD%B8%E7%B7%9A%E7%9A%84%E6%96%9C%E7%8E%87%E5%92%8C%E6%88%AA%E8%B7%9D"><span class="nav-number">1.6.4.</span> <span class="nav-text">計算線性迴歸線的斜率和截距</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#R%E5%B9%B3%E6%96%B9%E4%BF%82%E6%95%B8%E5%88%A4%E5%AE%9A%E6%AA%A2%E9%A9%97%E6%A8%A1%E5%9E%8B%E7%9A%84%E6%80%A7%E8%83%BD"><span class="nav-number">1.6.5.</span> <span class="nav-text">R平方係數判定檢驗模型的性能</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E9%A1%9E%E6%BC%94%E7%AE%97%E6%B3%95-%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92%E6%A8%A1%E5%9E%8B%E7%9A%84%E6%80%A7%E8%83%BD%E8%A9%95%E4%BC%B0"><span class="nav-number">1.7.</span> <span class="nav-text">分類演算法 - 機器學習模型的性能評估</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A8%88%E7%AE%97%E7%B2%BE%E7%A2%BA%E5%BA%A6-accuracy-score"><span class="nav-number">1.7.1.</span> <span class="nav-text">計算精確度 accuracy_score()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%AC%E5%9B%9E%E7%8E%87-recall-score"><span class="nav-number">1.7.2.</span> <span class="nav-text">召回率 recall_score()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#F1-%E5%88%86%E6%95%B8-f1-score"><span class="nav-number">1.7.3.</span> <span class="nav-text">F1 分數 f1_score()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%86%E9%A1%9E%E5%A0%B1%E5%91%8A-classification-report"><span class="nav-number">1.7.4.</span> <span class="nav-text">分類報告 classification_report()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B7%B7%E6%B7%86%E7%9F%A9%E9%99%A3-confusion-maxtrix"><span class="nav-number">1.7.5.</span> <span class="nav-text">混淆矩陣 confusion_maxtrix()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ROC-AUC-%E5%88%86%E6%95%B8"><span class="nav-number">1.7.6.</span> <span class="nav-text">ROC_AUC 分數</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92%E5%BF%85%E9%A0%88%E5%AD%B8%E6%9C%83%E7%9A%84%E9%9D%9E%E6%95%B8%E5%80%BC%E8%B3%87%E6%96%99%E8%BD%89%E6%8F%9B"><span class="nav-number">1.8.</span> <span class="nav-text">機器學習必須學會的非數值資料轉換</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#One-hot-%E7%B7%A8%E7%A2%BC"><span class="nav-number">1.8.1.</span> <span class="nav-text">One-hot 編碼</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%89%B9%E5%BE%B5%E5%90%8D%E7%A8%B1%E7%94%B1%E4%B8%AD%E6%96%87%E6%94%B9%E7%82%BA%E8%8B%B1%E6%96%87"><span class="nav-number">1.8.2.</span> <span class="nav-text">特徵名稱由中文改為英文</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%B3%87%E6%96%99%E5%B0%8D%E6%87%89-map-%E6%96%B9%E6%B3%95"><span class="nav-number">1.8.3.</span> <span class="nav-text">資料對應 map() 方法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A8%99%E7%B1%A4%E8%BD%89%E6%8F%9B-LabelEncoder"><span class="nav-number">1.8.4.</span> <span class="nav-text">標籤轉換 LabelEncoder()</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92%E6%BC%94%E7%AE%97%E6%B3%95"><span class="nav-number">1.9.</span> <span class="nav-text">機器學習演算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E9%9A%A8%E6%A9%9F%E6%95%B8%E6%93%9A%E5%AD%B8%E7%BF%92%E6%80%A7%E8%BF%B4%E6%AD%B8"><span class="nav-number">1.10.</span> <span class="nav-text">使用隨機數據學習性迴歸</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E9%9A%A8%E6%A9%9F%E6%95%B8%E6%93%9A%E6%B8%AC%E8%A9%A6%E8%BF%B4%E6%AD%B8%E6%A8%A1%E5%9E%8B"><span class="nav-number">1.10.1.</span> <span class="nav-text">使用隨機數據測試迴歸模型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#score-%E5%92%8C-r2-score-%E7%9A%84%E5%B7%AE%E7%95%B0"><span class="nav-number">1.10.2.</span> <span class="nav-text">score() 和 r2_score() 的差異</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E4%BB%96"><span class="nav-number">2.</span> <span class="nav-text">其他</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%84%B2%E5%AD%98%E5%85%AC%E5%BC%8F"><span class="nav-number">2.1.</span> <span class="nav-text">儲存公式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B8%E6%93%9A"><span class="nav-number">2.2.</span> <span class="nav-text">數據</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%89%B5%E5%BB%BA%E8%81%9A%E9%A1%9E%E7%AE%97%E6%B3%95%E7%9A%84%E6%B8%AC%E8%A9%A6%E6%95%B8%E6%93%9A%E9%9B%86"><span class="nav-number">2.2.1.</span> <span class="nav-text">創建聚類算法的測試數據集</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%90%88%E6%88%90%E7%B7%9A%E6%80%A7%E5%9B%9E%E6%AD%B8%E6%95%B8%E6%93%9A%E9%9B%86"><span class="nav-number">2.2.2.</span> <span class="nav-text">生成合成線性回歸數據集</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%82%8F%E8%BC%AF%E8%BF%B4%E6%AD%B8"><span class="nav-number">2.3.</span> <span class="nav-text">邏輯迴歸</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E8%A8%88%E7%AE%97"><span class="nav-number">2.3.1.</span> <span class="nav-text">基本計算</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%89%B9%E5%BE%B5%E7%B8%AE%E6%94%BE-%E5%B0%8D%E9%82%8F%E8%BC%AF%E8%BF%B4%E6%AD%B8%E5%BE%88%E9%87%8D%E8%A6%81-%E5%9B%A0%E5%90%84%E7%89%B9%E5%BE%B5%E6%95%B8%E5%80%BC%E5%A4%A7%E5%B0%8F%E6%9C%89%E5%B7%AE%E7%95%B0"><span class="nav-number">2.3.2.</span> <span class="nav-text">特徵縮放 - 對邏輯迴歸很重要,因各特徵數值大小有差異</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B1%BA%E7%AD%96%E6%A8%B9"><span class="nav-number">2.4.</span> <span class="nav-text">決策樹</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E4%BE%8B%E5%AD%90"><span class="nav-number">2.4.1.</span> <span class="nav-text">基本例子</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%B9%AA%E8%A3%BD%E6%B1%BA%E7%AD%96%E6%A8%B9"><span class="nav-number">2.4.2.</span> <span class="nav-text">繪製決策樹</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Robert Kao"
      src="/images/head.png">
  <p class="site-author-name" itemprop="name">Robert Kao</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">171</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">66</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
        <div class="back-to-top animated" role="button">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://hot5656.github.io/2024/06/13/python-32/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="Robert Kao">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Robert 雜記">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          scikit-learn
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2024-06-13 15:52:32" itemprop="dateCreated datePublished" datetime="2024-06-13T15:52:32+08:00">2024-06-13</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2024-08-02 15:47:05" itemprop="dateModified" datetime="2024-08-02T15:47:05+08:00">2024-08-02</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Coding/" itemprop="url" rel="index"><span itemprop="name">Coding</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2024/06/13/python-32/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2024/06/13/python-32/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>27k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>25 分鐘</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h3 id="基本"><a href="#基本" class="headerlink" title="基本"></a>基本</h3><ul>
<li>scikit-learn 是一個開源的 python 機器學習庫,提供一系列監督及非監督學習算法</li>
<li>提供大量用於分類,迴歸,群集,降維,模型選擇和預處理工具</li>
<li>廣泛運用於數據挖掘和數據分析</li>
</ul>
<span id="more"></span>

<h4 id="install"><a href="#install" class="headerlink" title="install"></a>install</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install scikit-learn</span><br></pre></td></tr></table></figure>

<h4 id="評估模型"><a href="#評估模型" class="headerlink" title="評估模型"></a>評估模型</h4><h5 id="均方誤差-Mean-Square-Error-MSE"><a href="#均方誤差-Mean-Square-Error-MSE" class="headerlink" title="均方誤差(Mean Square Error, MSE)"></a>均方誤差(Mean Square Error, MSE)</h5><p>MSE是觀察值與預測值之間差值平方的平均值,MSE越小,表示模型的預測能力越好,公式如下<br>$ MSE &#x3D; \frac{1}{n} \sum_{i-1}^{n}(y_i-\hat{y})$<br>$ y_i是觀察值 \hat{y}是預測值 n是樣本數量 $</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_squared_error</span><br><span class="line">	...</span><br><span class="line">MSE = mean_squared_error(y_true, y_pred)</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/06/13/python-32/pic1.png" class="" title="pic1">
</div>

<h5 id="均方根誤差-Root-Mean-Square-Error-RMSE"><a href="#均方根誤差-Root-Mean-Square-Error-RMSE" class="headerlink" title="均方根誤差(Root Mean Square Error, RMSE)"></a>均方根誤差(Root Mean Square Error, RMSE)</h5><p>這是MSE的平方根,與MSE相比,RMSE對較大的誤差有更強的懲罰效果<br>RMSE &#x3D; np.sqrt(MSE)</p>
<h5 id="平均絕對誤差-Mean-Absolute-Error-MAE"><a href="#平均絕對誤差-Mean-Absolute-Error-MAE" class="headerlink" title="平均絕對誤差(Mean Absolute Error, MAE)"></a>平均絕對誤差(Mean Absolute Error, MAE)</h5><p>這是預測值與實際值之間的絕對差平均值,這個指標能夠更好的反映預測誤差的實際大小</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> mean_absolute_error</span><br><span class="line">	...</span><br><span class="line">MAE = mean_absolute_error(y_true, y_pred)</span><br></pre></td></tr></table></figure>

<h5 id="R平方判定係數-Coefficient-of-Determination-RMSE"><a href="#R平方判定係數-Coefficient-of-Determination-RMSE" class="headerlink" title="R平方判定係數(Coefficient of Determination RMSE)"></a>R平方判定係數(Coefficient of Determination RMSE)</h5><p>R平方判定係數或簡稱判定係數,是一個迴歸模型性能評估指標,用於衡量模型資料變異程度.值介於0~1,越接近1表示模型對資料的擬合程度越好. </p>
<div style="max-width:500px">
  <img src="/2024/06/13/python-32/pic2.png" class="" title="pic2">
</div>

<p>$ Adjusted R^2 &#x3D; 1 - 	\frac{(1-R^2)*(n-1)}{(n-k-1)} $<br>$ n表示樣品數量,k表示特徵數量,R^2表示判定係數 $</p>
<p>判定係數公式如下:<br>$$ R^2(y,\hat{y}) &#x3D; 1 - \frac{\sum_{i&#x3D;1}^{n}(y_i - \hat{y}_i)^2} { \sum _{i&#x3D;1}^{n}(y_i - \overline{y})^2 } $$</p>
<p>$ n 是數據量, \hat{y}_i 是迴歸函數的預估值,\overline{y} 是所有y的平均值 $</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score</span><br><span class="line">	...</span><br><span class="line">R2_score = r2_score(y_true, y_pred)</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score, mean_squared_error</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,</span><br><span class="line">     <span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">24</span>]</span><br><span class="line">y = [<span class="number">100</span>, <span class="number">88</span>, <span class="number">75</span>, <span class="number">60</span>, <span class="number">50</span>, <span class="number">55</span>, <span class="number">55</span>, <span class="number">56</span>, <span class="number">58</span>, <span class="number">58</span>, <span class="number">61</span>,</span><br><span class="line">      <span class="number">63</span>, <span class="number">68</span>, <span class="number">71</span>, <span class="number">71</span>, <span class="number">75</span>, <span class="number">76</span>, <span class="number">88</span>, <span class="number">93</span>, <span class="number">97</span>, <span class="number">97</span>, <span class="number">100</span>]</span><br><span class="line"></span><br><span class="line">coef = np.polyfit(x, y, <span class="number">3</span>)</span><br><span class="line">model = np.poly1d(coef)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;MSE:<span class="subst">&#123;mean_squared_error(y, model(x)):<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;R2_Score:<span class="subst">&#123;r2_score(y, model(x)):<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># MSE:14.803</span></span><br><span class="line"><span class="comment"># R2_Score:0.944</span></span><br></pre></td></tr></table></figure>

<h4 id="機器學習數據集"><a href="#機器學習數據集" class="headerlink" title="機器學習數據集"></a>機器學習數據集</h4><p>可使用以下數據集作為機器學習使用</p>
<h5 id="scikit-learn-內建數據集"><a href="#scikit-learn-內建數據集" class="headerlink" title="scikit-learn 內建數據集"></a>scikit-learn 內建數據集</h5><p>scikit-learn 提供一些數據集</p>
<ul>
<li>鳶尾花 Iris</li>
<li>手寫數字 Digits</li>
<li>葡萄酒 Wine</li>
<li>威斯康辛州乳癌 Breast Cancer Wisconsin</li>
<li>波士頓房價 Boston House Prices</li>
</ul>
<h5 id="Kaggle-數據集"><a href="#Kaggle-數據集" class="headerlink" title="Kaggle 數據集"></a>Kaggle 數據集</h5><ul>
<li>Kaggle 是一個數據科學平台</li>
<li>數據涵蓋許多不同主題,包含但不限於金融,醫療,影像識別,自然語言處理,音訊分析</li>
<li>Kaggle 有活躍的社區,你可以參加由Kaggle或其他機構主辦的數據科學競賽,並可以查看其他使用者對數據集的分析和模型</li>
<li>對每個數據集,可以找到相關的核心筆記本(kernels),討論和新聞,這些可幫助使用者理解和使用數據集<br>為了使用 Kaggle 數據集,需註冊一個帳號,你可以直接下載或使用API下載</li>
</ul>
<h5 id="UCI-數據集"><a href="#UCI-數據集" class="headerlink" title="UCI 數據集"></a>UCI 數據集</h5><ul>
<li>UCI 數據集由加州大學爾灣分校(University of California, Irvine)機器學習儲存庫提供</li>
<li>涵蓋醫學,金融,生物學和社會科學等</li>
<li>這些數據涉及的領域包含機器學習,統計學,模式識別,數據挖掘等</li>
<li>可用於機器學習任務,如分類,迴歸,聚類等<br><a target="_blank" rel="noopener" href="https://archive.ics.uci.edu/">UC Irvine Machine Learning Repository</a></li>
</ul>
<h5 id="函數生成數據集-scikit-learn-函數生成數據"><a href="#函數生成數據集-scikit-learn-函數生成數據" class="headerlink" title="函數生成數據集(scikit-learn 函數生成數據)"></a>函數生成數據集(scikit-learn 函數生成數據)</h5><p>也可以使用 scikit-learn 內建的函數生成下列類型的數據集:</p>
<ul>
<li>線性分佈數據集</li>
<li>集群分佈數據集</li>
<li>循環分佈數據集</li>
</ul>
<h4 id="scikit-learn-生成數據實作"><a href="#scikit-learn-生成數據實作" class="headerlink" title="scikit-learn 生成數據實作"></a>scikit-learn 生成數據實作</h4><h5 id="線性分佈數據"><a href="#線性分佈數據" class="headerlink" title="線性分佈數據"></a>線性分佈數據</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_regression</span><br><span class="line">	...</span><br><span class="line">X, y = make_regression(n_samples, n_features, noise, random_state)</span><br></pre></td></tr></table></figure>
<ul>
<li>n_samples : options,生成樣品數量, default 100</li>
<li>n_features : options,生成特徵數量, default 100</li>
<li>noise : option,加入高斯噪聲的標準差, default 0</li>
<li>random_state : option,隨機生成器的種子,加入此參數確保每次生成數據一致, default None(每次生成數據不同)</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 產生數據</span></span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_regression</span><br><span class="line"></span><br><span class="line">X, y = make_regression(n_features=<span class="number">1</span>, noise=<span class="number">0</span>, random_state=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;X 的資料格式:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(X), <span class="built_in">len</span>(X))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;陣列維度:<span class="subst">&#123;X.ndim&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;陣列外型:<span class="subst">&#123;X.shape&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;陣列大小:<span class="subst">&#123;X.size&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;前5個X的樣本:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(X[:<span class="number">5</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">70</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;y 的資料格式:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(y), <span class="built_in">len</span>(y))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;陣列維度:<span class="subst">&#123;y.ndim&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;陣列外型:<span class="subst">&#123;y.shape&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;陣列大小:<span class="subst">&#123;y.size&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;前5個y的樣本:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(y[:<span class="number">5</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># X 的資料格式:</span></span><br><span class="line"><span class="comment"># &lt;class &#x27;numpy.ndarray&#x27;&gt; 100</span></span><br><span class="line"><span class="comment"># 陣列維度:2</span></span><br><span class="line"><span class="comment"># 陣列外型:(100, 1)</span></span><br><span class="line"><span class="comment"># 陣列大小:100</span></span><br><span class="line"><span class="comment"># 前5個X的樣本:</span></span><br><span class="line"><span class="comment"># X 為 2維 陣列</span></span><br><span class="line"><span class="comment"># [[ 0.12691209]</span></span><br><span class="line"><span class="comment">#  [ 0.44386323]</span></span><br><span class="line"><span class="comment">#  [ 0.76103773]</span></span><br><span class="line"><span class="comment">#  [ 0.95008842]</span></span><br><span class="line"><span class="comment">#  [-0.40317695]]</span></span><br><span class="line"><span class="comment"># ======================================================================</span></span><br><span class="line"><span class="comment"># y 的資料格式:</span></span><br><span class="line"><span class="comment"># &lt;class &#x27;numpy.ndarray&#x27;&gt; 100</span></span><br><span class="line"><span class="comment"># 陣列維度:1</span></span><br><span class="line"><span class="comment"># 陣列外型:(100,)</span></span><br><span class="line"><span class="comment"># 陣列大小:100</span></span><br><span class="line"><span class="comment"># 前5個y的樣本:</span></span><br><span class="line"><span class="comment"># y 為 2維 陣列</span></span><br><span class="line"><span class="comment"># [  5.37923312  18.81336721  32.25696819  40.26997723 -17.08885844]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 對照兩組數據</span></span><br><span class="line"><span class="comment"># 繪製多子圖</span></span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_regression</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成數據</span></span><br><span class="line">X1, y1 = make_regression(n_features=<span class="number">1</span>, noise=<span class="number">0</span>, random_state=<span class="number">10</span>)</span><br><span class="line">X2, y2 = make_regression(n_features=<span class="number">1</span>, noise=<span class="number">10</span>, random_state=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立兩個子圖畫布</span></span><br><span class="line">fig, axs = plt.subplots(nrows=<span class="number">1</span>, ncols=<span class="number">2</span>, figsize=(<span class="number">10</span>,<span class="number">5</span>))</span><br><span class="line"><span class="comment"># 繪第1個子圖</span></span><br><span class="line">axs[<span class="number">0</span>].scatter(X1, y1)</span><br><span class="line">axs[<span class="number">0</span>].set_title(<span class="string">&quot;Noise = 0&quot;</span>)</span><br><span class="line"><span class="comment"># 繪第2個子圖</span></span><br><span class="line">axs[<span class="number">1</span>].scatter(X2, y2)</span><br><span class="line">axs[<span class="number">1</span>].set_title(<span class="string">&quot;Noise = 10&quot;</span>)</span><br><span class="line"><span class="comment"># 設定標籤</span></span><br><span class="line"><span class="keyword">for</span> ax <span class="keyword">in</span> axs:</span><br><span class="line">    ax.set_xlabel(<span class="string">&quot;特徵&quot;</span>)</span><br><span class="line">    ax.set_ylabel(<span class="string">&quot;目標&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 自動調整子圖間距</span></span><br><span class="line">plt.tight_layout()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/06/13/python-32/pic3.png" class="" title="pic3">
</div>

<h5 id="群集分佈數據"><a href="#群集分佈數據" class="headerlink" title="群集分佈數據"></a>群集分佈數據</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_blobs</span><br><span class="line">	...</span><br><span class="line">X,y = make_blobs(n_samples, n_features, centers, random_state)</span><br></pre></td></tr></table></figure>
<ul>
<li>n_samples : options,生成樣品數量, default 100</li>
<li>n_features : options,每個樣品特徵數, default 2</li>
<li>centers : option,整數或是一組[n_cneters, n_feature]的陣列,表示生成數據中心數量或固定中心位置, default 3</li>
<li>random_state : option,隨機生成器的種子,加入此參數確保每次生成數據一致, default None(每次生成數據不同)</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_blobs</span><br><span class="line"></span><br><span class="line">X,y = make_blobs(n_samples=<span class="number">500</span>, n_features=<span class="number">2</span>, centers=<span class="number">5</span>, random_state=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;輸出 X 的資料格式:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(X))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;X 前 5 個樣本&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(X[:<span class="number">5</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">70</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;X[:,0] 前 5 個樣本&quot;</span>)</span><br><span class="line">xx = X[:,<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(xx[:<span class="number">5</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">70</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;X[:,1] 前 5 個樣本&quot;</span>)</span><br><span class="line">xx = X[:,<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(xx[:<span class="number">5</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">70</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;y 前 5 個樣本&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(y[:<span class="number">5</span>])</span><br><span class="line"><span class="comment"># 輸出 X 的資料格式:</span></span><br><span class="line"><span class="comment"># &lt;class &#x27;numpy.ndarray&#x27;&gt;</span></span><br><span class="line"><span class="comment"># X 前 5 個樣本</span></span><br><span class="line"><span class="comment">#  n_features=2 所以每個樣本有 2 個特徵</span></span><br><span class="line"><span class="comment"># [[-2.33022219  4.78405366]</span></span><br><span class="line"><span class="comment">#  [-2.27930436  1.79758281]</span></span><br><span class="line"><span class="comment">#  [-7.22570502 -3.79313579]</span></span><br><span class="line"><span class="comment">#  [-7.66603898 -7.59715459]</span></span><br><span class="line"><span class="comment">#  [-7.83173733 -3.70122759]]</span></span><br><span class="line"><span class="comment"># ======================================================================</span></span><br><span class="line"><span class="comment"># X[:,0] 前 5 個樣本</span></span><br><span class="line"><span class="comment"># [-2.33022219 -2.27930436 -7.22570502 -7.66603898 -7.83173733]</span></span><br><span class="line"><span class="comment"># ======================================================================</span></span><br><span class="line"><span class="comment"># X[:,1] 前 5 個樣本</span></span><br><span class="line"><span class="comment"># [ 4.78405366  1.79758281 -3.79313579 -7.59715459 -3.70122759]</span></span><br><span class="line"><span class="comment"># ======================================================================</span></span><br><span class="line"><span class="comment"># y 前 5 個樣本</span></span><br><span class="line"><span class="comment"># [0 4 3 2 3]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_blobs</span><br><span class="line"><span class="keyword">import</span> matplotlib.pylab <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">X1 ,y1 = make_blobs(n_samples=<span class="number">500</span>, n_features=<span class="number">2</span>, centers=<span class="number">5</span>, random_state=<span class="number">1</span>)</span><br><span class="line">X2 ,y2 = make_blobs(n_samples=<span class="number">300</span>, n_features=<span class="number">2</span>, centers=<span class="number">3</span>, random_state=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立兩個子圖畫布</span></span><br><span class="line">fig, axs = plt.subplots(nrows=<span class="number">1</span>, ncols=<span class="number">2</span>, figsize=(<span class="number">10</span>,<span class="number">5</span>))</span><br><span class="line"><span class="comment"># 繪第1個子圖</span></span><br><span class="line">axs[<span class="number">0</span>].scatter(X1[:,<span class="number">0</span>], X1[:,<span class="number">1</span>], c=y1)</span><br><span class="line">axs[<span class="number">0</span>].set_title(<span class="string">&quot;First dataset&quot;</span>)</span><br><span class="line"><span class="comment"># 繪第2個子圖</span></span><br><span class="line">axs[<span class="number">1</span>].scatter(X2[:,<span class="number">0</span>], X2[:,<span class="number">1</span>], c=y2)</span><br><span class="line">axs[<span class="number">1</span>].set_title(<span class="string">&quot;Second dataset&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/06/13/python-32/pic4.png" class="" title="pic4">
</div>

<h5 id="交錯半月群集數據"><a href="#交錯半月群集數據" class="headerlink" title="交錯半月群集數據"></a>交錯半月群集數據</h5><p>玩具數據集通常指那些簡單,小型的人造數據集<br>make_moons 就是一個玩具數據集的例子,數據集的兩個類別會在二維空間中形成兩個交錯的半圓形</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_moons</span><br><span class="line">	...</span><br><span class="line">X, y = make_moons(n_samples, noise, random_state)</span><br></pre></td></tr></table></figure>
<ul>
<li>n_samples : options,生成樣品數量, default 100</li>
<li>noise : option,加入高斯噪聲的標準差, default None</li>
<li>random_state : option,隨機生成器的種子,加入此參數確保每次生成數據一致, default None(每次生成數據不同)</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_moons</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">X, y = make_moons(n_samples=<span class="number">200</span>, noise=<span class="number">0.05</span>, random_state=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;X[:5] = <span class="subst">&#123;X[:<span class="number">5</span>]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;y=<span class="subst">&#123;y&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.scatter(X[:,<span class="number">0</span>], X[:,<span class="number">1</span>], c=y)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># X[:5] = [[ 0.81680544  0.5216447 ]</span></span><br><span class="line"><span class="comment">#  [ 1.61859642 -0.37982927]</span></span><br><span class="line"><span class="comment">#  [-0.02126953  0.27372826]</span></span><br><span class="line"><span class="comment">#  [-1.02181041 -0.07543984]</span></span><br><span class="line"><span class="comment">#  [ 1.76654633 -0.17069874]]</span></span><br><span class="line"><span class="comment"># y=[0 1 1 0 1 1 0 1 0 1 0 1 1 1 0 0 0 1 0 0 1 1 0 1 0 1 1 1 1 0 0 0 1 1 0 1 1</span></span><br><span class="line"><span class="comment">#  0 0 1 1 0 0 1 1 0 0 0 1 1 0 1 1 0 1 0 0 1 0 0 1 0 1 0 1 0 0 1 0 0 1 0 1 1</span></span><br><span class="line"><span class="comment">#  1 0 1 0 0 1 1 0 1 1 1 0 0 0 1 1 0 0 1 0 1 1 1 1 0 1 1 1 0 0 0 1 0 0 1 0 0</span></span><br><span class="line"><span class="comment">#  0 0 0 0 1 0 1 1 0 0 0 1 0 1 0 0 1 1 1 0 0 0 1 1 1 1 0 1 0 1 1 0 0 0 0 1 1</span></span><br><span class="line"><span class="comment">#  0 1 1 1 0 0 1 0 1 1 0 0 1 1 0 1 1 1 0 1 1 1 0 0 0 0 1 1 1 0 0 0 1 0 1 1 1</span></span><br><span class="line"><span class="comment">#  0 0 1 0 0 0 0 0 0 1 0 1 1 0 1]</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/06/13/python-32/pic5.png" class="" title="pic5">
</div>

<h5 id="環形結構分佈的群集數據"><a href="#環形結構分佈的群集數據" class="headerlink" title="環形結構分佈的群集數據"></a>環形結構分佈的群集數據</h5><p>make_circles() 可以用來生成兩個環狀結構的數據集,一個圓內部的點和一個圓外部的點</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_circles</span><br><span class="line">	...</span><br><span class="line">X, y = make_circles(n_samples, noise, random_state)</span><br></pre></td></tr></table></figure>
<ul>
<li>n_samples : options,生成樣品數量, default 100</li>
<li>noise : option,加入高斯噪聲的標準差, default None</li>
<li>random_state : option,隨機生成器的種子,加入此參數確保每次生成數據一致, default None(每次生成數據不同)</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_circles</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">X, y = make_circles(n_samples=<span class="number">100</span>, noise=<span class="number">0.05</span>, random_state=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">plt.scatter(X[:,<span class="number">0</span>],  X[:,<span class="number">1</span>], c=y)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<div style="max-width:500px">
  <img src="/2024/06/13/python-32/pic6.png" class="" title="pic6">
</div>

<h5 id="n-class-分類數據集"><a href="#n-class-分類數據集" class="headerlink" title="n-class 分類數據集"></a>n-class 分類數據集</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_classification</span><br><span class="line">	...</span><br><span class="line">X, y = make_classification(n_samples=<span class="number">100</span>, n_features=<span class="number">20</span>, n_informative=<span class="number">2</span>, n_redundant=<span class="number">2</span>, n_repeated=<span class="number">0</span>, n_classes=<span class="number">2</span>,  n_clusters_per_class=<span class="number">2</span>, weights=<span class="literal">None</span>, hypercube=<span class="literal">True</span>, shift=<span class="number">0.0</span>, scale=<span class="number">1.0</span>, shuffle=<span class="literal">True</span>, random_state=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>n_samples : options,生成樣品數量, default 100</li>
<li>n_features : options,生成特徵數量, default 20</li>
<li>n_informative : 信息特徵數, default 2</li>
<li>n_redundant : 冗餘特徵數, default 1</li>
<li>n_repeated : 重複特徵數, default 0</li>
<li>n_classes : 數據集中類別數, default 2</li>
<li>n_clusters_per_class : 每個類別的簇數, default 2</li>
<li>weights : 每個類別樣品所佔的比例, default None</li>
<li>hypercube : 如為 True 將簇放置在超立方體的頂點上, 如為 False 將簇放置在隨機多維標準常規中, default True</li>
<li>shift : 特徵的均值, default 0.0</li>
<li>scale : 特徵的標準差, default 1.0</li>
<li>random_state : option,隨機生成器的種子,加入此參數確保每次生成數據一致, default None(每次生成數據不同)</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_classification</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">X, y = make_classification(n_samples=<span class="number">100</span>, n_features=<span class="number">2</span>, n_informative=<span class="number">2</span>, n_redundant=<span class="number">0</span>, n_repeated=<span class="number">0</span>, n_classes=<span class="number">2</span>, random_state=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">plt.scatter(X[:,<span class="number">0</span>], X[:,<span class="number">1</span>], marker=<span class="string">&#x27;o&#x27;</span>, c=y, s=<span class="number">25</span>, edgecolors=<span class="string">&#x27;k&#x27;</span> )</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/06/13/python-32/pic7.png" class="" title="pic7">
</div>

<h4 id="scikit-learn-數據預處理"><a href="#scikit-learn-數據預處理" class="headerlink" title="scikit-learn 數據預處理"></a>scikit-learn 數據預處理</h4><p>scikit-learn 數據預處理 有以下幾點</p>
<ul>
<li>數據清洗:消除數據中的噪聲,例如遺漏值,異常值或不一致的數據等</li>
<li>數據轉換:將數據轉換成適合模型學習的格式.如某些算法只能處理數值數據,所以我們需要將類別數據進行編碼</li>
<li>數據標準化&#x2F;正規化:消除數據尺度的差異,讓所有的特徵都在尺度範圍內(數據標準化也稱為數據縮放)</li>
<li>特徵選擇&#x2F;提取:有時我們要減少數據的維度以減少運算,或者將原始特徵轉換成更好表示數據的新特徵</li>
</ul>
<h5 id="標準化數據-StandardScaler"><a href="#標準化數據-StandardScaler" class="headerlink" title="標準化數據 StandardScaler"></a>標準化數據 StandardScaler</h5><p>有時使用 make_blobs()產生的數據,特徵資料的差異會很大,可使用StandardScaler()將資料標準化為平均數是0,變異數是1</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line">  ...</span><br><span class="line">StandardScaler().fit_transform(data)</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 數據中心點變成 (0,0)</span></span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_blobs</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">X, y = make_blobs(n_samples=<span class="number">200</span>, n_features=<span class="number">2</span>, centers=<span class="number">2</span>, random_state=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">X_sta = StandardScaler().fit_transform(X)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立兩個子圖畫布</span></span><br><span class="line">fig, axs = plt.subplots(nrows=<span class="number">1</span>, ncols=<span class="number">2</span>, figsize=(<span class="number">10</span>,<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line">axs[<span class="number">0</span>].scatter(X[:,<span class="number">0</span>], X[:,<span class="number">1</span>], c=y)</span><br><span class="line">axs[<span class="number">0</span>].set_title(<span class="string">&quot;一般數據&quot;</span>)</span><br><span class="line">axs[<span class="number">0</span>].grid()</span><br><span class="line"></span><br><span class="line">axs[<span class="number">1</span>].scatter(X_sta[:,<span class="number">0</span>], X_sta[:,<span class="number">1</span>], c=y)</span><br><span class="line">axs[<span class="number">1</span>].set_title(<span class="string">&quot;標準化數據&quot;</span>)</span><br><span class="line">axs[<span class="number">1</span>].grid()</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/06/13/python-32/pic8.png" class="" title="pic8">
</div>

<h5 id="設定數據區間-MinMaxScaler"><a href="#設定數據區間-MinMaxScaler" class="headerlink" title="設定數據區間 MinMaxScaler"></a>設定數據區間 MinMaxScaler</h5><p>MinMaxScaler() 主要將資料縮放的最小值和最大值之間,通常是0到1,也可以是其他任意範圍</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> MinMaxScaler</span><br><span class="line">  ...</span><br><span class="line">MinMaxScaler().fit_transform(data)</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 縮放0和1之間數據</span></span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_blobs</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> MinMaxScaler</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">X, y = make_blobs(n_samples=<span class="number">200</span>, n_features=<span class="number">2</span>, centers=<span class="number">2</span>, random_state=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">X_sta = MinMaxScaler().fit_transform(X)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立兩個子圖畫布</span></span><br><span class="line">fig, axs = plt.subplots(nrows=<span class="number">1</span>, ncols=<span class="number">2</span>, figsize=(<span class="number">10</span>,<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line">axs[<span class="number">0</span>].scatter(X[:,<span class="number">0</span>], X[:,<span class="number">1</span>], c=y)</span><br><span class="line">axs[<span class="number">0</span>].set_title(<span class="string">&quot;一般數據&quot;</span>)</span><br><span class="line">axs[<span class="number">0</span>].grid()</span><br><span class="line"></span><br><span class="line">axs[<span class="number">1</span>].scatter(X_sta[:,<span class="number">0</span>], X_sta[:,<span class="number">1</span>], c=y)</span><br><span class="line">axs[<span class="number">1</span>].set_title(<span class="string">&quot;縮放0和1之間數據&quot;</span>)</span><br><span class="line">axs[<span class="number">1</span>].grid()</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/06/13/python-32/pic9.png" class="" title="pic9">
</div>

<h5 id="特殊數據縮放-RobusterScaler"><a href="#特殊數據縮放-RobusterScaler" class="headerlink" title="特殊數據縮放 RobusterScaler"></a>特殊數據縮放 RobusterScaler</h5><p>RobusterScaler()是一種特殊數據縮放器,特別適合處理含有異常的數據<br>對於包含異常值的數據,一般縮放方法,可能會受到異常值的影響<br>RobusterScaler()工作原理是數值減去中位數摒除以四分位距(IQR)IQR是第3四分位距(75%)和第1四分位距(20%)之間的差</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> MinMaRobusterScalerxScaler</span><br><span class="line">  ...</span><br><span class="line">RobusterScaler().fit_transform(data)</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># RobustScaler 縮放數據</span></span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_blobs</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> RobustScaler</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">X, y = make_blobs(n_samples=<span class="number">200</span>, n_features=<span class="number">2</span>, centers=<span class="number">2</span>, random_state=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">X_sta = RobustScaler().fit_transform(X)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立兩個子圖畫布</span></span><br><span class="line">fig, axs = plt.subplots(nrows=<span class="number">1</span>, ncols=<span class="number">2</span>, figsize=(<span class="number">10</span>,<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line">axs[<span class="number">0</span>].scatter(X[:,<span class="number">0</span>], X[:,<span class="number">1</span>], c=y)</span><br><span class="line">axs[<span class="number">0</span>].set_title(<span class="string">&quot;一般數據&quot;</span>)</span><br><span class="line">axs[<span class="number">0</span>].grid()</span><br><span class="line"></span><br><span class="line">axs[<span class="number">1</span>].scatter(X_sta[:,<span class="number">0</span>], X_sta[:,<span class="number">1</span>], c=y)</span><br><span class="line">axs[<span class="number">1</span>].set_title(<span class="string">&quot;RobustScaler 縮放數據&quot;</span>)</span><br><span class="line">axs[<span class="number">1</span>].grid()</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/06/13/python-32/pic10.png" class="" title="pic10">
</div>

<h4 id="機器學習-scikit-learn-入門"><a href="#機器學習-scikit-learn-入門" class="headerlink" title="機器學習 scikit-learn 入門"></a>機器學習 scikit-learn 入門</h4><h5 id="使用-scikit-learn-LinearRegression-建立線性回歸模型"><a href="#使用-scikit-learn-LinearRegression-建立線性回歸模型" class="headerlink" title="使用 scikit-learn LinearRegression 建立線性回歸模型"></a>使用 scikit-learn LinearRegression 建立線性回歸模型</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立線性回歸模型</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line"><span class="comment"># 數據擬合模型 model.fit(X=height, y=weight) 做數據擬合, X必需為二維陣列</span></span><br><span class="line">model.fit(X, y)</span><br></pre></td></tr></table></figure>
<ul>
<li>model.predict(height) : 預測新數據</li>
<li>model.score(X_test, Y_test) : 獲得(X_test, Y_test)數據的R平方值</li>
<li>model.intercept_ : 模型方程式的截距</li>
<li>model.coef_ : 模型方程式的迴歸係數</li>
<li>X 必需為二維陣列,可使用 reshape(-1,1) 將一維轉為二維陣列</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 scikit-learn LinearRegression 建立線性回歸模型</span></span><br><span class="line"><span class="comment"># 繪製身高與體重資料圖表</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># reshape(-1,1) 將一維陣列轉為二維陣列</span></span><br><span class="line">height = np.array([<span class="number">1.6</span>, <span class="number">1.63</span>, <span class="number">1.71</span>, <span class="number">1.73</span>, <span class="number">1.83</span>]).reshape(-<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">weight = np.array([<span class="number">55</span>, <span class="number">58</span>, <span class="number">62</span>, <span class="number">65</span>, <span class="number">71</span>])</span><br><span class="line"></span><br><span class="line">plt.plot(height, weight, <span class="string">&quot;ko&quot;</span>)</span><br><span class="line">plt.axis([<span class="number">1.5</span>, <span class="number">1.85</span>, <span class="number">50</span>, <span class="number">90</span>])</span><br><span class="line">plt.title(<span class="string">&quot;身高 vs 體重&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;身高&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;體重&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;height=<span class="subst">&#123;height&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;height[:,0]=<span class="subst">&#123;height[:,<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 建立線性迴歸模型係數</span></span><br><span class="line">coef = np.polyfit(height[:,<span class="number">0</span>], weight, <span class="number">1</span>)</span><br><span class="line"><span class="comment"># 建立線性迴線函數</span></span><br><span class="line">reg = np.poly1d(coef)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;reg(height[:,0]) = <span class="subst">&#123;reg(height[:,<span class="number">0</span>])&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立線性回歸模型</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line"><span class="comment"># 數據擬合模型 model.fit(X=height, y=weight) 做數據擬合, X必需為二維陣列</span></span><br><span class="line">model.fit(X=height, y=weight)</span><br><span class="line"><span class="comment"># y_pred = model.predict(X),執行數據預測 X必需為二維陣列</span></span><br><span class="line">y_pred = model.predict(height)</span><br><span class="line">plt.plot(height, y_pred, c=<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;y_pred=<span class="subst">&#123;y_pred&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># np.polyfit() 與 LinearRegression() 結果是一樣</span></span><br><span class="line"><span class="comment"># height=[[1.6 ]</span></span><br><span class="line"><span class="comment">#  [1.63]</span></span><br><span class="line"><span class="comment">#  [1.71]</span></span><br><span class="line"><span class="comment">#  [1.73]</span></span><br><span class="line"><span class="comment">#  [1.83]]</span></span><br><span class="line"><span class="comment"># height[:,0]=[1.6  1.63 1.71 1.73 1.83]</span></span><br><span class="line"><span class="comment"># reg(height[:,0]) = [55.37073171 57.4195122  62.88292683 64.24878049 71.07804878]</span></span><br><span class="line"><span class="comment"># y_pred=[55.37073171 57.4195122  62.88292683 64.24878049 71.07804878]</span></span><br><span class="line"></span><br><span class="line">plt.grid()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/06/13/python-32/pic11.png" class="" title="pic11">
</div>

<h5 id="資料預測"><a href="#資料預測" class="headerlink" title="資料預測"></a>資料預測</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 資料預測</span></span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># reshape(-1,1) 將一維陣列轉為二維陣列</span></span><br><span class="line">height = np.array([<span class="number">1.6</span>, <span class="number">1.63</span>, <span class="number">1.71</span>, <span class="number">1.73</span>, <span class="number">1.83</span>]).reshape(-<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">weight = np.array([<span class="number">55</span>, <span class="number">58</span>, <span class="number">62</span>, <span class="number">65</span>, <span class="number">71</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立線性回歸模型</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line"><span class="comment"># model.fit(X=height, y=weight) 做數據擬合, X必需為二維陣列</span></span><br><span class="line">model.fit(X=height, y=weight)</span><br><span class="line"><span class="comment"># y_pred = model.predict(X),執行數據預測 X必需為二維陣列</span></span><br><span class="line"><span class="comment"># y_pred = model.predict(height)</span></span><br><span class="line">h = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;輸入身高(cm):&quot;</span>))</span><br><span class="line">h /= <span class="number">100</span></span><br><span class="line">weight_pred = model.predict([[h]])</span><br><span class="line"><span class="built_in">print</span>(weight_pred)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;預測體重: <span class="subst">&#123;weight_pred[<span class="number">0</span>]:<span class="number">.2</span>f&#125;</span> 公斤&quot;</span>)</span><br><span class="line"><span class="comment"># 輸入身高(cm):175</span></span><br><span class="line"><span class="comment"># [65.61463415]</span></span><br><span class="line"><span class="comment"># 預測體重: 65.61 公斤</span></span><br></pre></td></tr></table></figure>

<h5 id="模型的儲存與載入"><a href="#模型的儲存與載入" class="headerlink" title="模型的儲存與載入"></a>模型的儲存與載入</h5><h6 id="pickle"><a href="#pickle" class="headerlink" title="pickle"></a>pickle</h6><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line">pickle.dump(model, save_file)		<span class="comment"># save file</span></span><br><span class="line">model = pickle.load(load_file)	<span class="comment"># load file</span></span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 模型儲存 - python&#x27;s pickle</span></span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># reshape(-1,1) 將一維陣列轉為二維陣列</span></span><br><span class="line">height = np.array([<span class="number">1.6</span>, <span class="number">1.63</span>, <span class="number">1.71</span>, <span class="number">1.73</span>, <span class="number">1.83</span>]).reshape(-<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">weight = np.array([<span class="number">55</span>, <span class="number">58</span>, <span class="number">62</span>, <span class="number">65</span>, <span class="number">71</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立線性回歸模型</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line"><span class="comment"># model.fit(X=height, y=weight) 做數據擬合, X必需為二維陣列</span></span><br><span class="line">model.fit(X=height, y=weight)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 模型儲存</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;model_ch22_9.pkl&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    pickle.dump(model, f)</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 載入模型 - python&#x27;s pickle</span></span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="comment"># 載入模型</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;model_ch22_9.pkl&#x27;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    model = pickle.load(f)</span><br><span class="line"></span><br><span class="line">h = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;輸入身高(cm):&quot;</span>))</span><br><span class="line">h /= <span class="number">100</span></span><br><span class="line">weight_pred = model.predict([[h]])</span><br><span class="line"><span class="built_in">print</span>(weight_pred)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;預測體重: <span class="subst">&#123;weight_pred[<span class="number">0</span>]:<span class="number">.2</span>f&#125;</span> 公斤&quot;</span>)</span><br><span class="line"><span class="comment"># 輸入身高(cm):175</span></span><br><span class="line"><span class="comment"># [65.61463415]</span></span><br><span class="line"><span class="comment"># 預測體重: 65.61 公斤</span></span><br></pre></td></tr></table></figure>

<h6 id="joblib-scikit-learn-建議-可有較好的效率"><a href="#joblib-scikit-learn-建議-可有較好的效率" class="headerlink" title="joblib (scikit-learn 建議,可有較好的效率)"></a>joblib (scikit-learn 建議,可有較好的效率)</h6><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> joblib <span class="keyword">import</span> dump</span><br><span class="line"><span class="keyword">from</span> joblib <span class="keyword">import</span> load</span><br><span class="line"></span><br><span class="line">dump(model, <span class="string">&quot;model_name.joblib&quot;</span>)		<span class="comment"># save file</span></span><br><span class="line">model = load(<span class="string">&quot;model_name.joblib&quot;</span>)		<span class="comment"># load file</span></span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 模型儲存 - joblib(scikit-learn建議)</span></span><br><span class="line"><span class="keyword">from</span> joblib <span class="keyword">import</span> dump</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># reshape(-1,1) 將一維陣列轉為二維陣列</span></span><br><span class="line">height = np.array([<span class="number">1.6</span>, <span class="number">1.63</span>, <span class="number">1.71</span>, <span class="number">1.73</span>, <span class="number">1.83</span>]).reshape(-<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">weight = np.array([<span class="number">55</span>, <span class="number">58</span>, <span class="number">62</span>, <span class="number">65</span>, <span class="number">71</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立線性回歸模型</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line"><span class="comment"># model.fit(X=height, y=weight) 做數據擬合, X必需為二維陣列</span></span><br><span class="line">model.fit(X=height, y=weight)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 模型儲存</span></span><br><span class="line">dump(model, <span class="string">&quot;model_ch22_11.joblib&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 載入模型 - joblib(scikit-learn建議)</span></span><br><span class="line"><span class="keyword">from</span> joblib <span class="keyword">import</span> load</span><br><span class="line"></span><br><span class="line"><span class="comment"># 載入模型</span></span><br><span class="line">model = load(<span class="string">&quot;model_ch22_11.joblib&quot;</span>)</span><br><span class="line"></span><br><span class="line">h = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;輸入身高(cm):&quot;</span>))</span><br><span class="line">h /= <span class="number">100</span></span><br><span class="line">weight_pred = model.predict([[h]])</span><br><span class="line"><span class="built_in">print</span>(weight_pred)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;預測體重: <span class="subst">&#123;weight_pred[<span class="number">0</span>]:<span class="number">.2</span>f&#125;</span> 公斤&quot;</span>)</span><br><span class="line"><span class="comment"># 輸入身高(cm):175</span></span><br><span class="line"><span class="comment"># [65.61463415]</span></span><br><span class="line"><span class="comment"># 預測體重: 65.61 公斤</span></span><br></pre></td></tr></table></figure>

<h5 id="計算線性迴歸線的斜率和截距"><a href="#計算線性迴歸線的斜率和截距" class="headerlink" title="計算線性迴歸線的斜率和截距"></a>計算線性迴歸線的斜率和截距</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 scikit-learn LinearRegression 建立線性回歸模型</span></span><br><span class="line"><span class="comment"># 繪製身高與體中資料圖表</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># reshape(-1,1) 將一維陣列轉為二維陣列</span></span><br><span class="line">height = np.array([<span class="number">1.6</span>, <span class="number">1.63</span>, <span class="number">1.71</span>, <span class="number">1.73</span>, <span class="number">1.83</span>]).reshape(-<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">weight = np.array([<span class="number">55</span>, <span class="number">58</span>, <span class="number">62</span>, <span class="number">65</span>, <span class="number">71</span>])</span><br><span class="line"></span><br><span class="line">plt.plot(height, weight, <span class="string">&quot;ko&quot;</span>)</span><br><span class="line">plt.axis([<span class="number">0</span>, <span class="number">1.9</span>, -<span class="number">150</span>, <span class="number">150</span>])</span><br><span class="line">plt.title(<span class="string">&quot;身高 vs 體重&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;身高&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;體重&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立線性回歸模型</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line"><span class="comment"># model.fit(X=height, y=weight) 做數據擬合, X必需為二維陣列</span></span><br><span class="line">model.fit(X=height, y=weight)</span><br><span class="line"></span><br><span class="line">x_line = np.array([<span class="number">0</span>, <span class="number">1.9</span>]).reshape(-<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line"><span class="comment"># y_pred = model.predict(X),執行數據預測 X必需為二維陣列</span></span><br><span class="line">y_pred = model.predict(x_line)</span><br><span class="line">plt.plot(x_line, y_pred, c=<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 截距與斜率</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;y截距 : <span class="subst">&#123;model.intercept_:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;斜率  : <span class="subst">&#123;model.coef_[<span class="number">0</span>]:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.grid()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># y截距 : -53.90</span></span><br><span class="line"><span class="comment"># 斜率  : 68.29</span></span><br><span class="line"><span class="comment"># 所以方程式為 : weight = 68.29*height - 53.9</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/06/13/python-32/pic12.png" class="" title="pic12">
</div>

<h5 id="R平方係數判定檢驗模型的性能"><a href="#R平方係數判定檢驗模型的性能" class="headerlink" title="R平方係數判定檢驗模型的性能"></a>R平方係數判定檢驗模型的性能</h5><p>$ R^2(y,\hat{y}) &#x3D; 1 - \frac{\sum_{i&#x3D;1}^{n}(y_i - \hat{y}_i)^2} { \sum _{i&#x3D;1}^{n}(y_i - \overline{y})^2 } &#x3D; 1 - \frac{RSS}{TSS}$</p>
<ul>
<li>RSS : Residual Sum of Squares,又稱為殘差平方和(或誤差平方和),表示模型無法解釋的變異性,RSS應盡可能小 </li>
<li>TSS : Total of Squares,又稱為總平方和,衡量目標變數的變異性,表示目標變數的總變異性,TSS是模型預測值和實際值差異的上限</li>
<li>R 平方係數應盡可能接近 1</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score</span><br><span class="line"></span><br><span class="line"><span class="comment"># reshape(-1,1) 將一維陣列轉為二維陣列</span></span><br><span class="line">height = np.array([<span class="number">1.6</span>, <span class="number">1.63</span>, <span class="number">1.71</span>, <span class="number">1.73</span>, <span class="number">1.83</span>]).reshape(-<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">weight = np.array([<span class="number">55</span>, <span class="number">58</span>, <span class="number">62</span>, <span class="number">65</span>, <span class="number">71</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立線性回歸模型</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line"><span class="comment"># model.fit(X=height, y=weight) 做數據擬合, X必需為二維陣列</span></span><br><span class="line">model.fit(X=height, y=weight)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 手工計算 RSS</span></span><br><span class="line"><span class="comment"># np.ravel 將原陣列降為一維,若修改會影響原值</span></span><br><span class="line"><span class="comment"># np.flatten 將原陣列降為一維,若修改不會影響原值</span></span><br><span class="line">RSS = np.<span class="built_in">sum</span>((weight - np.ravel(model.predict(height))) ** <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;RSS : <span class="subst">&#123;RSS:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 手工計算 TSS</span></span><br><span class="line">mean_weight = np.mean(weight)</span><br><span class="line">TSS = np.<span class="built_in">sum</span>((weight - mean_weight) ** <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;TSS : <span class="subst">&#123;TSS:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 手工計算 R平方係數</span></span><br><span class="line">R_quare = <span class="number">1</span> - (RSS/TSS)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;手工計算 R平方係數 : <span class="subst">&#123;R_quare:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 函數計算 R平方係數</span></span><br><span class="line"><span class="comment"># LinearRegression 內含 R平方係數函數,不可使用 sklearn.metrics - r2_score</span></span><br><span class="line">R_score = model.score(height, weight)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;函數計算 R平方係數 : <span class="subst">&#123;R_score:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># RSS : 1.82</span></span><br><span class="line"><span class="comment"># TSS : 154.80</span></span><br><span class="line"><span class="comment"># 手工計算 R平方係數 : 0.99</span></span><br><span class="line"><span class="comment"># 函數計算 R平方係數 : 0.99</span></span><br></pre></td></tr></table></figure>

<h4 id="分類演算法-機器學習模型的性能評估"><a href="#分類演算法-機器學習模型的性能評估" class="headerlink" title="分類演算法 - 機器學習模型的性能評估"></a>分類演算法 - 機器學習模型的性能評估</h4><h5 id="計算精確度-accuracy-score"><a href="#計算精確度-accuracy-score" class="headerlink" title="計算精確度 accuracy_score()"></a>計算精確度 accuracy_score()</h5><p>計算分類器的準確度</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score</span><br><span class="line">	...</span><br><span class="line">accuracy_score(y_true, y_pred, normalize=<span class="literal">True</span>, sample_weight=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>y_true : 真實目標值陣列</li>
<li>y_pred : 模型預測值</li>
<li>normalize : True(default)返回正確比例, Flase返回正確分類總數</li>
<li>sample_weight : option,可提供各個權重</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 精確度</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score</span><br><span class="line"></span><br><span class="line">y_true = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>]</span><br><span class="line">y_pred = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Accuacy Score : <span class="subst">&#123;accuracy_score(y_true, y_pred)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># Accuacy Score : 0.8333333333333334</span></span><br></pre></td></tr></table></figure>

<h5 id="召回率-recall-score"><a href="#召回率-recall-score" class="headerlink" title="召回率 recall_score()"></a>召回率 recall_score()</h5><p>計算正標籤正確比例</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> recall_score</span><br><span class="line"> ...</span><br><span class="line">recall_score(y_true, y_pred, sample_weight=<span class="literal">None</span>) </span><br></pre></td></tr></table></figure>
<ul>
<li>y_true : 真實目標值陣列</li>
<li>y_pred : 模型預測值</li>
<li>sample_weight : option,可提供各個權重</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 召回率:計算正類別標籤正確比例</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> recall_score</span><br><span class="line"></span><br><span class="line">y_true = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">y_pred = [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Recall Score : <span class="subst">&#123;recall_score(y_true, y_pred)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 正類別標籤(1)有4個,正確預測3個</span></span><br><span class="line"><span class="comment"># Recall Score : 0.75</span></span><br></pre></td></tr></table></figure>

<h5 id="F1-分數-f1-score"><a href="#F1-分數-f1-score" class="headerlink" title="F1 分數 f1_score()"></a>F1 分數 f1_score()</h5><p>F1 分數是精確率（Precision）和召回率（Recall）的調和平均數,對於不平衡的數據集,F1分數是一個較好的指標<br>不平衡數據集（Imbalanced Dataset）指的是在數據集中，不同類別的樣本數量分布不均勻</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> f1_score</span><br><span class="line">	...</span><br><span class="line">f1_score(t_true, t_pred, sample_weight=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<p>公式如下 :<br>$F1&#x3D; 2 × 	\frac{Precision×Recall<br>}{Precision+Recall} $<br>精確率（Precision） 是指在模型預測為正類的所有樣本中，實際為正類的比例。<br>召回率（Recall） 是指在實際為正類的所有樣本中，被模型正確預測為正類的比例。</p>
<p>計算步驟 :</p>
<ul>
<li>真正類（True Positives，TP）：正確預測為正類的數量。</li>
<li>偽正類（False Positives，FP）：錯誤預測為正類的數量。</li>
<li>偽負類（False Negatives，FN）：錯誤預測為負類的數量。</li>
<li>真負類（True Negatives，TN）：正確預測為負類的數量。</li>
</ul>
<p>精確率（Precision） &#x3D; TP &#x2F; (TP + FP)<br>召回率（Recall） &#x3D; TP &#x2F; (TP + FN)<br>Precision &#x3D; TP &#x2F; (TP + FP) &#x3D; 3&#x2F;(3 + 0) &#x3D; 1<br>Recall &#x3D; TP &#x2F; (TP + FN) &#x3D; 3&#x2F;(3 + 1) &#x3D; 0.75<br>F1 &#x3D; 2 * (Precision<em>Recall)&#x2F;(Precision+Recall) &#x3D; 2 * (1</em>0.75)&#x2F;(1+0.75) &#x3D; 0.8571428571</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># F1 分數:精確率(precision)和召回率(recall)的平均數</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> f1_score</span><br><span class="line"></span><br><span class="line">t_true = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">t_pred = [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;F1 Score : <span class="subst">&#123;f1_score(t_true, t_pred)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># F1 Score : 0.8571428571428571</span></span><br></pre></td></tr></table></figure>

<h5 id="分類報告-classification-report"><a href="#分類報告-classification-report" class="headerlink" title="分類報告 classification_report()"></a>分類報告 classification_report()</h5><p>分類報告提供多個類別的性能指標</p>
<ul>
<li>精確度(Precision):</li>
<li>召回率(Recall):</li>
<li>F1分數(F1 Score)</li>
<li>準確度(Accuracy)</li>
<li>算術平均(Macro average):對每個類別進行算術平均</li>
<li>加權平均(Weighted average):對每個類別進行加權平均</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> classification_report</span><br><span class="line"></span><br><span class="line">y_true = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">y_pred = [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">report = classification_report(y_true, y_pred)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;分類報告 :&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(report)</span><br><span class="line"><span class="comment"># 分類報告 :</span></span><br><span class="line"><span class="comment">#               precision    recall  f1-score   support</span></span><br><span class="line"><span class="comment">#            0       0.50      0.33      0.40         3 0 的 F1 Score</span></span><br><span class="line"><span class="comment">#            1       0.60      0.75      0.67         4 1 的 F1 Score</span></span><br><span class="line"><span class="comment">#     accuracy                           0.57         7 準確度</span></span><br><span class="line"><span class="comment">#    macro avg       0.55      0.54      0.53         7 算術平均</span></span><br><span class="line"><span class="comment"># weighted avg       0.56      0.57      0.55         7 加權平均</span></span><br><span class="line"><span class="comment">#										 0.55 = (0.50 + 0.56)/2</span></span><br><span class="line"><span class="comment">#										 0.56 = (0.50 * 3 + 0.60 * 4)/7</span></span><br></pre></td></tr></table></figure>

<h5 id="混淆矩陣-confusion-maxtrix"><a href="#混淆矩陣-confusion-maxtrix" class="headerlink" title="混淆矩陣 confusion_maxtrix()"></a>混淆矩陣 confusion_maxtrix()</h5><p>列(row)表實際類別,行(column)表預測類別</p>
<div style="max-width:500px">
  <img src="/2024/06/13/python-32/pic13.png" class="" title="pic13">
</div>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> confusion_matrix</span><br><span class="line">confusion_matrix(y_true, y_pred, sample_weight=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> confusion_matrix</span><br><span class="line"></span><br><span class="line">y_true = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">y_pred = [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">cm = confusion_matrix(y_true, y_pred)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;混淆矩陣 :&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(cm)</span><br><span class="line"><span class="comment"># 混淆矩陣 :			猜0		 猜1</span></span><br><span class="line"><span class="comment"># [[1 2]			0		1			2</span></span><br><span class="line"><span class="comment">#  [1 3]]			1		1			3	</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/06/13/python-32/pic13.png" class="" title="pic13">
</div>

<h5 id="ROC-AUC-分數"><a href="#ROC-AUC-分數" class="headerlink" title="ROC_AUC 分數"></a>ROC_AUC 分數</h5><p>roc_auc_score() 用於衡量二元分類器性能的函數<br>ROC(Receiver Operating Characteristic)接收操作者特性<br>AUC(Area Under the Curve)ROC曲線下面的面積<br>roc_auc_score()計算接收者操作特性曲線下面的面積分數的方法</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> roc_auc_score</span><br><span class="line">	...</span><br><span class="line">roc_auc_score(y_true, y_scores)</span><br></pre></td></tr></table></figure>
<ul>
<li>y_true : 真實標籤,通常以0和1的形式出現,某些情況下可能是-1和1</li>
<li>y_pred : 分類器預測為正類(1)的機率</li>
<li>返回0和1間的分數,越接近1,模型性能越好.越接近0,模型性能越差.若為0.5,相當於隨機猜測.</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> roc_auc_score, roc_curve</span><br><span class="line"></span><br><span class="line">y_true = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">y_scores = [<span class="number">0.1</span>, <span class="number">0.4</span>, <span class="number">0.35</span>, <span class="number">0.8</span>]</span><br><span class="line">auc_score = roc_auc_score(y_true, y_scores)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ROC AUC 分數 : <span class="subst">&#123;auc_score&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># ROC AUC 分數 : 0.75</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 計算FPR和TPR</span></span><br><span class="line">fpr, tpr, thresholds = roc_curve(y_true, y_scores)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;fpr=<span class="subst">&#123;fpr&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;tpr=<span class="subst">&#123;tpr&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;thresholds=<span class="subst">&#123;thresholds&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># fpr=[0.  0.  0.5 0.5 1. ]</span></span><br><span class="line"><span class="comment"># tpr=[0.  0.5 0.5 1.  1. ]</span></span><br><span class="line"><span class="comment"># thresholds=[ inf 0.8  0.4  0.35 0.1 ]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 繪製ROC曲線</span></span><br><span class="line">plt.figure()</span><br><span class="line">plt.plot(fpr, tpr, color=<span class="string">&#x27;darkorange&#x27;</span>, lw=<span class="number">2</span>, label=<span class="string">f&#x27;ROC curve (area = <span class="subst">&#123;auc_score:<span class="number">.2</span>f&#125;</span>)&#x27;</span>)</span><br><span class="line">plt.plot([<span class="number">0</span>, <span class="number">1</span>], [<span class="number">0</span>, <span class="number">1</span>], color=<span class="string">&#x27;navy&#x27;</span>, lw=<span class="number">2</span>, linestyle=<span class="string">&#x27;--&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 標示出梯形的面積區域</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(fpr)):</span><br><span class="line">    plt.fill_betweenx([<span class="number">0</span>, tpr[i]], fpr[i-<span class="number">1</span>], fpr[i], color=<span class="string">&#x27;orange&#x27;</span>, alpha=<span class="number">0.3</span>)</span><br><span class="line"></span><br><span class="line">plt.xlim([<span class="number">0.0</span>, <span class="number">1.0</span>])</span><br><span class="line">plt.ylim([<span class="number">0.0</span>, <span class="number">1.0</span>])</span><br><span class="line">plt.xlabel(<span class="string">&#x27;False Positive Rate&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;True Positive Rate&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Receiver Operating Characteristic (ROC)&#x27;</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;lower right&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>面積計算 &#x3D; 0.5 * 0.5 + 0.5 * 1 &#x3D; 0.75</p>
<div style="max-width:500px">
  <img src="/2024/06/13/python-32/pic15.png" class="" title="pic15">
</div>

<h4 id="機器學習必須學會的非數值資料轉換"><a href="#機器學習必須學會的非數值資料轉換" class="headerlink" title="機器學習必須學會的非數值資料轉換"></a>機器學習必須學會的非數值資料轉換</h4><h5 id="One-hot-編碼"><a href="#One-hot-編碼" class="headerlink" title="One-hot 編碼"></a>One-hot 編碼</h5><p>One-hot編碼是一種將類別行變數轉為數執行變數的方法.<br>pandas get_dummies() 可將類別變數轉為 one-hot 編碼<br>pd.get_dummies(df, columns&#x3D;None, prefix&#x3D;None ,prefix_sep&#x3D;’_’, drop_first&#x3D;False)</p>
<ul>
<li>df : 要進行編碼的 DataFrame</li>
<li>columns : 要進行編碼的欄位名稱,None 表對所有欄位</li>
<li>prefix : 對虛擬變數添加的前綴(default None)</li>
<li>prefix_sep : 連接原始欄位名稱和類別名稱的分隔符</li>
<li>drop_first : 是否刪除第一個類別的虛擬變數</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;<span class="string">&quot;color&quot;</span>: [<span class="string">&quot;red&quot;</span>, <span class="string">&quot;blue&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>] &#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="comment">#    color</span></span><br><span class="line"><span class="comment"># 0    red</span></span><br><span class="line"><span class="comment"># 1   blue</span></span><br><span class="line"><span class="comment"># 2  green</span></span><br><span class="line"><span class="comment"># 3   blue</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 pandas&#x27;s get_dummies() 進行 one-hot 編碼</span></span><br><span class="line">encoded_df = pd.get_dummies(df, columns=[<span class="string">&#x27;color&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(encoded_df)</span><br><span class="line"><span class="comment">#    color_blue  color_green  color_red</span></span><br><span class="line"><span class="comment"># 0       False        False       True</span></span><br><span class="line"><span class="comment"># 1        True        False      False</span></span><br><span class="line"><span class="comment"># 2       False         True      False</span></span><br><span class="line"><span class="comment"># 3        True        False      False</span></span><br></pre></td></tr></table></figure>

<h5 id="特徵名稱由中文改為英文"><a href="#特徵名稱由中文改為英文" class="headerlink" title="特徵名稱由中文改為英文"></a>特徵名稱由中文改為英文</h5><p>pd.rename 用於重命名 DataFrame 或 Series 中的標籤（column或index）<br>pd.rename(mapper&#x3D;None, index&#x3D;None, columns&#x3D;None,<br>                axis&#x3D;None, inplace&#x3D;False)</p>
<ul>
<li>mapper : 字典或函數，用於指定新舊標籤之間的映射關係</li>
<li>index : 與 mapper 類似，用於指定索引重命名的映射</li>
<li>columns : 與 mapper 類似，用於指定列重命名的映射</li>
<li>axis : 指定沿哪個軸進行重命名，0 或 ‘index’ 表示重命名索引，1 或 ‘columns’ 表示重命名列。</li>
<li>inplace : 默認為 False。如果設置為 True，則會在原 DataFrame 上進行修改，而不返回新對象</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df = pd.read_csv(<span class="string">&quot;個人資料.csv&quot;</span>)</span><br><span class="line"><span class="comment"># column 對齊資料</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.ambiguous_as_wide&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 若含有中英文資料可以對齊</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(df.columns)</span><br><span class="line">columns = &#123;</span><br><span class="line">    <span class="string">&quot;編號&quot;</span>:<span class="string">&quot;ID&quot;</span>,</span><br><span class="line">    <span class="string">&quot;學歷&quot;</span>:<span class="string">&quot;Education&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df.rename(columns=columns, inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(df.head())</span><br><span class="line"><span class="comment">#    編號         學歷</span></span><br><span class="line"><span class="comment"># 0   101         高中</span></span><br><span class="line"><span class="comment"># 1   102         大學</span></span><br><span class="line"><span class="comment"># 2   103         碩士</span></span><br><span class="line"><span class="comment"># 3   104         博士</span></span><br><span class="line"><span class="comment"># 4   105  high_school</span></span><br><span class="line"><span class="comment"># Index([&#x27;編號&#x27;, &#x27;學歷&#x27;], dtype=&#x27;object&#x27;)</span></span><br><span class="line"><span class="comment">#     ID    Education</span></span><br><span class="line"><span class="comment"># 0  101         高中</span></span><br><span class="line"><span class="comment"># 1  102         大學</span></span><br><span class="line"><span class="comment"># 2  103         碩士</span></span><br><span class="line"><span class="comment"># 3  104         博士</span></span><br><span class="line"><span class="comment"># 4  105  high_school</span></span><br></pre></td></tr></table></figure>

<h5 id="資料對應-map-方法"><a href="#資料對應-map-方法" class="headerlink" title="資料對應 map() 方法"></a>資料對應 map() 方法</h5><p>pd.map() 可轉換資料為數值資料,字典key是原始資料,直是替換結果</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">edu = &#123;<span class="string">&#x27;高中&#x27;</span>:<span class="number">1</span>, <span class="string">&#x27;大學&#x27;</span>:<span class="number">2</span>, <span class="string">&#x27;碩士&#x27;</span>:<span class="number">3</span>, <span class="string">&#x27;博士&#x27;</span>:<span class="number">4</span>, <span class="string">&#x27;high_school&#x27;</span>:<span class="number">99</span>  &#125;</span><br><span class="line">df[<span class="string">&#x27;Education&#x27;</span>] = df[<span class="string">&#x27;Education&#x27;</span>].<span class="built_in">map</span>(edu)</span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># map number to string</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">iris =  pd.Series([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;執行 map() 前\n<span class="subst">&#123;iris&#125;</span>&quot;</span>)</span><br><span class="line">iris = iris.<span class="built_in">map</span>(&#123;<span class="number">0</span>:<span class="string">&#x27;setosa&#x27;</span>, <span class="number">1</span>:<span class="string">&#x27;versicolor&#x27;</span>, <span class="number">2</span>:<span class="string">&#x27;virginica&#x27;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;執行 map() 後\n<span class="subst">&#123;iris&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 執行 map() 前</span></span><br><span class="line"><span class="comment"># 0    0</span></span><br><span class="line"><span class="comment"># 1    1</span></span><br><span class="line"><span class="comment"># 2    2</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br><span class="line"><span class="comment"># 執行 map() 後</span></span><br><span class="line"><span class="comment"># 0        setosa</span></span><br><span class="line"><span class="comment"># 1    versicolor</span></span><br><span class="line"><span class="comment"># 2     virginica</span></span><br><span class="line"><span class="comment"># dtype: object</span></span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df = pd.read_csv(<span class="string">&quot;個人資料.csv&quot;</span>)</span><br><span class="line"><span class="comment"># column 對齊資料</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.ambiguous_as_wide&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 若含有中英文資料可以對齊</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">columns = &#123;</span><br><span class="line">    <span class="string">&quot;編號&quot;</span>:<span class="string">&quot;ID&quot;</span>,</span><br><span class="line">    <span class="string">&quot;學歷&quot;</span>:<span class="string">&quot;Education&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">df.rename(columns=columns, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">edu = &#123;<span class="string">&#x27;高中&#x27;</span>:<span class="number">1</span>, <span class="string">&#x27;大學&#x27;</span>:<span class="number">2</span>, <span class="string">&#x27;碩士&#x27;</span>:<span class="number">3</span>, <span class="string">&#x27;博士&#x27;</span>:<span class="number">4</span>, <span class="string">&#x27;high_school&#x27;</span>:<span class="number">99</span>  &#125;</span><br><span class="line">df[<span class="string">&#x27;Education&#x27;</span>] = df[<span class="string">&#x27;Education&#x27;</span>].<span class="built_in">map</span>(edu)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df.head())</span><br><span class="line"><span class="comment">#     ID  Education</span></span><br><span class="line"><span class="comment"># 0  101          1</span></span><br><span class="line"><span class="comment"># 1  102          2</span></span><br><span class="line"><span class="comment"># 2  103          3</span></span><br><span class="line"><span class="comment"># 3  104          4</span></span><br><span class="line"><span class="comment"># 4  105         99</span></span><br></pre></td></tr></table></figure>

<h5 id="標籤轉換-LabelEncoder"><a href="#標籤轉換-LabelEncoder" class="headerlink" title="標籤轉換 LabelEncoder()"></a>標籤轉換 LabelEncoder()</h5><p>LabelEncoder() 可將標籤轉換為0 ~ n_classs-1值</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder</span><br><span class="line"></span><br><span class="line">fruits = [<span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;chery&#x27;</span>, <span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;chery&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>]</span><br><span class="line"><span class="comment"># 創建 LabelEncoder 物件</span></span><br><span class="line">label = LabelEncoder()</span><br><span class="line"></span><br><span class="line"><span class="comment"># fit_transform 轉為數值</span></span><br><span class="line">fruits_encoded = label.fit_transform(fruits)</span><br><span class="line"><span class="built_in">print</span>(fruits_encoded)</span><br><span class="line"></span><br><span class="line"><span class="comment"># inverse_transform 轉回原來文字</span></span><br><span class="line"><span class="built_in">print</span>(label.inverse_transform(fruits_encoded))</span><br><span class="line"><span class="comment"># [0 0 1 0 1 2]</span></span><br><span class="line"><span class="comment"># [&#x27;apple&#x27; &#x27;apple&#x27; &#x27;chery&#x27; &#x27;apple&#x27; &#x27;chery&#x27; &#x27;orange&#x27;]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeRegressor</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment">#定義特徵</span></span><br><span class="line">features =[[<span class="string">&#x27;晴&#x27;</span>,<span class="string">&#x27;熱&#x27;</span>,<span class="string">&#x27;弱&#x27;</span>],</span><br><span class="line">           [<span class="string">&#x27;晴&#x27;</span>,<span class="string">&#x27;熱&#x27;</span>,<span class="string">&#x27;強&#x27;</span>],</span><br><span class="line">           [<span class="string">&#x27;陰&#x27;</span>,<span class="string">&#x27;熱&#x27;</span>,<span class="string">&#x27;弱&#x27;</span>],</span><br><span class="line">           [<span class="string">&#x27;雨&#x27;</span>,<span class="string">&#x27;涼&#x27;</span>,<span class="string">&#x27;弱&#x27;</span>],</span><br><span class="line">           [<span class="string">&#x27;雨&#x27;</span>,<span class="string">&#x27;冷&#x27;</span>,<span class="string">&#x27;弱&#x27;</span>],</span><br><span class="line">           [<span class="string">&#x27;雨&#x27;</span>,<span class="string">&#x27;冷&#x27;</span>,<span class="string">&#x27;強&#x27;</span>],</span><br><span class="line">           [<span class="string">&#x27;陰&#x27;</span>,<span class="string">&#x27;冷&#x27;</span>,<span class="string">&#x27;強&#x27;</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 將特徵轉為數字編碼</span></span><br><span class="line">features_encoded = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(features[<span class="number">0</span>])):</span><br><span class="line">    <span class="comment"># 創建 LabelEncoder 物件</span></span><br><span class="line">    le = LabelEncoder()</span><br><span class="line">    <span class="comment"># fit_transform 轉為數值</span></span><br><span class="line">    feature_encoded = le.fit_transform([row[i] <span class="keyword">for</span> row <span class="keyword">in</span> features])</span><br><span class="line">    features_encoded.append(feature_encoded)</span><br><span class="line"><span class="comment"># 3*7 陣列,轉成 7*3 陣列</span></span><br><span class="line">features_encoded = np.array(features_encoded).T</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;特徵標籤編碼\n<span class="subst">&#123;features_encoded&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 特徵標籤編碼</span></span><br><span class="line"><span class="comment"># [[0 2 0]</span></span><br><span class="line"><span class="comment">#  [0 2 1]</span></span><br><span class="line"><span class="comment">#  [1 2 0]</span></span><br><span class="line"><span class="comment">#  [2 1 0]</span></span><br><span class="line"><span class="comment">#  [2 0 0]</span></span><br><span class="line"><span class="comment">#  [2 0 1]</span></span><br><span class="line"><span class="comment">#  [1 0 1]]</span></span><br></pre></td></tr></table></figure>

<h4 id="機器學習演算法"><a href="#機器學習演算法" class="headerlink" title="機器學習演算法"></a>機器學習演算法</h4><ul>
<li>監督學習法<ul>
<li>線性迴歸</li>
<li>邏輯迴歸</li>
<li>KNN 演算法</li>
<li>支持向量機(SVM)</li>
<li>決策樹</li>
<li>隨機森林</li>
</ul>
</li>
<li>無監督學習法<ul>
<li>分群(或稱聚類)分析(如:K-means)</li>
<li>降維(如:主成份分析(PCA))</li>
</ul>
</li>
</ul>
<h4 id="使用隨機數據學習性迴歸"><a href="#使用隨機數據學習性迴歸" class="headerlink" title="使用隨機數據學習性迴歸"></a>使用隨機數據學習性迴歸</h4><h5 id="使用隨機數據測試迴歸模型"><a href="#使用隨機數據測試迴歸模型" class="headerlink" title="使用隨機數據測試迴歸模型"></a>使用隨機數據測試迴歸模型</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_regression</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成數據</span></span><br><span class="line">X, y = make_regression(n_features=<span class="number">1</span>, noise=<span class="number">20</span>, random_state=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分割測試數據與測試數據</span></span><br><span class="line">X_train, X_test, y_train, y_test = \</span><br><span class="line">    train_test_split(X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立線性回歸模型</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line"><span class="comment"># 數據擬合模型 model.fit(X=height, y=weight) 做數據擬合, X必需為二維陣列</span></span><br><span class="line">model.fit(X=X_train, y=y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 繪資料圖</span></span><br><span class="line">plt.scatter(X_train, y_train, label=<span class="string">&quot;訓練數據&quot;</span>)</span><br><span class="line">plt.scatter(X_test, y_test, label=<span class="string">&quot;測試數據&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 繪迴歸線</span></span><br><span class="line">y_pred = model.predict(X_test)</span><br><span class="line">plt.plot(X_test, y_pred, color=<span class="string">&#x27;red&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 計算 R 平方數</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;R2_Score:<span class="subst">&#123;r2_score(y_test, y_pred):<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.legend()</span><br><span class="line">plt.axis([-<span class="number">3</span>, <span class="number">3</span>, -<span class="number">150</span>, <span class="number">150</span>])</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># R2_Score:0.76</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/06/13/python-32/pic16.png" class="" title="pic16">
</div>

<h5 id="score-和-r2-score-的差異"><a href="#score-和-r2-score-的差異" class="headerlink" title="score() 和 r2_score() 的差異"></a>score() 和 r2_score() 的差異</h5><p>scikit-learn 中 score() 和 r2_score() 都可以計算R平方判定係數,但場景有一些差異</p>
<ul>
<li><p>score(X, y) :</p>
  <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line">model = LinearRegression().fit(X_train, y_train)</span><br><span class="line">r2 = model.score(x_test, y_test)</span><br></pre></td></tr></table></figure>
</li>
<li><p>r2_score(y_true, y_pred) :</p>
  <figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score</span><br><span class="line">y_pred = model.predict(X_test)</span><br><span class="line">r2 = r2_score(y_test, y_pred)</span><br></pre></td></tr></table></figure></li>
</ul>
<p>如果你想快速地在個模型上計算R平方判定係數,score(X, y)較方便,如你需要更多的靈活性,如比對不同模型的預測效果,或你已有預測結果,r2_score(y_true, y_pred)可能更適合</p>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><h4 id="儲存公式"><a href="#儲存公式" class="headerlink" title="儲存公式"></a>儲存公式</h4><a href="/2024/06/27/python-33/" title="# 邏輯迴歸模型語法基礎"># 邏輯迴歸模型語法基礎</a>

<h4 id="數據"><a href="#數據" class="headerlink" title="數據"></a>數據</h4><h5 id="創建聚類算法的測試數據集"><a href="#創建聚類算法的測試數據集" class="headerlink" title="創建聚類算法的測試數據集"></a>創建聚類算法的測試數據集</h5><a href="/2024/06/27/python-33/" title="# 繪製散點圖"># 繪製散點圖</a>

<h5 id="生成合成線性回歸數據集"><a href="#生成合成線性回歸數據集" class="headerlink" title="生成合成線性回歸數據集"></a>生成合成線性回歸數據集</h5><a href="/2024/06/27/python-33/" title="# 線性回歸數據集-繪製散點圖"># 線性回歸數據集-繪製散點圖</a>

<h4 id="邏輯迴歸"><a href="#邏輯迴歸" class="headerlink" title="邏輯迴歸"></a>邏輯迴歸</h4><h5 id="基本計算"><a href="#基本計算" class="headerlink" title="基本計算"></a>基本計算</h5><a href="/2024/06/27/python-33/" title="# 邏輯迴歸模型語法基礎"># 邏輯迴歸模型語法基礎</a>

<h5 id="特徵縮放-對邏輯迴歸很重要-因各特徵數值大小有差異"><a href="#特徵縮放-對邏輯迴歸很重要-因各特徵數值大小有差異" class="headerlink" title="特徵縮放 - 對邏輯迴歸很重要,因各特徵數值大小有差異"></a>特徵縮放 - 對邏輯迴歸很重要,因各特徵數值大小有差異</h5><a href="/2024/06/27/python-33/" title="# 用最相關2個特徵,設計邏輯迴歸模型"># 用最相關2個特徵,設計邏輯迴歸模型</a>

<h4 id="決策樹"><a href="#決策樹" class="headerlink" title="決策樹"></a>決策樹</h4><h5 id="基本例子"><a href="#基本例子" class="headerlink" title="基本例子"></a>基本例子</h5><a href="/2024/06/27/python-33/" title="# 天氣數據實例"># 天氣數據實例</a>

<h5 id="繪製決策樹"><a href="#繪製決策樹" class="headerlink" title="繪製決策樹"></a>繪製決策樹</h5><a href="/2024/06/27/python-33/" title="# 繪製決策樹"># 繪製決策樹</a>






    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/python/" rel="tag"># python</a>
              <a href="/tags/ML/" rel="tag"># ML</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/06/05/python-31/" rel="prev" title="Seaborn">
                  <i class="fa fa-chevron-left"></i> Seaborn
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/06/27/python-33/" rel="next" title="(2) 機器學習最強入門:基礎數學/機率/統計邁向AI真實數據">
                  (2) 機器學習最強入門:基礎數學/機率/統計邁向AI真實數據 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    
  <div class="comments" id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Robert Kao</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="總字數">2.7m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="所需總閱讀時間">41:16</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 強力驅動
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="/js/local-search.js"></script>






  




  <script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'none'
      },
      options: {
        renderActions: {
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              const target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js';
    script.defer = true;
    document.head.appendChild(script);
  } else {
    MathJax.startup.document.state(0);
    MathJax.typesetClear();
    MathJax.texReset();
    MathJax.typeset();
  }
</script>



<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://hot5656-blog.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://hot5656.github.io/2024/06/13/python-32/";
    this.page.identifier = "2024/06/13/python-32/";
    this.page.title = "scikit-learn";
    };
  NexT.utils.loadComments('#disqus_thread', () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://hot5656-blog.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
