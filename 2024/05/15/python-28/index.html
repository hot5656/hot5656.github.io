<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hot5656.github.io","root":"/","images":"/images","scheme":"Gemini","version":"8.2.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜尋...","empty":"我們無法找到任何有關 ${query} 的搜索結果","hits_time":"${hits} 找到 ${time} 個結果","hits":"找到 ${hits} 個結果"},"path":"/search.json","localsearch":{"enable":"enable","trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false}};
  </script>
<meta name="description" content="名詞一般名詞 人工智慧(Articial Intelligence) 機器學習(Machine Learning) 深入學習(Deep Learning) 神經網路(Neural Network) 卷積神經網路(Convolutional Neural Network) Tensorflow">
<meta property="og:type" content="article">
<meta property="og:title" content="(1) 機器學習最強入門:基礎數學&#x2F;機率&#x2F;統計邁向AI真實數據">
<meta property="og:url" content="https://hot5656.github.io/2024/05/15/python-28/index.html">
<meta property="og:site_name" content="Robert 雜記">
<meta property="og:description" content="名詞一般名詞 人工智慧(Articial Intelligence) 機器學習(Machine Learning) 深入學習(Deep Learning) 神經網路(Neural Network) 卷積神經網路(Convolutional Neural Network) Tensorflow">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic1.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic2.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic3.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic4.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic5.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic6.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic7.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic8.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic9.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic10.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic11.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic12.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic13.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic14.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic15.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic16.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic17.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic18.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic23.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic19.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic20.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic21.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic22.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic24.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic25.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic26.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic27.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic28.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic29.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic30.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic31.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic32.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic33.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic34.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic35.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic36.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic37.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic38.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic39.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic40.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic41.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic42.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic43.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic44.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic45.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic46.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic47.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic48.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic49.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic50.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic51.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic52.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic53.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic54.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic55.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic56.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic57.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic58.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic59.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic60.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic61.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic62.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic63.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic64.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic65.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic66.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic67.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic69.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic68.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic70.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic71.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic72.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic73.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic74.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic75.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic76.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic77.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic78.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic79.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic80.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic81.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic82.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic83.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic84.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic85.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic86.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic87.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic88.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic89.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic90.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic91.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic92.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic93.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic94.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic95.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic96.png">
<meta property="og:image" content="https://hot5656.github.io/2024/05/15/python-28/pic97.png">
<meta property="article:published_time" content="2024-05-15T07:32:27.000Z">
<meta property="article:modified_time" content="2024-07-01T04:08:04.743Z">
<meta property="article:author" content="Robert Kao">
<meta property="article:tag" content="book">
<meta property="article:tag" content="python">
<meta property="article:tag" content="ML">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hot5656.github.io/2024/05/15/python-28/pic1.png">


<link rel="canonical" href="https://hot5656.github.io/2024/05/15/python-28/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-TW'
  };
</script>
<title>(1) 機器學習最強入門:基礎數學/機率/統計邁向AI真實數據 | Robert 雜記</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Robert 雜記</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首頁</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>標籤</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分類</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>歸檔列表</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜尋
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜尋..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8D%E8%A9%9E"><span class="nav-number">1.</span> <span class="nav-text">名詞</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E8%88%AC%E5%90%8D%E8%A9%9E"><span class="nav-number">1.1.</span> <span class="nav-text">一般名詞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92"><span class="nav-number">1.2.</span> <span class="nav-text">機器學習</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92%E6%87%89%E7%94%A8"><span class="nav-number">1.3.</span> <span class="nav-text">機器學習應用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B7%B1%E5%BA%A6%E5%AD%B8%E7%BF%92"><span class="nav-number">1.4.</span> <span class="nav-text">深度學習</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B8%E5%AD%B8"><span class="nav-number">1.5.</span> <span class="nav-text">數學</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%B9%E7%A8%8B%E5%BC%8F%E8%88%87%E5%87%BD%E6%95%B8"><span class="nav-number">2.</span> <span class="nav-text">方程式與函數</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E5%85%83%E5%87%BD%E6%95%B8"><span class="nav-number">2.1.</span> <span class="nav-text">二元函數</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link"><span class="nav-number">2.1.1.</span> <span class="nav-text"># 二元函數3D圖(Z&#x3D;X+Y)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#-1"><span class="nav-number">2.1.2.</span> <span class="nav-text"># 等高圖</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sympy"><span class="nav-number">2.2.</span> <span class="nav-text">sympy</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#sympy-%E8%AA%AA%E6%98%8E"><span class="nav-number">2.2.1.</span> <span class="nav-text">sympy 說明</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A7%A3%E4%B8%80%E5%85%83%E4%B8%80%E6%AC%A1%E6%96%B9%E7%A8%8B%E5%BC%8F"><span class="nav-number">2.2.2.</span> <span class="nav-text">解一元一次方程式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A7%A3%E8%81%AF%E7%AB%8B%E6%96%B9%E7%A8%8B%E5%BC%8F"><span class="nav-number">2.2.3.</span> <span class="nav-text">解聯立方程式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A7%A3%E4%B8%80%E5%85%83%E4%BA%8C%E6%AC%A1%E6%96%B9%E7%A8%8B%E5%BC%8F"><span class="nav-number">2.2.4.</span> <span class="nav-text">解一元二次方程式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#FiniteSet-%E5%BB%BA%E7%AB%8B%E9%9B%86%E5%90%88"><span class="nav-number">2.2.5.</span> <span class="nav-text">FiniteSet - 建立集合</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%81%AF%E7%AB%8B%E6%96%B9%E7%A8%8B%E5%BC%8F"><span class="nav-number">3.</span> <span class="nav-text">聯立方程式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A4%90%E5%BB%B3%E7%87%9F%E5%88%A9%E8%A8%88%E7%AE%97"><span class="nav-number">3.1.</span> <span class="nav-text">餐廳營利計算</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9B%9E%E5%85%94%E5%90%8C%E7%B1%A0"><span class="nav-number">3.2.</span> <span class="nav-text">雞兔同籠</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A5%AD%E5%8B%99%E7%9B%AE%E6%A8%99%E8%A8%88%E7%AE%97"><span class="nav-number">3.3.</span> <span class="nav-text">業務目標計算</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9E%82%E7%9B%B4%E7%9B%B8%E4%BA%A4%E7%B7%9A"><span class="nav-number">3.4.</span> <span class="nav-text">垂直相交線</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B1%82%E6%9F%90%E4%B8%80%E9%BB%9E%E8%87%B3%E4%B8%80%E6%A2%9D%E7%B7%9A%E5%9E%82%E7%9B%B4%E7%B7%9A"><span class="nav-number">3.5.</span> <span class="nav-text">求某一點至一條線垂直線</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%95%A2%E6%B0%8F%E5%AE%9A%E7%90%86"><span class="nav-number">4.</span> <span class="nav-text">畢氏定理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9B%BB%E5%BD%B1%E5%88%86%E9%A1%9E"><span class="nav-number">4.1.</span> <span class="nav-text">電影分類</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A8%88%E7%AE%97%E5%85%A9%E5%80%8B%E5%90%91%E9%87%8F%E7%9A%84%E6%AD%90%E5%B9%BE%E4%B9%8E%E9%87%8C%E5%BE%B7%E8%B7%9D%E9%9B%A2"><span class="nav-number">4.2.</span> <span class="nav-text">計算兩個向量的歐幾乎里德距離</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%81%AF%E7%AB%8B%E4%B8%8D%E7%AD%89%E5%BC%8F"><span class="nav-number">5.</span> <span class="nav-text">聯立不等式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%96%8B%E7%99%BC%E5%88%86%E6%9E%90"><span class="nav-number">5.1.</span> <span class="nav-text">開發分析</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E6%AC%A1%E5%87%BD%E6%95%B8"><span class="nav-number">6.</span> <span class="nav-text">二次函數</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E4%B8%80%E5%85%83%E4%BA%8C%E6%AC%A1%E6%96%B9%E7%A8%8B%E5%BC%8F%E7%9A%84%E6%A0%B9"><span class="nav-number">6.1.</span> <span class="nav-text">解一元二次方程式的根</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E5%85%83%E4%BA%8C%E6%AC%A1%E6%96%B9%E7%A8%8B%E5%BC%8F%E7%B9%AA%E5%9C%96%E4%B8%A6%E7%AE%97%E6%A5%B5%E5%80%BC"><span class="nav-number">6.2.</span> <span class="nav-text">一元二次方程式繪圖並算極值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%80%E5%85%83%E4%B8%89%E6%AC%A1%E5%9C%96%E5%BD%A2%E7%B9%AA%E8%A3%BD"><span class="nav-number">6.3.</span> <span class="nav-text">一元三次圖形繪製</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B1%82%E4%B8%80%E5%85%83%E4%BA%8C%E6%AC%A1%E6%96%B9%E7%A8%8B%E5%BC%8F-%E4%B8%A6%E7%B9%AA%E5%9C%96"><span class="nav-number">6.4.</span> <span class="nav-text">求一元二次方程式,並繪圖</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E6%AC%A1%E5%87%BD%E6%95%B8%E7%9A%84%E9%85%8D%E6%96%B9%E6%B3%95-%E6%A8%99%E6%BA%96%E5%BC%8F"><span class="nav-number">6.5.</span> <span class="nav-text">二次函數的配方法(標準式)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%8C%E9%8A%B7%E5%95%8F%E9%A1%8C%E5%88%86%E6%9E%90"><span class="nav-number">6.6.</span> <span class="nav-text">行銷問題分析</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%80%E5%B0%8F%E5%B9%B3%E6%96%B9%E6%B3%95-%E7%B7%9A%E6%80%A7%E8%BF%B4%E6%AD%B8%E6%A8%A1%E5%9E%8B"><span class="nav-number">7.</span> <span class="nav-text">最小平方法(線性迴歸模型)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Numpy-%E5%AF%A6%E4%BD%9C%E6%9C%80%E5%B0%8F%E5%B9%B3%E6%96%B9%E6%B3%95"><span class="nav-number">7.1.</span> <span class="nav-text">Numpy 實作最小平方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B0%A3%E6%BA%AB-vs-%E9%8A%B7%E5%94%AE%E9%87%8F"><span class="nav-number">7.2.</span> <span class="nav-text">氣溫 vs 銷售量</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%92%E5%88%97%E8%88%87%E7%B5%84%E5%90%88"><span class="nav-number">8.</span> <span class="nav-text">排列與組合</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#nPr-permutation-%E6%8E%92%E5%88%97"><span class="nav-number">8.1.</span> <span class="nav-text">nPr(permutation-排列)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9A%8E%E5%B1%A4%E8%A7%80%E5%BF%B5"><span class="nav-number">8.2.</span> <span class="nav-text">階層觀念</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%87%8D%E8%A4%87%E6%8E%92%E5%88%97"><span class="nav-number">8.3.</span> <span class="nav-text">重複排列</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B5%84%E5%90%88-combination"><span class="nav-number">8.4.</span> <span class="nav-text">組合(combination)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A9%9F%E7%8E%87"><span class="nav-number">9.</span> <span class="nav-text">機率</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A9%9F%E7%8E%87%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-number">9.1.</span> <span class="nav-text">機率基本概念</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A8%88%E7%AE%97%E9%9A%A8%E6%A9%9F%E7%94%A2%E7%94%9F%E5%80%BC-%E4%B8%A6%E7%B9%AA%E5%87%BA%E9%95%B7%E6%A2%9D%E5%9C%96"><span class="nav-number">9.1.1.</span> <span class="nav-text">計算隨機產生值,並繪出長條圖</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A9%9F%E7%8E%87%E4%B9%98%E6%B3%95%E8%88%87%E5%8A%A0%E6%B3%95"><span class="nav-number">9.1.2.</span> <span class="nav-text">機率乘法與加法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%A4%98%E4%BA%8B%E4%BB%B6%E8%88%87%E4%B9%98%E6%B3%95"><span class="nav-number">9.1.3.</span> <span class="nav-text">餘事件與乘法</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A2%9D%E4%BB%B6%E6%A9%9F%E7%8E%87"><span class="nav-number">9.2.</span> <span class="nav-text">條件機率</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B2%9D%E6%B0%8F%E5%AE%9A%E7%90%86"><span class="nav-number">9.3.</span> <span class="nav-text">貝氏定理</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#COVID-19-%E6%99%AE%E7%AF%A9%E6%BA%96%E7%A2%BA%E5%BA%A6%E5%88%86%E6%9E%90"><span class="nav-number">9.3.1.</span> <span class="nav-text">COVID-19 普篩準確度分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%86%AB%E5%AD%B8%E4%BE%8B%E5%AD%90%E5%88%86%E6%9E%90"><span class="nav-number">9.3.2.</span> <span class="nav-text">醫學例子分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9E%83%E5%9C%BE%E9%83%B5%E4%BB%B6%E5%88%86%E9%A1%9E%E5%AF%A6%E4%BD%9C"><span class="nav-number">9.3.3.</span> <span class="nav-text">垃圾郵件分類實作</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%92%99%E5%9C%B0%E5%8D%A1%E7%BE%85%E6%A8%A1%E6%93%AC%E8%A8%88%E7%AE%97PI"><span class="nav-number">9.4.</span> <span class="nav-text">蒙地卡羅模擬計算PI</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E9%A0%85%E5%BC%8F%E5%AE%9A%E7%90%86"><span class="nav-number">10.</span> <span class="nav-text">二項式定理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E9%A0%85%E5%BC%8F%E5%B1%95%E9%96%8B%E8%88%87%E8%A6%8F%E5%BE%8B%E6%80%A7"><span class="nav-number">10.1.</span> <span class="nav-text">二項式展開與規律性</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%BE%E5%87%BA-x-n-k-y-k-%E4%BF%82%E6%95%B8"><span class="nav-number">10.2.</span> <span class="nav-text">找出 $x^{n-k}y^k$ 係數</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E9%A0%85%E5%BC%8F%E6%87%89%E7%94%A8%E6%96%BC%E6%A5%AD%E5%8B%99%E5%88%86%E6%9E%90"><span class="nav-number">10.3.</span> <span class="nav-text">二項式應用於業務分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#5%E6%AC%A1%E9%8A%B7%E5%94%AE%E7%9A%86%E5%A4%B1%E6%95%97%E7%9A%84%E6%A9%9F%E7%8E%87"><span class="nav-number">10.3.1.</span> <span class="nav-text">5次銷售皆失敗的機率</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%83%851%E6%AC%A1%E9%8A%B7%E5%94%AE%E6%88%90%E5%8A%9F%E7%9A%84%E6%A9%9F%E7%8E%87"><span class="nav-number">10.3.2.</span> <span class="nav-text">僅1次銷售成功的機率</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%83%852%E6%AC%A1%E9%8A%B7%E5%94%AE%E6%88%90%E5%8A%9F%E7%9A%84%E6%A9%9F%E7%8E%87"><span class="nav-number">10.3.3.</span> <span class="nav-text">僅2次銷售成功的機率</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A5%AD%E5%8B%99%E5%88%86%E6%9E%90%E6%A9%9F%E7%8E%87%E8%A8%88%E7%AE%97%E9%9B%86%E7%B9%AA%E8%A3%BD%E9%95%B7%E6%A2%9D%E5%9C%96"><span class="nav-number">10.4.</span> <span class="nav-text">業務分析機率計算集繪製長條圖</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-numpy-binomial-%E7%94%A2%E7%94%9F%E6%A5%AD%E5%8B%99%E5%88%86%E6%9E%90%E8%B3%87%E6%96%99%E7%B9%AA%E5%9C%96"><span class="nav-number">10.5.</span> <span class="nav-text">使用 numpy binomial 產生業務分析資料繪圖</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%87%E6%95%B8"><span class="nav-number">11.</span> <span class="nav-text">指數</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B9%AA%E8%A3%BD%E5%9F%B7%E8%A1%8C%E6%99%82%E9%96%93%E9%97%9C%E4%BF%82%E5%9C%96-n-x3D-1-5"><span class="nav-number">11.1.</span> <span class="nav-text">繪製執行時間關係圖(n&#x3D;1~5)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B9%AA%E8%A3%BD-y-x3D-2-x-y-x3D-4-x"><span class="nav-number">11.2.</span> <span class="nav-text">繪製 $y&#x3D;2^x, y&#x3D;4^x$</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B9%AA%E8%A3%BD-y-x3D-0-5-x-y-x3D-0-25-x"><span class="nav-number">11.3.</span> <span class="nav-text">繪製 $y&#x3D;0.5^x, y&#x3D;0.25^x$</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8D%E6%95%B8"><span class="nav-number">12.</span> <span class="nav-text">對數</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B9%AA%E5%B0%8D%E6%95%B8-2-%E5%8F%8A-0-5-%E7%9A%84%E5%9C%96%E5%BD%A2"><span class="nav-number">12.1.</span> <span class="nav-text">繪對數 2 及 0.5 的圖形</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%90%E6%8B%89%E6%95%B8%E8%88%87%E9%82%8F%E8%BC%AF%E5%87%BD%E6%95%B8"><span class="nav-number">13.</span> <span class="nav-text">歐拉數與邏輯函數</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%90%E6%8B%89%E6%95%B8-Euler%E2%80%99s-Number"><span class="nav-number">13.1.</span> <span class="nav-text">歐拉數-Euler’s Number</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%B9%AA%E8%A3%BD%E6%AD%90%E6%8B%89%E6%95%B8%E5%9C%96%E5%BD%A2"><span class="nav-number">13.1.1.</span> <span class="nav-text">繪製歐拉數圖形</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%82%8F%E8%BC%AF%E5%87%BD%E6%95%B8-logistic-function"><span class="nav-number">13.2.</span> <span class="nav-text">邏輯函數(logistic function)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%B9%AA%E8%A3%BD%E9%82%8F%E8%BC%AF%E5%87%BD%E6%95%B8"><span class="nav-number">13.2.1.</span> <span class="nav-text">繪製邏輯函數</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Sigmoid-%E5%87%BD%E6%95%B8"><span class="nav-number">13.2.2.</span> <span class="nav-text">Sigmoid 函數</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#logit-%E5%87%BD%E6%95%B8"><span class="nav-number">13.3.</span> <span class="nav-text">logit 函數</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Odds"><span class="nav-number">13.3.1.</span> <span class="nav-text">Odds</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Odds-%E5%88%B0-logit"><span class="nav-number">13.3.2.</span> <span class="nav-text">Odds 到 logit</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%B9%AA%E8%A3%BD-logit-%E5%87%BD%E6%95%B8"><span class="nav-number">13.3.3.</span> <span class="nav-text">繪製 logit 函數</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8E%A8%E7%AE%97%E5%87%BA%E9%8C%AF%E7%8E%87%E8%88%87%E5%9B%9E%E8%B3%BC%E7%8E%87%E7%9A%84%E9%97%9C%E4%BF%82"><span class="nav-number">13.3.4.</span> <span class="nav-text">推算出錯率與回購率的關係</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B8"><span class="nav-number">14.</span> <span class="nav-text">三角函數</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%92%E5%BA%A6%E5%BC%A7%E5%BA%A6%E7%9A%84%E6%8F%9B%E7%AE%97"><span class="nav-number">14.1.</span> <span class="nav-text">角度弧度的換算</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A8%88%E7%AE%97%E5%BC%A7%E9%95%B7"><span class="nav-number">14.2.</span> <span class="nav-text">計算弧長</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A8%88%E7%AE%97sin-cos"><span class="nav-number">14.3.</span> <span class="nav-text">計算sin(), cos()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%92%E5%BA%A6%E7%B9%AA%E5%9C%93"><span class="nav-number">14.4.</span> <span class="nav-text">角度繪圓</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%A2%E7%94%9F%E4%B8%80%E5%B9%B4%E7%9A%84-sin-cos-%E5%80%BC"><span class="nav-number">14.5.</span> <span class="nav-text">產生一年的 sin, cos 值</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A4%8E%E7%B5%B1%E8%A8%88%E8%88%87%E5%A4%A7%E5%9E%8B%E9%81%8B%E7%AE%97%E5%AD%90"><span class="nav-number">15.</span> <span class="nav-text">基礎統計與大型運算子</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B8%E6%93%9A%E4%B8%AD%E5%BF%83%E6%8C%87%E6%A8%99"><span class="nav-number">15.1.</span> <span class="nav-text">數據中心指標</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B9%AA%E8%A3%BD%E6%88%90%E7%B8%BE%E5%88%86%E5%B8%83%E5%9C%96"><span class="nav-number">15.2.</span> <span class="nav-text">繪製成績分布圖</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%B9%AA%E8%A3%BD%E6%88%90%E7%B8%BE%E9%95%B7%E6%A2%9D%E5%9C%96"><span class="nav-number">15.2.1.</span> <span class="nav-text">繪製成績長條圖</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%B9%AA%E8%A3%BD%E6%88%90%E7%B8%BE%E7%9B%B4%E6%96%B9%E5%9C%96"><span class="nav-number">15.2.2.</span> <span class="nav-text">繪製成績直方圖</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%B9%AA%E8%A3%BD%E6%88%90%E7%B8%BE%E7%9B%B4%E6%96%B9%E5%9C%96-%E5%85%A9%E5%80%8B%E6%88%90%E7%B8%BE"><span class="nav-number">15.2.3.</span> <span class="nav-text">繪製成績直方圖(兩個成績)</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B8%E6%93%9A%E5%88%86%E6%95%A3%E6%8C%87%E6%A8%99"><span class="nav-number">15.3.</span> <span class="nav-text">數據分散指標</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AE%8A%E7%95%B0%E6%95%B8"><span class="nav-number">15.3.1.</span> <span class="nav-text">變異數</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A8%99%E6%BA%96%E5%B7%AE-Standard-Deviation-SD"><span class="nav-number">15.3.2.</span> <span class="nav-text">標準差(Standard Deviation-SD)</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%B4%E6%AD%B8%E5%88%86%E6%9E%90"><span class="nav-number">15.4.</span> <span class="nav-text">迴歸分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%9B%B8%E9%97%9C%E4%BF%82%E6%95%B8-Correlation-Coefficient"><span class="nav-number">15.4.1.</span> <span class="nav-text">相關係數(Correlation Coefficient)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BB%BA%E7%AB%8B%E7%B7%9A%E6%80%A7%E5%9B%9E%E6%AD%B8%E6%A8%A1%E5%9E%8B%E8%88%87%E6%95%B8%E6%93%9A%E9%A0%90%E6%B8%AC"><span class="nav-number">15.4.2.</span> <span class="nav-text">建立線性回歸模型與數據預測</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BA%8C%E6%AC%A1%E5%87%BD%E6%95%B8%E5%9B%9E%E6%AD%B8%E6%A8%A1%E5%9E%8B"><span class="nav-number">15.4.3.</span> <span class="nav-text">二次函數回歸模型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%9A%A8%E6%A9%9F%E5%87%BD%E6%95%B8%E7%9A%84%E5%88%86%E5%B8%83"><span class="nav-number">15.4.4.</span> <span class="nav-text">隨機函數的分布</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#randn"><span class="nav-number">15.4.4.1.</span> <span class="nav-text">randn()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#normal"><span class="nav-number">15.4.4.2.</span> <span class="nav-text">normal()</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#uniform-x2F-random"><span class="nav-number">15.4.4.3.</span> <span class="nav-text">uniform()&#x2F;random()</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%91%E9%87%8F"><span class="nav-number">16.</span> <span class="nav-text">向量</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92%E7%9A%84%E5%90%91%E9%87%8F%E7%9F%A5%E8%AD%98"><span class="nav-number">16.1.</span> <span class="nav-text">機器學習的向量知識</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%91%E9%87%8F%E7%9A%84%E9%95%B7%E5%BA%A6"><span class="nav-number">16.2.</span> <span class="nav-text">向量的長度</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%91%E9%87%8F%E6%96%B9%E7%A8%8B%E5%BC%8F"><span class="nav-number">16.3.</span> <span class="nav-text">向量方程式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%91%E9%87%8F%E5%85%A7%E7%A9%8D"><span class="nav-number">16.4.</span> <span class="nav-text">向量內積</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%81%95%E5%90%8C%E5%B7%A5%E4%BD%9C"><span class="nav-number">16.4.1.</span> <span class="nav-text">偕同工作</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%90%91%E9%87%8F%E5%85%A7%E7%A9%8D%E7%9A%84%E5%AE%9A%E7%BE%A9"><span class="nav-number">16.4.2.</span> <span class="nav-text">向量內積的定義</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%B9%BE%E4%BD%95%E5%AE%9A%E7%BE%A9%E5%90%91%E9%87%8F%E5%85%A7%E7%A9%8D"><span class="nav-number">16.4.2.1.</span> <span class="nav-text">幾何定義向量內積</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%BB%A3%E6%95%B8%E5%AE%9A%E7%BE%A9%E5%90%91%E9%87%8F%E5%85%A7%E7%A9%8D"><span class="nav-number">16.4.2.2.</span> <span class="nav-text">代數定義向量內積</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%B9%BE%E4%BD%95%E5%AE%9A%E7%BE%A9%E8%88%87%E4%BB%A3%E6%95%B8%E5%AE%9A%E7%BE%A9%E6%98%AF%E7%9B%B8%E7%AD%89"><span class="nav-number">16.4.2.3.</span> <span class="nav-text">幾何定義與代數定義是相等</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%A9%E6%A2%9D%E7%9B%B4%E7%B7%9A%E7%9A%84%E5%A4%BE%E8%A7%92"><span class="nav-number">16.4.3.</span> <span class="nav-text">兩條直線的夾角</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%90%91%E9%87%8F%E5%85%A7%E7%A9%8D%E7%9A%84%E6%80%A7%E8%B3%AA"><span class="nav-number">16.4.4.</span> <span class="nav-text">向量內積的性質</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%A4%98%E5%BC%A6%E7%9B%B8%E4%BC%BC%E5%BA%A6"><span class="nav-number">16.4.5.</span> <span class="nav-text">餘弦相似度</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9A%AE%E7%88%BE%E9%81%9C%E7%9B%B8%E9%97%9C%E4%BF%82%E6%95%B8-Pearson-correlation-coefiicient"><span class="nav-number">16.5.</span> <span class="nav-text">皮爾遜相關係數(Pearson correlation coefiicient)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%9A%AE%E7%88%BE%E9%81%9C%E7%9B%B8%E9%97%9C%E4%BF%82%E6%95%B8%E5%AE%9A%E7%BE%A9"><span class="nav-number">16.5.1.</span> <span class="nav-text">皮爾遜相關係數定義</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%B6%B2%E8%B7%AF%E8%B3%BC%E7%89%A9%E5%95%8F%E5%8D%B7%E8%AA%BF%E6%9F%A5%E6%A1%88%E4%BE%8B%E8%A7%A3%E8%AA%AA"><span class="nav-number">16.5.2.</span> <span class="nav-text">網路購物問卷調查案例解說</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%90%91%E9%87%8F%E5%85%A7%E7%A9%8D%E8%A8%88%E7%AE%97%E4%BF%82%E6%95%B8"><span class="nav-number">16.5.3.</span> <span class="nav-text">使用向量內積計算係數</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%91%E9%87%8F%E5%A4%96%E7%A9%8D"><span class="nav-number">16.6.</span> <span class="nav-text">向量外積</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A8%88%E7%AE%97%E9%9D%A2%E7%A9%8D"><span class="nav-number">16.7.</span> <span class="nav-text">計算面積</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A9%E9%99%A3"><span class="nav-number">17.</span> <span class="nav-text">矩陣</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A9%E9%99%A3%E8%A1%A8%E9%81%94%E6%96%B9%E5%BC%8F"><span class="nav-number">17.1.</span> <span class="nav-text">矩陣表達方式</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%9F%A9%E9%99%A3%E7%9A%84%E8%A1%8C%E8%88%87%E5%88%97"><span class="nav-number">17.1.1.</span> <span class="nav-text">矩陣的行與列</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E8%A1%A8%E7%A4%BA%E6%B3%95"><span class="nav-number">17.1.2.</span> <span class="nav-text">其他表示法</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A9%E9%99%A3%E7%9B%B8%E5%8A%A0%E8%88%87%E7%9B%B8%E6%B8%9B"><span class="nav-number">17.2.</span> <span class="nav-text">矩陣相加與相減</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9F%A9%E9%99%A3%E7%9B%B8%E4%B9%98"><span class="nav-number">17.3.</span> <span class="nav-text">矩陣相乘</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A8%88%E7%AE%97%E7%94%B2%E5%92%8C%E4%B9%99%E5%9C%A8%E8%B6%85%E5%95%86%E5%8F%8A%E7%99%BE%E8%B2%A8%E5%85%AC%E5%8F%B8%E6%8E%A1%E8%B2%B7%E5%90%84%E9%9C%80%E5%A4%9A%E5%B0%91%E9%8C%A2"><span class="nav-number">17.3.1.</span> <span class="nav-text">計算甲和乙在超商及百貨公司採買各需多少錢</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A8%88%E7%AE%97%E7%94%B2-%E4%B9%99%E5%90%84%E5%90%83%E4%B8%8B%E5%A4%9A%E5%B0%91%E7%86%B1%E9%87%8F"><span class="nav-number">17.3.2.</span> <span class="nav-text">計算甲,乙各吃下多少熱量</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B9%E5%BD%A2%E7%9F%A9%E9%99%A3-square-matrix"><span class="nav-number">17.4.</span> <span class="nav-text">方形矩陣(square matrix)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%96%AE%E4%BD%8D%E7%9F%A9%E9%99%A3-indentity-matrix"><span class="nav-number">17.5.</span> <span class="nav-text">單位矩陣(indentity matrix)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%8D%E7%9F%A9%E9%99%A3-inverse-matrix"><span class="nav-number">17.6.</span> <span class="nav-text">反矩陣(inverse matrix)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%A8%E5%8F%8D%E7%9F%A9%E9%99%A3%E8%A7%A3%E8%81%AF%E7%AB%8B%E6%96%B9%E7%A8%8B%E5%BC%8F"><span class="nav-number">17.7.</span> <span class="nav-text">用反矩陣解聯立方程式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%B5%E9%87%8F-Tensor"><span class="nav-number">17.8.</span> <span class="nav-text">張量(Tensor)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BD%89%E7%BD%AE%E7%9F%A9%E9%99%A3"><span class="nav-number">17.9.</span> <span class="nav-text">轉置矩陣</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BD%89%E7%BD%AE%E7%9F%A9%E9%99%A3%E7%9A%84%E6%87%89%E7%94%A8"><span class="nav-number">17.10.</span> <span class="nav-text">轉置矩陣的應用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%91%E9%87%8F-%E7%9F%A9%E9%99%A3%E8%88%87%E5%A4%9A%E5%85%83%E7%B7%9A%E6%80%A7%E8%BF%B4%E6%AD%B8-20-%E4%B8%8D%E4%BA%86%E8%A7%A3"><span class="nav-number">18.</span> <span class="nav-text">向量,矩陣與多元線性迴歸(20):不了解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E6%AC%A1%E5%87%BD%E6%95%B8%E8%BF%B4%E6%AD%B8%E6%9B%B2%E7%B7%9A%E5%AF%A6%E4%BD%9C"><span class="nav-number">19.</span> <span class="nav-text">三次函數迴歸曲線實作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B6%B2%E8%B3%BC%E8%BF%B4%E6%AD%B8%E6%9B%B2%E7%B7%9A%E7%B9%AA%E8%A3%BD"><span class="nav-number">19.1.</span> <span class="nav-text">網購迴歸曲線繪製</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-scikit-learn-%E8%A9%95%E4%BC%B0%E8%BF%B4%E6%AD%B8%E6%A8%A1%E5%9E%8B"><span class="nav-number">19.2.</span> <span class="nav-text">使用 scikit-learn 評估迴歸模型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A0%90%E6%B8%AC%E6%9C%AA%E4%BE%86%E5%80%BC"><span class="nav-number">19.3.</span> <span class="nav-text">預測未來值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8D%E9%81%A9%E5%90%88%E4%B8%89%E6%AC%A1%E5%87%BD%E6%95%B8%E8%BF%B4%E6%AD%B8%E6%95%B8%E6%93%9A-%E5%AF%A6%E4%BE%8B"><span class="nav-number">19.4.</span> <span class="nav-text">不適合三次函數迴歸數據(實例)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B7%9A%E6%80%A7%E8%BF%B4%E6%AD%B8-%E6%B3%A2%E5%A3%AB%E9%A0%93%E6%88%BF%E5%83%B9"><span class="nav-number">20.</span> <span class="nav-text">線性迴歸 - 波士頓房價</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B0%A1%E5%96%AE%E8%B3%87%E6%96%99%E6%B8%AC%E8%A9%A6"><span class="nav-number">20.1.</span> <span class="nav-text">簡單資料測試</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%94%A2%E7%94%9F%E8%BF%B4%E6%AD%B8%E6%A8%A1%E5%9E%8B-%E8%BA%AB%E9%AB%98-%E8%85%B0%E5%9C%8D%E8%88%87%E9%AB%94%E9%87%8D%E7%9A%84%E6%B8%AC%E8%A9%A6"><span class="nav-number">20.1.1.</span> <span class="nav-text">產生迴歸模型(身高.腰圍與體重的測試)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BA%86%E8%A7%A3%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%84%AA%E5%8A%A3-R-%E5%B9%B3%E6%96%B9%E4%BF%82%E6%95%B8"><span class="nav-number">20.1.2.</span> <span class="nav-text">了解模型的優劣(R 平方係數)</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B3%A2%E5%A3%AB%E9%A0%93%E6%88%BF%E5%83%B9%E6%95%B8%E6%93%9A"><span class="nav-number">20.2.</span> <span class="nav-text">波士頓房價數據</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%97%E5%87%BA%E8%B3%87%E6%96%99%E6%95%B8%E6%93%9A"><span class="nav-number">20.2.1.</span> <span class="nav-text">列出資料數據</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%B3%87%E6%96%99%E8%99%95%E7%90%86"><span class="nav-number">20.2.2.</span> <span class="nav-text">資料處理</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%9C%80%E7%9B%B8%E9%97%9C%E7%89%B9%E5%BE%B5%E5%81%9A%E6%88%BF%E5%83%B9%E9%A0%90%E4%BC%B0"><span class="nav-number">20.3.</span> <span class="nav-text">使用最相關特徵做房價預估</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%B9%AA%E8%A3%BD%E6%95%A3%E9%BB%9E%E5%9C%96"><span class="nav-number">20.3.1.</span> <span class="nav-text">繪製散點圖</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%8D%B2%E5%BE%97-R%E5%B9%B3%E6%96%B9%E5%88%A4%E5%AE%9A%E4%BF%82%E6%95%B8-%E6%88%AA%E8%B7%9D%E8%88%87%E4%BF%82%E6%95%B8"><span class="nav-number">20.3.2.</span> <span class="nav-text">獲得 R平方判定係數,截距與係數</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A8%88%E7%AE%97%E9%A0%90%E4%BC%B0%E6%88%BF%E5%83%B9"><span class="nav-number">20.3.3.</span> <span class="nav-text">計算預估房價</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%B9%AA%E8%A3%BD%E5%AF%A6%E9%9A%9B%E6%88%BF%E5%83%B9%E8%88%87%E9%A0%90%E4%BC%B0%E6%88%BF%E5%83%B9"><span class="nav-number">20.3.4.</span> <span class="nav-text">繪製實際房價與預估房價</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%B9%AA%E8%A3%BD3D%E5%AF%A6%E9%9A%9B%E6%88%BF%E5%83%B9%E8%88%87%E9%A0%90%E4%BC%B0%E6%88%BF%E5%83%B9"><span class="nav-number">20.3.5.</span> <span class="nav-text">繪製3D實際房價與預估房價</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%9A%E9%A0%85%E5%BC%8F%E8%BF%B4%E6%AD%B8"><span class="nav-number">20.4.</span> <span class="nav-text">多項式迴歸</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%B9%AA%E8%A3%BD%E6%95%A3%E9%BB%9E%E5%9C%96%E5%8F%8A%E8%BF%B4%E6%AD%B8%E7%9B%B4%E7%B7%9A"><span class="nav-number">20.4.1.</span> <span class="nav-text">繪製散點圖及迴歸直線</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E4%B8%80%E5%85%83%E4%BA%8C%E6%AC%A1%E7%89%B9%E5%BE%B5"><span class="nav-number">20.4.2.</span> <span class="nav-text">生成一元二次特徵</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A4%9A%E9%A0%85%E5%BC%8F%E7%89%B9%E5%BE%B5%E6%87%89%E7%94%A8%E5%9C%A8-LinearRegression"><span class="nav-number">20.4.3.</span> <span class="nav-text">多項式特徵應用在 LinearRegression</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A9%9F%E5%99%A8%E5%AD%B8%E7%BF%92%E7%9A%84%E7%90%86%E6%83%B3%E6%A8%A1%E5%9E%8B"><span class="nav-number">20.4.4.</span> <span class="nav-text">機器學習的理想模型</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E4%BA%8C%E5%85%83%E4%BA%8C%E6%AC%A1%E6%96%B9%E7%A8%8B%E5%BC%8F%E5%81%9A%E6%88%BF%E5%83%B9%E9%A0%90%E4%BC%B0"><span class="nav-number">20.4.5.</span> <span class="nav-text">使用二元二次方程式做房價預估</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%A8%88%E7%AE%97-R-score"><span class="nav-number">20.4.5.1.</span> <span class="nav-text">計算 R score</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%A8%88%E7%AE%97%E9%A0%90%E4%BC%B0%E6%88%BF%E5%83%B9-1"><span class="nav-number">20.4.5.2.</span> <span class="nav-text">計算預估房價</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%B9%AA%E8%A3%BD3D%E5%AF%A6%E9%9A%9B%E6%88%BF%E5%83%B9vs%E9%A0%90%E4%BC%B0%E6%88%BF%E5%83%B9"><span class="nav-number">20.4.6.</span> <span class="nav-text">繪製3D實際房價vs預估房價</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%A8%E6%89%80%E6%9C%89%E7%9A%84%E7%89%B9%E5%BE%B5%E5%9F%B7%E8%A1%8C%E6%B3%A2%E5%A3%AB%E9%A0%93%E6%88%BF%E5%83%B9%E9%A0%90%E4%BC%B0"><span class="nav-number">20.5.</span> <span class="nav-text">用所有的特徵執行波士頓房價預估</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AE%98%E5%B7%AE%E5%9C%96-Residual-Plot"><span class="nav-number">20.6.</span> <span class="nav-text">殘差圖(Residual Plot)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E8%BF%B4%E6%AD%B8-SGDRegressor"><span class="nav-number">20.7.</span> <span class="nav-text">梯度下降迴歸 SGDRegressor()</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Robert Kao"
      src="/images/head.png">
  <p class="site-author-name" itemprop="name">Robert Kao</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">171</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">66</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
        <div class="back-to-top animated" role="button">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://hot5656.github.io/2024/05/15/python-28/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="Robert Kao">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Robert 雜記">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          (1) 機器學習最強入門:基礎數學/機率/統計邁向AI真實數據
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2024-05-15 15:32:27" itemprop="dateCreated datePublished" datetime="2024-05-15T15:32:27+08:00">2024-05-15</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2024-07-01 12:08:04" itemprop="dateModified" datetime="2024-07-01T12:08:04+08:00">2024-07-01</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Coding/" itemprop="url" rel="index"><span itemprop="name">Coding</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2024/05/15/python-28/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2024/05/15/python-28/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>92k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>1:24</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h3 id="名詞"><a href="#名詞" class="headerlink" title="名詞"></a>名詞</h3><h4 id="一般名詞"><a href="#一般名詞" class="headerlink" title="一般名詞"></a>一般名詞</h4><ul>
<li>人工智慧(Articial Intelligence)</li>
<li>機器學習(Machine Learning)</li>
<li>深入學習(Deep Learning)</li>
<li>神經網路(Neural Network)</li>
<li>卷積神經網路(Convolutional Neural Network)</li>
<li>Tensorflow</li>
</ul>
<span id="more"></span>

<h4 id="機器學習"><a href="#機器學習" class="headerlink" title="機器學習"></a>機器學習</h4><ul>
<li>監督學習(supervised learning):以已知輸入和輸出數據進行學習,找出輸入及輸出之間的關係,一搬將80%(or 70%)數據用於訓練,20%(or 30%)用於測試<br>  訓練術據是建立迴歸模型,測試數據用來判斷迴歸模型是否足夠好<br>  常見的演算法有線性迴歸,邏輯迴歸,支援向量(Support Vector Machine-SVM),決策樹和隨機森林</li>
<li>無監督學習(unsupervised learning):沒有目標,主要用於找出數據結構,識別模式和關係<br>  根據數據特性或規律做群集(clustering)分類是一種典型使用<br>  常見演算法有分群(或稱 聚類)分析(如 K-means),降維(如 主成分分析-Principal Comonent Analysis-PCA)</li>
<li>強化學習(reinforcement learning):沒有明確訓練資料與標準答案,機器必須在給予環境中自我學習,然後評估行動回饋是正面或負面,進而調整下次行動,進而獲得正確答案<br>  遊戲AI:圍棋,象棋…<br>  機器人控制:教導機器人完成複雜動作<br>  自動駕駛<br>  能源管理:可應用於智慧電網<br>  金融交易:開發智慧交易策略</li>
</ul>
<h4 id="機器學習應用"><a href="#機器學習應用" class="headerlink" title="機器學習應用"></a>機器學習應用</h4><ul>
<li>圖像辨識</li>
<li>自然語言處理:用於理解,生成和翻譯人類語言.使得可進行情感分析,機器翻譯,語音辨識和自然語言回應</li>
<li>推薦系統:依用戶瀏覽及購買歷史,提供產品及服務的推薦</li>
<li>金融領域:檢測欺詐交易,評估信用風險,預測股票價格波動</li>
<li>醫療領域:分析醫療數據,幫助醫生診斷,預測病情發展</li>
<li>物聯網:優化智慧家居,智慧城市,能源管理,設備維護,安全監控</li>
<li>遊戲領域:使遊戲腳色可根據玩家行為自主決策及適應,遊戲測試,優化,自動發現問題即提出改善方案</li>
<li>廣告投射:分析用戶行為,精準投射廣告</li>
<li>工業自動化:應用於機器人和自動化設備,使能夠在無人工干預下,自動完成生產,檢測和維護</li>
<li>客戶諮詢:開發智慧服務機器人,自動回答用戶問題,處理用戶諮詢,提高客戶效率和滿意度</li>
<li>社交媒體:分析用戶行為,用於客戶分類,內容過濾,情感分析,提供更優質的社交體驗</li>
<li>供應鏈管理:預測供應鏈中的需求,供應和運輸,提供有效的庫存管理,物流規劃和風險管理</li>
</ul>
<h4 id="深度學習"><a href="#深度學習" class="headerlink" title="深度學習"></a>深度學習</h4><ul>
<li>深度學習主要關注使用人工精神網路來模擬人類大腦過程</li>
<li>深度學習在許多領域取的顯著得成果,如語音辨識,圖像辨識,自然語言處理及遊戲</li>
<li>常見的神經網路類型包含<br>  捲積神經網路(Convlutional Neural Network-CNN):圖像辨識<br>  循環神經網路(Recurrent Neural Networks-RNNs):時序數據,語音識別,語言建模<br>  變換器(Transformer):自然語言處理</li>
</ul>
<h4 id="數學"><a href="#數學" class="headerlink" title="數學"></a>數學</h4><ul>
<li>線性迴歸:依蒐集到的數據,找出與數據最近的一條直線,或稱為最近函數</li>
</ul>
<h3 id="方程式與函數"><a href="#方程式與函數" class="headerlink" title="方程式與函數"></a>方程式與函數</h3><h4 id="二元函數"><a href="#二元函數" class="headerlink" title="二元函數"></a>二元函數</h4><h5 id=""><a href="#" class="headerlink" title=""></a><a href="/2024/05/17/python-29/" title="# 二元函數3D圖(Z&#x3D;X+Y)"># 二元函數3D圖(Z&#x3D;X+Y)</a></h5><h5 id="-1"><a href="#-1" class="headerlink" title=""></a><a href="/2024/05/17/python-29/" title="# 等高圖"># 等高圖</a></h5><h4 id="sympy"><a href="#sympy" class="headerlink" title="sympy"></a>sympy</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install sympy</span><br></pre></td></tr></table></figure>

<h5 id="sympy-說明"><a href="#sympy-說明" class="headerlink" title="sympy 說明"></a>sympy 說明</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sympy 說明</span></span><br><span class="line"><span class="keyword">import</span> sympy <span class="keyword">as</span> sp</span><br><span class="line"></span><br><span class="line"><span class="comment"># simple</span></span><br><span class="line">x = sp.Symbol(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">y = sp.Symbol(<span class="string">&#x27;y&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(x.name)</span><br><span class="line"><span class="built_in">print</span>(x + x + <span class="number">2</span>)</span><br><span class="line">z = <span class="number">5</span>*x + <span class="number">6</span>*y + x*y</span><br><span class="line"><span class="built_in">print</span>(z)</span><br><span class="line"><span class="comment"># x</span></span><br><span class="line"><span class="comment"># 2*x + 2</span></span><br><span class="line"><span class="comment"># x*y + 5*x + 6*y</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 多個符號</span></span><br><span class="line">a, b, c = sp.symbols((<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(a.name, b.name, c.name)</span><br><span class="line"><span class="comment"># a b c</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 字串轉為數學表達式</span></span><br><span class="line"><span class="comment"># eq = input(&quot;輸入公式:&quot;) # x**3 + 2*x**2 + 3*x + 5</span></span><br><span class="line"><span class="comment"># eq = sp.sympify(eq)</span></span><br><span class="line"><span class="comment"># print(eq)</span></span><br><span class="line"><span class="comment"># print(2*eq)</span></span><br><span class="line"><span class="comment"># result = eq.subs(&#123;x:1&#125;)</span></span><br><span class="line"><span class="comment"># print(result)</span></span><br><span class="line"><span class="comment"># 輸入公式:x**3 + 2*x**2 + 3*x + 5</span></span><br><span class="line"><span class="comment"># x**3 + 2*x**2 + 3*x + 5</span></span><br><span class="line"><span class="comment"># 2*x**3 + 4*x**2 + 6*x + 10</span></span><br><span class="line"><span class="comment"># 11</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 支援數學函數</span></span><br><span class="line"><span class="comment"># pi</span></span><br><span class="line"><span class="comment"># E: 歐拉數e</span></span><br><span class="line"><span class="comment"># sin(x), cos(x), tan(x)</span></span><br><span class="line"><span class="comment"># log(x,n) : 計算 n 為底數的對數,省略n為自然對數</span></span><br><span class="line"><span class="comment"># exp(x): e**x</span></span><br><span class="line"><span class="comment"># root(x,n): x 開n次方,省略n為2次方</span></span><br><span class="line">eq2 = sp.sin(x**<span class="number">2</span>) + sp.log(<span class="number">8</span>,<span class="number">2</span>)*x + sp.log(sp.exp(<span class="number">3</span>))</span><br><span class="line">result2 = eq2.subs(&#123;x:<span class="number">1</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(result2)</span><br><span class="line"><span class="built_in">print</span>(result2.evalf())  <span class="comment"># 計算值</span></span><br><span class="line"><span class="comment"># 由於 SymPy 主要是用於符號計算的工具，所以當進行符號替換時，會保持符號的形式而不會自動計算出實際值。</span></span><br><span class="line"><span class="comment"># sin(1) + 6</span></span><br><span class="line"><span class="comment"># 6.84147098480790</span></span><br></pre></td></tr></table></figure>

<h5 id="解一元一次方程式"><a href="#解一元一次方程式" class="headerlink" title="解一元一次方程式"></a>解一元一次方程式</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解一元一次方程式</span></span><br><span class="line"><span class="keyword">import</span> sympy <span class="keyword">as</span> sp</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3x+5 = 8</span></span><br><span class="line">x = sp.Symbol(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">eq = <span class="number">3</span>*x + <span class="number">5</span> - <span class="number">8</span></span><br><span class="line">ans = sp.solve(eq)</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(ans))</span><br><span class="line"><span class="comment"># [1]</span></span><br><span class="line"><span class="comment"># &lt;class &#x27;list&#x27;&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="解聯立方程式"><a href="#解聯立方程式" class="headerlink" title="解聯立方程式"></a>解聯立方程式</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解聯立方程式</span></span><br><span class="line"><span class="comment"># a  +  b = 1</span></span><br><span class="line"><span class="comment"># 5a + b  = 2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Symbol, solve</span><br><span class="line">a = Symbol(<span class="string">&quot;a&quot;</span>)</span><br><span class="line">b = Symbol(<span class="string">&quot;b&quot;</span>)</span><br><span class="line"><span class="comment"># 定義公式要右邊為 0</span></span><br><span class="line">eq1 = a + b - <span class="number">1</span></span><br><span class="line">eq2 = <span class="number">5</span>*a + b -<span class="number">2</span></span><br><span class="line">ans = solve((eq1, eq2))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">type</span>(ans))</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a=<span class="subst">&#123;ans[a]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;b=<span class="subst">&#123;ans[b]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># &lt;class &#x27;dict&#x27;&gt;</span></span><br><span class="line"><span class="comment"># &#123;a: 1/4, b: 3/4&#125;</span></span><br><span class="line"><span class="comment"># a=1/4</span></span><br><span class="line"><span class="comment"># b=3/4</span></span><br></pre></td></tr></table></figure>

<h5 id="解一元二次方程式"><a href="#解一元二次方程式" class="headerlink" title="解一元二次方程式"></a>解一元二次方程式</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解一元二次方程式的根</span></span><br><span class="line"><span class="comment"># x**2 - 2x - 8 = 0</span></span><br><span class="line"><span class="comment"># x**2 - 2x + 1 = 0</span></span><br><span class="line"><span class="comment"># x**2 + x + 1 = 0</span></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 兩個根</span></span><br><span class="line">x = Symbol(<span class="string">&quot;x&quot;</span>)</span><br><span class="line">f = x**<span class="number">2</span> - <span class="number">2</span>*x - <span class="number">8</span></span><br><span class="line">roots = solve(f)</span><br><span class="line"><span class="built_in">print</span>(roots)</span><br><span class="line"><span class="comment"># [-2, 4]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 一個根</span></span><br><span class="line">f = x**<span class="number">2</span> - <span class="number">2</span>*x + <span class="number">1</span></span><br><span class="line">roots = solve(f)</span><br><span class="line"><span class="built_in">print</span>(roots)</span><br><span class="line"><span class="comment"># [1]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 無實數根</span></span><br><span class="line">f = x**<span class="number">2</span> + x + <span class="number">1</span></span><br><span class="line">roots = solve(f)</span><br><span class="line"><span class="built_in">print</span>(roots)</span><br><span class="line">number_roots = [root.evalf() <span class="keyword">for</span> root <span class="keyword">in</span> roots]</span><br><span class="line"><span class="built_in">print</span>(number_roots)</span><br><span class="line"><span class="comment"># [-1/2 - sqrt(3)*I/2, -1/2 + sqrt(3)*I/2]</span></span><br><span class="line"><span class="comment"># [-0.5 - 0.866025403784439*I, -0.5 + 0.866025403784439*I]</span></span><br></pre></td></tr></table></figure>

<h5 id="FiniteSet-建立集合"><a href="#FiniteSet-建立集合" class="headerlink" title="FiniteSet - 建立集合"></a>FiniteSet - 建立集合</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sympy 模組與集合</span></span><br><span class="line"><span class="comment"># sympy FiniteSet 可建立集合</span></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> FiniteSet</span><br><span class="line">A = FiniteSet(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(A)</span><br><span class="line"><span class="comment"># &#123;1, 2, 3&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立集合冪集</span></span><br><span class="line">a = A.powerset()</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"><span class="comment"># FiniteSet(EmptySet, &#123;1&#125;, &#123;2&#125;, &#123;3&#125;, &#123;1, 2&#125;, &#123;1, 3&#125;, &#123;2, 3&#125;, &#123;1, 2, 3&#125;)</span></span><br></pre></td></tr></table></figure>

<h3 id="聯立方程式"><a href="#聯立方程式" class="headerlink" title="聯立方程式"></a>聯立方程式</h3><h4 id="餐廳營利計算"><a href="#餐廳營利計算" class="headerlink" title="餐廳營利計算"></a>餐廳營利計算</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 餐廳營利計算</span></span><br><span class="line"><span class="comment"># P(600,0)      600a  + b = 0</span></span><br><span class="line"><span class="comment"># P(1000,12)    1000a + b = 12 --&gt; 1000a + b - 12 = 0</span></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Symbol, solve</span><br><span class="line">a = Symbol(<span class="string">&quot;a&quot;</span>)</span><br><span class="line">b = Symbol(<span class="string">&quot;b&quot;</span>)</span><br><span class="line"><span class="comment"># 定義公式要右邊為 0</span></span><br><span class="line">eq1 = <span class="number">600</span> * a + b</span><br><span class="line">eq2 = <span class="number">1000</span> * a + b - <span class="number">12</span></span><br><span class="line">ans = solve((eq1, eq2))</span><br><span class="line"><span class="comment"># print(ans)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a=<span class="subst">&#123;ans[a]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;b=<span class="subst">&#123;ans[b]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># print(f&quot;&#123;type(ans[a])&#125;&quot;)</span></span><br><span class="line"><span class="comment"># a=3/100</span></span><br><span class="line"><span class="comment"># b=-18</span></span><br><span class="line"><span class="comment"># y = 0.03x - 18</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">points_x = [<span class="number">600</span>, <span class="number">1000</span>]</span><br><span class="line">points_y = [ px * ans[a] + ans[b] <span class="keyword">for</span> px <span class="keyword">in</span> points_x]</span><br><span class="line">plt.plot(points_x, points_y, <span class="string">&quot;-o&quot;</span>)</span><br><span class="line"></span><br><span class="line">x = <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">2500</span>, <span class="number">10</span>)</span><br><span class="line">y = [ans[a] * y - <span class="number">18</span> <span class="keyword">for</span> y <span class="keyword">in</span> x]</span><br><span class="line"><span class="comment"># x 顯示範圍 0~1000, y 顯示範圍 -20~15</span></span><br><span class="line"><span class="comment"># plt.axis([0,1000, -20, 15])</span></span><br><span class="line">plt.plot(x,y)</span><br><span class="line">plt.title(<span class="string">&#x27;餐廳營利對照圖&#x27;</span>, fontsize=<span class="number">20</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;人數&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;利潤/萬元&#x27;</span>)</span><br><span class="line">plt.grid()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出1500人 利潤</span></span><br><span class="line">people1 = <span class="number">1500</span></span><br><span class="line">frofit1 = people1 * ans[a] + ans[b]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;f(<span class="subst">&#123;people1&#125;</span>) = <span class="subst">&#123;frofit1&#125;</span>&quot;</span>)</span><br><span class="line">plt.plot(people1, frofit1, <span class="string">&quot;-o&quot;</span>, color=<span class="string">&#x27;red&#x27;</span>)</span><br><span class="line"><span class="comment"># show 文字</span></span><br><span class="line">plt.text(people1-<span class="number">170</span>, frofit1+<span class="number">5</span>, <span class="string">f&quot;(<span class="subst">&#123;people1&#125;</span>, <span class="subst">&#123;frofit1&#125;</span>)&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出利潤 48 萬</span></span><br><span class="line">frofit2 = <span class="number">48</span></span><br><span class="line">people2 = (frofit2 - ans[b]) / ans[a]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;f(<span class="subst">&#123;people2&#125;</span>) = <span class="subst">&#123;frofit2&#125;</span>&quot;</span>)</span><br><span class="line">plt.plot(people2, frofit2, <span class="string">&quot;-o&quot;</span>, color=<span class="string">&#x27;red&#x27;</span>)</span><br><span class="line"><span class="comment"># show 文字</span></span><br><span class="line">plt.text(people2-<span class="number">170</span>, frofit2+<span class="number">5</span>, <span class="string">f&quot;(<span class="subst">&#123;people2&#125;</span>, <span class="subst">&#123;frofit2&#125;</span>)&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># a=3/100</span></span><br><span class="line"><span class="comment"># b=-18</span></span><br><span class="line"><span class="comment"># f(1500) = 27</span></span><br><span class="line"><span class="comment"># f(2200) = 48</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic1.png" class="" title="pic1">
</div>

<h4 id="雞兔同籠"><a href="#雞兔同籠" class="headerlink" title="雞兔同籠"></a>雞兔同籠</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 雞兔同籠</span></span><br><span class="line"><span class="comment"># x + y = 35</span></span><br><span class="line"><span class="comment"># 2x + 4y = 100</span></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Symbol, solve</span><br><span class="line">x = Symbol(<span class="string">&quot;x&quot;</span>)</span><br><span class="line">y = Symbol(<span class="string">&quot;y&quot;</span>)</span><br><span class="line">eq1 = x + y - <span class="number">35</span></span><br><span class="line">eq2 = <span class="number">2</span>*x + <span class="number">4</span>*y -<span class="number">100</span></span><br><span class="line">ans = solve((eq1, eq2))</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;雞=<span class="subst">&#123;ans[x]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;兔=<span class="subst">&#123;ans[y]&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">x_p = <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">101</span>)</span><br><span class="line">y1_p = [ <span class="number">35</span> - x_no <span class="keyword">for</span> x_no <span class="keyword">in</span> x_p]</span><br><span class="line">y2_p = [ (<span class="number">100</span> - <span class="number">2</span>*x_no)/<span class="number">4</span> <span class="keyword">for</span> x_no <span class="keyword">in</span> x_p]</span><br><span class="line">plt.plot(x_p, y1_p)</span><br><span class="line">plt.plot(x_p, y2_p)</span><br><span class="line"></span><br><span class="line">plt.plot(ans[x], ans[y], <span class="string">&quot;-o&quot;</span>)</span><br><span class="line">plt.text(ans[x], ans[y]+<span class="number">5</span>, <span class="string">f&quot;(<span class="subst">&#123;ans[x]&#125;</span>, <span class="subst">&#123;ans[y]&#125;</span>)&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.xlabel(<span class="string">&#x27;雞&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;兔&#x27;</span>)</span><br><span class="line">plt.grid()</span><br><span class="line"></span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># &#123;x: 20, y: 15&#125;</span></span><br><span class="line"><span class="comment"># 雞=20</span></span><br><span class="line"><span class="comment"># 兔=15</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic2.png" class="" title="pic2">
</div>

<h4 id="業務目標計算"><a href="#業務目標計算" class="headerlink" title="業務目標計算"></a>業務目標計算</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 業務目標計算</span></span><br><span class="line"><span class="comment"># x + y = 100(天)</span></span><br><span class="line"><span class="comment"># 2x + 4y = 350(萬)</span></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Symbol, solve</span><br><span class="line">x = Symbol(<span class="string">&quot;x&quot;</span>)</span><br><span class="line">y = Symbol(<span class="string">&quot;y&quot;</span>)</span><br><span class="line">eq1 = x + y - <span class="number">100</span></span><br><span class="line">eq2 = <span class="number">2</span>*x + <span class="number">4</span>*y - <span class="number">350</span></span><br><span class="line">ans = solve((eq1, eq2))</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;菜鳥業務=<span class="subst">&#123;ans[x]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;資深業務=<span class="subst">&#123;ans[y]&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">line_x = <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">101</span>)</span><br><span class="line">line1_y = [ <span class="number">100</span> - x_no <span class="keyword">for</span> x_no <span class="keyword">in</span> line_x]</span><br><span class="line">line2_y = [ (<span class="number">350</span> - <span class="number">2</span>*x_no)/<span class="number">4</span> <span class="keyword">for</span> x_no <span class="keyword">in</span> line_x]</span><br><span class="line">plt.plot(line_x, line1_y)</span><br><span class="line">plt.plot(line_x, line2_y)</span><br><span class="line"></span><br><span class="line">plt.plot(ans[x], ans[y], <span class="string">&quot;-o&quot;</span>)</span><br><span class="line">plt.text(ans[x], ans[y]+<span class="number">5</span>, <span class="string">f&quot;(<span class="subst">&#123;ans[x]&#125;</span>, <span class="subst">&#123;ans[y]&#125;</span>)&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.xlabel(<span class="string">&#x27;菜鳥業務&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;資深業務&#x27;</span>)</span><br><span class="line">plt.grid()</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic3.png" class="" title="pic3">
</div>

<h4 id="垂直相交線"><a href="#垂直相交線" class="headerlink" title="垂直相交線"></a>垂直相交線</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 垂直相交線</span></span><br><span class="line"><span class="comment"># y = x</span></span><br><span class="line"><span class="comment"># y = -x + 2</span></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Symbol, solve</span><br><span class="line">x = Symbol(<span class="string">&quot;x&quot;</span>)</span><br><span class="line">y = Symbol(<span class="string">&quot;y&quot;</span>)</span><br><span class="line">eq1 = x - y</span><br><span class="line">eq2 = -x + <span class="number">2</span> - y</span><br><span class="line">ans = solve((eq1, eq2))</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">line_x = <span class="built_in">range</span>(-<span class="number">5</span>,<span class="number">5</span>)</span><br><span class="line">line1_y = [  x_no <span class="keyword">for</span> x_no <span class="keyword">in</span> line_x]</span><br><span class="line">line2_y = [ -x_no + <span class="number">2</span> <span class="keyword">for</span> x_no <span class="keyword">in</span> line_x]</span><br><span class="line">plt.plot(line_x, line1_y)</span><br><span class="line">plt.plot(line_x, line2_y)</span><br><span class="line"></span><br><span class="line">plt.plot(ans[x], ans[y], <span class="string">&quot;-o&quot;</span>)</span><br><span class="line">plt.text(ans[x]-<span class="number">0.25</span>, ans[y]+<span class="number">0.5</span>, <span class="string">f&quot;(<span class="subst">&#123;ans[x]&#125;</span>, <span class="subst">&#123;ans[y]&#125;</span>)&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.xlabel(<span class="string">&#x27;x-axis&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;y-axis&#x27;</span>)</span><br><span class="line">plt.grid()</span><br><span class="line"></span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># &#123;x: 1, y: 1&#125;</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic4.png" class="" title="pic4">
</div>

<h4 id="求某一點至一條線垂直線"><a href="#求某一點至一條線垂直線" class="headerlink" title="求某一點至一條線垂直線"></a>求某一點至一條線垂直線</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 求某一點至一條線垂直線</span></span><br><span class="line"><span class="comment"># y = 0.5x - 0.5</span></span><br><span class="line"><span class="comment"># point (2,3)</span></span><br><span class="line"><span class="comment"># y = -2x + 7</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Symbol, solve</span><br><span class="line">x = Symbol(<span class="string">&quot;x&quot;</span>)</span><br><span class="line">y = Symbol(<span class="string">&quot;y&quot;</span>)</span><br><span class="line">eq1 = <span class="number">0.5</span>*x - <span class="number">0.5</span> - y</span><br><span class="line">eq2 = -<span class="number">2</span>*x + <span class="number">7</span> - y</span><br><span class="line">ans = solve((eq1, eq2))</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">line_x = <span class="built_in">range</span>(-<span class="number">5</span>,<span class="number">6</span>)</span><br><span class="line">line_y = [<span class="number">0.5</span>*x_no - <span class="number">0.5</span> <span class="keyword">for</span> x_no <span class="keyword">in</span> line_x]</span><br><span class="line">plt.plot(line_x, line_y)</span><br><span class="line"></span><br><span class="line">line2_x = <span class="built_in">range</span>(-<span class="number">5</span>,<span class="number">6</span>)</span><br><span class="line">line2_y = [-<span class="number">2</span>*x_no + <span class="number">7</span> <span class="keyword">for</span> x_no <span class="keyword">in</span> line2_x ]</span><br><span class="line">plt.plot(line2_x, line2_y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># point (2,3)</span></span><br><span class="line">point_x = <span class="number">2</span></span><br><span class="line">point_y = <span class="number">3</span></span><br><span class="line">plt.plot(point_x, point_y, <span class="string">&quot;-o&quot;</span>)</span><br><span class="line">plt.text(point_x-<span class="number">0.25</span>, point_y+<span class="number">0.5</span>, <span class="string">f&quot;(<span class="subst">&#123;point_x&#125;</span>, <span class="subst">&#123;point_y&#125;</span>)&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># point connection</span></span><br><span class="line">plt.plot(ans[x], ans[y], <span class="string">&quot;-o&quot;</span>)</span><br><span class="line">plt.text(ans[x]-<span class="number">0.25</span>, ans[y]+<span class="number">0.5</span>, <span class="string">f&quot;(<span class="subst">&#123;<span class="built_in">int</span>(ans[x])&#125;</span>, <span class="subst">&#123;<span class="built_in">int</span>(ans[y])&#125;</span>)&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.xlabel(<span class="string">&#x27;x-axis&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;y-axis&#x27;</span>)</span><br><span class="line">plt.grid()</span><br><span class="line"><span class="comment"># x, y軸距長度一致</span></span><br><span class="line">plt.axis(<span class="string">&#x27;equal&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># &#123;x: 3.00000000000000, y: 1.00000000000000&#125;</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic5.png" class="" title="pic5">
</div>

<h3 id="畢氏定理"><a href="#畢氏定理" class="headerlink" title="畢氏定理"></a>畢氏定理</h3><h4 id="電影分類"><a href="#電影分類" class="headerlink" title="電影分類"></a>電影分類</h4><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic6.png" class="" title="pic6">
</div>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 電影分類</span></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="comment"># 玩命關頭</span></span><br><span class="line">film = [<span class="number">5</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">2</span>]</span><br><span class="line">film_titles = [</span><br><span class="line">    <span class="string">&quot;復仇者聯盟&quot;</span>,</span><br><span class="line">    <span class="string">&quot;決戰中途島&quot;</span>,</span><br><span class="line">    <span class="string">&quot;冰雪奇緣&quot;</span>,</span><br><span class="line">    <span class="string">&quot;雙子殺手&quot;</span></span><br><span class="line">]</span><br><span class="line">film_features = [</span><br><span class="line">    [<span class="number">2</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">6</span>],</span><br><span class="line">    [<span class="number">5</span>, <span class="number">6</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">5</span>],</span><br><span class="line">    [<span class="number">8</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>],</span><br><span class="line">    [<span class="number">5</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">3</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">dists =[]</span><br><span class="line"><span class="keyword">for</span> p <span class="keyword">in</span> film_features:</span><br><span class="line">    distance = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i, item <span class="keyword">in</span> <span class="built_in">enumerate</span>(p):</span><br><span class="line">        score = <span class="built_in">int</span>(item) - <span class="built_in">int</span>(film[i])</span><br><span class="line">        distance += score * score</span><br><span class="line">    dists.append(math.sqrt(distance))</span><br><span class="line">good_point = <span class="number">0</span></span><br><span class="line">good_distance = dists[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> index, value <span class="keyword">in</span> <span class="built_in">enumerate</span>(dists):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;film_titles[index]&#125;</span> : <span class="subst">&#123;value:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> index &gt; <span class="number">0</span> <span class="keyword">and</span> dists[index] &lt; good_distance:</span><br><span class="line">        good_point = index</span><br><span class="line">        good_distance = dists[index]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;close movie is <span class="subst">&#123;film_titles[good_point]&#125;</span> : <span class="subst">&#123;dists[good_point]:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 復仇者聯盟 : 7.14</span></span><br><span class="line"><span class="comment"># 決戰中途島 : 8.66</span></span><br><span class="line"><span class="comment"># 冰雪奇緣 : 16.19</span></span><br><span class="line"><span class="comment"># 雙子殺手 : 2.45</span></span><br><span class="line"><span class="comment"># close movie is 雙子殺手 : 2.45</span></span><br></pre></td></tr></table></figure>

<h4 id="計算兩個向量的歐幾乎里德距離"><a href="#計算兩個向量的歐幾乎里德距離" class="headerlink" title="計算兩個向量的歐幾乎里德距離"></a>計算兩個向量的歐幾乎里德距離</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 計算兩個向量的歐幾乎里德距離</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">a = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">b = np.array([<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>])</span><br><span class="line">distance = np.sqrt(np.<span class="built_in">sum</span>((a-b)**<span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;a and b 距離 : <span class="subst">&#123;distance:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># a and b 距離 : 5.20</span></span><br></pre></td></tr></table></figure>

<h3 id="聯立不等式"><a href="#聯立不等式" class="headerlink" title="聯立不等式"></a>聯立不等式</h3><h4 id="開發分析"><a href="#開發分析" class="headerlink" title="開發分析"></a>開發分析</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 開發分析</span></span><br><span class="line"><span class="comment"># 商用軟體: 開發費用90萬,包裝介面設計50萬</span></span><br><span class="line"><span class="comment"># App軟體 : 開發費用150萬,包裝介面設計20萬</span></span><br><span class="line"><span class="comment"># 研發成本&lt;=1200萬</span></span><br><span class="line"><span class="comment"># 包裝介面&lt;=350萬</span></span><br><span class="line"><span class="comment"># 每個按鍵獲利50萬,計算最大獲利</span></span><br><span class="line"><span class="comment"># 90x + 150y &lt;= 1200 --&gt; y &lt;= -0.6x + 8</span></span><br><span class="line"><span class="comment"># 50x + 20y  &lt;= 350  --&gt; y &lt;= -2.5x + 17.5</span></span><br><span class="line"><span class="comment"># z = 50x + 50y</span></span><br><span class="line"><span class="comment"># (若獲利 600萬) 50x + 50y = 600 --&gt; y = -x + 12</span></span><br><span class="line"><span class="comment"># (5, 5) --&gt; 50*5 + 50*5 = 500 --&gt; y = -x + 10</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Symbol, solve</span><br><span class="line"></span><br><span class="line"><span class="comment"># 求 line1 line2 交叉</span></span><br><span class="line">x = Symbol(<span class="string">&quot;x&quot;</span>)</span><br><span class="line">y = Symbol(<span class="string">&quot;y&quot;</span>)</span><br><span class="line">eq1 = -<span class="number">0.6</span>*x + <span class="number">8</span>  - y</span><br><span class="line">eq2 = -<span class="number">2.5</span>*x + <span class="number">17.5</span> - y</span><br><span class="line">ans = solve((eq1, eq2))</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">line_x = <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">15</span>)</span><br><span class="line">line1_y = [ -<span class="number">0.6</span>*x_no + <span class="number">8</span> <span class="keyword">for</span> x_no <span class="keyword">in</span> line_x ]</span><br><span class="line">line2_y = [ -<span class="number">2.5</span>*x_no + <span class="number">17.5</span> <span class="keyword">for</span> x_no <span class="keyword">in</span> line_x ]</span><br><span class="line">plt.plot(line_x, line1_y)</span><br><span class="line">plt.plot(line_x, line2_y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># add point connection</span></span><br><span class="line">plt.plot(ans[x], ans[y], <span class="string">&quot;-o&quot;</span>)</span><br><span class="line">plt.text(ans[x]-<span class="number">0.25</span>, ans[y]+<span class="number">0.5</span>, <span class="string">f&quot;(<span class="subst">&#123;<span class="built_in">int</span>(ans[x])&#125;</span>, <span class="subst">&#123;<span class="built_in">int</span>(ans[y])&#125;</span>)&quot;</span>)</span><br><span class="line"></span><br><span class="line">line3_x = <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">15</span>)</span><br><span class="line"><span class="comment"># 獲利 600萬</span></span><br><span class="line"><span class="comment"># line3_y = [ -x_no + 12 for x_no in line3_x ]</span></span><br><span class="line"><span class="comment"># 獲利 500萬</span></span><br><span class="line">line3_y = [ -x_no + <span class="number">10</span> <span class="keyword">for</span> x_no <span class="keyword">in</span> line3_x ]</span><br><span class="line">plt.plot(line3_x, line3_y, lw=<span class="string">&#x27;2.0&#x27;</span>, color=<span class="string">&quot;green&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.xlabel(<span class="string">&#x27;商用軟體&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;App軟體&#x27;</span>)</span><br><span class="line"><span class="comment"># 表格顯示範圍 x:0~20,y:0~20</span></span><br><span class="line">plt.axis([<span class="number">0</span>, <span class="number">20</span>, <span class="number">0</span>, <span class="number">20</span>])</span><br><span class="line">plt.grid()</span><br><span class="line"></span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># &#123;x: 5.00000000000000, y: 5.00000000000000&#125;</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic7.png" class="" title="pic7">
</div>

<h3 id="二次函數"><a href="#二次函數" class="headerlink" title="二次函數"></a>二次函數</h3><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic8.png" class="" title="pic8">
</div>
<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic9.png" class="" title="pic9">
</div>

<h4 id="解一元二次方程式的根"><a href="#解一元二次方程式的根" class="headerlink" title="解一元二次方程式的根"></a>解一元二次方程式的根</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解一元二次方程式的根</span></span><br><span class="line"><span class="comment"># x**2 - 2x - 8 = 0</span></span><br><span class="line"><span class="comment"># x**2 - 2x + 1 = 0</span></span><br><span class="line"><span class="comment"># x**2 + x + 1 = 0</span></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># 兩個根</span></span><br><span class="line">x = Symbol(<span class="string">&quot;x&quot;</span>)</span><br><span class="line">f = x**<span class="number">2</span> - <span class="number">2</span>*x - <span class="number">8</span></span><br><span class="line">roots = solve(f)</span><br><span class="line"><span class="built_in">print</span>(roots)</span><br><span class="line"><span class="comment"># [-2, 4]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 一個根</span></span><br><span class="line">f = x**<span class="number">2</span> - <span class="number">2</span>*x + <span class="number">1</span></span><br><span class="line">roots = solve(f)</span><br><span class="line"><span class="built_in">print</span>(roots)</span><br><span class="line"><span class="comment"># [1]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 無實數根</span></span><br><span class="line">f = x**<span class="number">2</span> + x + <span class="number">1</span></span><br><span class="line">roots = solve(f)</span><br><span class="line"><span class="built_in">print</span>(roots)</span><br><span class="line">number_roots = [root.evalf() <span class="keyword">for</span> root <span class="keyword">in</span> roots]</span><br><span class="line"><span class="built_in">print</span>(number_roots)</span><br><span class="line"><span class="comment"># [-1/2 - sqrt(3)*I/2, -1/2 + sqrt(3)*I/2]</span></span><br><span class="line"><span class="comment"># [-0.5 - 0.866025403784439*I, -0.5 + 0.866025403784439*I]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 算實際值(當含函數式)</span></span><br><span class="line">f = <span class="number">3</span>*(x-<span class="number">2</span>)**<span class="number">2</span> - <span class="number">2</span></span><br><span class="line"><span class="comment"># solve 函數的輸出是符號表達式。這些表達式可能是涉及根號或其他符號的形式。</span></span><br><span class="line"><span class="comment"># 如果我們需要實際的數值，我們需要進一步轉換這些符號表達式為數值。</span></span><br><span class="line">roots = solve(f)</span><br><span class="line"><span class="built_in">print</span>(roots)</span><br><span class="line">number_roots = [root.evalf() <span class="keyword">for</span> root <span class="keyword">in</span> roots]</span><br><span class="line"><span class="built_in">print</span>(number_roots)</span><br><span class="line"><span class="comment"># [2 - sqrt(6)/3, sqrt(6)/3 + 2]</span></span><br><span class="line"><span class="comment"># [1.18350341907227, 2.81649658092773]</span></span><br></pre></td></tr></table></figure>

<h4 id="一元二次方程式繪圖並算極值"><a href="#一元二次方程式繪圖並算極值" class="headerlink" title="一元二次方程式繪圖並算極值"></a>一元二次方程式繪圖並算極值</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一元二次方程式繪圖並算極值</span></span><br><span class="line"><span class="comment"># y = 3x**2 - 12x + 10 繪圖,標示兩個根,標極值</span></span><br><span class="line"><span class="comment"># y = -3x**2 + 12x - 9 繪圖,標示兩個根,標極值</span></span><br><span class="line"><span class="comment"># y = x**2 +  x + 1 (無根)</span></span><br><span class="line"><span class="comment"># 根的意義為 y 值為 0</span></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">x = Symbol(<span class="string">&quot;x&quot;</span>)</span><br><span class="line"><span class="comment"># y = 3x**2 - 12x + 10</span></span><br><span class="line">f = <span class="number">3</span>*x**<span class="number">2</span> -<span class="number">12</span>*x + <span class="number">10</span></span><br><span class="line"><span class="comment"># y = -3x**2 + 12x - 9</span></span><br><span class="line"><span class="comment"># f = -3*x**2 + 12*x - 9</span></span><br><span class="line">roots = solve(f)</span><br><span class="line"><span class="comment"># print(roots)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># y = 3x**2 - 12x + 10</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x</span>) :</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">3</span>*x**<span class="number">2</span> -<span class="number">12</span>*x + <span class="number">10</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">g</span>(<span class="params">x</span>) :</span></span><br><span class="line">    <span class="keyword">return</span> -f(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># y = -3x**2 + 12x - 9</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f2</span>(<span class="params">x</span>) :</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">3</span>*x**<span class="number">2</span> +<span class="number">12</span>*x - <span class="number">9</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">g2</span>(<span class="params">x</span>) :</span></span><br><span class="line">    <span class="keyword">return</span> -f2(x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> minimize_scalar</span><br><span class="line"></span><br><span class="line"><span class="comment"># y = 3x**2 - 12x + 10</span></span><br><span class="line">line_x =  np.linspace(<span class="number">0</span>, <span class="number">4</span>, <span class="number">100</span>)</span><br><span class="line"><span class="comment"># line_y = [3*x_no**2 - 12*x_no + 10 for x_no in line_x]</span></span><br><span class="line"><span class="comment"># 與前面算式相等</span></span><br><span class="line">line_y = <span class="number">3</span>*line_x**<span class="number">2</span> - <span class="number">12</span>*line_x + <span class="number">10</span></span><br><span class="line"><span class="comment"># y = 3x**2 + 12x - 9</span></span><br><span class="line"><span class="comment"># line_x =  np.linspace(0, 4, 100)</span></span><br><span class="line"><span class="comment"># line_y = [-3*x_no**2 + 12*x_no - 9 for x_no in line_x]</span></span><br><span class="line"><span class="comment"># 無根</span></span><br><span class="line"><span class="comment"># line_x =  np.linspace(-4, 4, 100)</span></span><br><span class="line"><span class="comment"># line_y = [x_no**2 +  x_no + 1 for x_no in line_x]</span></span><br><span class="line">plt.plot(line_x, line_y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 標示根</span></span><br><span class="line"><span class="keyword">for</span> root <span class="keyword">in</span> roots:</span><br><span class="line">    x_value = root.evalf()</span><br><span class="line">    <span class="comment"># y = 3x**2 - 12x + 10</span></span><br><span class="line">    y_value = f(x_value)</span><br><span class="line">    <span class="comment"># y = -3x**2 + 12x - 9</span></span><br><span class="line">    <span class="comment"># y_value = f2(x_value)</span></span><br><span class="line">    plt.plot(x_value, y_value, <span class="string">&quot;-o&quot;</span>)</span><br><span class="line">    plt.text(x_value - <span class="number">0.35</span>, y_value + <span class="number">0.4</span>, <span class="string">f&quot;(<span class="subst">&#123;x_value:<span class="number">.2</span>f&#125;</span>,<span class="subst">&#123;y_value:<span class="number">.2</span>f&#125;</span>)&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 標示極值</span></span><br><span class="line"><span class="comment"># y = 3x**2 - 12x + 10</span></span><br><span class="line">peak = minimize_scalar(f)</span><br><span class="line"><span class="comment"># y = -3x**2 + 12x - 9</span></span><br><span class="line"><span class="comment"># peak = minimize_scalar(f2)</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span>(np.isinf(peak.fun)):</span><br><span class="line">    <span class="comment"># 有最小值</span></span><br><span class="line">    limit_y = peak.fun</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="comment"># y = 3x**2 - 12x + 10</span></span><br><span class="line">    peak = minimize_scalar(g)</span><br><span class="line">    <span class="comment"># y = -3x**2 + 12x - 9</span></span><br><span class="line">    <span class="comment"># peak = minimize_scalar(g2)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span>(np.isinf(peak.fun)):</span><br><span class="line">        <span class="comment"># 有最大值</span></span><br><span class="line">        limit_y = -peak.fun</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span>(np.isinf(peak.fun)):</span><br><span class="line">    plt.plot(peak.x, limit_y, <span class="string">&quot;-o&quot;</span>)</span><br><span class="line">    plt.text(peak.x - <span class="number">0.35</span>, limit_y + <span class="number">0.4</span>, <span class="string">f&quot;(<span class="subst">&#123;peak.x:<span class="number">.2</span>f&#125;</span>,<span class="subst">&#123;limit_y:<span class="number">.2</span>f&#125;</span>)&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic10.png" class="" title="pic10">
</div>

<h4 id="一元三次圖形繪製"><a href="#一元三次圖形繪製" class="headerlink" title="一元三次圖形繪製"></a>一元三次圖形繪製</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一元三次圖形繪製</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 上下圖</span></span><br><span class="line"><span class="comment"># subplot(2,1,1)</span></span><br><span class="line"><span class="comment"># subplot(2,1,2)</span></span><br><span class="line">plt.figure(figsize=[<span class="number">8</span>,<span class="number">8</span>])</span><br><span class="line"><span class="comment"># fig 1</span></span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">line_x =  np.linspace(-<span class="number">1</span>, <span class="number">1</span>, <span class="number">100</span>)</span><br><span class="line">line_y = line_x**<span class="number">3</span> - line_x</span><br><span class="line">plt.plot(line_x, line_y, color=<span class="string">&quot;green&quot;</span>)</span><br><span class="line">plt.grid()</span><br><span class="line"></span><br><span class="line"><span class="comment"># fig 2</span></span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">line2_x =  np.linspace(-<span class="number">2</span>, <span class="number">2</span>, <span class="number">100</span>)</span><br><span class="line">line2_y = line2_x**<span class="number">3</span> - line2_x</span><br><span class="line">plt.plot(line2_x, line2_y, color=<span class="string">&quot;red&quot;</span>)</span><br><span class="line">plt.grid()</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic11.png" class="" title="pic11">
</div>

<h4 id="求一元二次方程式-並繪圖"><a href="#求一元二次方程式-並繪圖" class="headerlink" title="求一元二次方程式,並繪圖"></a>求一元二次方程式,並繪圖</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 求一元二次方程式,並繪圖</span></span><br><span class="line"><span class="comment"># 匯出 100, 200, 300 的點,及預估 400 的點</span></span><br><span class="line"><span class="comment"># 拜訪次數(1=100次) vs 業績(回收問卷)</span></span><br><span class="line"><span class="comment"># y = ax**2 + bx + c</span></span><br><span class="line"><span class="comment"># x = 1, y =500 --&gt; 500 = a + b +c</span></span><br><span class="line"><span class="comment"># x = 2, y =1000 --&gt; 1000 = 4a + 2b +c</span></span><br><span class="line"><span class="comment"># x = 3, y =2000 --&gt; 2000 = 9a + 3b +c</span></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols, solve</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">y_count</span>(<span class="params">a, b, c, x</span>):</span></span><br><span class="line">    <span class="keyword">return</span> (a*x**<span class="number">2</span> + b*x + c)</span><br><span class="line"></span><br><span class="line">a, b, c = symbols((<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>))</span><br><span class="line">eq1 = a + b + c - <span class="number">500</span></span><br><span class="line">eq2 = <span class="number">4</span>*a + <span class="number">2</span>*b + c - <span class="number">1000</span></span><br><span class="line">eq3 = <span class="number">9</span>*a + <span class="number">3</span>*b + c - <span class="number">2000</span></span><br><span class="line">ans = solve((eq1, eq2, eq3))</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"><span class="comment"># &#123;a: 250, b: -250, c: 500&#125;</span></span><br><span class="line"></span><br><span class="line">x = np.linspace(<span class="number">0</span>, <span class="number">5</span>, <span class="number">50</span>)</span><br><span class="line">y = ans[a]*x**<span class="number">2</span> + ans[b]*x + ans[c]</span><br><span class="line">plt.plot(x,y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">5</span>):</span><br><span class="line">    y_axis = y_count(ans[a], ans[b], ans[c], i)</span><br><span class="line">    plt.plot(i, y_axis, <span class="string">&quot;-o&quot;</span>, color=<span class="string">&quot;green&quot;</span>)</span><br><span class="line">    plt.text(i - <span class="number">0.6</span>, y_axis + <span class="number">200</span>, <span class="string">f&quot;(<span class="subst">&#123;i&#125;</span>,<span class="subst">&#123;y_axis&#125;</span>)&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 計算回收 3000 張問卷,拜訪次數</span></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Symbol, solve</span><br><span class="line">count_value = <span class="number">3000</span></span><br><span class="line">z = Symbol(<span class="string">&quot;z&quot;</span>)</span><br><span class="line">eq = ans[a]*z**<span class="number">2</span> + ans[b]*z + ans[c] - count_value</span><br><span class="line">ans_3000 = solve(eq)</span><br><span class="line"><span class="built_in">print</span>(ans_3000)</span><br><span class="line"><span class="comment"># [1/2 - sqrt(41)/2, 1/2 + sqrt(41)/2]</span></span><br><span class="line"><span class="keyword">for</span> ans_item <span class="keyword">in</span> ans_3000:</span><br><span class="line">    ans_value = ans_item.evalf()</span><br><span class="line">    <span class="built_in">print</span>(ans_value)</span><br><span class="line">    <span class="keyword">if</span> (ans_value &gt; <span class="number">0</span>):</span><br><span class="line">        plt.plot(ans_value, count_value, <span class="string">&quot;-o&quot;</span>, color=<span class="string">&quot;red&quot;</span>)</span><br><span class="line">        plt.text(ans_value - <span class="number">0.8</span>, count_value + <span class="number">200</span>, <span class="string">f&quot;(<span class="subst">&#123;ans_value:<span class="number">.2</span>f&#125;</span>,<span class="subst">&#123;count_value&#125;</span>)&quot;</span>)</span><br><span class="line"><span class="comment"># -2.70156211871642</span></span><br><span class="line"><span class="comment"># 3.70156211871642</span></span><br><span class="line"></span><br><span class="line">plt.xlabel(<span class="string">&#x27;拜訪次數(單位=100)&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;業績&#x27;</span>)</span><br><span class="line">plt.grid()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic12.png" class="" title="pic12">
</div>

<h4 id="二次函數的配方法-標準式"><a href="#二次函數的配方法-標準式" class="headerlink" title="二次函數的配方法(標準式)"></a>二次函數的配方法(標準式)</h4><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic13.png" class="" title="pic13">
</div>

<h4 id="行銷問題分析"><a href="#行銷問題分析" class="headerlink" title="行銷問題分析"></a>行銷問題分析</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 行銷問題分析</span></span><br><span class="line"><span class="comment"># 每月行銷次數 增加業績</span></span><br><span class="line"><span class="comment">#     1         10萬</span></span><br><span class="line"><span class="comment">#     2         18萬</span></span><br><span class="line"><span class="comment">#     3         19萬</span></span><br><span class="line"><span class="comment"># y = ax**2 + b*x + c</span></span><br><span class="line"><span class="comment"># a + b + c = 10</span></span><br><span class="line"><span class="comment"># 4a + 2b + c = 18</span></span><br><span class="line"><span class="comment"># 9a + 3b + c = 18</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> Symbol, symbols, solve</span><br><span class="line">a, b, c = symbols((<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>))</span><br><span class="line">eq1 = a + b + c - <span class="number">10</span></span><br><span class="line">eq2 = <span class="number">4</span>*a + <span class="number">2</span>*b + c - <span class="number">18</span></span><br><span class="line">eq3 = <span class="number">9</span>*a + <span class="number">3</span>*b + c - <span class="number">19</span></span><br><span class="line">ans = solve((eq1, eq2, eq3))</span><br><span class="line"><span class="built_in">print</span>(ans)</span><br><span class="line"><span class="comment"># &#123;a: -7/2, b: 37/2, c: -5&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># x 要放在最前面</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span>(<span class="params">x, a, b, c</span>) :</span></span><br><span class="line">    <span class="keyword">return</span> (a*x**<span class="number">2</span> + b*x + c)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">g</span>(<span class="params">x, a, b, c</span>) :</span></span><br><span class="line">    <span class="keyword">return</span> -f(x, a, b, c)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> scipy.optimize <span class="keyword">import</span> minimize_scalar</span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">x = np.linspace(<span class="number">0</span>, <span class="number">5</span>, <span class="number">50</span>)</span><br><span class="line">y = ans[a]*x**<span class="number">2</span> + ans[b]*x + ans[c]</span><br><span class="line">plt.plot(x,y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 算最大值</span></span><br><span class="line"><span class="built_in">print</span>(ans[a].evalf(), ans[b].evalf(), ans[c].evalf())</span><br><span class="line"><span class="comment"># args 不含 x, 要轉成 float 才不會有問題</span></span><br><span class="line">args = (<span class="built_in">float</span>(ans[a].evalf()), <span class="built_in">float</span>(ans[b].evalf()), <span class="built_in">float</span>(ans[c].evalf()))</span><br><span class="line">peak = minimize_scalar(g, args=args)</span><br><span class="line">limit_y = -peak.fun</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;max (<span class="subst">&#123;peak.x&#125;</span>,<span class="subst">&#123;limit_y&#125;</span>)&quot;</span>)</span><br><span class="line">plt.plot(peak.x,limit_y, <span class="string">&quot;-o&quot;</span>)</span><br><span class="line">plt.text(peak.x-<span class="number">0.3</span>,limit_y-<span class="number">2</span>, <span class="string">f&quot;(<span class="subst">&#123;peak.x:<span class="number">.1</span>f&#125;</span>,<span class="subst">&#123;limit_y:<span class="number">.1</span>f&#125;</span>)&quot;</span>)</span><br><span class="line"><span class="comment"># -3.50000000000000 18.5000000000000 -5.00000000000000</span></span><br><span class="line"><span class="comment"># max (2.6428571428571432,19.446428571428577)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 算業績15萬的交叉點</span></span><br><span class="line"><span class="comment"># 15 = -3.5**2 + 18.5*x - 5</span></span><br><span class="line">ask_y = <span class="number">15</span></span><br><span class="line">x2 = Symbol(<span class="string">&quot;x2&quot;</span>)</span><br><span class="line">eq = -<span class="number">3.5</span>*x2**<span class="number">2</span> + <span class="number">18.5</span>*x2 - <span class="number">20</span></span><br><span class="line">ans2 = solve(eq)</span><br><span class="line"><span class="built_in">print</span>(ans2)</span><br><span class="line"><span class="keyword">for</span> x_value <span class="keyword">in</span> ans2:</span><br><span class="line">    plt.plot(x_value,ask_y, <span class="string">&quot;-o&quot;</span>, color=<span class="string">&quot;green&quot;</span>)</span><br><span class="line">    plt.text(x_value+<span class="number">0.1</span>,ask_y, <span class="string">f&quot;(<span class="subst">&#123;x_value:<span class="number">.1</span>f&#125;</span>,<span class="subst">&#123;ask_y:<span class="number">.1</span>f&#125;</span>)&quot;</span>)</span><br><span class="line">plt.grid()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic14.png" class="" title="pic14">
</div>

<h3 id="最小平方法-線性迴歸模型"><a href="#最小平方法-線性迴歸模型" class="headerlink" title="最小平方法(線性迴歸模型)"></a>最小平方法(線性迴歸模型)</h3><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic15.png" class="" title="pic15">
</div>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic16.png" class="" title="pic16">
</div>

<h4 id="Numpy-實作最小平方法"><a href="#Numpy-實作最小平方法" class="headerlink" title="Numpy 實作最小平方法"></a>Numpy 實作最小平方法</h4><a href="/2024/04/12/python-22/" title="# polyfit-計算迴歸線"># polyfit-計算迴歸線</a>

<h4 id="氣溫-vs-銷售量"><a href="#氣溫-vs-銷售量" class="headerlink" title="氣溫 vs 銷售量"></a>氣溫 vs 銷售量</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 氣溫 vs 銷售量</span></span><br><span class="line"><span class="comment"># 氣溫x   22, 26, 23, 28, 27, 32, 30</span></span><br><span class="line"><span class="comment"># 銷售量y 15, 35, 21, 62, 48, 101, 86</span></span><br><span class="line"><span class="comment"># 預估氣溫31的銷售量</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x = np.array([<span class="number">22</span>, <span class="number">26</span>, <span class="number">23</span>, <span class="number">28</span>, <span class="number">27</span>, <span class="number">32</span>, <span class="number">30</span>])</span><br><span class="line">y = np.array([<span class="number">15</span>, <span class="number">35</span>, <span class="number">21</span>, <span class="number">62</span>, <span class="number">48</span>, <span class="number">101</span>, <span class="number">86</span>])</span><br><span class="line"></span><br><span class="line">a, b = np.polyfit(x, y, <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;斜率<span class="subst">&#123;a:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;截距<span class="subst">&#123;b:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 繪迴歸直線</span></span><br><span class="line">x2 = np.linspace(<span class="number">20</span>, <span class="number">35</span>, <span class="number">50</span>)</span><br><span class="line">y2 = a * x2 + b</span><br><span class="line">plt.plot(x2, y2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 預估氣溫31的銷售量</span></span><br><span class="line">x_count = <span class="number">31</span></span><br><span class="line">y_count = a*x_count + b</span><br><span class="line">plt.plot(x_count, y_count, <span class="string">&quot;-o&quot;</span>, color=<span class="string">&quot;red&quot;</span>)</span><br><span class="line">plt.text(x_count-<span class="number">1.5</span>, y_count+<span class="number">3</span>, <span class="string">f&quot;(<span class="subst">&#123;x_count&#125;</span>,<span class="subst">&#123;<span class="built_in">int</span>(y_count)&#125;</span>)&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> index, x_value <span class="keyword">in</span> <span class="built_in">enumerate</span>(x):</span><br><span class="line">    plt.plot(x_value, y[index], <span class="string">&quot;-o&quot;</span>, color=<span class="string">&quot;green&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.xlabel(<span class="string">&#x27;氣溫&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;銷售量&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.grid()</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># 斜率8.89</span></span><br><span class="line"><span class="comment"># 截距-186.30</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic17.png" class="" title="pic17">
</div>

<h3 id="排列與組合"><a href="#排列與組合" class="headerlink" title="排列與組合"></a>排列與組合</h3><h4 id="nPr-permutation-排列"><a href="#nPr-permutation-排列" class="headerlink" title="nPr(permutation-排列)"></a>nPr(permutation-排列)</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nPr(permutation-排列):從 n 個位數圖提出r個數字排列</span></span><br><span class="line"><span class="comment"># n*(n-1)*(n-2)...</span></span><br><span class="line"><span class="comment"># 4P3</span></span><br><span class="line"><span class="comment"># [itertools](https://docs.python.org/3/library/itertools.html)</span></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line">n = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;</span><br><span class="line">r = <span class="number">3</span></span><br><span class="line">A = <span class="built_in">set</span>(itertools.permutations(n, r))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;元素數量 = <span class="subst">&#123;<span class="built_in">len</span>(A)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> A:</span><br><span class="line">    <span class="built_in">print</span>(a)</span><br><span class="line"><span class="comment"># 元素數量 = 24</span></span><br><span class="line"><span class="comment"># (2, 1, 3)</span></span><br><span class="line"><span class="comment"># (4, 2, 1)</span></span><br><span class="line"><span class="comment"># .....</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5P2</span></span><br><span class="line">n2 = &#123;<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>, <span class="string">&quot;d&quot;</span>, <span class="string">&quot;e&quot;</span>&#125;</span><br><span class="line">r2 = <span class="number">2</span></span><br><span class="line">A2 = <span class="built_in">set</span>(itertools.permutations(n2, r2))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;元素數量 = <span class="subst">&#123;<span class="built_in">len</span>(A2)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> a2 <span class="keyword">in</span> A2:</span><br><span class="line">    <span class="built_in">print</span>(a2)</span><br><span class="line"><span class="comment"># 元素數量 = 20</span></span><br><span class="line"><span class="comment"># (&#x27;c&#x27;, &#x27;b&#x27;)</span></span><br><span class="line"><span class="comment"># (&#x27;e&#x27;, &#x27;a&#x27;)</span></span><br><span class="line"><span class="comment"># .....</span></span><br></pre></td></tr></table></figure>

<h4 id="階層觀念"><a href="#階層觀念" class="headerlink" title="階層觀念"></a>階層觀念</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 階層觀念</span></span><br><span class="line"><span class="comment"># 5 個客戶分別在5個城市,有多少拜訪路徑? 5!</span></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line">n = &#123;<span class="string">&quot;A&quot;</span>, <span class="string">&quot;B&quot;</span>, <span class="string">&quot;C&quot;</span>, <span class="string">&quot;D&quot;</span>, <span class="string">&quot;E&quot;</span>&#125;</span><br><span class="line">r = <span class="number">5</span></span><br><span class="line">A = <span class="built_in">set</span>(itertools.permutations(n, r))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;元素數量 = <span class="subst">&#123;<span class="built_in">len</span>(A)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> A:</span><br><span class="line">    <span class="built_in">print</span>(a)</span><br><span class="line"><span class="comment"># 元素數量 = 120</span></span><br><span class="line"><span class="comment"># (&#x27;C&#x27;, &#x27;D&#x27;, &#x27;E&#x27;, &#x27;A&#x27;, &#x27;B&#x27;)</span></span><br><span class="line"><span class="comment"># (&#x27;B&#x27;, &#x27;E&#x27;, &#x27;D&#x27;, &#x27;A&#x27;, &#x27;C&#x27;)</span></span><br><span class="line"><span class="comment"># ......</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 30個城市客戶的路徑</span></span><br><span class="line"><span class="comment"># 假設電腦每秒可計算 10000000000000(10兆) 路徑, 多久可算完</span></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">N2 = <span class="number">30</span></span><br><span class="line">combinations = math.factorial(N2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;combinations = <span class="subst">&#123;combinations&#125;</span>&quot;</span>)</span><br><span class="line">times = <span class="number">10000000000000</span></span><br><span class="line">years = combinations/times/<span class="number">60</span>/<span class="number">60</span>/<span class="number">24</span>/<span class="number">365</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;計算 <span class="subst">&#123;years:<span class="number">.2</span>f&#125;</span> 年&quot;</span>)</span><br><span class="line"><span class="comment"># combinations = 265252859812191058636308480000000</span></span><br><span class="line"><span class="comment"># 計算 841111300774.32 年</span></span><br></pre></td></tr></table></figure>

<h4 id="重複排列"><a href="#重複排列" class="headerlink" title="重複排列"></a>重複排列</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重複排列</span></span><br><span class="line"><span class="comment"># n**r</span></span><br><span class="line"><span class="comment"># 5個數字可重複排列於3個位置 5*5*5=125</span></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line">n = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">A = <span class="built_in">set</span>(itertools.product(n, n , n))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;元素數量 = <span class="subst">&#123;<span class="built_in">len</span>(A)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> A:</span><br><span class="line">    <span class="built_in">print</span>(a)</span><br><span class="line"><span class="comment"># 元素數量 = 125</span></span><br><span class="line"><span class="comment"># (5, 3, 3)</span></span><br><span class="line"><span class="comment"># (5, 4, 2)</span></span><br><span class="line"><span class="comment"># .....</span></span><br></pre></td></tr></table></figure>

<h4 id="組合-combination"><a href="#組合-combination" class="headerlink" title="組合(combination)"></a>組合(combination)</h4><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic18.png" class="" title="pic18">
</div>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 組合(combination) - 從5數字中選出3個數字</span></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line">n = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;</span><br><span class="line">r = <span class="number">3</span></span><br><span class="line">A = <span class="built_in">set</span>(itertools.combinations(n , <span class="number">3</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;組合 = <span class="subst">&#123;<span class="built_in">len</span>(A)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> a <span class="keyword">in</span> A:</span><br><span class="line">    <span class="built_in">print</span>(a)</span><br><span class="line"><span class="comment"># 組合 = 10</span></span><br><span class="line"><span class="comment"># (2, 4, 5)</span></span><br><span class="line"><span class="comment"># (1, 3, 5)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 計算2個骰子有多少組合</span></span><br><span class="line">n2 = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;</span><br><span class="line">A2 = <span class="built_in">set</span>(itertools.combinations(n2 , <span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;骰子組合 = <span class="subst">&#123;<span class="built_in">len</span>(A2)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 骰子組合 = 15</span></span><br></pre></td></tr></table></figure>

<h3 id="機率"><a href="#機率" class="headerlink" title="機率"></a>機率</h3><h4 id="機率基本概念"><a href="#機率基本概念" class="headerlink" title="機率基本概念"></a>機率基本概念</h4><h5 id="計算隨機產生值-並繪出長條圖"><a href="#計算隨機產生值-並繪出長條圖" class="headerlink" title="計算隨機產生值,並繪出長條圖"></a>計算隨機產生值,並繪出長條圖</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 隨機整數函數</span></span><br><span class="line"><span class="comment"># import random</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># min = 1</span></span><br><span class="line"><span class="comment"># max = 6</span></span><br><span class="line"><span class="comment"># target1 = 1</span></span><br><span class="line"><span class="comment"># target2 = 6</span></span><br><span class="line"><span class="comment"># n = 10000</span></span><br><span class="line"><span class="comment"># counter1 = 0</span></span><br><span class="line"><span class="comment"># counter2 = 0</span></span><br><span class="line"><span class="comment"># for i in range(n):</span></span><br><span class="line"><span class="comment">#     once = random.randint(min, max)</span></span><br><span class="line"><span class="comment">#     if once == target1:</span></span><br><span class="line"><span class="comment">#         counter1 += 1</span></span><br><span class="line"><span class="comment">#     if once == target2:</span></span><br><span class="line"><span class="comment">#         counter2 += 1</span></span><br><span class="line"><span class="comment"># print(f&quot;total&#123;n&#125;, target &#123;target1&#125; &#123;counter1&#125; times, 機率&#123;counter1/n&#125;&quot;)</span></span><br><span class="line"><span class="comment"># print(f&quot;total&#123;n&#125;, target &#123;target2&#125; &#123;counter2&#125; times, 機率&#123;counter2/n&#125;&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 計算隨機產生值,並繪出長條圖</span></span><br><span class="line"><span class="comment"># 隨機整數函數</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="built_in">min</span> = <span class="number">1</span></span><br><span class="line"><span class="built_in">max</span> = <span class="number">6</span></span><br><span class="line">n = <span class="number">10000</span></span><br><span class="line">dice = [<span class="number">0</span>] * <span class="number">6</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    data = random.randint(<span class="built_in">min</span>, <span class="built_in">max</span>)</span><br><span class="line">    dice[data-<span class="number">1</span>] += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(dice)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">listx = <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">7</span>)</span><br><span class="line">plt.bar(listx, dice)</span><br><span class="line"></span><br><span class="line">plt.xlabel(<span class="string">&#x27;數字&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;次數&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line"><span class="comment"># show 數值</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(dice)):</span><br><span class="line">    plt.text(i+<span class="number">1</span>, dice[i], <span class="built_in">str</span>(dice[i]), ha=<span class="string">&#x27;center&#x27;</span>, va=<span class="string">&#x27;bottom&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># [1618, 1699, 1674, 1692, 1696, 1621]</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic23.png" class="" title="pic23">
</div>

<h5 id="機率乘法與加法"><a href="#機率乘法與加法" class="headerlink" title="機率乘法與加法"></a>機率乘法與加法</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 機率乘法與加法</span></span><br><span class="line"><span class="comment"># 員工中獎率計算</span></span><br><span class="line"><span class="comment"># 7 支籤,2位中獎可抽獎</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 分數計算</span></span><br><span class="line"><span class="keyword">from</span> fractions <span class="keyword">import</span> Fraction</span><br><span class="line"></span><br><span class="line">x = Fraction(<span class="number">2</span>, <span class="number">7</span>) * Fraction(<span class="number">1</span> ,<span class="number">6</span>)</span><br><span class="line">y = Fraction(<span class="number">5</span>, <span class="number">7</span>) * Fraction(<span class="number">2</span>, <span class="number">6</span>)</span><br><span class="line">p = x + y</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;第一位中獎率 <span class="subst">&#123;Fraction(<span class="number">2</span>, <span class="number">7</span>)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;第二位中獎率 <span class="subst">&#123;p&#125;</span> 轉成浮點數 <span class="subst">&#123;<span class="built_in">float</span>(p)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 第一位中獎率 2/7</span></span><br><span class="line"><span class="comment"># 第二位中獎率 2/7 轉成浮點數 0.2857142857142857</span></span><br></pre></td></tr></table></figure>

<h5 id="餘事件與乘法"><a href="#餘事件與乘法" class="headerlink" title="餘事件與乘法"></a>餘事件與乘法</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 餘事件與乘法</span></span><br><span class="line"><span class="comment"># 丟三次骰子,都不出現5的機率</span></span><br><span class="line"><span class="comment"># 不出現5 : (5/6)*(6/5)*(5/6)</span></span><br><span class="line"><span class="comment"># 所以出現5的機率:1-(5/6)*(6/5)*(5/6)</span></span><br><span class="line"><span class="keyword">from</span> fractions <span class="keyword">import</span> Fraction</span><br><span class="line"></span><br><span class="line">x = Fraction(<span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line">p1 = x**<span class="number">3</span></span><br><span class="line">p2 = <span class="number">1</span> - p1</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;不出現5的機率 <span class="subst">&#123;<span class="built_in">float</span>(p1)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;出現5的機率 <span class="subst">&#123;<span class="built_in">float</span>(p2)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 不出現5的機率 0.5787037037037037</span></span><br><span class="line"><span class="comment"># 出現5的機率 0.4212962962962963</span></span><br></pre></td></tr></table></figure>

<h4 id="條件機率"><a href="#條件機率" class="headerlink" title="條件機率"></a>條件機率</h4><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic19.png" class="" title="pic19">
</div>
<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic20.png" class="" title="pic20">
</div>

<h4 id="貝氏定理"><a href="#貝氏定理" class="headerlink" title="貝氏定理"></a>貝氏定理</h4><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic21.png" class="" title="pic21">
</div>
<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic22.png" class="" title="pic22">
</div>

<h5 id="COVID-19-普篩準確度分析"><a href="#COVID-19-普篩準確度分析" class="headerlink" title="COVID-19 普篩準確度分析"></a>COVID-19 普篩準確度分析</h5><p>$$P(確診|陽性) &#x3D; \frac{P(陽性|確診)⋅P(確診)}{P(陽性)} $$<br><strong>快篩</strong></p>
<ul>
<li>靈敏度（敏感度）：99%（即0.99）</li>
<li>假陽性率：1%（即0.01）</li>
<li>先驗患病率：0.01%（即0.0001）</li>
</ul>
<p><strong>PCR</strong></p>
<ul>
<li>靈敏度（敏感度）：99.99%（即0.9999）</li>
<li>假陽性率：0.01%（即0.0001）</li>
<li>先驗患病率：0.01%（即0.0001）</li>
</ul>
<p><strong>計算快篩陽性確診率</strong><br>P(陽性) &#x3D; 確診＊0.99 + 非確診＊0.01<br>                &#x3D; 0.0001*0.99 + (1-0.0001)<em>0.01<br>                &#x3D; 0.000099 + 0.009999<br>                &#x3D; 0.010098<br>P​(確診|陽性) &#x3D; 0.99</em>0.0001&#x2F;0.010098 &#x3D; 0.0098</p>
<p><strong>計算PCR陽性確診率</strong><br>P(陽性) &#x3D; 確診＊0.9999 + 非確診＊0.0001<br>                &#x3D; 0.0001*0.9999 + (1-0.0001)<em>0.0001<br>                &#x3D; 0.00009999 + 0.00009999<br>                &#x3D; 0.00019998<br>P​(確診|陽性) &#x3D; 0.9999</em>0.0001&#x2F;0.00019998 &#x3D; 0.5</p>
<p><strong>結果</strong></p>
<ul>
<li>快篩陽性結果確診率：約0.98%</li>
<li>PCR陽性結果確診率 ：約50%</li>
</ul>
<p>快篩即使測試具有高靈敏度和特異性，當患病率非常低時，假陽性結果仍會顯著影響快篩測試的後驗概率，而PCR測試在低患病率的情況下能提供更準確的後驗概率。</p>
<h5 id="醫學例子分析"><a href="#醫學例子分析" class="headerlink" title="醫學例子分析"></a>醫學例子分析</h5><p>某疾病測試,對有疾病測出有真陽性為99%,對無疾病測出真陰性為99%,假設在某群體中,有疾病的機率為1%<br>若一個人測出陽性,他有疾病的機率是多少?<br>$$P(病|陽性) &#x3D; \frac{P(陽性|病)⋅P(病)}{P(陽性)} $$<br>P(陽性) &#x3D; 病＊0.99 + 無病＊0.01<br>                &#x3D; 0.01*0.99 + (1-0.01)<em>0.01<br>                &#x3D; 0.0099 + 0.0099<br>                &#x3D; 0.0198<br>P​(病|陽性) &#x3D; 0.99</em>0.01&#x2F;0.0198 &#x3D; 0.5</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">P_A = <span class="number">0.01</span>          <span class="comment">#疾病率</span></span><br><span class="line">P_B_given_A = <span class="number">0.99</span>  <span class="comment">#有疾病準確率</span></span><br><span class="line"><span class="comment"># 陽性機率</span></span><br><span class="line">P_B = <span class="number">0.01</span>*<span class="number">0.99</span> + (<span class="number">1</span> - <span class="number">0.01</span>)*<span class="number">0.01</span></span><br><span class="line"><span class="comment">#陽性有病機率</span></span><br><span class="line">P_A_given_B = P_B_given_A * P_A / P_B</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;陽性有疾病的機率 <span class="subst">&#123;P_A_given_B&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 陽性有疾病的機率 0.5</span></span><br></pre></td></tr></table></figure>

<h5 id="垃圾郵件分類實作"><a href="#垃圾郵件分類實作" class="headerlink" title="垃圾郵件分類實作"></a>垃圾郵件分類實作</h5><p>$$P(spam∣words) &#x3D; \frac{P(words∣spam)⋅P(spam)}{P(words)} $$<br>$$P(ham∣words) &#x3D; \frac{P(words∣ham)⋅P(ham)}{P(words)} $$<br>因為 P(words) 在兩個公式中是相同的，因此可以忽略：<br>這樣，我們只需要比較 P(words∣spam)⋅P(spam) 和 P(words∣ham)⋅P(ham) 的大小即可。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 垃圾郵件分類實作</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 垃圾郵件數據</span></span><br><span class="line">spam_emails = [</span><br><span class="line">    <span class="string">&quot;Get a free gift card now!&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Limited time offer: Claim your prize!&quot;</span>,</span><br><span class="line">    <span class="string">&quot;You have won a free iPhone!&quot;</span></span><br><span class="line">]</span><br><span class="line"><span class="comment"># 非垃圾郵件數據</span></span><br><span class="line">ham_emails = [</span><br><span class="line">    <span class="string">&quot;Meeting rescheduled for tomorrow&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Can we discuss the repoet later?&quot;</span>,</span><br><span class="line">    <span class="string">&quot;Thank you for your prompt reply.&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 單詞計算</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count_words</span>(<span class="params">emails</span>):</span></span><br><span class="line">    word_count= &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> email <span class="keyword">in</span> emails:</span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> email.split():</span><br><span class="line">            word = word.lower()</span><br><span class="line">            <span class="keyword">if</span> word <span class="keyword">not</span> <span class="keyword">in</span> word_count:</span><br><span class="line">                word_count[word] = <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                word_count[word] += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> word_count</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># check email 型別</span></span><br><span class="line"><span class="comment"># 使用 ln(log 底數e)算機率的優點</span></span><br><span class="line"><span class="comment"># 1. 避免數值下溢：當計算多個小機率值的乘積時，避免結果變得極小。</span></span><br><span class="line"><span class="comment"># 2. 計算穩定性：轉換為求和運算使得計算更加穩定。</span></span><br><span class="line"><span class="comment"># 3. 簡化比較：分類時直接比較對數和，比比較原始機率乘積更簡單。</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">classify_email</span>(<span class="params">email</span>):</span></span><br><span class="line">    words = email.lower().split()</span><br><span class="line">    spam_prob = np.log(prior_spam)</span><br><span class="line">    ham_prob = np.log(prior_ham)</span><br><span class="line">    <span class="comment"># print(f&quot;spam_prob=&#123;prior_spam&#125;&#123;spam_prob&#125;&quot;)</span></span><br><span class="line">    <span class="comment"># print(f&quot;ham_prob=&#123;prior_ham&#125;&#123;ham_prob&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> words:</span><br><span class="line">        <span class="comment"># word 存在 get word value, 不存在 get 1/ (total_spam_words+2)</span></span><br><span class="line">        spam_prob += np.log(spam_word_prob.get(word, <span class="number">1</span>/ (total_spam_words+<span class="number">2</span>)))</span><br><span class="line">        ham_prob += np.log(ham_word_prob.get(word, <span class="number">1</span>/ (total_ham_words+<span class="number">2</span>)))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;spam_prob:<span class="subst">&#123;spam_prob&#125;</span> ham_prob:<span class="subst">&#123;ham_prob&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;垃圾郵件&quot;</span> <span class="keyword">if</span> spam_prob &gt; ham_prob <span class="keyword">else</span> <span class="string">&quot;非垃圾郵件&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 計算每個字的機率, +1 避免機率為零的情況, 分母 +2 而不是+1，是為了更好的平滑效果。</span></span><br><span class="line"><span class="comment"># 這樣做的目的是考慮訓練數據中未出現過的單詞。實際上，+2 是一個常見的變種，</span></span><br><span class="line"><span class="comment"># 但你也可以看到其他變種，如+1 或者+V（單詞表的大小）</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">word_probability</span>(<span class="params">word_count, total_count</span>):</span></span><br><span class="line">    <span class="comment"># 使用拉普拉斯平滑</span></span><br><span class="line">    <span class="keyword">return</span> &#123;word:(count+<span class="number">1</span>)/(total_count+<span class="number">2</span>) <span class="keyword">for</span> word, count <span class="keyword">in</span> word_count.items()&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 先驗機率 prior probabilities:無條件下的比例</span></span><br><span class="line"><span class="comment"># 條件機率 conditional probabilities:依條件算出的機率(如單詞)</span></span><br><span class="line">prior_spam = <span class="built_in">len</span>(spam_emails) / (<span class="built_in">len</span>(spam_emails) + <span class="built_in">len</span>(ham_emails))</span><br><span class="line">prior_ham = <span class="built_in">len</span>(ham_emails) / (<span class="built_in">len</span>(spam_emails) + <span class="built_in">len</span>(ham_emails))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;垃圾郵件先驗機率:<span class="subst">&#123;prior_spam&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;正常郵件先驗機率:<span class="subst">&#123;prior_ham&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">70</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 計算單詞</span></span><br><span class="line">spam_word_count = count_words(spam_emails)</span><br><span class="line">ham_word_count  = count_words(ham_emails)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;垃圾郵件單詞:<span class="subst">&#123;spam_word_count&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;正常郵件單詞:<span class="subst">&#123;ham_word_count&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">70</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 計算單詞總數</span></span><br><span class="line">total_spam_words = <span class="built_in">sum</span>(spam_word_count.values())</span><br><span class="line">total_ham_words = <span class="built_in">sum</span>(ham_word_count.values())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;垃圾郵件總單詞:<span class="subst">&#123;total_spam_words&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;正常郵件總單詞:<span class="subst">&#123;total_ham_words&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">70</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 對郵件進行單詞機率計算</span></span><br><span class="line">spam_word_prob = word_probability(spam_word_count, total_spam_words)</span><br><span class="line">ham_word_prob = word_probability(ham_word_count, total_ham_words)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;垃圾郵件字典單詞機率:<span class="subst">&#123;spam_word_prob&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;正常郵件字典單詞機率:<span class="subst">&#123;ham_word_prob&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">70</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 測試分類器</span></span><br><span class="line">test_email = <span class="string">&quot;Claims your free gift now&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;郵件:<span class="subst">&#123;test_email&#125;</span> 分類結果:<span class="subst">&#123;classify_email(test_email)&#125;</span>&quot;</span>)</span><br><span class="line">test_email = <span class="string">&quot;Can we discuss your decision tomorrow&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;郵件:<span class="subst">&#123;test_email&#125;</span> 分類結果:<span class="subst">&#123;classify_email(test_email)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># spam_prob:-13.1869018985419 ham_prob:-14.451858789480825</span></span><br><span class="line"><span class="comment"># 郵件:Claims your free gift now 分類結果:垃圾郵件</span></span><br><span class="line"><span class="comment"># spam_prob:-17.974393641323946 ham_prob:-14.569641825137209</span></span><br><span class="line"><span class="comment"># 郵件:Can we discuss your decision tomorrow 分類結果:非垃圾郵件</span></span><br></pre></td></tr></table></figure>

<h4 id="蒙地卡羅模擬計算PI"><a href="#蒙地卡羅模擬計算PI" class="headerlink" title="蒙地卡羅模擬計算PI"></a>蒙地卡羅模擬計算PI</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 蒙地卡羅模擬計算PI - 𝝿</span></span><br><span class="line"><span class="comment"># 2 * 2 正方形</span></span><br><span class="line"><span class="comment"># 圓面積/矩形面積 = PI / 4</span></span><br><span class="line"><span class="comment"># PI = 4 * hins / 1000000</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">trials = <span class="number">1000000</span></span><br><span class="line">hits = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(trials):</span><br><span class="line">    x = random.random()*<span class="number">2</span> - <span class="number">1</span></span><br><span class="line">    y = random.random()*<span class="number">2</span> - <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> x*x + y*y &lt;= <span class="number">1</span>:</span><br><span class="line">        hits += <span class="number">1</span></span><br><span class="line">PI = <span class="number">4</span> * hits / trials</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;PI=<span class="subst">&#123;PI&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># PI = 3.144032</span></span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 蒙地卡羅模擬計算PI - 𝝿 繪圖</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">trials = <span class="number">5000</span></span><br><span class="line">hits = <span class="number">0</span></span><br><span class="line">radius = <span class="number">50</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(trials) :</span><br><span class="line">    x = random.randint(<span class="number">1</span>, <span class="number">100</span>)</span><br><span class="line">    y = random.randint(<span class="number">1</span>, <span class="number">100</span>)</span><br><span class="line">    <span class="keyword">if</span> math.sqrt((x-<span class="number">50</span>)**<span class="number">2</span> + (y-<span class="number">50</span>)**<span class="number">2</span>) &lt;= radius:</span><br><span class="line">        plt.plot(x, y, <span class="string">&quot;-o&quot;</span>, c=<span class="string">&quot;y&quot;</span>)</span><br><span class="line">        hits += <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        plt.plot(x, y, <span class="string">&quot;-o&quot;</span>, c=<span class="string">&quot;g&quot;</span>)</span><br><span class="line"></span><br><span class="line">PI = <span class="number">4</span> * hits / trials</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;PI=<span class="subst">&#123;PI&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.axis(<span class="string">&#x27;equal&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># PI=3.1272</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic24.png" class="" title="pic24">
</div>

<h3 id="二項式定理"><a href="#二項式定理" class="headerlink" title="二項式定理"></a>二項式定理</h3><p>二項式定理主要是講解二項式次方的展開 $(x+y)^n$</p>
<h4 id="二項式展開與規律性"><a href="#二項式展開與規律性" class="headerlink" title="二項式展開與規律性"></a>二項式展開與規律性</h4><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic25.png" class="" title="pic25">
</div>

<h4 id="找出-x-n-k-y-k-係數"><a href="#找出-x-n-k-y-k-係數" class="headerlink" title="找出 $x^{n-k}y^k$ 係數"></a>找出 $x^{n-k}y^k$ 係數</h4><p>二項式定理如下:<br>$$ (x+y)^n &#x3D;  \sum_{k&#x3D;0}^n\left( ^n_k\right)x^{n-k}y^k $$<br>其中 $\left( ^n_k\right)$是二項式係數,表從n個物品中取出k個的方式數,公式如下<br>$$ \left( ^n_k\right) &#x3D; \frac{n!}{k!(n-k)} $$<br>若推算 $(x+y)^5&#x3D;x^5+5x^4y+10x^3y^2+10x^2y^3+5x^1y^4+y^5$<br>k&#x3D;0 –&gt; $\frac{5!}{0!(5-0)!}&#x3D;\frac{5!}{0!5!}&#x3D;1$<br>k&#x3D;1 –&gt; $\frac{5!}{1!(5-1)!}&#x3D;\frac{5!}{1!4!}&#x3D;5$<br>k&#x3D;2 –&gt; $\frac{5!}{2!(5-2)!}&#x3D;\frac{5!}{2!3!}&#x3D;10$<br>k&#x3D;3 –&gt; $\frac{5!}{3!(5-3)!}&#x3D;\frac{5!}{3!2!}&#x3D;10$<br>k&#x3D;4 –&gt; $\frac{5!}{4!(5-4)!}&#x3D;\frac{5!}{4!1!}&#x3D;5$<br>k&#x3D;5 –&gt; $\frac{5!}{5!(5-5)!}&#x3D;\frac{5!}{5!0!}&#x3D;1$</p>
<h4 id="二項式應用於業務分析"><a href="#二項式應用於業務分析" class="headerlink" title="二項式應用於業務分析"></a>二項式應用於業務分析</h4><p>假設推銷成功率為0.75(所以失敗率為0.25)<br>機率公式如下<br>$ P(x&#x3D;k)&#x3D;\left( ^n_k\right)p^k(1-p)^{n-k}$</p>
<h5 id="5次銷售皆失敗的機率"><a href="#5次銷售皆失敗的機率" class="headerlink" title="5次銷售皆失敗的機率"></a>5次銷售皆失敗的機率</h5><p>x 表成功次數<br>P(x&#x3D;0) &#x3D; 1 - 0.75 &#x3D; 0.25<br>5次銷售皆失敗的機率<br>$ P(x&#x3D;0)&#x3D;(0.25)^5&#x3D;0.0009765625&#x3D;0.09765625\% $</p>
<h5 id="僅1次銷售成功的機率"><a href="#僅1次銷售成功的機率" class="headerlink" title="僅1次銷售成功的機率"></a>僅1次銷售成功的機率</h5><p>$ P(x&#x3D;1)&#x3D;\left( ^5_1\right)(0.75)(0.25)^4&#x3D;5(0.75)(0.25)^4&#x3D;0.0146484375&#x3D;1.46484375\% $</p>
<h5 id="僅2次銷售成功的機率"><a href="#僅2次銷售成功的機率" class="headerlink" title="僅2次銷售成功的機率"></a>僅2次銷售成功的機率</h5><p>$ P(x&#x3D;2)&#x3D;\left( ^5_2\right)(0.75)^2(0.25)^3&#x3D;10(0.75)^2(0.25)^3&#x3D;0.087890625&#x3D;8.7890625\% $</p>
<h4 id="業務分析機率計算集繪製長條圖"><a href="#業務分析機率計算集繪製長條圖" class="headerlink" title="業務分析機率計算集繪製長條圖"></a>業務分析機率計算集繪製長條圖</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 業務分析機率計算集繪製長條圖</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">probability</span>(<span class="params">k</span>):</span></span><br><span class="line">    num = math.factorial(n)/(math.factorial(k)*math.factorial(n-k))</span><br><span class="line">    <span class="keyword">return</span> num*success**(k)*fail**(n-k)</span><br><span class="line"></span><br><span class="line">n = <span class="number">5</span></span><br><span class="line">success = <span class="number">0.75</span></span><br><span class="line"><span class="comment"># 修改次數及成功率</span></span><br><span class="line"><span class="comment"># n = 10</span></span><br><span class="line"><span class="comment"># success = 0.35</span></span><br><span class="line">fail = <span class="number">1</span> - success</span><br><span class="line">p = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n+<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> k == <span class="number">0</span>:</span><br><span class="line">        p.append(fail**n)</span><br><span class="line">    <span class="keyword">elif</span> k == n:</span><br><span class="line">        p.append(success**n)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        p.append(probability(k))</span><br><span class="line"></span><br><span class="line"><span class="comment"># show 機率加總</span></span><br><span class="line"><span class="comment"># total = 0</span></span><br><span class="line"><span class="comment"># for value in p:</span></span><br><span class="line"><span class="comment">#     total += value</span></span><br><span class="line"><span class="comment">#     print(f&quot;&#123;value&#125; &#123;total&#125;&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line">listx = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,n+<span class="number">1</span>) ]</span><br><span class="line">plt.bar(listx, p)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">f&#x27;銷售機率分析n=<span class="subst">&#123;n&#125;</span> 成功率:<span class="subst">&#123;success&#125;</span>&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;銷售成功數&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;機率&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># 0.0009765625 0.0009765625</span></span><br><span class="line"><span class="comment"># 0.0146484375 0.015625</span></span><br><span class="line"><span class="comment"># 0.087890625 0.103515625</span></span><br><span class="line"><span class="comment"># 0.263671875 0.3671875</span></span><br><span class="line"><span class="comment"># 0.3955078125 0.7626953125</span></span><br><span class="line"><span class="comment"># 0.2373046875 1.0</span></span><br><span class="line"><span class="comment"># [0.0009765625, 0.0146484375, 0.087890625, 0.263671875, 0.3955078125, 0.2373046875]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># [0.013462743344628911, 0.0724916949326172, 0.17565295310595708, 0.25221962497265626, 0.2376684927626953, 0.1535704107082031, 0.0689097996767578, 0.02120301528515624, 0.0042813780864257795, 0.0005123016513671872, 2.758547353515623e-05]</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic26.png" class="" title="pic26">
</div>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic27.png" class="" title="pic27">
</div>

<h4 id="使用-numpy-binomial-產生業務分析資料繪圖"><a href="#使用-numpy-binomial-產生業務分析資料繪圖" class="headerlink" title="使用 numpy binomial 產生業務分析資料繪圖"></a>使用 numpy binomial 產生業務分析資料繪圖</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 numpy binomial 產生業務分析資料繪圖</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment"># pip install seaborn</span></span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"></span><br><span class="line">n = <span class="number">5</span></span><br><span class="line">success = <span class="number">0.75</span></span><br><span class="line"><span class="comment"># 修改次數及成功率</span></span><br><span class="line"><span class="comment"># n = 10</span></span><br><span class="line"><span class="comment"># success = 0.35</span></span><br><span class="line"><span class="comment"># numpy.random.binomial 函數用於生成來自二項式分布的隨機樣本</span></span><br><span class="line"><span class="comment"># n 次獨立試驗中，成功 k 次的可能性，每次試驗成功的概率為 𝑝, siz為生成資料數量</span></span><br><span class="line">samples = np.random.binomial(n=n , p=success, size=<span class="number">1000</span>)</span><br><span class="line"><span class="comment"># print(len(samples))</span></span><br><span class="line"><span class="comment"># print(samples)</span></span><br><span class="line"><span class="comment"># kde=True 會劃出核密度估計曲線</span></span><br><span class="line">sns.histplot(samples, kde=<span class="literal">False</span>)</span><br><span class="line">plt.title(<span class="string">f&#x27;銷售機率分析 Binomial =<span class="subst">&#123;n&#125;</span> 成功率:<span class="subst">&#123;success&#125;</span>&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;銷售成功數&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;成功次數&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic28.png" class="" title="pic28">
</div>

<h3 id="指數"><a href="#指數" class="headerlink" title="指數"></a>指數</h3><h4 id="繪製執行時間關係圖-n-x3D-1-5"><a href="#繪製執行時間關係圖-n-x3D-1-5" class="headerlink" title="繪製執行時間關係圖(n&#x3D;1~5)"></a>繪製執行時間關係圖(n&#x3D;1~5)</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 繪製執行時間關係圖(n=1~5)</span></span><br><span class="line"><span class="comment"># O(1), O(logn), O(n), O(nlogn), O(n*n)</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">xpt = np.linspace(<span class="number">1</span>,<span class="number">5</span>,<span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(xpt)</span><br><span class="line">ypt1 = xpt / xpt</span><br><span class="line">ypt2 = np.log2(xpt)</span><br><span class="line">ypt3 = xpt</span><br><span class="line">ypt4 = xpt*np.log2(xpt)</span><br><span class="line">ypt5 = xpt*xpt</span><br><span class="line"><span class="built_in">print</span>(ypt1)</span><br><span class="line"><span class="built_in">print</span>(ypt2)</span><br><span class="line"><span class="built_in">print</span>(ypt3)</span><br><span class="line"><span class="built_in">print</span>(ypt4)</span><br><span class="line"><span class="built_in">print</span>(ypt5)</span><br><span class="line"></span><br><span class="line">plt.plot(xpt, ypt1, <span class="string">&#x27;-o&#x27;</span>, label=<span class="string">&quot;O(1)&quot;</span>)</span><br><span class="line">plt.plot(xpt, ypt2, <span class="string">&#x27;-o&#x27;</span>, label=<span class="string">&quot;O(logn)&quot;</span>)</span><br><span class="line">plt.plot(xpt, ypt3, <span class="string">&#x27;-o&#x27;</span>, label=<span class="string">&quot;O(n)&quot;</span>)</span><br><span class="line">plt.plot(xpt, ypt4, <span class="string">&#x27;-o&#x27;</span>, label=<span class="string">&quot;O(nlogn)&quot;</span>)</span><br><span class="line">plt.plot(xpt, ypt5, <span class="string">&#x27;-o&#x27;</span>, label=<span class="string">&quot;O(n*n)&quot;</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&quot;best&quot;</span>)</span><br><span class="line">plt.axis(<span class="string">&quot;equal&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic29.png" class="" title="pic29">
</div>

<h4 id="繪製-y-x3D-2-x-y-x3D-4-x"><a href="#繪製-y-x3D-2-x-y-x3D-4-x" class="headerlink" title="繪製 $y&#x3D;2^x, y&#x3D;4^x$"></a>繪製 $y&#x3D;2^x, y&#x3D;4^x$</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 繪製 y=2**x, y=4**x</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.linspace(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">30</span>)</span><br><span class="line">y2 = <span class="number">2</span> ** x</span><br><span class="line">y4 = <span class="number">4</span> ** x</span><br><span class="line"></span><br><span class="line">plt.plot(x, y2, label=<span class="string">&quot;2**x&quot;</span>)</span><br><span class="line">plt.plot(x, y4, label=<span class="string">&quot;4**x&quot;</span>)</span><br><span class="line">plt.plot(<span class="number">0</span>, <span class="number">1</span>, <span class="string">&#x27;-o&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.legend(loc=<span class="string">&quot;best&quot;</span>)</span><br><span class="line">plt.axis([-<span class="number">3</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">20</span>])</span><br><span class="line">plt.grid()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic30.png" class="" title="pic30">
</div>

<h4 id="繪製-y-x3D-0-5-x-y-x3D-0-25-x"><a href="#繪製-y-x3D-0-5-x-y-x3D-0-25-x" class="headerlink" title="繪製 $y&#x3D;0.5^x, y&#x3D;0.25^x$"></a>繪製 $y&#x3D;0.5^x, y&#x3D;0.25^x$</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 繪製 y=0.5**x, y=0.25**x(底數小於1)</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.linspace(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">30</span>)</span><br><span class="line">y2 = <span class="number">0.5</span> ** x</span><br><span class="line">y4 = <span class="number">0.25</span> ** x</span><br><span class="line"></span><br><span class="line">plt.plot(x, y2, label=<span class="string">&quot;0.25**x&quot;</span>)</span><br><span class="line">plt.plot(x, y4, label=<span class="string">&quot;0.5**x&quot;</span>)</span><br><span class="line">plt.plot(<span class="number">0</span>, <span class="number">1</span>, <span class="string">&#x27;-o&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.legend(loc=<span class="string">&quot;best&quot;</span>)</span><br><span class="line">plt.axis([-<span class="number">3</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">20</span>])</span><br><span class="line">plt.grid()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic31.png" class="" title="pic31">
</div>

<h3 id="對數"><a href="#對數" class="headerlink" title="對數"></a>對數</h3><h4 id="繪對數-2-及-0-5-的圖形"><a href="#繪對數-2-及-0-5-的圖形" class="headerlink" title="繪對數 2 及 0.5 的圖形"></a>繪對數 2 及 0.5 的圖形</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 繪對數 2 及 0.5 的圖形</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">x1 = np.linspace(<span class="number">0.1</span>, <span class="number">10</span>, <span class="number">90</span>)</span><br><span class="line">y1 = [math.log2(x) <span class="keyword">for</span> x <span class="keyword">in</span> x1 ]</span><br><span class="line">y2 = [math.log(x, <span class="number">0.5</span>) <span class="keyword">for</span> x <span class="keyword">in</span> x1 ]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(y1)</span><br><span class="line"><span class="built_in">print</span>(y2)</span><br><span class="line">plt.plot(x1, y1, label=<span class="string">&quot;base=2&quot;</span>)</span><br><span class="line">plt.plot(x1, y2, label=<span class="string">&quot;base=0.5&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.legend(loc=<span class="string">&quot;best&quot;</span>)</span><br><span class="line"><span class="comment"># plt.axis([-3, 3, 0, 20])</span></span><br><span class="line">plt.grid()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic32.png" class="" title="pic32">
</div>

<h3 id="歐拉數與邏輯函數"><a href="#歐拉數與邏輯函數" class="headerlink" title="歐拉數與邏輯函數"></a>歐拉數與邏輯函數</h3><h4 id="歐拉數-Euler’s-Number"><a href="#歐拉數-Euler’s-Number" class="headerlink" title="歐拉數-Euler’s Number"></a>歐拉數-Euler’s Number</h4><p>$$ 歐拉數 e &#x3D; \lim_{n \to \infty}\left( 1+\frac{1}{n} \right)^n \approx 2.718281778… $$</p>
<h5 id="繪製歐拉數圖形"><a href="#繪製歐拉數圖形" class="headerlink" title="繪製歐拉數圖形"></a>繪製歐拉數圖形</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 繪製歐拉數圖形</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.linspace(<span class="number">0.1</span>, <span class="number">1000</span>, <span class="number">100000</span>)</span><br><span class="line">y = [(<span class="number">1</span>+<span class="number">1</span>/x)**x <span class="keyword">for</span> x <span class="keyword">in</span> x]</span><br><span class="line">plt.plot(x, y, label=<span class="string">&quot;Euler&#x27;s Number&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.legend(loc=<span class="string">&quot;best&quot;</span>)</span><br><span class="line">plt.grid()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic33.png" class="" title="pic33">
</div>

<h4 id="邏輯函數-logistic-function"><a href="#邏輯函數-logistic-function" class="headerlink" title="邏輯函數(logistic function)"></a>邏輯函數(logistic function)</h4><p>邏輯函數是一種常見的S(Sigmoid)函數值介於0~1之間,簡單邏輯函數定義如下<br>$ y &#x3D; f(x) &#x3D; \frac{1}{1+e^{-x}} $</p>
<h5 id="繪製邏輯函數"><a href="#繪製邏輯函數" class="headerlink" title="繪製邏輯函數"></a>繪製邏輯函數</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.linspace(-<span class="number">5</span>, <span class="number">5</span>, <span class="number">10000</span>)</span><br><span class="line">y = [<span class="number">1</span>/(<span class="number">1</span>+np.e**-x) <span class="keyword">for</span> x <span class="keyword">in</span> x]</span><br><span class="line">plt.plot(x, y, label=<span class="string">&quot;Logistic function&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.axis([-<span class="number">5</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line">plt.legend()</span><br><span class="line">plt.grid()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic34.png" class="" title="pic34">
</div>

<h5 id="Sigmoid-函數"><a href="#Sigmoid-函數" class="headerlink" title="Sigmoid 函數"></a>Sigmoid 函數</h5><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic35.png" class="" title="pic35">
</div>

<h4 id="logit-函數"><a href="#logit-函數" class="headerlink" title="logit 函數"></a>logit 函數</h4><p>logit是logistic的反函數,它將(0,1)區間數值轉為實數全域,讓我們可以將機率數值轉成實數,進行數學操作</p>
<h5 id="Odds"><a href="#Odds" class="headerlink" title="Odds"></a>Odds</h5><p>Odds可翻譯為勝率,優勢比或賠率<br>骰子投出6的機率 $ P &#x3D; \frac{1}{6} % $<br>骰子投出6的 $ Odds &#x3D; \frac{P}{1-P} &#x3D;  \frac{\frac{1}{6}}{\frac{5}{6}} &#x3D; \frac{1}{5} $</p>
<h5 id="Odds-到-logit"><a href="#Odds-到-logit" class="headerlink" title="Odds 到 logit"></a>Odds 到 logit</h5><p>logit 就是 log of Odds(log 底數為 e)<br>$logit &#x3D; log(Odds) &#x3D; log(\frac{P}{1-P}) &#x3D; ln(\frac{P}{1-P})$<br>logit 也常被稱為 對數勝率(log odds)<br>若發生率為 0.7, $logist(0.7) &#x3D; ln(\frac{0.7}{1-0.7})$</p>
<h5 id="繪製-logit-函數"><a href="#繪製-logit-函數" class="headerlink" title="繪製 logit 函數"></a>繪製 logit 函數</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 繪製 0.1 ~ 9.99 的 logit 函數</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.linspace(<span class="number">0.01</span>, <span class="number">0.99</span>, <span class="number">100</span>)</span><br><span class="line">y = [np.log(x/(<span class="number">1</span>-x)) <span class="keyword">for</span> x <span class="keyword">in</span> x]</span><br><span class="line">plt.plot(x, y, label=<span class="string">&quot;logit function&quot;</span>)</span><br><span class="line">plt.plot(<span class="number">0.5</span>, np.log(<span class="number">0.5</span>/(<span class="number">1</span>-<span class="number">0.5</span>)), <span class="string">&quot;-o&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(np.log(<span class="number">0.5</span>/(<span class="number">1</span>-<span class="number">0.5</span>)))</span><br><span class="line"></span><br><span class="line">plt.axis([<span class="number">0</span>, <span class="number">1</span>, -<span class="number">5</span>, <span class="number">5</span>])</span><br><span class="line">plt.legend()</span><br><span class="line">plt.grid()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic36.png" class="" title="pic36">
</div>

<h5 id="推算出錯率與回購率的關係"><a href="#推算出錯率與回購率的關係" class="headerlink" title="推算出錯率與回購率的關係"></a>推算出錯率與回購率的關係</h5><p>無出錯回購率40%<br>1次出錯回購率15%<br>求2次出錯回購率?</p>
<p><strong>無出錯賠率和對數賠率</strong><br>P(x&#x3D;0) &#x3D; 0.4<br>Odds(x&#x3D;0)&#x3D; 0.4&#x2F;(1-0.4) &#x3D; 0.666..<br>logist(x&#x3D;0) &#x3D; ln(0.4&#x2F;(1-0.4)) &#x3D; -0.405..</p>
<p><strong>1次錯賠率和對數賠率</strong><br>P(x&#x3D;1) &#x3D; 0.15<br>Odds(x&#x3D;1)&#x3D; 0.15&#x2F;(1-0.15) &#x3D; 0.176..<br>logist(x&#x3D;1) &#x3D; ln(0.15&#x2F;(1-0.15)) &#x3D; -1.734..</p>
<p><strong>logist模型設定</strong><br>假設對數賠率與錯誤次數有關 Log Odds &#x3D; ax + b<br>x&#x3D;0<br>b &#x3D; -0.405<br>x&#x3D;1<br>a + b &#x3D; -1.734  –&gt; a &#x3D; -1.329<br>所以模型是<br>Log Odds &#x3D; -1.329x - 0.405</p>
<p><strong>預測2次錯回購率</strong><br><em><strong>計算對數賠率</strong></em><br>logist(x&#x3D;2) &#x3D; -1.329*2 - 0.405 &#x3D; -3.063<br><em><strong>轉換為賠率</strong></em><br>$ Odds(x&#x3D;2)&#x3D; e^-3.063 &#x3D; 0.046$<br><em><strong>轉換為回購率</strong></em><br>$ \frac{P}{1-P}&#x3D;0.046 $<br>P &#x3D; 0.046 - 0.046P<br>$ P &#x3D; \frac{0.046}{1+0.046} &#x3D; 0.044 &#x3D; 4.4\% $ </p>
<h3 id="三角函數"><a href="#三角函數" class="headerlink" title="三角函數"></a>三角函數</h3><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic37.png" class="" title="pic37">
</div>

<h4 id="角度弧度的換算"><a href="#角度弧度的換算" class="headerlink" title="角度弧度的換算"></a>角度弧度的換算</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 角度弧度的換算</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">degrees = [<span class="number">30</span>, <span class="number">45</span>, <span class="number">60</span>, <span class="number">90</span>, <span class="number">120</span>, <span class="number">135</span>, <span class="number">150</span>, <span class="number">180</span>]</span><br><span class="line"><span class="keyword">for</span> degree <span class="keyword">in</span> degrees:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;角度=<span class="subst">&#123;degree&#125;</span> 弧度=<span class="subst">&#123;np.pi*degree/<span class="number">180</span>:<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 角度=30 弧度=0.524</span></span><br><span class="line"><span class="comment"># 角度=45 弧度=0.785</span></span><br><span class="line"><span class="comment"># 角度=60 弧度=1.047</span></span><br><span class="line"><span class="comment"># 角度=90 弧度=1.571</span></span><br><span class="line"><span class="comment"># 角度=120 弧度=2.094</span></span><br><span class="line"><span class="comment"># 角度=135 弧度=2.356</span></span><br><span class="line"><span class="comment"># 角度=150 弧度=2.618</span></span><br><span class="line"><span class="comment"># 角度=180 弧度=3.142</span></span><br></pre></td></tr></table></figure>

<h4 id="計算弧長"><a href="#計算弧長" class="headerlink" title="計算弧長"></a>計算弧長</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 計算弧長</span></span><br><span class="line"><span class="comment"># 弧度 = 2𝝿r * degree/360</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">r = <span class="number">10</span></span><br><span class="line">degrees = [<span class="number">30</span>, <span class="number">60</span>, <span class="number">90</span>, <span class="number">120</span>]</span><br><span class="line"><span class="keyword">for</span> degree <span class="keyword">in</span> degrees:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;角度=<span class="subst">&#123;degree:3d&#125;</span> 弧長=<span class="subst">&#123;<span class="number">2</span>*np.pi*r*degree/<span class="number">360</span>:<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 角度= 30 弧長=5.236</span></span><br><span class="line"><span class="comment"># 角度= 60 弧長=10.472</span></span><br><span class="line"><span class="comment"># 角度= 90 弧長=15.708</span></span><br><span class="line"><span class="comment"># 角度=120 弧長=20.944</span></span><br></pre></td></tr></table></figure>

<h4 id="計算sin-cos"><a href="#計算sin-cos" class="headerlink" title="計算sin(), cos()"></a>計算sin(), cos()</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 計算sin(), cos()</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">degrees = [x*<span class="number">30</span> <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">13</span>)]</span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> degrees:</span><br><span class="line">    rad = np.radians(d)</span><br><span class="line">    sin = np.sin(rad)</span><br><span class="line">    cos = np.cos(rad)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;度數:<span class="subst">&#123;d:3d&#125;</span>\t弧度:<span class="subst">&#123;rad:<span class="number">3.2</span>f&#125;</span>\tsin<span class="subst">&#123;d:3d&#125;</span>=<span class="subst">&#123;sin:<span class="number">3.2</span>f&#125;</span> cos<span class="subst">&#123;d:3d&#125;</span>=<span class="subst">&#123;cos:<span class="number">3.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 度數:  0        弧度:0.00       sin  0=0.00 cos  0=1.00</span></span><br><span class="line"><span class="comment"># 度數: 30        弧度:0.52       sin 30=0.50 cos 30=0.87</span></span><br><span class="line"><span class="comment"># 度數: 60        弧度:1.05       sin 60=0.87 cos 60=0.50</span></span><br><span class="line"><span class="comment"># 度數: 90        弧度:1.57       sin 90=1.00 cos 90=0.00</span></span><br><span class="line"><span class="comment"># 度數:120        弧度:2.09       sin120=0.87 cos120=-0.50</span></span><br><span class="line"><span class="comment"># 度數:150        弧度:2.62       sin150=0.50 cos150=-0.87</span></span><br><span class="line"><span class="comment"># 度數:180        弧度:3.14       sin180=0.00 cos180=-1.00</span></span><br><span class="line"><span class="comment"># 度數:210        弧度:3.67       sin210=-0.50 cos210=-0.87</span></span><br><span class="line"><span class="comment"># 度數:240        弧度:4.19       sin240=-0.87 cos240=-0.50</span></span><br><span class="line"><span class="comment"># 度數:270        弧度:4.71       sin270=-1.00 cos270=-0.00</span></span><br><span class="line"><span class="comment"># 度數:300        弧度:5.24       sin300=-0.87 cos300=0.50</span></span><br><span class="line"><span class="comment"># 度數:330        弧度:5.76       sin330=-0.50 cos330=0.87</span></span><br><span class="line"><span class="comment"># 度數:360        弧度:6.28       sin360=-0.00 cos360=1.00</span></span><br></pre></td></tr></table></figure>

<h4 id="角度繪圓"><a href="#角度繪圓" class="headerlink" title="角度繪圓"></a>角度繪圓</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 角度繪圓</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># import numpy as np</span></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">degrees = [x*<span class="number">15</span> <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">25</span>)]</span><br><span class="line">x = [math.cos(math.radians(d)) <span class="keyword">for</span> d <span class="keyword">in</span> degrees]</span><br><span class="line">y = [math.sin(math.radians(d)) <span class="keyword">for</span> d <span class="keyword">in</span> degrees]</span><br><span class="line"></span><br><span class="line">plt.scatter(x, y)</span><br><span class="line">plt.plot(x,y)</span><br><span class="line">plt.axis(<span class="string">&quot;equal&quot;</span>)</span><br><span class="line">plt.grid()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic38.png" class="" title="pic38">
</div>

<h4 id="產生一年的-sin-cos-值"><a href="#產生一年的-sin-cos-值" class="headerlink" title="產生一年的 sin, cos 值"></a>產生一年的 sin, cos 值</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 產生一年的 sin, cos 值</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">dates = pd.date_range(start=<span class="string">&quot;2023-01-01&quot;</span>, end=<span class="string">&quot;2023-12-31&quot;</span>)</span><br><span class="line">df = pd.DataFrame(data=&#123;<span class="string">&#x27;date&#x27;</span>:dates&#125;)</span><br><span class="line">df[<span class="string">&#x27;day_of_year&#x27;</span>] = df[<span class="string">&#x27;date&#x27;</span>].dt.day_of_year</span><br><span class="line">df[<span class="string">&quot;sin_day_of_year&quot;</span>] = np.sin(<span class="number">2</span>*np.pi*df[<span class="string">&quot;day_of_year&quot;</span>]/<span class="number">365</span>)</span><br><span class="line">df[<span class="string">&quot;cos_day_of_year&quot;</span>] = np.cos(<span class="number">2</span>*np.pi*df[<span class="string">&quot;day_of_year&quot;</span>]/<span class="number">365</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="comment">#           date  day_of_year  sin_day_of_year  cos_day_of_year</span></span><br><span class="line"><span class="comment"># 0   2023-01-01            1     1.721336e-02         0.999852</span></span><br><span class="line"><span class="comment"># 1   2023-01-02            2     3.442161e-02         0.999407</span></span><br><span class="line"><span class="comment"># 2   2023-01-03            3     5.161967e-02         0.998667</span></span><br><span class="line"><span class="comment"># 3   2023-01-04            4     6.880243e-02         0.997630</span></span><br><span class="line"><span class="comment"># 4   2023-01-05            5     8.596480e-02         0.996298</span></span><br><span class="line"><span class="comment"># ..         ...          ...              ...              ...</span></span><br><span class="line"><span class="comment"># 360 2023-12-27          361    -6.880243e-02         0.997630</span></span><br><span class="line"><span class="comment"># 361 2023-12-28          362    -5.161967e-02         0.998667</span></span><br><span class="line"><span class="comment"># 362 2023-12-29          363    -3.442161e-02         0.999407</span></span><br><span class="line"><span class="comment"># 363 2023-12-30          364    -1.721336e-02         0.999852</span></span><br><span class="line"><span class="comment"># 364 2023-12-31          365     6.432491e-16         1.000000</span></span><br></pre></td></tr></table></figure>

<h3 id="基礎統計與大型運算子"><a href="#基礎統計與大型運算子" class="headerlink" title="基礎統計與大型運算子"></a>基礎統計與大型運算子</h3><h4 id="數據中心指標"><a href="#數據中心指標" class="headerlink" title="數據中心指標"></a>數據中心指標</h4><p>平均數(mean)<br>中位數(median):若中間有兩個數值則取平均值<br>眾數(mode):數據中出現次數最高次數的數字</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> statistics <span class="keyword">as</span> st</span><br><span class="line"></span><br><span class="line">x = [<span class="number">66</span>, <span class="number">57</span>, <span class="number">25</span>, <span class="number">80</span>, <span class="number">60</span>, <span class="number">15</span>, <span class="number">120</span>, <span class="number">39</span>, <span class="number">80</span>, <span class="number">50</span>]</span><br><span class="line">x2 = [<span class="number">66</span>, <span class="number">57</span>, <span class="number">25</span>, <span class="number">80</span>, <span class="number">60</span>, <span class="number">15</span>, <span class="number">120</span>, <span class="number">39</span>, <span class="number">80</span>, <span class="number">50</span>, <span class="number">77</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;加總: <span class="subst">&#123;<span class="built_in">sum</span>(x)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;平均數: <span class="subst">&#123;<span class="built_in">sum</span>(x)/<span class="built_in">len</span>(x)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;平均數2: <span class="subst">&#123;np.mean(x)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 中位數</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;中位數: <span class="subst">&#123;np.median(x)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;中位數2: <span class="subst">&#123;np.median(x2)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># bincount 傳回 array lenth 為最大值 +1</span></span><br><span class="line"><span class="comment"># x 陣列必需為正整數陣列, 傳回 array 為 0 ~ max 數字數量</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;x bincount : <span class="subst">&#123;<span class="built_in">len</span>(np.bincount(x))&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;x2 bincount : <span class="subst">&#123;<span class="built_in">len</span>(np.bincount(x2))&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># argmax 傳回最大值索引</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;x argmax : <span class="subst">&#123;np.argmax(x)&#125;</span> <span class="subst">&#123;x[np.argmax(x)]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;x2 argmax : <span class="subst">&#123;np.argmax(x2)&#125;</span> <span class="subst">&#123;x2[np.argmax(x)]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># argmin 傳回最小值索引</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;x argmin : <span class="subst">&#123;np.argmin(x)&#125;</span> <span class="subst">&#123;x[np.argmin(x)]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;x2 argmin : <span class="subst">&#123;np.argmin(x2)&#125;</span> <span class="subst">&#123;x2[np.argmin(x)]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 眾數(mode):出現最高次數的數字</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;x mode:<span class="subst">&#123;st.mode(x)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加總: 592</span></span><br><span class="line"><span class="comment"># 平均數: 59.2</span></span><br><span class="line"><span class="comment"># 平均數2: 59.2</span></span><br><span class="line"><span class="comment"># 中位數: 58.5</span></span><br><span class="line"><span class="comment"># 中位數2: 60.0</span></span><br><span class="line"><span class="comment"># x bincount : 121</span></span><br><span class="line"><span class="comment"># x2 bincount : 121</span></span><br><span class="line"><span class="comment"># x argmax : 6 120</span></span><br><span class="line"><span class="comment"># x2 argmax : 6 120</span></span><br><span class="line"><span class="comment"># x argmax : 5 15</span></span><br><span class="line"><span class="comment"># x2 argmax : 5 15</span></span><br><span class="line"><span class="comment"># x mode:80</span></span><br></pre></td></tr></table></figure>

<h4 id="繪製成績分布圖"><a href="#繪製成績分布圖" class="headerlink" title="繪製成績分布圖"></a>繪製成績分布圖</h4><h5 id="繪製成績長條圖"><a href="#繪製成績長條圖" class="headerlink" title="繪製成績長條圖"></a>繪製成績長條圖</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 繪製成績長條圖</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> statistics <span class="keyword">as</span> st</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"></span><br><span class="line">sc = [<span class="number">60</span>,<span class="number">10</span>,<span class="number">40</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">30</span>,<span class="number">80</span>,<span class="number">60</span>,<span class="number">70</span>,<span class="number">90</span>,<span class="number">50</span>,<span class="number">50</span>,<span class="number">50</span>,<span class="number">70</span>,<span class="number">60</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">50</span>,<span class="number">60</span>,<span class="number">70</span>,</span><br><span class="line">      <span class="number">70</span>,<span class="number">40</span>,<span class="number">30</span>,<span class="number">70</span>,<span class="number">60</span>,<span class="number">80</span>,<span class="number">20</span>,<span class="number">80</span>,<span class="number">70</span>,<span class="number">50</span>,<span class="number">90</span>,<span class="number">80</span>,<span class="number">40</span>,<span class="number">40</span>,<span class="number">70</span>,<span class="number">60</span>,<span class="number">80</span>,<span class="number">30</span>,<span class="number">20</span>,<span class="number">70</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;平均成績 = <span class="subst">&#123;np.mean(sc)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;中位數成績 = <span class="subst">&#123;np.median(sc)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;眾數成績 = <span class="subst">&#123;st.mode(sc)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">hist = [<span class="number">0</span>] * <span class="number">9</span></span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> sc :</span><br><span class="line">    n = <span class="built_in">int</span>(s/<span class="number">10</span>) - <span class="number">1</span></span><br><span class="line">    hist[n] += <span class="number">1</span></span><br><span class="line"><span class="comment"># print(hist)</span></span><br><span class="line"></span><br><span class="line">x = np.arange(<span class="built_in">len</span>(hist))</span><br><span class="line">plt.bar(x, hist, width=<span class="number">0.5</span> )</span><br><span class="line"></span><br><span class="line">plt.xticks(x, (<span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">40</span>,<span class="number">50</span>,<span class="number">60</span>,<span class="number">70</span>,<span class="number">80</span>,<span class="number">90</span>))</span><br><span class="line">plt.title(<span class="string">&quot;成績表&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;分數&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;學生人數&quot;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># 平均成績 = 59.25</span></span><br><span class="line"><span class="comment"># 中位數成績 = 60.0</span></span><br><span class="line"><span class="comment"># 眾數成績 = 80</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic39.png" class="" title="pic39">
</div>

<h5 id="繪製成績直方圖"><a href="#繪製成績直方圖" class="headerlink" title="繪製成績直方圖"></a>繪製成績直方圖</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 繪製成績直方圖</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> statistics <span class="keyword">as</span> st</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"></span><br><span class="line">sc = [<span class="number">60</span>,<span class="number">10</span>,<span class="number">40</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">30</span>,<span class="number">80</span>,<span class="number">60</span>,<span class="number">70</span>,<span class="number">90</span>,<span class="number">50</span>,<span class="number">50</span>,<span class="number">50</span>,<span class="number">70</span>,<span class="number">60</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">50</span>,<span class="number">60</span>,<span class="number">70</span>,</span><br><span class="line">      <span class="number">70</span>,<span class="number">40</span>,<span class="number">30</span>,<span class="number">70</span>,<span class="number">60</span>,<span class="number">80</span>,<span class="number">20</span>,<span class="number">80</span>,<span class="number">70</span>,<span class="number">50</span>,<span class="number">90</span>,<span class="number">80</span>,<span class="number">40</span>,<span class="number">40</span>,<span class="number">70</span>,<span class="number">60</span>,<span class="number">80</span>,<span class="number">30</span>,<span class="number">20</span>,<span class="number">70</span>]</span><br><span class="line"></span><br><span class="line">plt.hist(sc, <span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">&quot;成績表&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;分數&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;學生人數&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic40.png" class="" title="pic40">
</div>

<h5 id="繪製成績直方圖-兩個成績"><a href="#繪製成績直方圖-兩個成績" class="headerlink" title="繪製成績直方圖(兩個成績)"></a>繪製成績直方圖(兩個成績)</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 繪製成績直方圖(兩個成績)</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> statistics <span class="keyword">as</span> st</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"></span><br><span class="line">sc1 = [<span class="number">60</span>,<span class="number">10</span>,<span class="number">40</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">30</span>,<span class="number">80</span>,<span class="number">60</span>,<span class="number">70</span>,<span class="number">90</span>,<span class="number">50</span>,<span class="number">50</span>,<span class="number">50</span>,<span class="number">70</span>,<span class="number">60</span>,<span class="number">80</span>,<span class="number">80</span>,<span class="number">50</span>,<span class="number">60</span>,<span class="number">70</span>,</span><br><span class="line">      <span class="number">70</span>,<span class="number">40</span>,<span class="number">30</span>,<span class="number">70</span>,<span class="number">60</span>,<span class="number">80</span>,<span class="number">20</span>,<span class="number">80</span>,<span class="number">70</span>,<span class="number">50</span>,<span class="number">90</span>,<span class="number">80</span>,<span class="number">40</span>,<span class="number">40</span>,<span class="number">70</span>,<span class="number">60</span>,<span class="number">80</span>,<span class="number">30</span>,<span class="number">20</span>,<span class="number">70</span>]</span><br><span class="line">sc2 = [<span class="number">50</span>,<span class="number">10</span>,<span class="number">60</span>,<span class="number">80</span>,<span class="number">70</span>,<span class="number">30</span>,<span class="number">80</span>,<span class="number">60</span>,<span class="number">30</span>,<span class="number">90</span>,<span class="number">50</span>,<span class="number">50</span>,<span class="number">50</span>,<span class="number">90</span>,<span class="number">70</span>,<span class="number">60</span>,<span class="number">50</span>,<span class="number">80</span>,<span class="number">50</span>,<span class="number">70</span>,</span><br><span class="line">      <span class="number">60</span>,<span class="number">50</span>,<span class="number">30</span>,<span class="number">70</span>,<span class="number">70</span>,<span class="number">80</span>,<span class="number">10</span>,<span class="number">80</span>,<span class="number">70</span>,<span class="number">50</span>,<span class="number">90</span>,<span class="number">80</span>,<span class="number">40</span>,<span class="number">50</span>,<span class="number">70</span>,<span class="number">60</span>,<span class="number">80</span>,<span class="number">40</span>,<span class="number">20</span>,<span class="number">70</span>]</span><br><span class="line"></span><br><span class="line">plt.hist([sc1, sc2], <span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">&quot;成績表&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;分數&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;學生人數&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic41.png" class="" title="pic41">
</div>

<h4 id="數據分散指標"><a href="#數據分散指標" class="headerlink" title="數據分散指標"></a>數據分散指標</h4><h5 id="變異數"><a href="#變異數" class="headerlink" title="變異數"></a>變異數</h5><p><strong>母體變異數</strong><br>$$ 變異數 &#x3D; \frac{1}{n}\sum_{i&#x3D;1}^{n}(x_i-\overline{x})^2$$<br><strong>樣本變異數</strong><br>樣本變異數除以(n-1)作為母體變異數的不偏愛(unbiased)估計量<br>$$ 樣本變異數 &#x3D; \frac{1}{n-1}\sum_{i&#x3D;1}^{n}(x_i-\overline{x})^2$$<br><strong>變異數公式</strong></p>
<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic42.png" class="" title="pic42">
</div>

<p><strong>計算銷售數據變異數</strong></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> statistics <span class="keyword">as</span> st</span><br><span class="line">x = [<span class="number">66</span>, <span class="number">58</span>, <span class="number">25</span>, <span class="number">78</span>, <span class="number">58</span>, <span class="number">15</span>, <span class="number">120</span>, <span class="number">39</span>, <span class="number">82</span>, <span class="number">50</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Numpy 母體變異數     : <span class="subst">&#123;np.var(x):<span class="number">6.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Numpy 樣本變異數     : <span class="subst">&#123;np.var(x, ddof=<span class="number">1</span>):<span class="number">6.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Statistics 母體變異數: <span class="subst">&#123;st.pvariance(x):<span class="number">6.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Statistics 樣本變異數: <span class="subst">&#123;st.variance(x):<span class="number">6.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># Numpy 母體變異數     : 823.49</span></span><br><span class="line"><span class="comment"># Numpy 樣本變異數     : 914.99</span></span><br><span class="line"><span class="comment"># Statistics 母體變異數: 823.49</span></span><br><span class="line"><span class="comment"># Statistics 樣本變異數: 914.99</span></span><br></pre></td></tr></table></figure>

<h5 id="標準差-Standard-Deviation-SD"><a href="#標準差-Standard-Deviation-SD" class="headerlink" title="標準差(Standard Deviation-SD)"></a>標準差(Standard Deviation-SD)</h5><p>變異數開根號就是標準差<br><strong>母體標準差</strong><br>$$ *母體標準差 &#x3D; \sqrt{\frac{1}{N}\sum_{i&#x3D;1}^{N}(x_i-\overline{x})^2}$$<br><strong>樣本標準差</strong><br>$$ 樣本標準差 &#x3D; \sqrt{\frac{1}{n-1}\sum_{i&#x3D;1}^{n}(x_i-\overline{x})^2}$$<br><strong>標準差公式</strong></p>
<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic43.png" class="" title="pic43">
</div>

<p><strong>計算銷售數據標準差</strong></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> statistics <span class="keyword">as</span> st</span><br><span class="line">x = [<span class="number">66</span>, <span class="number">58</span>, <span class="number">25</span>, <span class="number">78</span>, <span class="number">58</span>, <span class="number">15</span>, <span class="number">120</span>, <span class="number">39</span>, <span class="number">82</span>, <span class="number">50</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Numpy 母體標準差     : <span class="subst">&#123;np.std(x):<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Numpy 樣本標準差     : <span class="subst">&#123;np.std(x, ddof=<span class="number">1</span>):<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Statistics 母體標準差: <span class="subst">&#123;st.pstdev(x):<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Statistics 樣本標準差: <span class="subst">&#123;st.stdev(x):<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># Numpy 母體標準差     : 28.70</span></span><br><span class="line"><span class="comment"># Numpy 樣本標準差     : 30.25</span></span><br><span class="line"><span class="comment"># Statistics 母體標準差: 28.70</span></span><br><span class="line"><span class="comment"># Statistics 樣本標準差: 30.25</span></span><br></pre></td></tr></table></figure>

<h4 id="迴歸分析"><a href="#迴歸分析" class="headerlink" title="迴歸分析"></a>迴歸分析</h4><h5 id="相關係數-Correlation-Coefficient"><a href="#相關係數-Correlation-Coefficient" class="headerlink" title="相關係數(Correlation Coefficient)"></a>相關係數(Correlation Coefficient)</h5><p>相關係數絕對值小於0.3表低度相關,介於0.3和0.7表中度相關,大於0.7表高度相關</p>
<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic44.png" class="" title="pic44">
</div>

<p>$$ r &#x3D; \frac{	\sum_{i&#x3D;1}^{n}(x_i-\overline{x})(y_y-\overline{x})}{\sqrt{\sum_{i&#x3D;1}^{n}(x_i-\overline{x})^2}\sqrt{\sum_{i&#x3D;1}^{n}(y_i-\overline{y})^2}} $$</p>
<p><strong>天氣溫度與冰品營業額新關係數計算</strong></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 天氣溫度</span></span><br><span class="line">temperature = [<span class="number">25</span>,<span class="number">31</span>,<span class="number">28</span>,<span class="number">22</span>,<span class="number">27</span>,<span class="number">30</span>,<span class="number">29</span>,<span class="number">33</span>,<span class="number">32</span>,<span class="number">26</span>]</span><br><span class="line"><span class="comment"># 營業額</span></span><br><span class="line">rev = [<span class="number">900</span>,<span class="number">1200</span>,<span class="number">950</span>,<span class="number">600</span>,<span class="number">720</span>,<span class="number">1000</span>,<span class="number">1020</span>,<span class="number">1500</span>,<span class="number">1420</span>,<span class="number">1100</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;相關係數 = <span class="subst">&#123;np.corrcoef(temperature, rev).<span class="built_in">round</span>(<span class="number">2</span>)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 相關係數 = [[1.   0.87]</span></span><br><span class="line"><span class="comment">#  [0.87 1.  ]]</span></span><br><span class="line"></span><br><span class="line">plt.scatter(temperature, rev)</span><br><span class="line">plt.title(<span class="string">&quot;天氣溫度與冰品銷售&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;溫度&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;營業額&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic45.png" class="" title="pic45">
</div>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic46.png" class="" title="pic46">
</div>

<h5 id="建立線性回歸模型與數據預測"><a href="#建立線性回歸模型與數據預測" class="headerlink" title="建立線性回歸模型與數據預測"></a>建立線性回歸模型與數據預測</h5><p><strong>建立迴歸模型係數</strong><br>coef &#x3D; np.polyfit(temperature, rev, 1)<br><strong>建立迴歸直線函數</strong><br>reg &#x3D; np.poly1d(coef)</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 天氣溫度</span></span><br><span class="line">temperature = [<span class="number">25</span>,<span class="number">31</span>,<span class="number">28</span>,<span class="number">22</span>,<span class="number">27</span>,<span class="number">30</span>,<span class="number">29</span>,<span class="number">33</span>,<span class="number">32</span>,<span class="number">26</span>]</span><br><span class="line"><span class="comment"># 營業額</span></span><br><span class="line">rev = [<span class="number">900</span>,<span class="number">1200</span>,<span class="number">950</span>,<span class="number">600</span>,<span class="number">720</span>,<span class="number">1000</span>,<span class="number">1020</span>,<span class="number">1500</span>,<span class="number">1420</span>,<span class="number">1100</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立迴歸模型係數</span></span><br><span class="line">coef = np.polyfit(temperature, rev, <span class="number">1</span>)</span><br><span class="line"><span class="comment"># 建立迴歸直線函數</span></span><br><span class="line">reg = np.poly1d(coef)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(coef.<span class="built_in">round</span>(<span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(reg)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;計算溫度 35 度時冰品銷售營業額 = <span class="subst">&#123;reg(<span class="number">35</span>).<span class="built_in">round</span>(<span class="number">0</span>)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># [  71.63 -986.22]</span></span><br><span class="line"><span class="comment"># 71.63 x - 986.2</span></span><br><span class="line"><span class="comment"># 計算溫度 35 度時冰品銷售營業額 = 1521.0</span></span><br><span class="line"></span><br><span class="line">plt.plot(temperature, reg(temperature) , color=<span class="string">&#x27;red&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.scatter(temperature, rev)</span><br><span class="line">plt.title(<span class="string">&quot;天氣溫度與冰品銷售&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;溫度&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;營業額&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic47.png" class="" title="pic47">
</div>

<h5 id="二次函數回歸模型"><a href="#二次函數回歸模型" class="headerlink" title="二次函數回歸模型"></a>二次函數回歸模型</h5><p>繪製二次函數圖形時,需先將數據依溫度排序,否則所繪製的迴歸圖形會有錯亂<br><strong>建立二次函數迴歸模型係數</strong><br>coef &#x3D; np.polyfit(temperature, rev, 2)<br><strong>建立二次函數迴歸方程式</strong><br>reg &#x3D; np.poly1d(coef)</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 天氣溫度</span></span><br><span class="line">temperature = [<span class="number">22</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">32</span>,<span class="number">33</span>]</span><br><span class="line"><span class="comment"># 營業額</span></span><br><span class="line">rev = [<span class="number">600</span>,<span class="number">900</span>,<span class="number">1100</span>,<span class="number">720</span>,<span class="number">950</span>,<span class="number">1020</span>,<span class="number">1000</span>,<span class="number">1200</span>,<span class="number">1420</span>,<span class="number">1500</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立二次函數迴歸模型係數</span></span><br><span class="line">coef = np.polyfit(temperature, rev, <span class="number">2</span>)</span><br><span class="line"><span class="comment"># 建立二次函數迴歸方程式</span></span><br><span class="line">reg = np.poly1d(coef)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(coef.<span class="built_in">round</span>(<span class="number">2</span>))</span><br><span class="line"><span class="built_in">print</span>(reg)</span><br><span class="line"></span><br><span class="line">plt.plot(temperature, reg(temperature) , color=<span class="string">&#x27;red&#x27;</span>)</span><br><span class="line">plt.scatter(temperature, rev)</span><br><span class="line"></span><br><span class="line">plt.title(<span class="string">&quot;天氣溫度與冰品銷售&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;溫度&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;營業額&quot;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># [   4.64 -185.73 2530.84]</span></span><br><span class="line"><span class="comment">#        2</span></span><br><span class="line"><span class="comment"># 4.642 x - 185.7 x + 2531</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic48.png" class="" title="pic48">
</div>

<h5 id="隨機函數的分布"><a href="#隨機函數的分布" class="headerlink" title="隨機函數的分布"></a>隨機函數的分布</h5><p><strong>常見Numpy的隨機函數</strong></p>
<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic49.png" class="" title="pic49">
</div>

<p><strong>常態分布(normal distribution)函數的數學公式</strong></p>
<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic50.png" class="" title="pic50">
</div>

<h6 id="randn"><a href="#randn" class="headerlink" title="randn()"></a>randn()</h6><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># randn產生1個或多個平均值是0,標準差是1的常態分佈隨機數</span></span><br><span class="line"><span class="comment"># randn傳回實數,無特定range</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">mu = <span class="number">0</span></span><br><span class="line">sigma = <span class="number">1</span></span><br><span class="line">s = np.random.randn(<span class="number">10000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># density=True告訴plt.hist()函數要繪製一個標準化的直方圖</span></span><br><span class="line"><span class="comment"># density=True被設置，這些值被歸一化，因此它們表示每個區間中資料點的比例，而不是絕對數量</span></span><br><span class="line"><span class="comment"># bins是用於定義直方圖區間邊界的陣列。這些邊界包括了最小值到最大值之間的所有區間</span></span><br><span class="line"><span class="comment"># ignored：是一個無用的值，它在這個情況下沒有被使用，所以可以忽略它。</span></span><br><span class="line">count, bins, ignored = plt.hist(s, <span class="number">30</span>, density=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;<span class="built_in">len</span>(count)&#125;</span> count=<span class="subst">&#123;count&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;<span class="built_in">len</span>(bins)&#125;</span>,bins=<span class="subst">&#123;bins&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ignored=<span class="subst">&#123;ignored&#125;</span>&quot;</span>)</span><br><span class="line">plt.plot(bins, <span class="number">1</span>/(sigma * np.sqrt( <span class="number">2</span>* np.pi)) * np.exp( -(bins - mu)**<span class="number">2</span> / (<span class="number">2</span>*sigma**<span class="number">2</span>)) , linewidth=<span class="number">2</span>, color=<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic51.png" class="" title="pic51">
</div>

<h6 id="normal"><a href="#normal" class="headerlink" title="normal()"></a>normal()</h6><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># normal 產生常態分佈函數的隨機數(可設定平均值及標準差)</span></span><br><span class="line"><span class="comment"># normal 傳回實數,無特定range</span></span><br><span class="line"><span class="comment"># seaborn.kdeplot 繪製常態分佈曲線非常方便</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line">mu = <span class="number">0</span></span><br><span class="line">sigma = <span class="number">1</span></span><br><span class="line">s = np.random.normal(mu, sigma, <span class="number">10000</span>)</span><br><span class="line"></span><br><span class="line">count, bins, ignored = plt.hist(s, <span class="number">30</span>, density=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># plt.plot(bins, 1/(sigma * np.sqrt( 2* np.pi)) * np.exp( -(bins - mu)**2 / (2*sigma**2)) , linewidth=2, color=&#x27;r&#x27;)</span></span><br><span class="line">sns.kdeplot(s)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic52.png" class="" title="pic52">
</div>

<h6 id="uniform-x2F-random"><a href="#uniform-x2F-random" class="headerlink" title="uniform()&#x2F;random()"></a>uniform()&#x2F;random()</h6><p>uniform(low, high, size) 平均分布的隨機函數<br>low: default 0.0,隨機數下限值<br>high: default 1.0,隨機數上限值<br>size: default 1,產生隨機數數量</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uniform(low, high, size) 平均分布的隨機函數</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># s = np.random.uniform(size=10000)</span></span><br><span class="line">s = np.random.random(<span class="number">10000</span>)</span><br><span class="line"></span><br><span class="line">plt.hist(s, <span class="number">30</span>, density=<span class="literal">True</span>)</span><br><span class="line">sns.kdeplot(s)</span><br><span class="line"><span class="comment"># plt.title(&quot;np.random.uniform 繪圖&quot;)</span></span><br><span class="line">plt.title(<span class="string">&quot;np.random.random 繪圖&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic53.png" class="" title="pic53">
</div>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic54.png" class="" title="pic54">
</div>

<h3 id="向量"><a href="#向量" class="headerlink" title="向量"></a>向量</h3><h4 id="機器學習的向量知識"><a href="#機器學習的向量知識" class="headerlink" title="機器學習的向量知識"></a>機器學習的向量知識</h4><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic55.png" class="" title="pic55">
</div>

<h4 id="向量的長度"><a href="#向量的長度" class="headerlink" title="向量的長度"></a>向量的長度</h4><p>$|\mathbf{a}| or ||\mathbf{a}||$<br>對於一個n維的向量$\mathbf{a}$而言,長度計算如下<br>$ ||\mathbf{a}|| &#x3D; \sqrt{a_1^2 + a_2^2 + … + a_n^2} $ </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># np.linalg.norm 計算向量長度</span></span><br><span class="line">&gt;&gt;&gt; import numpy as np</span><br><span class="line">&gt;&gt;&gt; park = np.array([1,3])  </span><br><span class="line">&gt;&gt;&gt; norm_park = np.linalg.norm(park)  </span><br><span class="line">&gt;&gt;&gt; norm_park </span><br><span class="line">3.1622776601683795 </span><br><span class="line"></span><br><span class="line"><span class="comment"># 計算商店到公司的長度</span></span><br><span class="line">&gt;&gt;&gt; store = np.array([2, 1])</span><br><span class="line">&gt;&gt;&gt; office = np.array([4, 4])</span><br><span class="line">&gt;&gt;&gt; store_office = office - store</span><br><span class="line">&gt;&gt;&gt; norm_store_office = np.linalg.norm(store_office)  </span><br><span class="line">&gt;&gt;&gt; norm_store_office                               </span><br><span class="line">3.605551275463989</span><br></pre></td></tr></table></figure>

<h4 id="向量方程式"><a href="#向量方程式" class="headerlink" title="向量方程式"></a>向量方程式</h4><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic56.png" class="" title="pic56">
</div>

<p>$\overrightarrow{a} &#x3D; \left( ^{-1} _2\right)$<br>$\overrightarrow{b} &#x3D; \left( ^{1} _4\right)$<br>$ p\overrightarrow{k} &#x3D; \overrightarrow{b} - \overrightarrow{a} $<br>$ \overrightarrow{b} &#x3D; \overrightarrow{a} + p\overrightarrow{k} $<br>$p\overrightarrow{k} &#x3D; \left( ^{1-(-1)} _{4-2}\right) &#x3D; \left( ^2 _2\right)$</p>
<p>$\overrightarrow{k} &#x3D; \left( ^{2} _2\right), p&#x3D;1$</p>
<h4 id="向量內積"><a href="#向量內積" class="headerlink" title="向量內積"></a>向量內積</h4><h5 id="偕同工作"><a href="#偕同工作" class="headerlink" title="偕同工作"></a>偕同工作</h5><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic57.png" class="" title="pic57">
</div>

<p>$ k &#x3D; 	\parallel{b}\parallel \cos{θ} $</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; import math</span><br><span class="line">&gt;&gt;&gt; 10*math.cos(math.radians(60))</span><br><span class="line">5.000000000000001</span><br></pre></td></tr></table></figure>

<h5 id="向量內積的定義"><a href="#向量內積的定義" class="headerlink" title="向量內積的定義"></a>向量內積的定義</h5><p>向量內積的幾何定義和代數定義是相同的，只是表達方式不同。具體來說，它們是兩個等價的定義，描述了同一個運算。</p>
<p>向量內積(inner product) a⋅b (a dot b)</p>
<h6 id="幾何定義向量內積"><a href="#幾何定義向量內積" class="headerlink" title="幾何定義向量內積"></a>幾何定義向量內積</h6><p>$a⋅b &#x3D; \parallel{a}\parallel \parallel{b}\parallel \cos{θ} $<br>向量內積的另一層解釋是,第一個向量投影到第二個向量的長度</p>
<ol>
<li>交換率<br>  a⋅b &#x3D; b⋅a</li>
<li>分配律<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic58.png" class="" title="pic58">
</div></li>
</ol>
<p>a⋅(b+c) &#x3D; a⋅b + a⋅c<br>$\parallel{b+c}\parallel\cos{θ} &#x3D; \parallel{b}\parallel\cos{α} + \parallel{c}\parallel\cos{β} $</p>
<h6 id="代數定義向量內積"><a href="#代數定義向量內積" class="headerlink" title="代數定義向量內積"></a>代數定義向量內積</h6><p>$\mathbf{a} &#x3D; (a_1 a_2 … a_n)$<br>$\mathbf{b} &#x3D; (b_1 b_2 … b_n)$<br>$a⋅b &#x3D; \sum_{n}^{i&#x3D;1}a_ib_i &#x3D; a_1b_1 +  a_2b_2 + … + a_nb_n$<br>若為2維空間 $a⋅b &#x3D; a_1b_1 + a_2b_2 $<br>例如2向量為 (1 3) (4 2) 向量內積計算如下:<br>  1*4 + 3*2 &#x3D; 10</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 計算向量內積可使用 numpy.dot()</span></span><br><span class="line">&gt;&gt;&gt; import numpy as np</span><br><span class="line">&gt;&gt;&gt; a = np.array([1, 3])</span><br><span class="line">&gt;&gt;&gt; b = np.array([4, 2])</span><br><span class="line">&gt;&gt;&gt; np.dot(a, b)</span><br><span class="line">10</span><br></pre></td></tr></table></figure>

<h6 id="幾何定義與代數定義是相等"><a href="#幾何定義與代數定義是相等" class="headerlink" title="幾何定義與代數定義是相等"></a>幾何定義與代數定義是相等</h6><p>幾何定義<br>$ a⋅b &#x3D; \parallel{a}\parallel \parallel{b}\parallel \cos{θ} &#x3D; a_1b_1 + a_2b_2 $<br>假設向量 x(1 0), y(0 1)<br>$\parallel{x}\parallel &#x3D; \sqrt{1^2 + 0^2 } &#x3D; 1$<br>$\parallel{y}\parallel &#x3D; \sqrt{0^2 + 1^2 } &#x3D; 1$<br>$ x⋅y &#x3D; \parallel{x}\parallel \parallel{y}\parallel \cos{\frac{π}{2}} $ &#x3D; 1*1*0 &#x3D; 0<br>$ x⋅x &#x3D; \parallel{x}\parallel \parallel{x}\parallel \cos{0} $ &#x3D; 1*1*1 &#x3D; 1<br>代數定義<br>x⋅y &#x3D; 0*1 + 1*0 &#x3D; 0<br>x⋅x &#x3D; 1*1 + 0*0 &#x3D; 1</p>
<h5 id="兩條直線的夾角"><a href="#兩條直線的夾角" class="headerlink" title="兩條直線的夾角"></a>兩條直線的夾角</h5><p>$a⋅b &#x3D; \parallel{a}\parallel \parallel{b}\parallel \cos{θ} &#x3D; a_1b_1 + a_2b_2$<br>$ \cos{θ} &#x3D; \frac{a_1b_1 + a_2b_2}{\parallel{a}\parallel \parallel{b}\parallel} $</p>
<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic59.png" class="" title="pic59">
</div>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 計算兩條直線的夾角</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">a = np.array([<span class="number">1</span>,<span class="number">1</span>])</span><br><span class="line">b = np.array([<span class="number">5</span>,<span class="number">5</span>])</span><br><span class="line">c = np.array([<span class="number">1</span>,<span class="number">5</span>])</span><br><span class="line">d = np.array([<span class="number">5</span>,<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 向量</span></span><br><span class="line">ab = b - a</span><br><span class="line">cd = d - c</span><br><span class="line"><span class="comment"># 向量大小</span></span><br><span class="line">norm_ab = np.linalg.norm(ab)</span><br><span class="line">norm_cd = np.linalg.norm(cd)</span><br><span class="line"></span><br><span class="line">dot_ab_cd = np.dot(ab, cd)</span><br><span class="line">cos_value = dot_ab_cd/(norm_ab * norm_cd)</span><br><span class="line">cos_value = dot_ab_cd/(norm_ab * norm_cd)</span><br><span class="line">rad = math.acos(cos_value)</span><br><span class="line">deg = math.degrees(rad)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;角度是:<span class="subst">&#123;deg&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 角度是:90.0</span></span><br></pre></td></tr></table></figure>

<h5 id="向量內積的性質"><a href="#向量內積的性質" class="headerlink" title="向量內積的性質"></a>向量內積的性質</h5><p>$ \cos{θ} &#x3D; \frac{a_1b_1 + a_2b_2}{\parallel{a}\parallel \parallel{b}\parallel} $</p>
<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic60.png" class="" title="pic60">
</div>

<h5 id="餘弦相似度"><a href="#餘弦相似度" class="headerlink" title="餘弦相似度"></a>餘弦相似度</h5><p>$ 弦相似度(consine similarity) &#x3D; \cos{θ} &#x3D; \frac{a_1b_1 + a_2b_2}{\parallel{a}\parallel \parallel{b}\parallel} $</p>
<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic61.png" class="" title="pic61">
</div>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 判斷句子相似度</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">consine_similarity</span>(<span class="params">va, vb</span>):</span></span><br><span class="line">    norm_a = np.linalg.norm(va)</span><br><span class="line">    norm_b = np.linalg.norm(vb)</span><br><span class="line">    dot_ab = np.dot(va, vb)</span><br><span class="line">    <span class="keyword">return</span> dot_ab/(norm_a * norm_b )</span><br><span class="line"></span><br><span class="line">a = np.array([<span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>])</span><br><span class="line">b = np.array([<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line">c = np.array([<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot; a 和 b 的相似度 : <span class="subst">&#123;consine_similarity(a, b)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot; a 和 c 的相似度 : <span class="subst">&#123;consine_similarity(a, c)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot; b 和 c 的相似度 : <span class="subst">&#123;consine_similarity(b, c)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment">#  a 和 b 的相似度 : 0.5070925528371099</span></span><br><span class="line"><span class="comment">#  a 和 c 的相似度 : 0.5070925528371099</span></span><br><span class="line"><span class="comment">#  b 和 c 的相似度 : 0.7999999999999998</span></span><br></pre></td></tr></table></figure>

<h4 id="皮爾遜相關係數-Pearson-correlation-coefiicient"><a href="#皮爾遜相關係數-Pearson-correlation-coefiicient" class="headerlink" title="皮爾遜相關係數(Pearson correlation coefiicient)"></a>皮爾遜相關係數(Pearson correlation coefiicient)</h4><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic62.png" class="" title="pic62">
</div>

<h5 id="皮爾遜相關係數定義"><a href="#皮爾遜相關係數定義" class="headerlink" title="皮爾遜相關係數定義"></a>皮爾遜相關係數定義</h5><p>皮爾遜相關係數定義是兩個變數之間共變異數和標準差的商<br>$$ r &#x3D; \frac{\sum_{i&#x3D;1}^{n}(x_i-\overline{x})(y_i-\overline{y})}{\sqrt{\sum_{i&#x3D;1}^{n}(x_i-\overline{x})^2}\sqrt{\sum_{i&#x3D;1}^{n}(y_i-\overline{y})^2}} $$</p>
<h5 id="網路購物問卷調查案例解說"><a href="#網路購物問卷調查案例解說" class="headerlink" title="網路購物問卷調查案例解說"></a>網路購物問卷調查案例解說</h5><p>2019年12月做問卷調查,2021年1月再對詢問對象調查商品繼續購買次數</p>
<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic63.png" class="" title="pic63">
</div>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic64.png" class="" title="pic64">
</div>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic65.png" class="" title="pic65">
</div>

<p>$ r &#x3D; \frac{30}{\sqrt{18}\sqrt{196}} &#x3D; 0.505$<br>可以看出滿意度與下次購買有正相關,不過相關強度是中等</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">x = np.array([<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">8</span>])</span><br><span class="line">y = np.array([<span class="number">12</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">18</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">16</span>])</span><br><span class="line"></span><br><span class="line">x_mean = np.mean(x)</span><br><span class="line">y_mean = np.mean(y)</span><br><span class="line"></span><br><span class="line">xi_x =[v - x_mean <span class="keyword">for</span> v <span class="keyword">in</span> x]</span><br><span class="line">yi_x =[v - y_mean <span class="keyword">for</span> v <span class="keyword">in</span> y]</span><br><span class="line"></span><br><span class="line">data1 = [<span class="number">0</span>] * <span class="number">10</span></span><br><span class="line">data2 = [<span class="number">0</span>] * <span class="number">10</span></span><br><span class="line">data3 = [<span class="number">0</span>] * <span class="number">10</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(x)):</span><br><span class="line">    data1[i] = xi_x[i] * yi_x[i]</span><br><span class="line">    data2[i] = xi_x[i]**<span class="number">2</span></span><br><span class="line">    data3[i] = yi_x[i]**<span class="number">2</span></span><br><span class="line"></span><br><span class="line">v1 = np.<span class="built_in">sum</span>(data1)</span><br><span class="line">v2 = np.<span class="built_in">sum</span>(data2)</span><br><span class="line">v3 = np.<span class="built_in">sum</span>(data3)</span><br><span class="line">r = v1/((v2**<span class="number">0.5</span>)*(v3**<span class="number">0.5</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;coefficient=<span class="subst">&#123;r:<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># coefficient=0.505</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">xpt1 = np.linspace(<span class="number">0</span>, <span class="number">12</span>, <span class="number">12</span>)</span><br><span class="line">ypt1 = [y_mean <span class="keyword">for</span> xp <span class="keyword">in</span> xpt1]</span><br><span class="line">ypt2 = np.linspace(<span class="number">0</span>, <span class="number">20</span>, <span class="number">20</span>)</span><br><span class="line">xpt2 = [x_mean <span class="keyword">for</span> xp <span class="keyword">in</span> ypt2]</span><br><span class="line"></span><br><span class="line">plt.scatter(x, y)</span><br><span class="line">plt.plot(xpt1, ypt1, color=<span class="string">&quot;g&quot;</span>)</span><br><span class="line">plt.plot(xpt2, ypt2, color=<span class="string">&quot;r&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># plt.axis([0, 12, 0, 20])</span></span><br><span class="line">plt.title(<span class="string">&quot;滿意度 vs 再購買次數&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;滿意度&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;再購買次數&quot;</span>)</span><br><span class="line">plt.grid()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic66.png" class="" title="pic66">
</div>

<h5 id="使用向量內積計算係數"><a href="#使用向量內積計算係數" class="headerlink" title="使用向量內積計算係數"></a>使用向量內積計算係數</h5><p>$a &#x3D; (x_1-\overline{x}\ x_2-\overline{x} … x_n-\overline{x}) $<br>$b &#x3D; (y_1-\overline{y}\ y_2-\overline{y} … y_n-\overline{y}) $<br>$r &#x3D; \cos(θ) &#x3D; 	\frac{a⋅b}{\parallel a \parallel \parallel b \parallel} $</p>
<p>分子<br>$ a⋅b &#x3D; (x_1-\overline(x))(y_1-\overline(y)) + (x_2-\overline(x))(y_2-\overline(y)) + … + (x_n-\overline(x))(y_n-\overline(y)) $<br>$ &#x3D; \sum_{i&#x3D;1}^{n}(x_i-\overline{x})(y_i-\overline{y}) $</p>
<p>分母<br>$$ \parallel a \parallel &#x3D; \sqrt{(x_1-\overline{x})^2 + (x_2-\overline{x})^2 + … + (x_n-\overline{x})^2} &#x3D; \sqrt{\sum_{i&#x3D;1}^{n}(x_i-\overline{x})^2} $$<br>$$ \parallel b \parallel &#x3D; \sqrt{(y_1-\overline{y})^2 + (y_2-\overline{y})^2 + … + (y_n-\overline{y})^2} &#x3D; \sqrt{\sum_{i&#x3D;1}^{n}(y_i-\overline{y})^2} $$</p>
<p>推導結果<br>$$ r &#x3D; \cos(θ) &#x3D; 	\frac{a⋅b}{\parallel a \parallel \parallel b \parallel} &#x3D; \frac{\sum_{i&#x3D;1}^{n}(x_i-\overline{x})(y_i-\overline{y})}{\sqrt{\sum_{i&#x3D;1}^{n}(x_i-\overline{x})^2}\sqrt{\sum_{i&#x3D;1}^{n}(y_i-\overline{y})^2}} $$</p>
<h4 id="向量外積"><a href="#向量外積" class="headerlink" title="向量外積"></a>向量外積</h4><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic67.png" class="" title="pic67">
</div>

<p>向量外積的定義如下：假設我們有兩個向量 𝑎 和 𝑏<br>$ a &#x3D;<br>\left(<br>\begin{matrix}<br>    a_x	\\<br>    a_y \\<br>    a_z<br>\end{matrix}<br>\right)<br>$</p>
<p>$ b &#x3D;<br>\left(<br>\begin{matrix}<br>    b_x	\\<br>    b_y \\<br>    b_z<br>\end{matrix}<br>\right)<br>$</p>
<p>$ c &#x3D; a × b &#x3D;<br>\left(<br>\begin{matrix}<br>    c_x	\\<br>    c_y \\<br>    c_z<br>\end{matrix}<br>\right)<br>$<br>$ c_x &#x3D; a_yb_z - a_zb_y$<br>$ c_y &#x3D; a_zb_x - a_xb_z$<br>$ c_z &#x3D; a_xb_y - a_yb_x$</p>
<p>公式</p>
<p>$a × b &#x3D; \begin{vmatrix} i 	&amp; j 	&amp; k		\\ a_x &amp; a_y &amp; a_z \\ b_x &amp; b_y &amp; b_z \end{vmatrix} &#x3D; \begin{pmatrix} a_yb_z - a_zb_y	\\ a_zb_x - a_xb_z \\ a_xb_y - a_yb_x \end{pmatrix}$</p>
<p>例子<br>$ a &#x3D;<br>\left(<br>\begin{matrix}<br>    1	\\<br>    2 \\<br>    3<br>\end{matrix}<br>\right)<br>$<br>$<br>b &#x3D;<br>\left(<br>\begin{matrix}<br>    4	\\<br>    5 \\<br>    6<br>\end{matrix}<br>\right)<br>$</p>
<p>$ a × b &#x3D; \begin{vmatrix} i 	&amp; j 	&amp; k		\\ 	1 &amp; 2 &amp; 3 \\ 4 &amp; 5 &amp; 6 \end{vmatrix} &#x3D; \begin{pmatrix} 2⋅6 - 3⋅5	\\ 3⋅4 − 1⋅6 \\ 1⋅5 − 2⋅4 \end{pmatrix} &#x3D; \begin{pmatrix} 12 - 15	\\ 12 − 6 \\ 5 − 8 \end{pmatrix} &#x3D; \begin{pmatrix} -3	\\ 6 	\\ -3 \end{pmatrix} $</p>
<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic69.png" class="" title="pic69">
</div>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = np.array([<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>np.cross(a, b)</span><br><span class="line">array([-<span class="number">3</span>,  <span class="number">6</span>, -<span class="number">3</span>])</span><br></pre></td></tr></table></figure>

<h4 id="計算面積"><a href="#計算面積" class="headerlink" title="計算面積"></a>計算面積</h4><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic68.png" class="" title="pic68">
</div>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 計算兩個向量組成三角形面積</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">a = np.array([<span class="number">4</span>, <span class="number">2</span>])</span><br><span class="line">b = np.array([<span class="number">1</span>, <span class="number">3</span>])</span><br><span class="line"><span class="comment"># 計算角度再算面積</span></span><br><span class="line"><span class="comment"># 計算向量大小</span></span><br><span class="line">norm_a = np.linalg.norm(a)</span><br><span class="line">norm_b = np.linalg.norm(b)</span><br><span class="line"><span class="comment"># 計算內積</span></span><br><span class="line">dot_ab = np.dot(a, b)</span><br><span class="line"><span class="comment"># a.b = |a||b|cos(θ)</span></span><br><span class="line">cos_value = dot_ab/(norm_a*norm_b)</span><br><span class="line">rad = math.acos(cos_value)</span><br><span class="line"><span class="comment"># 算面積</span></span><br><span class="line">area = norm_a * norm_b * math.sin(rad)/<span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;計算角度再算面積 area=<span class="subst">&#123;area:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 以外積計算面積</span></span><br><span class="line">ab_cross = np.cross(a,b)</span><br><span class="line">area2 =  ab_cross / <span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;以外積計算面積 area=<span class="subst">&#123;area2:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 計算角度再算面積 area=5.00</span></span><br><span class="line"><span class="comment"># 以外積計算面積 area=5.00</span></span><br></pre></td></tr></table></figure>

<h3 id="矩陣"><a href="#矩陣" class="headerlink" title="矩陣"></a>矩陣</h3><h4 id="矩陣表達方式"><a href="#矩陣表達方式" class="headerlink" title="矩陣表達方式"></a>矩陣表達方式</h4><h5 id="矩陣的行與列"><a href="#矩陣的行與列" class="headerlink" title="矩陣的行與列"></a>矩陣的行與列</h5><p>2*3矩陣<br>$ A &#x3D;<br>\left(<br>\begin{matrix}<br>    1 &amp; 2 &amp; 3	\\<br>    4 &amp; 5 &amp; 6	<br>\end{matrix}<br>\right)<br>$<br>3*2矩陣<br>$ B &#x3D;<br>\left(<br>\begin{matrix}<br>    1 &amp; 4 \\<br>    2 &amp; 5 \\<br>    3 &amp; 6<br>\end{matrix}<br>\right)<br>$</p>
<h5 id="其他表示法"><a href="#其他表示法" class="headerlink" title="其他表示法"></a>其他表示法</h5><p>$ \begin{pmatrix} 1 &amp; 2 \\ 3 &amp; 4 \end{pmatrix} $<br>$ \begin{bmatrix} 1 &amp; 2 \\ 3 &amp; 4 \end{bmatrix} $<br>$ \begin{vmatrix} 1 &amp; 2 \\ 3 &amp; 4 \end{vmatrix} $<br>$ \begin{Vmatrix} 1 &amp; 2 \\ 3 &amp; 4 \end{Vmatrix} $</p>
<h4 id="矩陣相加與相減"><a href="#矩陣相加與相減" class="headerlink" title="矩陣相加與相減"></a>矩陣相加與相減</h4><p>矩陣大小要一樣直接相加減</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">A = np.matrix([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]])</span><br><span class="line">B = np.matrix([[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>], [<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;A + B = <span class="subst">&#123;A + B&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;A - B = <span class="subst">&#123;A - B&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># A + B = [[ 5  7  9]</span></span><br><span class="line"><span class="comment">#          [11 13 15]]</span></span><br><span class="line"><span class="comment"># A - B = [[-3 -3 -3]</span></span><br><span class="line"><span class="comment">#          [-3 -3 -3]]</span></span><br></pre></td></tr></table></figure>

<h4 id="矩陣相乘"><a href="#矩陣相乘" class="headerlink" title="矩陣相乘"></a>矩陣相乘</h4><p>A * B, A矩陣的行數要等於 B矩陣的列數</p>
<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic70.png" class="" title="pic70">
</div>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">A = np.matrix([[<span class="number">1</span>,<span class="number">2</span>],</span><br><span class="line">               [<span class="number">3</span>, <span class="number">4</span>]])</span><br><span class="line">B = np.matrix([[<span class="number">5</span>,<span class="number">6</span>],</span><br><span class="line">               [<span class="number">7</span>,<span class="number">8</span>]])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;A * B = <span class="subst">&#123;A * B&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">C = np.matrix([[ <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>],</span><br><span class="line">               [-<span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>]])</span><br><span class="line">D = np.matrix([[<span class="number">3</span>,<span class="number">1</span>],</span><br><span class="line">               [<span class="number">2</span>,<span class="number">1</span>],</span><br><span class="line">               [<span class="number">1</span>,<span class="number">0</span>]])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;C * D = <span class="subst">&#123;C * D&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># A * B = [[19 22]</span></span><br><span class="line"><span class="comment">#          [43 50]]</span></span><br><span class="line"><span class="comment"># C * D = [[5 1]</span></span><br><span class="line"><span class="comment">#          [4 2]]</span></span><br></pre></td></tr></table></figure>

<h5 id="計算甲和乙在超商及百貨公司採買各需多少錢"><a href="#計算甲和乙在超商及百貨公司採買各需多少錢" class="headerlink" title="計算甲和乙在超商及百貨公司採買各需多少錢"></a>計算甲和乙在超商及百貨公司採買各需多少錢</h5><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic71.png" class="" title="pic71">
</div>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 計算甲和乙在超商及百貨公司採買各需多少錢</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">A = np.matrix([[<span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>],</span><br><span class="line">               [<span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>]])</span><br><span class="line">B = np.matrix([[<span class="number">30</span>, <span class="number">50</span>],</span><br><span class="line">               [<span class="number">60</span>, <span class="number">80</span>],</span><br><span class="line">               [<span class="number">50</span>, <span class="number">60</span>]])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;A * B = <span class="subst">&#123;A * B&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># A * B = [[290 400]</span></span><br><span class="line"><span class="comment">#          [460 610]]</span></span><br></pre></td></tr></table></figure>

<h5 id="計算甲-乙各吃下多少熱量"><a href="#計算甲-乙各吃下多少熱量" class="headerlink" title="計算甲,乙各吃下多少熱量"></a>計算甲,乙各吃下多少熱量</h5><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic72.png" class="" title="pic72">
</div>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 計算甲,乙各吃下多少熱量</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">A = np.matrix([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>],</span><br><span class="line">               [<span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>]])</span><br><span class="line">B = np.matrix([[<span class="number">30</span>],[<span class="number">50</span>],[<span class="number">20</span>]])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;A * B = <span class="subst">&#123;A * B&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># A * B = [[150]</span></span><br><span class="line"><span class="comment">#          [150]]</span></span><br></pre></td></tr></table></figure>

<h4 id="方形矩陣-square-matrix"><a href="#方形矩陣-square-matrix" class="headerlink" title="方形矩陣(square matrix)"></a>方形矩陣(square matrix)</h4><p>一個矩陣列數等於行數<br>$$ A&#x3D;\begin{pmatrix} 1 &amp; 2 \\ 3 &amp; 4 \end{pmatrix} B&#x3D;\begin{pmatrix} 1 &amp; 2 &amp; 3\\ 4 &amp; 5 &amp; 6\\ 7 &amp; 8 &amp; 9 \end{pmatrix}$$</p>
<h4 id="單位矩陣-indentity-matrix"><a href="#單位矩陣-indentity-matrix" class="headerlink" title="單位矩陣(indentity matrix)"></a>單位矩陣(indentity matrix)</h4><p>一個方形矩陣由左上至右下對角線的元素為1,其他元素為0<br>單位矩陣有時用E或I表示,單位矩陣與單位矩陣相乘,結果皆為原來的矩陣<br>A * E &#x3D; A<br>E * A &#x3D; A<br>$$ A&#x3D;\begin{pmatrix} 1 &amp; 0 \\ 0 &amp; 1 \end{pmatrix} B&#x3D;\begin{pmatrix} 1 &amp; 0 &amp; 0\\ 0 &amp; 1 &amp; 0\\ 0 &amp; 0 &amp; 1 \end{pmatrix}$$</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">A = np.matrix([[<span class="number">1</span>, <span class="number">2</span>],</span><br><span class="line">               [<span class="number">3</span>, <span class="number">4</span>]])</span><br><span class="line">B = np.matrix([[<span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">               [<span class="number">0</span>, <span class="number">1</span>]])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;A * B = <span class="subst">&#123;A * B&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;B * A = <span class="subst">&#123;B * A&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># A * B = [[1 2]</span></span><br><span class="line"><span class="comment">#          [3 4]]</span></span><br><span class="line"><span class="comment"># B * A = [[1 2]</span></span><br><span class="line"><span class="comment">#          [3 4]]</span></span><br></pre></td></tr></table></figure>

<h4 id="反矩陣-inverse-matrix"><a href="#反矩陣-inverse-matrix" class="headerlink" title="反矩陣(inverse matrix)"></a>反矩陣(inverse matrix)</h4><p>只有方矩陣才有反矩陣,一個矩陣乘以反矩陣可以得到E,A的反矩陣表示為$A^{-1}$<br>$ A * A^{-1} &#x3D; E$<br>$ A^{-1} * A &#x3D; E$</p>
<p>2*2 反矩陣公式如下<br>$ A &#x3D; \begin{pmatrix} a_{1 1} &amp; a_{1 2} \\ a_{2 1} &amp; a_{2 2} \end{pmatrix}  A^{-1} &#x3D; \frac{1}{a_{1 1}a_{2 2} - a_{1 2}a_{2 1}}\begin{pmatrix} a_{2 2} &amp; -a_{1 2} \\ -a_{2 1} &amp; a_{1 1} \end{pmatrix} $</p>
<p>反矩陣實例<br>$ A &#x3D; \begin{pmatrix} 2 &amp; 3 \\ 5 &amp; 7 \end{pmatrix}  A^{-1} &#x3D; \frac{1}{14 - 15}\begin{pmatrix} 7 &amp; -3 \\ -5 &amp; 2 \end{pmatrix} &#x3D; \begin{pmatrix} -7 &amp; 3 \\ 5 &amp; -2 \end{pmatrix}$</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">A = np.matrix([[<span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">               [<span class="number">5</span>, <span class="number">7</span>]])</span><br><span class="line">B = np.linalg.inv(A)</span><br><span class="line">product_1 = A * B</span><br><span class="line">product_2 = B * A</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;A_inv = <span class="subst">&#123;B&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;A * A_inv = <span class="subst">&#123;product_1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;A_inv * A = <span class="subst">&#123;product_2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;A * A_inv(round) = <span class="subst">&#123;product_1.<span class="built_in">round</span>()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;A_inv * A(round) = <span class="subst">&#123;product_2.<span class="built_in">round</span>()&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># A_inv = [[-7.  3.]</span></span><br><span class="line"><span class="comment">#          [ 5. -2.]]</span></span><br><span class="line"><span class="comment"># A * A_inv = [[ 1.00000000e+00 -4.44089210e-16]</span></span><br><span class="line"><span class="comment">#              [-7.10542736e-15  1.00000000e+00]]</span></span><br><span class="line"><span class="comment"># A_inv * A = [[ 1.00000000e+00 -8.88178420e-16]</span></span><br><span class="line"><span class="comment">#              [-1.33226763e-15  1.00000000e+00]]</span></span><br><span class="line"><span class="comment"># A * A_inv(round) = [[ 1. -0.]</span></span><br><span class="line"><span class="comment">#                     [-0.  1.]]</span></span><br><span class="line"><span class="comment"># A_inv * A(round) = [[ 1. -0.]</span></span><br><span class="line"><span class="comment">#                     [-0.  1.]]</span></span><br></pre></td></tr></table></figure>

<h4 id="用反矩陣解聯立方程式"><a href="#用反矩陣解聯立方程式" class="headerlink" title="用反矩陣解聯立方程式"></a>用反矩陣解聯立方程式</h4><p>3x + 2y &#x3D; 5<br>x + 2y &#x3D; -1</p>
<p>$ \begin{pmatrix} 3 &amp; 2 \\ 1 &amp; 2 \end{pmatrix} \begin{pmatrix} x \\ y \end{pmatrix} &#x3D; \begin{pmatrix} 5 \\ -1 \end{pmatrix} $</p>
<p>$ \begin{pmatrix} 3 &amp; 2 \\ 1 &amp; 2 \end{pmatrix} 的反矩陣為 \begin{pmatrix} 0.5 &amp; -0.5 \\ -2.5 &amp; 0.75 \end{pmatrix}$</p>
<p>$ \begin{pmatrix} 0.5 &amp; -0.5 \\ -2.5 &amp; 0.75 \end{pmatrix} \begin{pmatrix} 3 &amp; 2 \\ 1 &amp; 2 \end{pmatrix} \begin{pmatrix} x \\ y \end{pmatrix} &#x3D; \begin{pmatrix} 0.5 &amp; -0.5 \\ -2.5 &amp; 0.75 \end{pmatrix} \begin{pmatrix} 5 \\ -1 \end{pmatrix} $<br>$ \begin{pmatrix} 1 &amp; 0 \\ 0 &amp; 1 \end{pmatrix}  \begin{pmatrix} x \\ y \end{pmatrix} &#x3D; \begin{pmatrix} 3 \\ -2 \end{pmatrix} $<br>解為 x&#x3D;3, y&#x3D;-2</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">A = np.matrix([[<span class="number">3</span>, <span class="number">2</span>],</span><br><span class="line">               [<span class="number">1</span>, <span class="number">2</span>]])</span><br><span class="line">B = np.linalg.inv(A)</span><br><span class="line">C = np.matrix([[<span class="number">5</span>],</span><br><span class="line">               [-<span class="number">1</span>]])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;反矩陣 : <span class="subst">&#123;B&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;E : <span class="subst">&#123;B*A&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;解方程式 : <span class="subst">&#123;B*C&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 反矩陣 : [[ 0.5  -0.5 ]</span></span><br><span class="line"><span class="comment">#           [-0.25  0.75]]</span></span><br><span class="line"><span class="comment"># E : [[1.00000000e+00 2.22044605e-16]</span></span><br><span class="line"><span class="comment">#      [1.11022302e-16 1.00000000e+00]]</span></span><br><span class="line"><span class="comment"># 解方程式 : [[ 3.]</span></span><br><span class="line"><span class="comment">#            [-2.]]</span></span><br></pre></td></tr></table></figure>

<h4 id="張量-Tensor"><a href="#張量-Tensor" class="headerlink" title="張量(Tensor)"></a>張量(Tensor)</h4><p>張量就是數據的結構,shape()可列出數字的外型</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">A = np.array([</span><br><span class="line">    [[<span class="number">1</span>,<span class="number">2</span>],</span><br><span class="line">     [<span class="number">3</span>,<span class="number">4</span>]],</span><br><span class="line">    [[<span class="number">5</span>,<span class="number">6</span>],</span><br><span class="line">     [<span class="number">7</span>,<span class="number">8</span>]],</span><br><span class="line">    [[<span class="number">9</span>,<span class="number">10</span>],</span><br><span class="line">     [<span class="number">11</span>,<span class="number">12</span>]],</span><br><span class="line">    ])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;A=<span class="subst">&#123;A&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;shape = <span class="subst">&#123;np.shape(A)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># A=[[[ 1  2]</span></span><br><span class="line"><span class="comment">#     [ 3  4]]</span></span><br><span class="line"><span class="comment">#    [[ 5  6]</span></span><br><span class="line"><span class="comment">#     [ 7  8]]</span></span><br><span class="line"><span class="comment">#    [[ 9 10]</span></span><br><span class="line"><span class="comment">#     [11 12]]]</span></span><br><span class="line"><span class="comment"># shape = (3, 2, 2)</span></span><br></pre></td></tr></table></figure>

<h4 id="轉置矩陣"><a href="#轉置矩陣" class="headerlink" title="轉置矩陣"></a>轉置矩陣</h4><p>就是將矩陣內的列元素和行元素對調<br>$ \begin{pmatrix} 0 &amp; 2 &amp; 4 &amp; 6 \\ 1 &amp; 3 &amp; 5 &amp; 7 \end{pmatrix}^T &#x3D; \begin{pmatrix} 0 &amp; 1 \\  2 &amp; 3 \\  4 &amp; 5 \\  6 &amp; 7 \end{pmatrix} $</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">A = np.array([[<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>],</span><br><span class="line">              [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>]])</span><br><span class="line">B = A.T</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;轉置矩陣1 = <span class="subst">&#123;B&#125;</span>&quot;</span>)</span><br><span class="line">C = np.transpose(A)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;轉置矩陣2 = <span class="subst">&#123;C&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 轉置矩陣1 = [[0 1]</span></span><br><span class="line"><span class="comment">#              [2 3]</span></span><br><span class="line"><span class="comment">#              [4 5]</span></span><br><span class="line"><span class="comment">#              [6 7]]</span></span><br><span class="line"><span class="comment"># 轉置矩陣2 = [[0 1]</span></span><br><span class="line"><span class="comment">#              [2 3]</span></span><br><span class="line"><span class="comment">#              [4 5]</span></span><br><span class="line"><span class="comment">#              [6 7]]</span></span><br></pre></td></tr></table></figure>

<h4 id="轉置矩陣的應用"><a href="#轉置矩陣的應用" class="headerlink" title="轉置矩陣的應用"></a>轉置矩陣的應用</h4><p>皮爾遜相關係數<br>$a &#x3D; (x_1-\overline{x}\ x_2-\overline{x} … x_n-\overline{x}) $<br>$b &#x3D; (y_1-\overline{y}\ y_2-\overline{y} … y_n-\overline{y}) $<br>$ r &#x3D; \cos(θ) &#x3D; 	\frac{a⋅b}{\parallel a \parallel \parallel b \parallel} &#x3D; \frac{\sum_{i&#x3D;1}^{n}(x_i-\overline{x})(y_i-\overline{y})}{\sqrt{\sum_{i&#x3D;1}^{n}(x_i-\overline{x})^2}\sqrt{\sum_{i&#x3D;1}^{n}(y_i-\overline{y})^2}} $</p>
<p>$ a &#x3D; \begin{pmatrix} x_1 - \overline{x} \\ x_2 - \overline{x} \\ … \\ x_n - \overline{x} \end{pmatrix} b &#x3D; \begin{pmatrix} y_1 - \overline{y} \\ y_2 - \overline{y} \\ … \\ y_n - \overline{y} \end{pmatrix}$</p>
<p>$ a^T⋅b &#x3D; \begin{pmatrix} x_1 - \overline{x} \\ x_2 - \overline{x} \\ … \\ x_n - \overline{x} \end{pmatrix} \begin{pmatrix} y_1 - \overline{y} \\ y_2 - \overline{y} \\ … \\ y_n - \overline{y} \end{pmatrix} $<br>上述是 1 * n 與 n * 1 矩陣,所以可以相乘的道純量,所以皮爾遜相關係數可改寫如下<br>$ r &#x3D; \cos(θ) &#x3D; 	\frac{a⋅b}{\parallel a \parallel \parallel b \parallel} &#x3D; \frac{\sum_{i&#x3D;1}^{n}(x_i-\overline{x})(y_i-\overline{y})}{\sqrt{\sum_{i&#x3D;1}^{n}(x_i-\overline{x})^2}\sqrt{\sum_{i&#x3D;1}^{n}(y_i-\overline{y})^2}} &#x3D; \frac{a^T⋅b}{\sqrt{a^T⋅a}\sqrt{b^T⋅b}} $<br>ps. 因為 $ \parallel a \parallel &#x3D; \sqrt{a^T⋅a} $</p>
<h3 id="向量-矩陣與多元線性迴歸-20-不了解"><a href="#向量-矩陣與多元線性迴歸-20-不了解" class="headerlink" title="向量,矩陣與多元線性迴歸(20):不了解"></a>向量,矩陣與多元線性迴歸(20):不了解</h3><h3 id="三次函數迴歸曲線實作"><a href="#三次函數迴歸曲線實作" class="headerlink" title="三次函數迴歸曲線實作"></a>三次函數迴歸曲線實作</h3><h4 id="網購迴歸曲線繪製"><a href="#網購迴歸曲線繪製" class="headerlink" title="網購迴歸曲線繪製"></a>網購迴歸曲線繪製</h4><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic73.png" class="" title="pic73">
</div>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 網購迴歸曲線繪製</span></span><br><span class="line"><span class="comment"># 購物網站 24 hour vs 購物人數</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"></span><br><span class="line">x = [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,</span><br><span class="line">     <span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">24</span>]</span><br><span class="line">y = [<span class="number">100</span>, <span class="number">88</span>, <span class="number">75</span>, <span class="number">60</span>, <span class="number">50</span>, <span class="number">55</span>, <span class="number">55</span>, <span class="number">56</span>, <span class="number">58</span>, <span class="number">58</span>, <span class="number">61</span>,</span><br><span class="line">      <span class="number">63</span>, <span class="number">68</span>, <span class="number">71</span>, <span class="number">71</span>, <span class="number">75</span>, <span class="number">76</span>, <span class="number">88</span>, <span class="number">93</span>, <span class="number">97</span>, <span class="number">97</span>, <span class="number">100</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立一次函數迴歸模型係數</span></span><br><span class="line"><span class="comment"># 建立一次函數迴歸方程式</span></span><br><span class="line">coef1 = np.polyfit(x, y, <span class="number">1</span>)</span><br><span class="line">model1 = np.poly1d(coef1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立二次函數迴歸模型係數</span></span><br><span class="line"><span class="comment"># 建立二次函數迴歸方程式</span></span><br><span class="line">coef2 = np.polyfit(x, y, <span class="number">2</span>)</span><br><span class="line">model2 = np.poly1d(coef2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立三次函數迴歸模型係數</span></span><br><span class="line"><span class="comment"># 建立三次函數迴歸方程式</span></span><br><span class="line">coef3 = np.polyfit(x, y, <span class="number">3</span>)</span><br><span class="line">model3 = np.poly1d(coef3)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(model1)</span><br><span class="line"><span class="built_in">print</span>(model2)</span><br><span class="line"><span class="built_in">print</span>(model3)</span><br><span class="line"></span><br><span class="line">plt.plot(x, model1(x) , color=<span class="string">&#x27;blue&#x27;</span>, label=<span class="string">&quot;1次函&quot;</span>)</span><br><span class="line">plt.plot(x, model2(x) , color=<span class="string">&#x27;green&#x27;</span>, label=<span class="string">&quot;2次函&quot;</span>)</span><br><span class="line">plt.plot(x, model3(x) , color=<span class="string">&#x27;red&#x27;</span>, label=<span class="string">&quot;3次函&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.scatter(x, y )</span><br><span class="line">plt.title(<span class="string">&quot;網路購物調查&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;時間&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;購物人數&quot;</span>)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1.207 x + 59.03</span></span><br><span class="line"><span class="comment">#         2</span></span><br><span class="line"><span class="comment"># 0.2591 x - 5.279 x + 87.1</span></span><br><span class="line"><span class="comment">#           3         2</span></span><br><span class="line"><span class="comment"># -0.02715 x + 1.275 x - 15.51 x + 110.2</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic74.png" class="" title="pic74">
</div>

<h4 id="使用-scikit-learn-評估迴歸模型"><a href="#使用-scikit-learn-評估迴歸模型" class="headerlink" title="使用 scikit-learn 評估迴歸模型"></a>使用 scikit-learn 評估迴歸模型</h4><a href="/2024/06/13/python-32/" title="# 評估模型"># 評估模型</a>

<h4 id="預測未來值"><a href="#預測未來值" class="headerlink" title="預測未來值"></a>預測未來值</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"></span><br><span class="line">x = [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,</span><br><span class="line">     <span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">24</span>]</span><br><span class="line">y = [<span class="number">100</span>, <span class="number">88</span>, <span class="number">75</span>, <span class="number">60</span>, <span class="number">50</span>, <span class="number">55</span>, <span class="number">55</span>, <span class="number">56</span>, <span class="number">58</span>, <span class="number">58</span>, <span class="number">61</span>,</span><br><span class="line">      <span class="number">63</span>, <span class="number">68</span>, <span class="number">71</span>, <span class="number">71</span>, <span class="number">75</span>, <span class="number">76</span>, <span class="number">88</span>, <span class="number">93</span>, <span class="number">97</span>, <span class="number">97</span>, <span class="number">100</span>]</span><br><span class="line"></span><br><span class="line">coef = np.polyfit(x, y, <span class="number">3</span>)</span><br><span class="line">model = np.poly1d(coef)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;18點購物人數預測 : <span class="subst">&#123;model(<span class="number">18</span>):<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;20點購物人數預測 : <span class="subst">&#123;model(<span class="number">20</span>):<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.plot(<span class="number">18</span>, model(<span class="number">18</span>), <span class="string">&quot;-o&quot;</span>, color=<span class="string">&quot;red&quot;</span>)</span><br><span class="line">plt.plot(<span class="number">20</span>, model(<span class="number">20</span>), <span class="string">&quot;-o&quot;</span>, color=<span class="string">&quot;red&quot;</span>)</span><br><span class="line">plt.plot(x, model(x) , color=<span class="string">&#x27;red&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.scatter(x, y )</span><br><span class="line">plt.title(<span class="string">&quot;網路購物調查&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;時間&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;購物人數&quot;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># 18點購物人數預測 : 85.63</span></span><br><span class="line"><span class="comment"># 20點購物人數預測 : 92.62</span></span><br></pre></td></tr></table></figure>
<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic75.png" class="" title="pic75">
</div>

<h4 id="不適合三次函數迴歸數據-實例"><a href="#不適合三次函數迴歸數據-實例" class="headerlink" title="不適合三次函數迴歸數據(實例)"></a>不適合三次函數迴歸數據(實例)</h4><p>不是所有數據皆可使用三次函數求迴歸模型</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不適合三次函數迴歸數據(實例)</span></span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score, mean_squared_error</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"></span><br><span class="line">x = [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,</span><br><span class="line">     <span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">24</span>]</span><br><span class="line">y = [<span class="number">100</span>, <span class="number">21</span>, <span class="number">75</span>, <span class="number">49</span>, <span class="number">15</span>, <span class="number">98</span>, <span class="number">55</span>, <span class="number">31</span>, <span class="number">33</span>, <span class="number">82</span>, <span class="number">61</span>,</span><br><span class="line">      <span class="number">80</span>, <span class="number">32</span>, <span class="number">71</span>, <span class="number">99</span>, <span class="number">15</span>, <span class="number">66</span>, <span class="number">88</span>, <span class="number">21</span>, <span class="number">97</span>, <span class="number">30</span>, <span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">coef = np.polyfit(x, y, <span class="number">3</span>)</span><br><span class="line">model = np.poly1d(coef)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;MSE:<span class="subst">&#123;mean_squared_error(y, model(x)):<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;R2_Score:<span class="subst">&#123;r2_score(y, model(x)):<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.plot(x, model(x) , color=<span class="string">&#x27;red&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.scatter(x, y )</span><br><span class="line">plt.title(<span class="string">&quot;網路購物調查&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;時間&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;購物人數&quot;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># 適合三次函數</span></span><br><span class="line"><span class="comment"># MSE:14.803</span></span><br><span class="line"><span class="comment"># R2_Score:0.944</span></span><br><span class="line"><span class="comment"># 不適合三次函數</span></span><br><span class="line"><span class="comment"># MSE:813.885</span></span><br><span class="line"><span class="comment"># R2_Score:0.151</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic76.png" class="" title="pic76">
</div>

<h3 id="線性迴歸-波士頓房價"><a href="#線性迴歸-波士頓房價" class="headerlink" title="線性迴歸 - 波士頓房價"></a>線性迴歸 - 波士頓房價</h3><h4 id="簡單資料測試"><a href="#簡單資料測試" class="headerlink" title="簡單資料測試"></a>簡單資料測試</h4><h5 id="產生迴歸模型-身高-腰圍與體重的測試"><a href="#產生迴歸模型-身高-腰圍與體重的測試" class="headerlink" title="產生迴歸模型(身高.腰圍與體重的測試)"></a>產生迴歸模型(身高.腰圍與體重的測試)</h5><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic77.png" class="" title="pic77">
</div>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;height&#x27;</span> : [<span class="number">162</span>, <span class="number">160</span>, <span class="number">167</span>, <span class="number">180</span>, <span class="number">177</span>, <span class="number">168</span>, <span class="number">189</span>, <span class="number">182</span>, <span class="number">176</span>, <span class="number">169</span>],</span><br><span class="line">    <span class="string">&#x27;waist&#x27;</span>  : [ <span class="number">71</span>,  <span class="number">81</span>,  <span class="number">70</span>,  <span class="number">90</span>,  <span class="number">95</span>,  <span class="number">80</span>,  <span class="number">78</span>, <span class="number">100</span>,  <span class="number">84</span>,  <span class="number">80</span>],</span><br><span class="line">    <span class="string">&#x27;weight&#x27;</span> : [ <span class="number">53</span>,  <span class="number">62</span>,  <span class="number">58</span>,  <span class="number">71</span>,  <span class="number">72</span>,  <span class="number">69</span>,  <span class="number">80</span>,  <span class="number">91</span>,  <span class="number">78</span>,  <span class="number">70</span>],</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立 DataFrmae</span></span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"><span class="comment"># 建立自變數和目標變數</span></span><br><span class="line">X = df[[<span class="string">&#x27;height&#x27;</span>, <span class="string">&#x27;waist&#x27;</span>]]</span><br><span class="line">y = df[<span class="string">&#x27;weight&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立線性迴歸模型及擬合數據</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line">model.fit(X, y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看模型的截距與係數</span></span><br><span class="line">intercept = model.intercept_</span><br><span class="line">coefficients = model.coef_</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;y截距(b0)  : <span class="subst">&#123;intercept:<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;斜率(b1,b2): <span class="subst">&#123;coefficients.<span class="built_in">round</span>(<span class="number">3</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 組合線性迴歸方程式</span></span><br><span class="line">formula = <span class="string">f&quot;y = <span class="subst">&#123;intercept:<span class="number">.3</span>f&#125;</span>&quot;</span></span><br><span class="line"><span class="keyword">for</span> i, coef <span class="keyword">in</span> <span class="built_in">enumerate</span>(coefficients):</span><br><span class="line">    formula += <span class="string">f&quot; + (<span class="subst">&#123;coef:<span class="number">.3</span>f&#125;</span>)*x<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;線性迴歸方程式:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(formula)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 輸入身高和腰圍</span></span><br><span class="line">h = <span class="built_in">eval</span>(<span class="built_in">input</span>(<span class="string">&quot;請輸入身高:&quot;</span>))</span><br><span class="line">w = <span class="built_in">eval</span>(<span class="built_in">input</span>(<span class="string">&quot;請輸入腰圍:&quot;</span>))</span><br><span class="line"><span class="comment"># 輸入轉成陣列</span></span><br><span class="line">new_weight = pd.DataFrame(np.array([[h,w]]), columns=[<span class="string">&quot;height&quot;</span>, <span class="string">&quot;waist&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(new_weight)</span><br><span class="line"></span><br><span class="line">predicted = model.predict(new_weight)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;預測體重:<span class="subst">&#123;predicted[<span class="number">0</span>]:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># y截距(b0)  : -90.625</span></span><br><span class="line"><span class="comment"># 斜率(b1,b2): [0.689 0.504]</span></span><br><span class="line"><span class="comment"># 線性迴歸方程式:</span></span><br><span class="line"><span class="comment"># y = -90.625 + (0.689)*x1 + (0.504)*x2</span></span><br><span class="line"><span class="comment"># 請輸入身高:170</span></span><br><span class="line"><span class="comment"># 請輸入腰圍:80</span></span><br><span class="line"><span class="comment">#    height  waist</span></span><br><span class="line"><span class="comment"># 0     170     80</span></span><br><span class="line"><span class="comment"># 預測體重:66.87</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 繪製 3D 散點圖</span></span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>, projection=<span class="string">&#x27;3d&#x27;</span>)</span><br><span class="line">ax.scatter(df[<span class="string">&#x27;height&#x27;</span>], df[<span class="string">&#x27;waist&#x27;</span>], df[<span class="string">&#x27;weight&#x27;</span>], color=<span class="string">&#x27;blue&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 創建網格以顯示平面</span></span><br><span class="line">x_surf, y_surf = np.meshgrid(np.linspace(df[<span class="string">&#x27;height&#x27;</span>].<span class="built_in">min</span>(), df[<span class="string">&#x27;height&#x27;</span>].<span class="built_in">max</span>(), <span class="number">100</span>),</span><br><span class="line">                             np.linspace(df[<span class="string">&#x27;waist&#x27;</span>].<span class="built_in">min</span>(), df[<span class="string">&#x27;waist&#x27;</span>].<span class="built_in">max</span>(), <span class="number">100</span>))</span><br><span class="line">z_surf = intercept + coefficients[<span class="number">0</span>] * x_surf + coefficients[<span class="number">1</span>] * y_surf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 繪製擬合平面</span></span><br><span class="line">ax.plot_surface(x_surf, y_surf, z_surf, color=<span class="string">&#x27;red&#x27;</span>, alpha=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 標籤</span></span><br><span class="line">ax.set_xlabel(<span class="string">&#x27;Height&#x27;</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">&#x27;Waist&#x27;</span>)</span><br><span class="line">ax.set_zlabel(<span class="string">&#x27;Weight&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic78.png" class="" title="pic78">
</div>

<h5 id="了解模型的優劣-R-平方係數"><a href="#了解模型的優劣-R-平方係數" class="headerlink" title="了解模型的優劣(R 平方係數)"></a>了解模型的優劣(R 平方係數)</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;height&#x27;</span> : [<span class="number">162</span>, <span class="number">160</span>, <span class="number">167</span>, <span class="number">180</span>, <span class="number">177</span>, <span class="number">168</span>, <span class="number">189</span>, <span class="number">182</span>, <span class="number">176</span>, <span class="number">169</span>],</span><br><span class="line">    <span class="string">&#x27;waist&#x27;</span>  : [ <span class="number">71</span>,  <span class="number">81</span>,  <span class="number">70</span>,  <span class="number">90</span>,  <span class="number">95</span>,  <span class="number">80</span>,  <span class="number">78</span>, <span class="number">100</span>,  <span class="number">84</span>,  <span class="number">80</span>],</span><br><span class="line">    <span class="string">&#x27;weight&#x27;</span> : [ <span class="number">53</span>,  <span class="number">62</span>,  <span class="number">58</span>,  <span class="number">71</span>,  <span class="number">72</span>,  <span class="number">69</span>,  <span class="number">80</span>,  <span class="number">91</span>,  <span class="number">78</span>,  <span class="number">70</span>],</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立 DataFrmae</span></span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"><span class="comment"># 建立自變數和目標變數</span></span><br><span class="line">X = df[[<span class="string">&#x27;height&#x27;</span>, <span class="string">&#x27;waist&#x27;</span>]]</span><br><span class="line">y = df[<span class="string">&#x27;weight&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分割測試數據與測試數據</span></span><br><span class="line">X_train, X_test, y_train, y_test = \</span><br><span class="line">    train_test_split(X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立線性迴歸模型及擬合數據</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line">model.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看模型的截距與係數</span></span><br><span class="line">intercept = model.intercept_</span><br><span class="line">coefficients = model.coef_</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;y截距(b0)  : <span class="subst">&#123;intercept:<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;斜率(b1,b2): <span class="subst">&#123;coefficients.<span class="built_in">round</span>(<span class="number">3</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 組合線性迴歸方程式</span></span><br><span class="line">formula = <span class="string">f&quot;y = <span class="subst">&#123;intercept:<span class="number">.3</span>f&#125;</span>&quot;</span></span><br><span class="line"><span class="keyword">for</span> i, coef <span class="keyword">in</span> <span class="built_in">enumerate</span>(coefficients):</span><br><span class="line">    formula += <span class="string">f&quot; + (<span class="subst">&#123;coef:<span class="number">.3</span>f&#125;</span>)*x<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;線性迴歸方程式:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(formula)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 算預測值</span></span><br><span class="line">y_pred = model.predict(X_test)</span><br><span class="line"><span class="comment"># 計算 R 平方數</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;R2_Score:<span class="subst">&#123;r2_score(y_test, y_pred):<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># y截距(b0)  : -92.547</span></span><br><span class="line"><span class="comment"># 斜率(b1,b2): [0.71  0.482]</span></span><br><span class="line"><span class="comment"># 線性迴歸方程式:</span></span><br><span class="line"><span class="comment"># y = -92.547 + (0.710)*x1 + (0.482)*x2</span></span><br><span class="line"><span class="comment"># R2_Score:0.73</span></span><br></pre></td></tr></table></figure>

<h4 id="波士頓房價數據"><a href="#波士頓房價數據" class="headerlink" title="波士頓房價數據"></a>波士頓房價數據</h4><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic79.png" class="" title="pic79">
</div>

<h5 id="列出資料數據"><a href="#列出資料數據" class="headerlink" title="列出資料數據"></a>列出資料數據</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># boston data url : http://lib.stat.cmu.edu/datasets/boston</span></span><br><span class="line">boston = pd.read_csv(<span class="string">&quot;boston.csv&quot;</span>, sep=<span class="string">&#x27;\s+&#x27;</span>)</span><br><span class="line"><span class="comment"># item0 to item12 data</span></span><br><span class="line">data = boston.iloc[:, :<span class="number">13</span>]</span><br><span class="line"><span class="comment"># item13 data</span></span><br><span class="line">target = boston.iloc[:,<span class="number">13</span>:<span class="number">14</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出資料外型</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;資料外型        : <span class="subst">&#123;boston.shape&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;自變數  樣品外型 : <span class="subst">&#123;data.shape&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;目標變數樣品外型 : <span class="subst">&#123;target.shape&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出3筆 自變數(特徵值)</span></span><br><span class="line"><span class="built_in">print</span>(data.head(<span class="number">3</span>))</span><br><span class="line"><span class="comment"># 列出3筆 目標變數(房價)</span></span><br><span class="line"><span class="built_in">print</span>(target.head(<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 特徵值名稱</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;data.columns&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;target.columns&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 資料外型        : (506, 14)</span></span><br><span class="line"><span class="comment"># 自變數  樣品外型 : (506, 13)</span></span><br><span class="line"><span class="comment"># 目標變數樣品外型 : (506, 1)</span></span><br><span class="line"><span class="comment">#       CRIM    ZN  INDUS  CHAS    NOX     RM   AGE     DIS  RAD    TAX  PTRATIO       B  LSTAT</span></span><br><span class="line"><span class="comment"># 0  0.00632  18.0   2.31     0  0.538  6.575  65.2  4.0900    1  296.0     15.3  396.90   4.98</span></span><br><span class="line"><span class="comment"># 1  0.02731   0.0   7.07     0  0.469  6.421  78.9  4.9671    2  242.0     17.8  396.90   9.14</span></span><br><span class="line"><span class="comment"># 2  0.02729   0.0   7.07     0  0.469  7.185  61.1  4.9671    2  242.0     17.8  392.83   4.03</span></span><br><span class="line"><span class="comment">#    MEDV</span></span><br><span class="line"><span class="comment"># 0  24.0</span></span><br><span class="line"><span class="comment"># 2  34.7</span></span><br><span class="line"><span class="comment"># Index([&#x27;CRIM&#x27;, &#x27;ZN&#x27;, &#x27;INDUS&#x27;, &#x27;CHAS&#x27;, &#x27;NOX&#x27;, &#x27;RM&#x27;, &#x27;AGE&#x27;, &#x27;DIS&#x27;, &#x27;RAD&#x27;, &#x27;TAX&#x27;,</span></span><br><span class="line"><span class="comment">#        &#x27;PTRATIO&#x27;, &#x27;B&#x27;, &#x27;LSTAT&#x27;],</span></span><br><span class="line"><span class="comment">#       dtype=&#x27;object&#x27;)</span></span><br><span class="line"><span class="comment"># Index([&#x27;MEDV&#x27;], dtype=&#x27;object&#x27;)</span></span><br></pre></td></tr></table></figure>

<h5 id="資料處理"><a href="#資料處理" class="headerlink" title="資料處理"></a>資料處理</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># boston data url : http://lib.stat.cmu.edu/datasets/boston</span></span><br><span class="line">boston = pd.read_csv(<span class="string">&quot;boston.csv&quot;</span>, sep=<span class="string">&#x27;\s+&#x27;</span>)</span><br><span class="line"><span class="comment"># item0 to item12 data</span></span><br><span class="line">data = boston.iloc[:, :<span class="number">13</span>]</span><br><span class="line"><span class="comment"># item13 data</span></span><br><span class="line">target = boston.iloc[:,<span class="number">13</span>:<span class="number">14</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 顯示所有 columns</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.max_columns&#x27;</span>, <span class="literal">None</span>)</span><br><span class="line"><span class="comment"># 設定顯示每 row 長度</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.width&#x27;</span>, <span class="number">300</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data.head())</span><br><span class="line"><span class="built_in">print</span>(boston.head())</span><br><span class="line"></span><br><span class="line"><span class="comment"># isnull() 檢查資料缺失</span></span><br><span class="line"><span class="built_in">print</span>(boston.isnull().<span class="built_in">sum</span>())</span><br><span class="line"><span class="comment"># show 出相互皮爾遜相關係數</span></span><br><span class="line"><span class="comment"># &gt; ±.7      相關性強</span></span><br><span class="line"><span class="comment"># ±.3 ~  ±.7 相關性中</span></span><br><span class="line"><span class="comment"># ±.1 ~  ±.3 相關性弱</span></span><br><span class="line"><span class="comment"># ≦ 0.1      相關性無</span></span><br><span class="line"><span class="built_in">print</span>(boston.corr())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用程式挑最有相關的2個特徵</span></span><br><span class="line"><span class="built_in">print</span>(boston.corr().<span class="built_in">abs</span>().nlargest(<span class="number">3</span>, <span class="string">&#x27;MEDV&#x27;</span>).index)</span><br><span class="line"><span class="built_in">print</span>(boston.corr().<span class="built_in">abs</span>().nlargest(<span class="number">3</span>, <span class="string">&#x27;MEDV&#x27;</span>).values[:,<span class="number">13</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#       CRIM    ZN  INDUS  CHAS    NOX     RM   AGE     DIS  RAD    TAX  PTRATIO       B  LSTAT</span></span><br><span class="line"><span class="comment"># 0  0.00632  18.0   2.31     0  0.538  6.575  65.2  4.0900    1  296.0     15.3  396.90   4.98</span></span><br><span class="line"><span class="comment"># 1  0.02731   0.0   7.07     0  0.469  6.421  78.9  4.9671    2  242.0     17.8  396.90   9.14</span></span><br><span class="line"><span class="comment"># 2  0.02729   0.0   7.07     0  0.469  7.185  61.1  4.9671    2  242.0     17.8  392.83   4.03</span></span><br><span class="line"><span class="comment"># 3  0.03237   0.0   2.18     0  0.458  6.998  45.8  6.0622    3  222.0     18.7  394.63   2.94</span></span><br><span class="line"><span class="comment"># 4  0.06905   0.0   2.18     0  0.458  7.147  54.2  6.0622    3  222.0     18.7  396.90   5.33</span></span><br><span class="line"><span class="comment">#       CRIM    ZN  INDUS  CHAS    NOX     RM   AGE     DIS  RAD    TAX  PTRATIO       B  LSTAT  MEDV</span></span><br><span class="line"><span class="comment"># 0  0.00632  18.0   2.31     0  0.538  6.575  65.2  4.0900    1  296.0     15.3  396.90   4.98  24.0</span></span><br><span class="line"><span class="comment"># 1  0.02731   0.0   7.07     0  0.469  6.421  78.9  4.9671    2  242.0     17.8  396.90   9.14  21.6</span></span><br><span class="line"><span class="comment"># 2  0.02729   0.0   7.07     0  0.469  7.185  61.1  4.9671    2  242.0     17.8  392.83   4.03  34.7</span></span><br><span class="line"><span class="comment"># 3  0.03237   0.0   2.18     0  0.458  6.998  45.8  6.0622    3  222.0     18.7  394.63   2.94  33.4</span></span><br><span class="line"><span class="comment"># 4  0.06905   0.0   2.18     0  0.458  7.147  54.2  6.0622    3  222.0     18.7  396.90   5.33  36.2</span></span><br><span class="line"><span class="comment"># CRIM       0</span></span><br><span class="line"><span class="comment"># ZN         0</span></span><br><span class="line"><span class="comment"># INDUS      0</span></span><br><span class="line"><span class="comment"># CHAS       0</span></span><br><span class="line"><span class="comment"># NOX        0</span></span><br><span class="line"><span class="comment"># RM         0</span></span><br><span class="line"><span class="comment"># AGE        0</span></span><br><span class="line"><span class="comment"># DIS        0</span></span><br><span class="line"><span class="comment"># RAD        0</span></span><br><span class="line"><span class="comment"># TAX        0</span></span><br><span class="line"><span class="comment"># PTRATIO    0</span></span><br><span class="line"><span class="comment"># B          0</span></span><br><span class="line"><span class="comment"># LSTAT      0</span></span><br><span class="line"><span class="comment"># MEDV       0</span></span><br><span class="line"><span class="comment"># dtype: int64</span></span><br><span class="line"><span class="comment">#              CRIM        ZN     INDUS      CHAS       NOX        RM       AGE       DIS       RAD       TAX   PTRATIO         B     LSTAT      MEDV</span></span><br><span class="line"><span class="comment"># CRIM     1.000000 -0.300774  0.590822  0.013922  0.634679 -0.190197  0.482013 -0.499501  0.838671  0.793392  0.362615 -0.377013  0.481907 -0.362077</span></span><br><span class="line"><span class="comment"># ZN      -0.300774  1.000000 -0.533828 -0.042697 -0.516604  0.311991 -0.569537  0.664408 -0.311948 -0.314563 -0.391679  0.175520 -0.412995  0.360445</span></span><br><span class="line"><span class="comment"># INDUS    0.590822 -0.533828  1.000000  0.062938  0.763651 -0.391676  0.644779 -0.708027  0.595129  0.720760  0.383248 -0.356977  0.603800 -0.483725</span></span><br><span class="line"><span class="comment"># CHAS     0.013922 -0.042697  0.062938  1.000000  0.091203  0.091251  0.086518 -0.099176 -0.007368 -0.035587 -0.121515  0.048788 -0.053929  0.175260</span></span><br><span class="line"><span class="comment"># NOX      0.634679 -0.516604  0.763651  0.091203  1.000000 -0.302188  0.731470 -0.769230  0.611441  0.668023  0.188933 -0.380051  0.590879 -0.427321</span></span><br><span class="line"><span class="comment"># RM      -0.190197  0.311991 -0.391676  0.091251 -0.302188  1.000000 -0.240265  0.205246 -0.209847 -0.292048 -0.355501  0.128069 -0.613808  0.695360</span></span><br><span class="line"><span class="comment"># AGE      0.482013 -0.569537  0.644779  0.086518  0.731470 -0.240265  1.000000 -0.747881  0.456022  0.506456  0.261515 -0.273534  0.602339 -0.376955</span></span><br><span class="line"><span class="comment"># DIS     -0.499501  0.664408 -0.708027 -0.099176 -0.769230  0.205246 -0.747881  1.000000 -0.494588 -0.534432 -0.232471  0.291512 -0.496996  0.249929</span></span><br><span class="line"><span class="comment"># RAD      0.838671 -0.311948  0.595129 -0.007368  0.611441 -0.209847  0.456022 -0.494588  1.000000  0.910228  0.464741 -0.444413  0.488676 -0.381626</span></span><br><span class="line"><span class="comment"># TAX      0.793392 -0.314563  0.720760 -0.035587  0.668023 -0.292048  0.506456 -0.534432  0.910228  1.000000  0.460853 -0.441808  0.543993 -0.468536</span></span><br><span class="line"><span class="comment"># PTRATIO  0.362615 -0.391679  0.383248 -0.121515  0.188933 -0.355501  0.261515 -0.232471  0.464741  0.460853  1.000000 -0.177383  0.374044 -0.507787</span></span><br><span class="line"><span class="comment"># B       -0.377013  0.175520 -0.356977  0.048788 -0.380051  0.128069 -0.273534  0.291512 -0.444413 -0.441808 -0.177383  1.000000 -0.366087  0.333461</span></span><br><span class="line"><span class="comment"># LSTAT    0.481907 -0.412995  0.603800 -0.053929  0.590879 -0.613808  0.602339 -0.496996  0.488676  0.543993  0.374044 -0.366087  1.000000 -0.737663</span></span><br><span class="line"><span class="comment"># MEDV    -0.362077  0.360445 -0.483725  0.175260 -0.427321  0.695360 -0.376955  0.249929 -0.381626 -0.468536 -0.507787  0.333461 -0.737663  1.000000</span></span><br><span class="line"><span class="comment"># Index([&#x27;MEDV&#x27;, &#x27;LSTAT&#x27;, &#x27;RM&#x27;], dtype=&#x27;object&#x27;)</span></span><br><span class="line"><span class="comment"># [1.         0.73766273 0.69535995]</span></span><br></pre></td></tr></table></figure>

<h4 id="使用最相關特徵做房價預估"><a href="#使用最相關特徵做房價預估" class="headerlink" title="使用最相關特徵做房價預估"></a>使用最相關特徵做房價預估</h4><h5 id="繪製散點圖"><a href="#繪製散點圖" class="headerlink" title="繪製散點圖"></a>繪製散點圖</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 繪製散點圖</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># boston data url : http://lib.stat.cmu.edu/datasets/boston</span></span><br><span class="line">boston = pd.read_csv(<span class="string">&quot;boston.csv&quot;</span>, sep=<span class="string">&#x27;\s+&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立兩個子圖畫布</span></span><br><span class="line">fig, axs = plt.subplots(nrows=<span class="number">1</span>, ncols=<span class="number">2</span>, figsize=(<span class="number">10</span>,<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 繪第1個子圖</span></span><br><span class="line">axs[<span class="number">0</span>].scatter(boston[<span class="string">&#x27;LSTAT&#x27;</span>], boston[<span class="string">&#x27;MEDV&#x27;</span>])</span><br><span class="line">axs[<span class="number">0</span>].set_title(<span class="string">&quot;低收入比例vs房價&quot;</span>)</span><br><span class="line">axs[<span class="number">0</span>].set_xlabel(<span class="string">&quot;低收入比例&quot;</span>)</span><br><span class="line">axs[<span class="number">0</span>].set_ylabel(<span class="string">&quot;房價&quot;</span>)</span><br><span class="line"><span class="comment"># 繪第2個子圖</span></span><br><span class="line">axs[<span class="number">1</span>].scatter(boston[<span class="string">&#x27;RM&#x27;</span>], boston[<span class="string">&#x27;MEDV&#x27;</span>])</span><br><span class="line">axs[<span class="number">1</span>].set_title(<span class="string">&quot;房間數vs房價&quot;</span>)</span><br><span class="line">axs[<span class="number">1</span>].set_xlabel(<span class="string">&quot;房間數&quot;</span>)</span><br><span class="line">axs[<span class="number">1</span>].set_ylabel(<span class="string">&quot;房價&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic80.png" class="" title="pic80">
</div>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 繪製3D散點圖</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># boston data url : http://lib.stat.cmu.edu/datasets/boston</span></span><br><span class="line">boston = pd.read_csv(<span class="string">&quot;boston.csv&quot;</span>, sep=<span class="string">&#x27;\s+&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 畫單張圖</span></span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax = fig.add_subplot(projection=<span class="string">&#x27;3d&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 繪製 3D 圖</span></span><br><span class="line">ax.scatter(boston[<span class="string">&#x27;LSTAT&#x27;</span>], boston[<span class="string">&#x27;RM&#x27;</span>], boston[<span class="string">&#x27;MEDV&#x27;</span>], color=<span class="string">&#x27;b&#x27;</span>)  <span class="comment"># 散佈圖</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># set title</span></span><br><span class="line">ax.set_title(<span class="string">&#x27;3D散點圖&#x27;</span>, fontsize=<span class="number">16</span>, color=<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line"><span class="comment"># set label</span></span><br><span class="line">ax.set_xlabel(<span class="string">&#x27;低收入比例&#x27;</span>, color=<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">&#x27;房間數&#x27;</span>, color=<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line">ax.set_zlabel(<span class="string">&#x27;房價&#x27;</span>, color=<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic81.png" class="" title="pic81">
</div>

<h5 id="獲得-R平方判定係數-截距與係數"><a href="#獲得-R平方判定係數-截距與係數" class="headerlink" title="獲得 R平方判定係數,截距與係數"></a>獲得 R平方判定係數,截距與係數</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 獲得 R平方判定係數,截距與係數</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score</span><br><span class="line"><span class="keyword">from</span> joblib <span class="keyword">import</span> dump</span><br><span class="line"></span><br><span class="line"><span class="comment"># boston data url : http://lib.stat.cmu.edu/datasets/boston</span></span><br><span class="line">boston = pd.read_csv(<span class="string">&quot;boston.csv&quot;</span>, sep=<span class="string">&#x27;\s+&#x27;</span>)</span><br><span class="line"></span><br><span class="line">X = pd.DataFrame(np.c_[boston[<span class="string">&#x27;LSTAT&#x27;</span>], boston[<span class="string">&#x27;RM&#x27;</span>]], columns=[<span class="string">&#x27;LSTAT&#x27;</span>, <span class="string">&#x27;RM&#x27;</span>])</span><br><span class="line">y = boston[<span class="string">&#x27;MEDV&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分割測試數據與測試數據</span></span><br><span class="line">X_train, X_test, y_train, y_test = \</span><br><span class="line">    train_test_split(X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立線性迴歸模型及擬合數據</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line">model.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line">intercept = model.intercept_</span><br><span class="line">coefficients = model.coef_</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;y截距(b0)  : <span class="subst">&#123;intercept:<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;斜率(b1,b2): <span class="subst">&#123;coefficients.<span class="built_in">round</span>(<span class="number">3</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 組合線性迴歸方程式</span></span><br><span class="line">formula = <span class="string">f&quot;y = <span class="subst">&#123;intercept:<span class="number">.3</span>f&#125;</span>&quot;</span></span><br><span class="line"><span class="keyword">for</span> i, coef <span class="keyword">in</span> <span class="built_in">enumerate</span>(coefficients):</span><br><span class="line">    formula += <span class="string">f&quot; + (<span class="subst">&#123;coef:<span class="number">.3</span>f&#125;</span>)*x<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;線性迴歸方程式:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(formula)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 算預測值</span></span><br><span class="line">y_pred = model.predict(X_test)</span><br><span class="line"><span class="comment"># 計算 R 平方數</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;R2_Score:<span class="subst">&#123;r2_score(y_test, y_pred):<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 儲存模型</span></span><br><span class="line">dump(model, <span class="string">&#x27;boston_model.joblib&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># y截距(b0)  : 2.493</span></span><br><span class="line"><span class="comment"># 斜率(b1,b2): [-0.659  4.539]        </span></span><br><span class="line"><span class="comment"># 線性迴歸方程式:</span></span><br><span class="line"><span class="comment"># y = 2.493 + (-0.659)*x1 + (4.539)*x2</span></span><br><span class="line"><span class="comment"># R2_Score:0.675</span></span><br></pre></td></tr></table></figure>

<h5 id="計算預估房價"><a href="#計算預估房價" class="headerlink" title="計算預估房價"></a>計算預估房價</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 計算預估房價</span></span><br><span class="line"><span class="keyword">from</span> joblib <span class="keyword">import</span> load</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 載入模型</span></span><br><span class="line">model = load(<span class="string">&#x27;boston_model.joblib&#x27;</span>)</span><br><span class="line">lstat = <span class="built_in">eval</span>(<span class="built_in">input</span>(<span class="string">&quot;請輸入低收入比例 : &quot;</span>))</span><br><span class="line">rooms = <span class="built_in">eval</span>(<span class="built_in">input</span>(<span class="string">&quot;請輸入房間數     :&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用 模型計算房價</span></span><br><span class="line">data  = pd.DataFrame(np.c_[[lstat], [rooms]], columns =[<span class="string">&#x27;LSTAT&#x27;</span>, <span class="string">&#x27;RM&#x27;</span>])</span><br><span class="line">price_pred = model.predict(data)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;用模型計算房價     : <span class="subst">&#123;price_pred[<span class="number">0</span>]:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用 迴歸公式計算房價</span></span><br><span class="line">intercept = model.intercept_</span><br><span class="line">coeff = model.coef_</span><br><span class="line">price_cal = intercept + coeff[<span class="number">0</span>] * lstat + coeff[<span class="number">1</span>] * rooms</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;用迴歸公式計算房價 : <span class="subst">&#123;price_cal:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 請輸入低收入比例 : 4.98</span></span><br><span class="line"><span class="comment"># 請輸入房間數     :6</span></span><br><span class="line"><span class="comment"># 用模型計算房價     : 26.44</span></span><br><span class="line"><span class="comment"># 用迴歸公式計算房價 : 26.44</span></span><br></pre></td></tr></table></figure>

<h5 id="繪製實際房價與預估房價"><a href="#繪製實際房價與預估房價" class="headerlink" title="繪製實際房價與預估房價"></a>繪製實際房價與預估房價</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 繪製實際房價與預估房價</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># boston data url : http://lib.stat.cmu.edu/datasets/boston</span></span><br><span class="line">boston = pd.read_csv(<span class="string">&quot;boston.csv&quot;</span>, sep=<span class="string">&#x27;\s+&#x27;</span>)</span><br><span class="line"></span><br><span class="line">X = pd.DataFrame(np.c_[boston[<span class="string">&#x27;LSTAT&#x27;</span>], boston[<span class="string">&#x27;RM&#x27;</span>]], columns=[<span class="string">&#x27;LSTAT&#x27;</span>, <span class="string">&#x27;RM&#x27;</span>])</span><br><span class="line">y = boston[<span class="string">&#x27;MEDV&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分割測試數據與測試數據</span></span><br><span class="line">X_train, X_test, y_train, y_test = \</span><br><span class="line">    train_test_split(X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立線性迴歸模型及擬合數據</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line">model.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line">y_pred = model.predict(X_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;真實房價\n <span class="subst">&#123;np.array(y_test.tolist())&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span>*<span class="number">70</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;預測房價\n <span class="subst">&#123;y_pred.<span class="built_in">round</span>(<span class="number">1</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">plt.scatter(y_test, y_pred)</span><br><span class="line">line_x = np.linspace(<span class="number">0</span>, <span class="number">50</span>, <span class="number">100</span>)</span><br><span class="line">plt.plot(line_x, line_x, color=<span class="string">&#x27;red&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&quot;實際房價vs預測房價&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;實際房價&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;預測房價&quot;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 真實房價</span></span><br><span class="line"><span class="comment">#  [28.2 23.9 16.6 22.  20.8 23.  27.9 14.5 21.5 22.6 23.7 31.2 19.3 19.4</span></span><br><span class="line"><span class="comment">#  19.4 27.9 13.9 50.  24.1 14.6 16.2 15.6 23.8 25.  23.5  8.3 13.5 17.5</span></span><br><span class="line"><span class="comment">#  43.1 11.5 24.1 18.5 50.  12.6 19.8 24.5 14.9 36.2 11.9 19.1 22.6 20.7</span></span><br><span class="line"><span class="comment">#  30.1 13.3 14.6  8.4 50.  12.7 25.  18.6 29.8 22.2 28.7 23.8  8.1 22.2</span></span><br><span class="line"><span class="comment">#   6.3 22.1 17.5 48.3 16.7 26.6  8.5 14.5 23.7 37.2 41.7 16.5 21.7 22.7</span></span><br><span class="line"><span class="comment">#  23.  10.5 21.9 21.  20.4 21.8 50.  22.  23.3 37.3 18.  19.2 34.9 13.4</span></span><br><span class="line"><span class="comment">#  22.9 22.5 13.  24.6 18.3 18.1 23.9 50.  13.6 22.9 10.9 18.9 22.4 22.9</span></span><br><span class="line"><span class="comment">#  44.8 21.7 10.2 15.4]</span></span><br><span class="line"><span class="comment"># ----------------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># 預測房價</span></span><br><span class="line"><span class="comment">#  [28.6 28.2 17.5 23.8 20.1 24.1 29.5 21.5 17.7 25.8 28.  30.7 19.5 22.</span></span><br><span class="line"><span class="comment">#  22.1 20.  17.4 39.  25.6  5.4 20.8 17.1 26.2 27.6 28.  13.2 16.8 22.8</span></span><br><span class="line"><span class="comment">#  31.8 13.2 28.7 15.8 37.1 20.  24.4 20.4 19.5 31.4  5.9 20.4 26.4 26.7</span></span><br><span class="line"><span class="comment">#  27.5 14.6 18.7 18.5 36.6 18.4 23.7 24.6 26.5 24.  28.2 23.9  6.  27.4</span></span><br><span class="line"><span class="comment">#   9.3 26.3 20.  37.3 21.7 28.3 15.4 19.7  7.6 30.9 38.7 26.5 22.9 21.4</span></span><br><span class="line"><span class="comment">#  27.1  5.  15.8 24.9 21.  21.8 32.4 26.4 27.2 32.6 21.5 23.  31.6 17.2</span></span><br><span class="line"><span class="comment">#  28.  28.  18.9 28.3 19.5 20.1 30.4 38.6 17.7 21.6 21.1 21.  26.  26.4</span></span><br><span class="line"><span class="comment">#  37.3 22.  18.6 19.5]</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic82.png" class="" title="pic82">
</div>

<h5 id="繪製3D實際房價與預估房價"><a href="#繪製3D實際房價與預估房價" class="headerlink" title="繪製3D實際房價與預估房價"></a>繪製3D實際房價與預估房價</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 繪製3D實際房價與預估房價</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># boston data url : http://lib.stat.cmu.edu/datasets/boston</span></span><br><span class="line">boston = pd.read_csv(<span class="string">&quot;boston.csv&quot;</span>, sep=<span class="string">&#x27;\s+&#x27;</span>)</span><br><span class="line"></span><br><span class="line">X = pd.DataFrame(np.c_[boston[<span class="string">&#x27;LSTAT&#x27;</span>], boston[<span class="string">&#x27;RM&#x27;</span>]], columns=[<span class="string">&#x27;LSTAT&#x27;</span>, <span class="string">&#x27;RM&#x27;</span>])</span><br><span class="line">y = boston[<span class="string">&#x27;MEDV&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分割測試數據與測試數據</span></span><br><span class="line">X_train, X_test, y_train, y_test = \</span><br><span class="line">    train_test_split(X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立線性迴歸模型及擬合數據</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line">model.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line">y_pred = model.predict(X_test)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;真實房價\n <span class="subst">&#123;np.array(y_test.tolist())&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span>*<span class="number">70</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;預測房價\n <span class="subst">&#123;y_pred.<span class="built_in">round</span>(<span class="number">1</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 多單張圖</span></span><br><span class="line">fig = plt.figure(figsize= (<span class="number">10</span>, <span class="number">6</span>))</span><br><span class="line">ax1 = fig.add_subplot(<span class="number">121</span>, projection=<span class="string">&#x27;3d&#x27;</span>)</span><br><span class="line">ax2 = fig.add_subplot(<span class="number">122</span>, projection=<span class="string">&#x27;3d&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ax1</span></span><br><span class="line"><span class="comment"># 繪製 3D 圖</span></span><br><span class="line">ax1.scatter(boston[<span class="string">&#x27;LSTAT&#x27;</span>], boston[<span class="string">&#x27;RM&#x27;</span>], boston[<span class="string">&#x27;MEDV&#x27;</span>], color=<span class="string">&#x27;b&#x27;</span>)  <span class="comment"># 散佈圖</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 繪製擬合平面</span></span><br><span class="line">x = np.arange(<span class="number">0</span>, <span class="number">40</span>, <span class="number">1</span>)    <span class="comment"># 低收入比例</span></span><br><span class="line">y = np.arange(<span class="number">0</span>, <span class="number">10</span>, <span class="number">1</span>)    <span class="comment"># 房間數</span></span><br><span class="line">x_surf1, y_surf1 = np.meshgrid(x, y)</span><br><span class="line">z = <span class="keyword">lambda</span> x, y: (model.intercept_ + model.coef_[<span class="number">0</span>]*x + model.coef_[<span class="number">1</span>]*y)</span><br><span class="line">ax1.plot_surface(x_surf1, y_surf1, z(x_surf1, y_surf1), color=<span class="string">&#x27;None&#x27;</span>, alpha=<span class="number">0.2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># set title</span></span><br><span class="line">ax1.set_title(<span class="string">&#x27;真實房價vs預估房價&#x27;</span>, fontsize=<span class="number">16</span>, color=<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line"><span class="comment"># set label</span></span><br><span class="line">ax1.set_xlabel(<span class="string">&#x27;低收入比例&#x27;</span>, color=<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line">ax1.set_ylabel(<span class="string">&#x27;房間數&#x27;</span>, color=<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line">ax1.set_zlabel(<span class="string">&#x27;房價&#x27;</span>, color=<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ax2</span></span><br><span class="line"><span class="comment"># 繪製 3D 圖</span></span><br><span class="line">ax2.scatter(boston[<span class="string">&#x27;LSTAT&#x27;</span>], boston[<span class="string">&#x27;RM&#x27;</span>], boston[<span class="string">&#x27;MEDV&#x27;</span>], color=<span class="string">&#x27;b&#x27;</span>)  <span class="comment"># 散佈圖</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 繪製擬合平面</span></span><br><span class="line">ax2.plot_surface(x_surf1, y_surf1, z(x_surf1, y_surf1), color=<span class="string">&#x27;None&#x27;</span>, alpha=<span class="number">0.2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># set title</span></span><br><span class="line">ax2.set_title(<span class="string">&#x27;真實房價vs預估房價&#x27;</span>, fontsize=<span class="number">16</span>, color=<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line"><span class="comment"># set label</span></span><br><span class="line">ax2.set_xlabel(<span class="string">&#x27;低收入比例&#x27;</span>, color=<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line">ax2.set_ylabel(<span class="string">&#x27;房間數&#x27;</span>, color=<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line">ax2.set_zlabel(<span class="string">&#x27;房價&#x27;</span>, color=<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更改視角</span></span><br><span class="line">ax2.view_init(elev=<span class="number">30</span>, azim=<span class="number">45</span>)</span><br><span class="line"><span class="comment"># 在 z 軸方向上抬高 30 度，同時在 xy 平面內旋轉 45 度。也就是說，觀察者的視角是在 z 軸上方 30 度，並且從 x 軸方向向 y 軸方向旋轉了 45 度。</span></span><br><span class="line"><span class="comment"># elev (elevation)：高度角，表示從 xy 平面向上的角度。這個參數控制視角在 z 軸方向上的旋轉。</span></span><br><span class="line"><span class="comment">#     當 elev=0 時，視角與 xy 平面平行。</span></span><br><span class="line"><span class="comment">#     當 elev=90 時，視角在 z 軸的正上方。</span></span><br><span class="line"><span class="comment"># azim (azimuth)：方位角，表示從 x 軸方向開始在 xy 平面內的旋轉角度。這個參數控制視角在 xy 平面內的旋轉。</span></span><br><span class="line"><span class="comment">#     當 azim=0 時，視角沿著 x 軸正方向。</span></span><br><span class="line"><span class="comment">#     當 azim=90 時，視角沿著 y 軸正方向。</span></span><br><span class="line"><span class="comment">#     當 azim=45 時，視角位於 x 軸和 y 軸之間的 45 度角處。</span></span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 真實房價</span></span><br><span class="line"><span class="comment">#  [28.2 23.9 16.6 22.  20.8 23.  27.9 14.5 21.5 22.6 23.7 31.2 19.3 19.4</span></span><br><span class="line"><span class="comment">#  19.4 27.9 13.9 50.  24.1 14.6 16.2 15.6 23.8 25.  23.5  8.3 13.5 17.5</span></span><br><span class="line"><span class="comment">#  43.1 11.5 24.1 18.5 50.  12.6 19.8 24.5 14.9 36.2 11.9 19.1 22.6 20.7</span></span><br><span class="line"><span class="comment">#  30.1 13.3 14.6  8.4 50.  12.7 25.  18.6 29.8 22.2 28.7 23.8  8.1 22.2</span></span><br><span class="line"><span class="comment">#   6.3 22.1 17.5 48.3 16.7 26.6  8.5 14.5 23.7 37.2 41.7 16.5 21.7 22.7</span></span><br><span class="line"><span class="comment">#  23.  10.5 21.9 21.  20.4 21.8 50.  22.  23.3 37.3 18.  19.2 34.9 13.4</span></span><br><span class="line"><span class="comment">#  22.9 22.5 13.  24.6 18.3 18.1 23.9 50.  13.6 22.9 10.9 18.9 22.4 22.9</span></span><br><span class="line"><span class="comment">#  44.8 21.7 10.2 15.4]</span></span><br><span class="line"><span class="comment"># ----------------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># 預測房價</span></span><br><span class="line"><span class="comment">#  [28.6 28.2 17.5 23.8 20.1 24.1 29.5 21.5 17.7 25.8 28.  30.7 19.5 22.</span></span><br><span class="line"><span class="comment">#  22.1 20.  17.4 39.  25.6  5.4 20.8 17.1 26.2 27.6 28.  13.2 16.8 22.8</span></span><br><span class="line"><span class="comment">#  31.8 13.2 28.7 15.8 37.1 20.  24.4 20.4 19.5 31.4  5.9 20.4 26.4 26.7</span></span><br><span class="line"><span class="comment">#  27.5 14.6 18.7 18.5 36.6 18.4 23.7 24.6 26.5 24.  28.2 23.9  6.  27.4</span></span><br><span class="line"><span class="comment">#   9.3 26.3 20.  37.3 21.7 28.3 15.4 19.7  7.6 30.9 38.7 26.5 22.9 21.4</span></span><br><span class="line"><span class="comment">#  27.1  5.  15.8 24.9 21.  21.8 32.4 26.4 27.2 32.6 21.5 23.  31.6 17.2</span></span><br><span class="line"><span class="comment">#  28.  28.  18.9 28.3 19.5 20.1 30.4 38.6 17.7 21.6 21.1 21.  26.  26.4</span></span><br><span class="line"><span class="comment">#  37.3 22.  18.6 19.5]</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic83.png" class="" title="pic83">
</div>

<h4 id="多項式迴歸"><a href="#多項式迴歸" class="headerlink" title="多項式迴歸"></a>多項式迴歸</h4><h5 id="繪製散點圖及迴歸直線"><a href="#繪製散點圖及迴歸直線" class="headerlink" title="繪製散點圖及迴歸直線"></a>繪製散點圖及迴歸直線</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一元一次迴歸公式</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;data23_19.csv&#x27;</span>)</span><br><span class="line"></span><br><span class="line">X = pd.DataFrame(df.x)</span><br><span class="line">y = df.y</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(X)</span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line"></span><br><span class="line">model = LinearRegression()</span><br><span class="line">model.fit(X,y)</span><br><span class="line">y_pred = model.predict(X)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;R2_score = <span class="subst">&#123;model.score(X, y):<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.plot(X, y_pred, color=<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line">plt.scatter(df.x, df.y)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment">#    x    y</span></span><br><span class="line"><span class="comment"># 0  1  1.5</span></span><br><span class="line"><span class="comment"># 1  2  3.0</span></span><br><span class="line"><span class="comment"># 2  3  4.5</span></span><br><span class="line"><span class="comment"># 3  4  4.2</span></span><br><span class="line"><span class="comment"># 4  5  5.2</span></span><br><span class="line"><span class="comment"># 5  6  5.5</span></span><br><span class="line"><span class="comment">#    x</span></span><br><span class="line"><span class="comment"># 0  1</span></span><br><span class="line"><span class="comment"># 1  2</span></span><br><span class="line"><span class="comment"># 2  3</span></span><br><span class="line"><span class="comment"># 3  4</span></span><br><span class="line"><span class="comment"># 4  5</span></span><br><span class="line"><span class="comment"># 5  6</span></span><br><span class="line"><span class="comment"># 0    1.5</span></span><br><span class="line"><span class="comment"># 1    3.0</span></span><br><span class="line"><span class="comment"># 2    4.5</span></span><br><span class="line"><span class="comment"># 3    4.2</span></span><br><span class="line"><span class="comment"># 4    5.2</span></span><br><span class="line"><span class="comment"># 5    5.5</span></span><br><span class="line"><span class="comment"># Name: y, dtype: float64</span></span><br><span class="line"><span class="comment"># R2_score = 0.880</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic84.png" class="" title="pic84">
</div>

<h5 id="生成一元二次特徵"><a href="#生成一元二次特徵" class="headerlink" title="生成一元二次特徵"></a>生成一元二次特徵</h5><p>fit_transform() 結合 fit() 和 transform():</p>
<ul>
<li>fit() : 用於學習模型參數</li>
<li>transform() : 利用fit()得到的參數來變換數據</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 生成一元二次多項式特徵值</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> PolynomialFeatures</span><br><span class="line"></span><br><span class="line"><span class="comment"># 設定基本數據</span></span><br><span class="line">X = np.array([[<span class="number">1</span>], [<span class="number">2</span>], [<span class="number">3</span>], [<span class="number">4</span>]])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 PolynomialFeatures 生成一元二次特徵</span></span><br><span class="line"><span class="comment"># 生成二次多項式</span></span><br><span class="line">degree = <span class="number">2</span></span><br><span class="line">poly = PolynomialFeatures(degree)</span><br><span class="line"><span class="comment"># fit : 學習數據的參數</span></span><br><span class="line"><span class="comment"># transform : 加入數據</span></span><br><span class="line">X_poly = poly.fit_transform(X)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(X)</span><br><span class="line"><span class="comment"># 列印生成多項式特徵</span></span><br><span class="line"><span class="built_in">print</span>(poly.get_feature_names_out(input_features=[<span class="string">&#x27;x&#x27;</span>]))</span><br><span class="line"><span class="built_in">print</span>(X_poly)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 PolynomialFeatures 生成一元四次特徵</span></span><br><span class="line">degree = <span class="number">4</span></span><br><span class="line">poly4 = PolynomialFeatures(degree)</span><br><span class="line">X_poly4 = poly4.fit_transform(X)</span><br><span class="line"><span class="built_in">print</span>(poly4.get_feature_names_out(input_features=[<span class="string">&#x27;x&#x27;</span>]))</span><br><span class="line"><span class="built_in">print</span>(X_poly4)</span><br><span class="line"></span><br><span class="line"><span class="comment"># [[1]</span></span><br><span class="line"><span class="comment">#  [2]</span></span><br><span class="line"><span class="comment">#  [3]</span></span><br><span class="line"><span class="comment">#  [4]]</span></span><br><span class="line"><span class="comment"># [&#x27;1&#x27; &#x27;x&#x27; &#x27;x^2&#x27;]</span></span><br><span class="line"><span class="comment"># [[ 1.  1.  1.]</span></span><br><span class="line"><span class="comment">#  [ 1.  2.  4.]</span></span><br><span class="line"><span class="comment">#  [ 1.  3.  9.]</span></span><br><span class="line"><span class="comment">#  [ 1.  4. 16.]]</span></span><br><span class="line"><span class="comment"># [&#x27;1&#x27; &#x27;x&#x27; &#x27;x^2&#x27; &#x27;x^3&#x27; &#x27;x^4&#x27;]</span></span><br><span class="line"><span class="comment"># [[  1.   1.   1.   1.   1.]</span></span><br><span class="line"><span class="comment">#  [  1.   2.   4.   8.  16.]</span></span><br><span class="line"><span class="comment">#  [  1.   3.   9.  27.  81.]</span></span><br><span class="line"><span class="comment">#  [  1.   4.  16.  64. 256.]]</span></span><br></pre></td></tr></table></figure>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> PolynomialFeatures</span><br><span class="line"></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;data23_19.csv&#x27;</span>)</span><br><span class="line">X = pd.DataFrame(df.x)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"><span class="built_in">print</span>(X)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 PolynomialFeatures 生成一元二次特徵</span></span><br><span class="line">degree = <span class="number">2</span></span><br><span class="line">poly = PolynomialFeatures(degree)</span><br><span class="line">X_poly = poly.fit_transform(X)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列印生成多項式特徵</span></span><br><span class="line"><span class="built_in">print</span>(poly.get_feature_names_out())</span><br><span class="line"><span class="built_in">print</span>(X_poly)</span><br><span class="line"></span><br><span class="line"><span class="comment">#   x    y</span></span><br><span class="line"><span class="comment"># 0  1  1.5</span></span><br><span class="line"><span class="comment"># 1  2  3.0</span></span><br><span class="line"><span class="comment"># 2  3  4.5</span></span><br><span class="line"><span class="comment"># 3  4  4.2</span></span><br><span class="line"><span class="comment"># 4  5  5.2</span></span><br><span class="line"><span class="comment"># 5  6  5.5</span></span><br><span class="line"><span class="comment">#    x</span></span><br><span class="line"><span class="comment"># 0  1</span></span><br><span class="line"><span class="comment"># 1  2</span></span><br><span class="line"><span class="comment"># 2  3</span></span><br><span class="line"><span class="comment"># 3  4</span></span><br><span class="line"><span class="comment"># 4  5</span></span><br><span class="line"><span class="comment"># 5  6</span></span><br><span class="line"><span class="comment"># [&#x27;1&#x27; &#x27;x&#x27; &#x27;x^2&#x27;]</span></span><br><span class="line"><span class="comment"># [[ 1.  1.  1.]</span></span><br><span class="line"><span class="comment">#  [ 1.  2.  4.]</span></span><br><span class="line"><span class="comment">#  [ 1.  3.  9.]</span></span><br><span class="line"><span class="comment">#  [ 1.  4. 16.]</span></span><br><span class="line"><span class="comment">#  [ 1.  5. 25.]</span></span><br><span class="line"><span class="comment">#  [ 1.  6. 36.]]</span></span><br></pre></td></tr></table></figure>

<h5 id="多項式特徵應用在-LinearRegression"><a href="#多項式特徵應用在-LinearRegression" class="headerlink" title="多項式特徵應用在 LinearRegression"></a>多項式特徵應用在 LinearRegression</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> PolynomialFeatures</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;data23_19.csv&#x27;</span>)</span><br><span class="line">X = pd.DataFrame(df.x)</span><br><span class="line">y = df.y</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 PolynomialFeatures 生成一元二次特徵</span></span><br><span class="line"><span class="comment"># degree = 2</span></span><br><span class="line"><span class="comment"># degree = 3</span></span><br><span class="line">degree = <span class="number">5</span></span><br><span class="line">poly = PolynomialFeatures(degree)</span><br><span class="line">X_poly = poly.fit_transform(X)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立一元二次多項式迴歸模型</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line">model.fit(X_poly, y)</span><br><span class="line">y_poly_pred = model.predict(X_poly)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 輸出 R 平方係數</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;R2 score = <span class="subst">&#123;model.score(X_poly, y):<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 截距與斜率</span></span><br><span class="line">intercept =  model.intercept_</span><br><span class="line">coeff = model.coef_</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;截距 : <span class="subst">&#123;intercept:<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;係數  : <span class="subst">&#123;coeff.<span class="built_in">round</span>(<span class="number">3</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立兩個子圖畫布</span></span><br><span class="line">fig, axs = plt.subplots(nrows=<span class="number">1</span>, ncols=<span class="number">2</span>, figsize=(<span class="number">10</span>,<span class="number">5</span>))</span><br><span class="line"><span class="comment"># 繪第1個子圖</span></span><br><span class="line">axs[<span class="number">0</span>].scatter(X, y)</span><br><span class="line">axs[<span class="number">0</span>].scatter(X, y_poly_pred, color=<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">axs[<span class="number">0</span>].plot(X, y_poly_pred)</span><br><span class="line"><span class="comment"># axs[0].set_title(&quot;一元二次迴歸模型 - 點的連線&quot;)</span></span><br><span class="line"><span class="comment"># axs[0].set_title(&quot;一元三次迴歸模型 - 點的連線&quot;)</span></span><br><span class="line">axs[<span class="number">0</span>].set_title(<span class="string">&quot;一元五次迴歸模型 - 點的連線&quot;</span>)</span><br><span class="line"><span class="comment"># 繪第2個子圖</span></span><br><span class="line">xx = np.linspace(<span class="number">1</span>, <span class="number">6</span>, <span class="number">100</span>)</span><br><span class="line"><span class="comment"># y_curf = lambda x: (intercept + coeff[1]*x + coeff[2]*x*x)</span></span><br><span class="line"><span class="comment"># y_curf = lambda x: (intercept + coeff[1]*x + coeff[2]*x*x + coeff[3]*x**3)</span></span><br><span class="line">y_curf = <span class="keyword">lambda</span> x: (intercept + coeff[<span class="number">1</span>]*x + coeff[<span class="number">2</span>]*x**<span class="number">2</span> + coeff[<span class="number">3</span>]*x**<span class="number">3</span> + coeff[<span class="number">4</span>]*x**<span class="number">4</span> + coeff[<span class="number">5</span>]*x**<span class="number">5</span>)</span><br><span class="line">axs[<span class="number">1</span>].plot(xx, y_curf(xx))</span><br><span class="line">axs[<span class="number">1</span>].scatter(X, y)</span><br><span class="line"><span class="comment"># axs[1].set_title(&quot;一元二次迴歸模型 - 曲線&quot;)</span></span><br><span class="line"><span class="comment"># axs[1].set_title(&quot;一元三次迴歸模型 - 曲線&quot;)</span></span><br><span class="line">axs[<span class="number">1</span>].set_title(<span class="string">&quot;一元五次迴歸模型 - 曲線&quot;</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># === 一元二次特徵 ====</span></span><br><span class="line"><span class="comment"># R2 score = 0.95</span></span><br><span class="line"><span class="comment"># 截距 : 0.020</span></span><br><span class="line"><span class="comment"># 係數  : [ 0.     1.751 -0.143]</span></span><br><span class="line"><span class="comment"># === 一元三次特徵 ====</span></span><br><span class="line"><span class="comment"># R2 score = 0.96</span></span><br><span class="line"><span class="comment"># 截距 : -1.333</span></span><br><span class="line"><span class="comment"># 係數  : [ 0.     3.454 -0.707  0.054]</span></span><br><span class="line"><span class="comment"># === 一元五次特徵 ====</span></span><br><span class="line"><span class="comment"># R2 score = 1.00</span></span><br><span class="line"><span class="comment"># 截距 : 16.700</span></span><br><span class="line"><span class="comment"># 係數  : [  0.    -34.842  27.696  -9.425   1.454  -0.083]</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic85.png" class="" title="pic85">
</div>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic86.png" class="" title="pic86">
</div>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic87.png" class="" title="pic87">
</div>

<h5 id="機器學習的理想模型"><a href="#機器學習的理想模型" class="headerlink" title="機器學習的理想模型"></a>機器學習的理想模型</h5><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic88.png" class="" title="pic88">
</div>

<h5 id="使用二元二次方程式做房價預估"><a href="#使用二元二次方程式做房價預估" class="headerlink" title="使用二元二次方程式做房價預估"></a>使用二元二次方程式做房價預估</h5><h6 id="計算-R-score"><a href="#計算-R-score" class="headerlink" title="計算 R score"></a>計算 R score</h6><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 二元二次多項式模型</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> PolynomialFeatures</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score</span><br><span class="line"><span class="keyword">from</span> joblib <span class="keyword">import</span> dump</span><br><span class="line"></span><br><span class="line"><span class="comment"># boston data url : http://lib.stat.cmu.edu/datasets/boston</span></span><br><span class="line">boston = pd.read_csv(<span class="string">&quot;boston.csv&quot;</span>, sep=<span class="string">&#x27;\s+&#x27;</span>)</span><br><span class="line"></span><br><span class="line">X = pd.DataFrame(np.c_[boston[<span class="string">&#x27;LSTAT&#x27;</span>], boston[<span class="string">&#x27;RM&#x27;</span>]], columns=[<span class="string">&#x27;LSTAT&#x27;</span>, <span class="string">&#x27;RM&#x27;</span>])</span><br><span class="line">y = boston[<span class="string">&#x27;MEDV&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分割測試數據與測試數據</span></span><br><span class="line">X_train, X_test, y_train, y_test = \</span><br><span class="line">    train_test_split(X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 PolynomialFeatures 生成二元二次特徵</span></span><br><span class="line">degree = <span class="number">2</span></span><br><span class="line">poly = PolynomialFeatures(degree)</span><br><span class="line">X_train_poly = poly.fit_transform(X_train)</span><br><span class="line"><span class="comment"># correct</span></span><br><span class="line">X_test_poly = poly.transform(X_test)</span><br><span class="line"><span class="comment"># not correct</span></span><br><span class="line"><span class="comment"># X_test_poly = poly.fit_transform(X_test)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立二元二次多項式迴歸模型</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line">model.fit(X_train_poly, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 計算 R 平方數</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;R score : <span class="subst">&#123;model.score(X_test_poly, y_test)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看模型截距與係數</span></span><br><span class="line">intercept = model.intercept_</span><br><span class="line">coeff = model.coef_</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;截距 : <span class="subst">&#123;intercept&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 多項式特徵</span></span><br><span class="line"><span class="built_in">print</span>(poly.get_feature_names_out())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;係數 : <span class="subst">&#123;coeff&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># R score : 0.8217783992497054</span></span><br><span class="line"><span class="comment"># 截距 : 62.51039478281932</span></span><br><span class="line"><span class="comment"># [&#x27;1&#x27; &#x27;LSTAT&#x27; &#x27;RM&#x27; &#x27;LSTAT^2&#x27; &#x27;LSTAT RM&#x27; &#x27;RM^2&#x27;]</span></span><br><span class="line"><span class="comment"># 係數 : [ 0.00000000e+00  3.28222887e-01 -1.54871817e+01  8.58456016e-03</span></span><br><span class="line"><span class="comment">#  -2.22945786e-01  1.71576436e+00]</span></span><br></pre></td></tr></table></figure>

<h6 id="計算預估房價-1"><a href="#計算預估房價-1" class="headerlink" title="計算預估房價"></a>計算預估房價</h6><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 二元二次多項式模型 - 計算預估房價</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> PolynomialFeatures</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score</span><br><span class="line"><span class="keyword">from</span> joblib <span class="keyword">import</span> dump</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># boston data url : http://lib.stat.cmu.edu/datasets/boston</span></span><br><span class="line">boston = pd.read_csv(<span class="string">&quot;boston.csv&quot;</span>, sep=<span class="string">&#x27;\s+&#x27;</span>)</span><br><span class="line"></span><br><span class="line">X = pd.DataFrame(np.c_[boston[<span class="string">&#x27;LSTAT&#x27;</span>], boston[<span class="string">&#x27;RM&#x27;</span>]], columns=[<span class="string">&#x27;LSTAT&#x27;</span>, <span class="string">&#x27;RM&#x27;</span>])</span><br><span class="line">y = boston[<span class="string">&#x27;MEDV&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分割測試數據與測試數據</span></span><br><span class="line">X_train, X_test, y_train, y_test = \</span><br><span class="line">    train_test_split(X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 PolynomialFeatures 生成二元二次特徵</span></span><br><span class="line">degree = <span class="number">2</span></span><br><span class="line">poly = PolynomialFeatures(degree)</span><br><span class="line">X_train_poly = poly.fit_transform(X_train)</span><br><span class="line"><span class="comment"># correct</span></span><br><span class="line">X_test_poly = poly.transform(X_test)</span><br><span class="line"><span class="comment"># not correct</span></span><br><span class="line"><span class="comment"># X_test_poly = poly.fit_transform(X_test)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立二元二次多項式迴歸模型</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line">model.fit(X_train_poly, y_train)</span><br><span class="line"></span><br><span class="line">y_pred = model.predict(X_test_poly)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;實際房價\n<span class="subst">&#123;np.array(y_test.tolist())&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span>*<span class="number">70</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;預估房價\n<span class="subst">&#123;y_pred.<span class="built_in">round</span>(<span class="number">1</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">plt.scatter(y_test, y_pred)</span><br><span class="line">line_x = np.linspace(<span class="number">0</span>, <span class="number">50</span>, <span class="number">100</span>)</span><br><span class="line">plt.plot(line_x, line_x, color=<span class="string">&#x27;red&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&quot;實際房價vs預測房價&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;實際房價&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;預測房價&quot;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 實際房價</span></span><br><span class="line"><span class="comment"># [28.2 23.9 16.6 22.  20.8 23.  27.9 14.5 21.5 22.6 23.7 31.2 19.3 19.4</span></span><br><span class="line"><span class="comment">#  19.4 27.9 13.9 50.  24.1 14.6 16.2 15.6 23.8 25.  23.5  8.3 13.5 17.5</span></span><br><span class="line"><span class="comment">#  43.1 11.5 24.1 18.5 50.  12.6 19.8 24.5 14.9 36.2 11.9 19.1 22.6 20.7</span></span><br><span class="line"><span class="comment">#  30.1 13.3 14.6  8.4 50.  12.7 25.  18.6 29.8 22.2 28.7 23.8  8.1 22.2</span></span><br><span class="line"><span class="comment">#   6.3 22.1 17.5 48.3 16.7 26.6  8.5 14.5 23.7 37.2 41.7 16.5 21.7 22.7</span></span><br><span class="line"><span class="comment">#  23.  10.5 21.9 21.  20.4 21.8 50.  22.  23.3 37.3 18.  19.2 34.9 13.4</span></span><br><span class="line"><span class="comment">#  22.9 22.5 13.  24.6 18.3 18.1 23.9 50.  13.6 22.9 10.9 18.9 22.4 22.9</span></span><br><span class="line"><span class="comment">#  44.8 21.7 10.2 15.4]</span></span><br><span class="line"><span class="comment"># ----------------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># 預估房價</span></span><br><span class="line"><span class="comment"># [28.4 27.8 15.4 23.4 20.9 22.4 30.  19.8 16.  24.7 27.6 31.8 18.8 21.4</span></span><br><span class="line"><span class="comment">#  20.8 19.7 13.2 50.7 24.9 12.6 20.3 16.6 25.  27.3 28.1 11.9 14.4 21.7</span></span><br><span class="line"><span class="comment">#  33.7 14.4 28.9 15.5 44.7 17.5 23.4 19.1 16.7 33.  18.6 18.4 25.8 26.2</span></span><br><span class="line"><span class="comment">#  26.9 12.  16.2 14.  43.4 17.  22.6 23.  24.9 22.3 28.3 22.2 11.7 26.9</span></span><br><span class="line"><span class="comment">#   9.1 26.1 18.4 45.6 19.1 28.1 14.6 16.8 10.5 32.  48.9 25.5 21.8 20.4</span></span><br><span class="line"><span class="comment">#  26.8 14.4 18.7 22.9 19.1 21.2 34.7 25.5 26.6 35.1 18.9 21.9 33.2 13.1</span></span><br><span class="line"><span class="comment">#  27.9 28.1 15.7 28.5 18.5 17.3 31.3 49.7 15.9 20.2 19.  19.5 24.7 25.5</span></span><br><span class="line"><span class="comment">#  45.6 20.2 17.4 16.2]</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic89.png" class="" title="pic89">
</div>

<h5 id="繪製3D實際房價vs預估房價"><a href="#繪製3D實際房價vs預估房價" class="headerlink" title="繪製3D實際房價vs預估房價"></a>繪製3D實際房價vs預估房價</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 二元二次多項式模型</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> PolynomialFeatures</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score</span><br><span class="line"><span class="keyword">from</span> joblib <span class="keyword">import</span> dump</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># boston data url : http://lib.stat.cmu.edu/datasets/boston</span></span><br><span class="line">boston = pd.read_csv(<span class="string">&quot;boston.csv&quot;</span>, sep=<span class="string">&#x27;\s+&#x27;</span>)</span><br><span class="line"></span><br><span class="line">X = pd.DataFrame(np.c_[boston[<span class="string">&#x27;LSTAT&#x27;</span>], boston[<span class="string">&#x27;RM&#x27;</span>]], columns=[<span class="string">&#x27;LSTAT&#x27;</span>, <span class="string">&#x27;RM&#x27;</span>])</span><br><span class="line">y = boston[<span class="string">&#x27;MEDV&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分割測試數據與測試數據</span></span><br><span class="line">X_train, X_test, y_train, y_test = \</span><br><span class="line">    train_test_split(X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 PolynomialFeatures 生成二元二次特徵</span></span><br><span class="line">degree = <span class="number">2</span></span><br><span class="line">poly = PolynomialFeatures(degree)</span><br><span class="line">X_train_poly = poly.fit_transform(X_train)</span><br><span class="line"><span class="comment"># # correct</span></span><br><span class="line"><span class="comment"># X_test_poly = poly.transform(X_test)</span></span><br><span class="line"><span class="comment"># not correct</span></span><br><span class="line"><span class="comment"># X_test_poly = poly.fit_transform(X_test)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立二元二次多項式迴歸模型</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line">model.fit(X_train_poly, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># y_pred = model.predict(X_test_poly)</span></span><br><span class="line"><span class="comment"># print(f&quot;實際房價\n&#123;np.array(y_test.tolist())&#125;&quot;)</span></span><br><span class="line"><span class="comment"># print(&quot;-&quot;*70)</span></span><br><span class="line"><span class="comment"># print(f&quot;預估房價\n&#123;y_pred.round(1)&#125;&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看模型截距與係數</span></span><br><span class="line">intercept = model.intercept_</span><br><span class="line">coeff = model.coef_</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 多單張圖</span></span><br><span class="line">fig = plt.figure(figsize= (<span class="number">10</span>, <span class="number">6</span>))</span><br><span class="line">ax1 = fig.add_subplot(<span class="number">121</span>, projection=<span class="string">&#x27;3d&#x27;</span>)</span><br><span class="line">ax2 = fig.add_subplot(<span class="number">122</span>, projection=<span class="string">&#x27;3d&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ax1</span></span><br><span class="line"><span class="comment"># 繪製 3D 圖</span></span><br><span class="line">ax1.scatter(boston[<span class="string">&#x27;LSTAT&#x27;</span>], boston[<span class="string">&#x27;RM&#x27;</span>], boston[<span class="string">&#x27;MEDV&#x27;</span>], color=<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 繪製擬合平面</span></span><br><span class="line">x = np.arange(<span class="number">0</span>, <span class="number">40</span>, <span class="number">1</span>)    <span class="comment"># 低收入比例</span></span><br><span class="line">y = np.arange(<span class="number">0</span>, <span class="number">10</span>, <span class="number">1</span>)    <span class="comment"># 房間數</span></span><br><span class="line">x_surf1, y_surf1 = np.meshgrid(x, y)</span><br><span class="line">z = <span class="keyword">lambda</span> x, y: (model.intercept_ + \</span><br><span class="line">                  model.coef_[<span class="number">1</span>]*x + \</span><br><span class="line">                  model.coef_[<span class="number">2</span>]*y + \</span><br><span class="line">                  model.coef_[<span class="number">3</span>]*x**<span class="number">2</span> + \</span><br><span class="line">                  model.coef_[<span class="number">4</span>]*x*y + \</span><br><span class="line">                  model.coef_[<span class="number">5</span>]*y**<span class="number">2</span> )</span><br><span class="line">ax1.plot_surface(x_surf1, y_surf1, z(x_surf1, y_surf1), color=<span class="string">&#x27;None&#x27;</span>, alpha=<span class="number">0.2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># set title</span></span><br><span class="line">ax1.set_title(<span class="string">&#x27;真實房價vs預估房價&#x27;</span>, fontsize=<span class="number">16</span>, color=<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line"><span class="comment"># set label</span></span><br><span class="line">ax1.set_xlabel(<span class="string">&#x27;低收入比例&#x27;</span>, color=<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line">ax1.set_ylabel(<span class="string">&#x27;房間數&#x27;</span>, color=<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line">ax1.set_zlabel(<span class="string">&#x27;房價&#x27;</span>, color=<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ax2</span></span><br><span class="line"><span class="comment"># 繪製 3D 圖</span></span><br><span class="line">ax2.scatter(boston[<span class="string">&#x27;LSTAT&#x27;</span>], boston[<span class="string">&#x27;RM&#x27;</span>], boston[<span class="string">&#x27;MEDV&#x27;</span>], color=<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 繪製擬合平面</span></span><br><span class="line">ax2.plot_surface(x_surf1, y_surf1, z(x_surf1, y_surf1), color=<span class="string">&#x27;None&#x27;</span>, alpha=<span class="number">0.2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># set title</span></span><br><span class="line">ax2.set_title(<span class="string">&#x27;真實房價vs預估房價&#x27;</span>, fontsize=<span class="number">16</span>, color=<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line"><span class="comment"># set label</span></span><br><span class="line">ax2.set_xlabel(<span class="string">&#x27;低收入比例&#x27;</span>, color=<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line">ax2.set_ylabel(<span class="string">&#x27;房間數&#x27;</span>, color=<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line">ax2.set_zlabel(<span class="string">&#x27;房價&#x27;</span>, color=<span class="string">&#x27;g&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 更改視角</span></span><br><span class="line">ax2.view_init(elev=<span class="number">30</span>, azim=<span class="number">45</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic90.png" class="" title="pic90">
</div>

<h4 id="用所有的特徵執行波士頓房價預估"><a href="#用所有的特徵執行波士頓房價預估" class="headerlink" title="用所有的特徵執行波士頓房價預估"></a>用所有的特徵執行波士頓房價預估</h4><ul>
<li>使用所有的特徵值並未得到較好的預估結果</li>
<li>使用2個特徵的二次多項式得到較好的結果</li>
<li>較簡單的模型在預測未出現的數據有時表現得更好</li>
</ul>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用所有參數預估房價</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> PolynomialFeatures</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score, mean_squared_error</span><br><span class="line"><span class="keyword">from</span> joblib <span class="keyword">import</span> dump</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># boston data url : http://lib.stat.cmu.edu/datasets/boston</span></span><br><span class="line">boston = pd.read_csv(<span class="string">&quot;boston.csv&quot;</span>, sep=<span class="string">&#x27;\s+&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># X = pd.DataFrame(np.c_[boston[&#x27;LSTAT&#x27;], boston[&#x27;RM&#x27;]], columns=[&#x27;LSTAT&#x27;, &#x27;RM&#x27;])</span></span><br><span class="line">X = boston.drop(<span class="string">&#x27;MEDV&#x27;</span>, axis=<span class="number">1</span>)</span><br><span class="line">y = boston[<span class="string">&#x27;MEDV&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分割測試數據與測試數據</span></span><br><span class="line">X_train, X_test, y_train, y_test = \</span><br><span class="line">    train_test_split(X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立線性迴歸模型並擬合訓練數據</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line">model.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 進行預測</span></span><br><span class="line">y_pred = model.predict(X_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 計算模型性能指標</span></span><br><span class="line">r2 = r2_score(y_test, y_pred)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;R score : <span class="subst">&#123;r2.<span class="built_in">round</span>(<span class="number">3</span>)&#125;</span>&quot;</span>)</span><br><span class="line">mse = mean_squared_error(y_test, y_pred)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Mean Squared Error(MSE) : <span class="subst">&#123;mse.<span class="built_in">round</span>(<span class="number">3</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看模型截距與係數</span></span><br><span class="line">intercept =  model.intercept_</span><br><span class="line">coeff = model.coef_</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;截距 : <span class="subst">&#123;intercept:<span class="number">.3</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 多項式特徵</span></span><br><span class="line"><span class="comment"># print(poly.get_feature_names_out())</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;係數 : <span class="subst">&#123;coeff.<span class="built_in">round</span>(<span class="number">3</span>)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span>*<span class="number">70</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;實際房價\n<span class="subst">&#123;np.array(y_test.tolist())&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-&quot;</span>*<span class="number">70</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;預估房價\n<span class="subst">&#123;y_pred.<span class="built_in">round</span>(<span class="number">1</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 繪製實際房價與預測房價圖表</span></span><br><span class="line">plt.scatter(y_test, y_pred)</span><br><span class="line"><span class="comment"># 繪製對角線</span></span><br><span class="line">plt.plot([<span class="built_in">min</span>(y_test),<span class="built_in">max</span>(y_test)], [<span class="built_in">min</span>(y_test),<span class="built_in">max</span>(y_test)], color=<span class="string">&#x27;red&#x27;</span>, linestyle=<span class="string">&#x27;--&#x27;</span>, lw=<span class="number">2</span>)</span><br><span class="line">plt.title(<span class="string">&quot;實際房價vs預測房價&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;實際房價&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;預測房價&quot;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># R score : 0.763</span></span><br><span class="line"><span class="comment"># Mean Squared Error(MSE) : 23.441</span></span><br><span class="line"><span class="comment"># 截距 : 42.031</span></span><br><span class="line"><span class="comment"># 係數 : [ 5.0000e-02  5.3000e-02  2.4000e-02  2.3010e+00 -1.8746e+01  3.1110e+00</span></span><br><span class="line"><span class="comment">#   5.0000e-03 -1.4020e+00  2.3000e-01 -1.1000e-02 -9.7900e-01  8.0000e-03</span></span><br><span class="line"><span class="comment">#  -5.7700e-01]</span></span><br><span class="line"><span class="comment"># ----------------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># 實際房價</span></span><br><span class="line"><span class="comment"># [28.2 23.9 16.6 22.  20.8 23.  27.9 14.5 21.5 22.6 23.7 31.2 19.3 19.4</span></span><br><span class="line"><span class="comment">#  19.4 27.9 13.9 50.  24.1 14.6 16.2 15.6 23.8 25.  23.5  8.3 13.5 17.5</span></span><br><span class="line"><span class="comment">#  43.1 11.5 24.1 18.5 50.  12.6 19.8 24.5 14.9 36.2 11.9 19.1 22.6 20.7</span></span><br><span class="line"><span class="comment">#  30.1 13.3 14.6  8.4 50.  12.7 25.  18.6 29.8 22.2 28.7 23.8  8.1 22.2</span></span><br><span class="line"><span class="comment">#   6.3 22.1 17.5 48.3 16.7 26.6  8.5 14.5 23.7 37.2 41.7 16.5 21.7 22.7</span></span><br><span class="line"><span class="comment">#  23.  10.5 21.9 21.  20.4 21.8 50.  22.  23.3 37.3 18.  19.2 34.9 13.4</span></span><br><span class="line"><span class="comment">#  22.9 22.5 13.  24.6 18.3 18.1 23.9 50.  13.6 22.9 10.9 18.9 22.4 22.9</span></span><br><span class="line"><span class="comment">#  44.8 21.7 10.2 15.4]</span></span><br><span class="line"><span class="comment"># ----------------------------------------------------------------------</span></span><br><span class="line"><span class="comment"># 預估房價</span></span><br><span class="line"><span class="comment"># [32.2 28.  18.  21.6 18.1 20.  32.2 18.3 24.2 27.1 26.7 28.8 20.9 26.5</span></span><br><span class="line"><span class="comment">#  23.3 20.5 17.4 38.1 30.4  8.5 20.9 16.3 25.3 25.  31.3 10.6 13.7 17.1</span></span><br><span class="line"><span class="comment">#  36.4 14.2 21.5 13.7 42.9 18.1 21.9 20.3 17.  27.6  9.9 19.3 24.5 21.5</span></span><br><span class="line"><span class="comment">#  29.4 15.4 18.8 13.9 39.9 18.2 26.2 20.  24.5 24.3 25.4 26.8  4.  24.1</span></span><br><span class="line"><span class="comment">#  10.4 27.1 16.9 35.8 19.3 27.7 16.1 18.2 10.5 32.5 36.8 22.4 24.7 25.4</span></span><br><span class="line"><span class="comment">#  23.7  7.8 15.6 20.6 20.5 20.7 33.8 28.1 25.6 34.5 18.6 23.8 34.5 12.7</span></span><br><span class="line"><span class="comment">#  21.3 30.  16.6 24.6 19.  16.9 27.3 41.8 14.  23.2 17.4 21.9 23.2 29.</span></span><br><span class="line"><span class="comment">#  37.  20.3 16.9 17.7]</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic91.png" class="" title="pic91">
</div>

<h4 id="殘差圖-Residual-Plot"><a href="#殘差圖-Residual-Plot" class="headerlink" title="殘差圖(Residual Plot)"></a>殘差圖(Residual Plot)</h4><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic92.png" class="" title="pic92">
</div>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 殘差圖</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> PolynomialFeatures</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score, mean_squared_error</span><br><span class="line"><span class="keyword">from</span> joblib <span class="keyword">import</span> dump</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># boston data url : http://lib.stat.cmu.edu/datasets/boston</span></span><br><span class="line">boston = pd.read_csv(<span class="string">&quot;boston.csv&quot;</span>, sep=<span class="string">&#x27;\s+&#x27;</span>)</span><br><span class="line"></span><br><span class="line">X = boston.drop(<span class="string">&#x27;MEDV&#x27;</span>, axis=<span class="number">1</span>)</span><br><span class="line">y = boston[<span class="string">&#x27;MEDV&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分割測試數據與測試數據</span></span><br><span class="line">X_train, X_test, y_train, y_test = \</span><br><span class="line">    train_test_split(X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立線性迴歸模型並擬合訓練數據</span></span><br><span class="line">model = LinearRegression()</span><br><span class="line">model.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 進行預測</span></span><br><span class="line">y_pred = model.predict(X_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 計算殘差</span></span><br><span class="line">residuals = y_test - y_pred</span><br><span class="line"></span><br><span class="line"><span class="comment"># windows 使用 微軟正黑體</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.family&quot;</span>] = [<span class="string">&quot;Microsoft JhengHei&quot;</span>]</span><br><span class="line"><span class="comment"># 顯示負號</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 繪製殘差圖</span></span><br><span class="line">plt.scatter(y_pred, residuals, alpha=<span class="number">0.5</span>)</span><br><span class="line">plt.axhline(y=<span class="number">0</span>, color=<span class="string">&#x27;r&#x27;</span>, linestyle=<span class="string">&#x27;--&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&quot;波士頓房價殘插圖&quot;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&quot;預測房價&quot;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&quot;殘差&quot;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic93.png" class="" title="pic93">
</div>

<h4 id="梯度下降迴歸-SGDRegressor"><a href="#梯度下降迴歸-SGDRegressor" class="headerlink" title="梯度下降迴歸 SGDRegressor()"></a>梯度下降迴歸 SGDRegressor()</h4><div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic94.png" class="" title="pic94">
</div>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic95.png" class="" title="pic95">
</div>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic96.png" class="" title="pic96">
</div>

<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 梯度下降迴歸</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score, mean_squared_error</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> SGDRegressor</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandardScaler</span><br><span class="line"></span><br><span class="line"><span class="comment"># boston data url : http://lib.stat.cmu.edu/datasets/boston</span></span><br><span class="line">boston = pd.read_csv(<span class="string">&quot;boston.csv&quot;</span>, sep=<span class="string">&#x27;\s+&#x27;</span>)</span><br><span class="line"></span><br><span class="line">X = boston.drop(<span class="string">&#x27;MEDV&#x27;</span>, axis=<span class="number">1</span>)</span><br><span class="line">y = boston[<span class="string">&#x27;MEDV&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分割測試數據與測試數據</span></span><br><span class="line">X_train, X_test, y_train, y_test = \</span><br><span class="line">    train_test_split(X, y, test_size=<span class="number">0.2</span>, random_state=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># SGDRegressor 對特徵的尺度敏感,先進行標準化</span></span><br><span class="line"><span class="comment"># fit_transform 用於訓練數據：</span></span><br><span class="line"><span class="comment">#     fit 計算訓練數據的均值和方差</span></span><br><span class="line"><span class="comment">#     transform 使用這些計算出的均值和方差對訓練數據進行標準化</span></span><br><span class="line"><span class="comment"># transform 用於測試數據：</span></span><br><span class="line"><span class="comment">#     只使用訓練數據計算出的均值和方差來標準化測試數據，不會重新計算均值和方差</span></span><br><span class="line"><span class="comment"># 這樣做是為了避免數據洩漏，確保測試數據的標準化過程不受訓練數據的影響，同時保持測試數據的獨立性和真實性</span></span><br><span class="line">scaler = StandardScaler()</span><br><span class="line">X_train = scaler.fit_transform(X_train)</span><br><span class="line">X_test = scaler.transform(X_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立線性迴歸模型並進行擬合訓練數據</span></span><br><span class="line">sgd_regressor = SGDRegressor(max_iter=<span class="number">1000</span>, random_state=<span class="number">1</span>)</span><br><span class="line">sgd_regressor.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用測試集即進行預測</span></span><br><span class="line">y_pred = sgd_regressor.predict(X_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 計算訓練數據的R平方係數</span></span><br><span class="line">y_train_pred = sgd_regressor.predict(X_train)</span><br><span class="line">r2_train = r2_score(y_train, y_train_pred)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;訓練數據的R平方係數 : <span class="subst">&#123;r2_train.<span class="built_in">round</span>(<span class="number">3</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 計算測試數據的R平方係數</span></span><br><span class="line">r2_test = r2_score(y_test, y_pred)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;測試數據的R平方係數 : <span class="subst">&#123;r2_test.<span class="built_in">round</span>(<span class="number">3</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 計算模型的性能指標</span></span><br><span class="line">mse = mean_squared_error(y_test, y_pred)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;模型的性能指標(MSE) : <span class="subst">&#123;mse.<span class="built_in">round</span>(<span class="number">3</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 訓練數據的R平方係數 : 0.719</span></span><br><span class="line"><span class="comment"># 測試數據的R平方係數 : 0.762</span></span><br><span class="line"><span class="comment"># 模型的性能指標(MSE) : 23.499</span></span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2024/05/15/python-28/pic97.png" class="" title="pic97">
</div>
    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/book/" rel="tag"># book</a>
              <a href="/tags/python/" rel="tag"># python</a>
              <a href="/tags/ML/" rel="tag"># ML</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/05/15/python-27/" rel="prev" title="Gradio">
                  <i class="fa fa-chevron-left"></i> Gradio
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/05/17/python-29/" rel="next" title="matplotlib.pyplot 3D">
                  matplotlib.pyplot 3D <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    
  <div class="comments" id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Robert Kao</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="總字數">2.7m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="所需總閱讀時間">41:16</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 強力驅動
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="/js/local-search.js"></script>






  




  <script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'none'
      },
      options: {
        renderActions: {
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              const target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js';
    script.defer = true;
    document.head.appendChild(script);
  } else {
    MathJax.startup.document.state(0);
    MathJax.typesetClear();
    MathJax.texReset();
    MathJax.typeset();
  }
</script>



<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://hot5656-blog.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://hot5656.github.io/2024/05/15/python-28/";
    this.page.identifier = "2024/05/15/python-28/";
    this.page.title = "(1) 機器學習最強入門:基礎數學/機率/統計邁向AI真實數據";
    };
  NexT.utils.loadComments('#disqus_thread', () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://hot5656-blog.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
