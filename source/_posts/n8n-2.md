---
title: n8n - AI Agents, AI Automations & AI Voice Agents
abbrlink: f119
date: 2025-07-28 10:37:03
categories: AI
tags:
	n8n
	udemy
---

### install n8n
#### Hostinger n8n VPS hosting
``` bash
install as guide flow

# udgrade n8n for the Ubuntu 
docker compose pull
docker compose down
docker compose up -d
```

<!--more-->

#### install in windows(Node.js)
``` bash
1. search n8n github
2. Node.js install or nvm install(for Node.js version control)
3. npm install -g n8n
4. re-open cmd : run "n8n"
5. browser run : http://local:5678

# udgrade n8n 
1. npm update -g n8n
2. n8n
```

#### install in Mac(Node.js)
``` bash
1. node.js install
2. oper terminal : sudo npm install -g n8n 
3. n8n 
4. browser run: http://local:5678

# udgrade n8n 
1. npm update -g n8n
2. n8n
```

### coding
#### JSON
``` bash
# Selectors (`.first()`, `.last()`, `.all()`)
{{ $('Source Data').last().json.name }}

# JS function
{{ $('Source Data').last().json.name.toUpperCase() }}
{{ Math.round($('Source Data').last().json.age / 7) }}
{{ typeof $('Source Data').last().json.age }}

# get key
{{ Object.keys($('Source Data').last().json.contact) }}

# convert a structured JSON object into a single string
{{ JSON.stringify($('Source Data').last().json.contact, null, 2) }}

# join all list to a string
{{ $('Split Out Skills').all().map(item => item.json.skills).join(', ') }}

# String to object **** format must seet to object ****
{{ JSON.parse($('8. Utility Functions').item.json.contact_as_string) }}
```

#### Regular Expression
``` bash
# æŠŠæ‰€æœ‰é›™å¼•è™Ÿ " å–ä»£ç‚ºå·²è½‰ç¾©çš„ "ï¼Œç¢ºä¿å­—ä¸²åœ¨ JSONã€JS å­—é¢é‡æˆ–åºåˆ—åŒ–æ™‚ä¸æœƒå› æœªè½‰ç¾©å¼•è™Ÿè€Œç ´å£èªæ³•
replace(/"/g, '\\"') 

```

#### Code
##### array to json output
``` js
const items = [
  {
    name: 'John',
    email: 'john@example.com',
    age: 25,
    status: 'active'
  },
  {
    name: 'Sarah',
    email: 'sarah@example.com', 
    age: 30,
    status: 'inactive'
  },
  {
    name: 'Mike',
    email: 'mike@example.com',
    age: 28,
    status: 'active'
  }
];

return items.map(item => ({ json: item }));
``` 

##### convert data to a file mp3
``` js
return [
  {
    json: {},
    binary: {
      data: {
        data: Buffer.from($json["audio_data"], "base64"),
        mimeType: "audio/mpeg",
        fileName: "output.mp3"
      }
    }
  }
];
```

##### remove special character
``` js
// n8n code node è½‰æ›å‰é¢è³‡æ–™
return items.map(item => {
  let text = item.json.output; // å–å¾—å‰é¢ç¯€é»å‚³ä¾†çš„ output æ–‡å­—

  // ç¯„ä¾‹ï¼šæŠŠæ‰€æœ‰æ–‡å­—è½‰æˆå¤§å¯«
  // text = text.toUpperCase();

  // ç¯„ä¾‹ï¼šè·³è„« Telegram MarkdownV2 çš„ç‰¹æ®Šå­—å…ƒï¼ˆéƒ¨åˆ†ï¼‰
  text = text.replace(/([_*[\]()~`>#+-=|{}.!])/g, '\\$1');

  // å°‡è™•ç†å¾Œçš„æ–‡å­—å­˜å›æ–°çš„æ¬„ä½æˆ–è¦†è“‹åŸæœ¬æ¬„ä½
  item.json.processedText = text;

  return item;
});
```

##### string to json
``` js
const responseText = $input.first().json.content.parts[0].text

let jsonString = responseText;

// ç§»é™¤ ```
jsonString = jsonString.replace(/```json\n?/g, '');

// ç§»é™¤ ```
jsonString = jsonString.replace(/```\s*$/g, '');

// ç§»é™¤å‰å¾Œç©ºç™½
jsonString = jsonString.trim();

try {
  // è§£æ JSON å­—ç¬¦ä¸²
  const output = JSON.parse(jsonString);
  
  // å›å‚³è§£æå¾Œçš„çµæ§‹åŒ–è³‡æ–™
  return {
    output
  };
  
} catch (error) {
  // è§£æå¤±æ•—æ™‚çš„éŒ¯èª¤è™•ç†
  return {
    error: 'JSON format error',
    originalResponse: responseText,
    parseSuccess: false,
  };
}
```

##### 10_95Customer+Data+Processor+Complex+(Data+Cleaning+Example)
``` js
const items = $input.all();
const customers = items[0].json.customers;

const processedCustomers = customers.map(customer => {
  // Convert revenue string to actual number
  const revenueNumber = parseFloat(customer.revenue.replace(/[$,]/g, ''))
  
  let tier ;
  if (revenueNumber >= 40000) {
    tier = 'Premium';
  }
  else if  (revenueNumber >= 20000) {
    tier = 'Standard';
  } 
  else {
    tier = 'Basic';
  }

  const domain = customer.email.split('@')[1];
  const isUK = domain.includes('.uk');
  const country = isUK ? 'United Kingdom' : 'United States';

  const formattedPhone = `(${customer.phone.slice(0,3)}) -${customer.phone.slice(4,6)}-${customer.phone.slice(6,7)}-${customer.phone.slice(8)}`;
  
  return {
    // Original data (cleaned)
    name: customer.name,
    email: customer.email,
    phone: formattedPhone,
    company: customer.company,

    // NEW calculated fields
    revenueAmount : revenueNumber,
    customerTier : tier,
    country: country,

    // Business logic fields
    isHighValue : revenueNumber >= 25000,
    needsAccountManager : tier === 'Premium',
    emailDomain : domain
  }
})

// sum åˆå€¼ç‚º 0,å‚³å›åŠ ç¸½å€¼ 
const totalRevenue = processedCustomers.reduce((sum, customer) => sum + customer.revenueAmount, 0);
const averageRevenue = totalRevenue / processedCustomers.length;
// å‚³å› c.isHighValue's length
const highValueCount = processedCustomers.filter(c => c.isHighValue).length;

return {
  processedCustomers : processedCustomers,
  summary :{
    totalCustomers : processedCustomers.length,
    totalRevenue : totalRevenue,
    averageRevenue : Math.round(averageRevenue),
    highValueCustomers: highValueCount,
    premiumCustomers: processedCustomers.filter(c => c.customerTier === 'Premium').length
  },
  
  message: `Processed ${processedCustomers.length} customers with advanced business logic`
};
```

##### 10_95Weather+Message+Generator+Example
``` js
const items = $input.all();
const locations = items[0].json.locations;
const weatherReports = locations.map( location => {
  let message = '';
  let recommendation = '';  

  if (location.temperature < 10) {
    message = `It's chilly in ${location.city} at ${location.temperature}Â°C`;
    recommendation = 'Dress warm and bring a jacket!';
  } else if (location.temperature > 25) {
    message = `It's hot in ${location.city} at ${location.temperature}Â°C`;
    recommendation = 'Perfect t-shirt weather!';
  }
  else {
    message = `Bice weather in ${location.city} at ${location.temperature}Â°C`;
    recommendation = 'Comfortable temperature today!';
  }

  if (location.condition.includes('rain')){
    recommendation += ' Don\'t forget your umbrella!'; 
  } else if (location.condition.includes('snow')){
    recommendation += ' Watch out for slippery roads!'; 
  } else if (location.condition.includes('sunny')){
    recommendation += ' great day to be outside!'; 
  }
  
  if (location.humidity > 80 ){
    recommendation += ' High humidity - stay hydrated!'
  }
  
  return {
    city: location.city,
    originalDate: location,
    weatherMessage: message,
    recommendation: recommendation,
    alertLevel: location.temperature < 0 ? 'extreme' : 
      location.temperature < 10 ? 'low' :
      location.temperature > 30 ? 'high' : 'normal'
  };
})

return {
  totalLocations: locations.length,
  weatherReports : weatherReports,
  generatedAt: new Date().toISOString()
}
```

##### 10_95Sales+Calculator+Example
``` js
const items = $input.all();
const sales = items[0].json.salesData;

const saleWithTotals = sales.map(sale => ({
  ...sale,
  totalPrice: sale.quantity * sale.unitPrice
}));

const totalRevenue = saleWithTotals.reduce((sum, sale) => sum + sale.totalPrice, 0);
const totalQuantitly = saleWithTotals.reduce((sum, sale) => sum + sale.quantity, 0);
const averageOrderValue = totalRevenue / sales.length;

// const productSummary = {};
// saleWithTotals.forEach(sale => {
//   if (!productSummary[sale.product]) {
//     productSummary[sale.product] = {
//       product: sale.product,
//       totalQuantity: 0,
//       totalRevenue: 0,
//       orderCount: 0
//     };
//   }
//   productSummary[sale.product].totalQuantity += sale.quantity;
//   productSummary[sale.product].totalRevenue +=  sale.totalPrice;
//   productSummary[sale.product].orderCount += 1
// });


// ä½¿ç”¨è¨»è§£æ¨™æ³¨å±¬æ€§
/**
 * @typedef {Object} ProductSummaryItem
 * @property {string} product
 * @property {number} totalQuantity
 * @property {number} totalRevenue
 * @property {number} orderCount
 */

/** @type {Object.<string, ProductSummaryItem>} */
// JSDoc çš„å‹åˆ¥è¨»è§£èªæ³•ï¼Œç”¨ä¾†å‘Šè¨´ç·¨è¼¯å™¨æˆ–å…¶ä»–å·¥å…·ï¼Œé€™å€‹è®Šæ•¸æ˜¯ä¸€å€‹ç‰©ä»¶ï¼ˆObjectï¼‰ï¼Œä¸¦ä¸”ï¼š
// ç‰©ä»¶çš„éµï¼ˆkeyï¼‰æ˜¯å­—ä¸²ï¼ˆstringï¼‰å‹æ…‹
// ç‰©ä»¶çš„å€¼ï¼ˆvalueï¼‰æ˜¯ä½ è‡ªå·±å®šç¾©çš„ ProductSummaryItem çµæ§‹ç‰©ä»¶
// é€™è£¡çš„ Object.<string, ProductSummaryItem> è¡¨ç¤ºã€Œä¸€å€‹ä»¥å­—ä¸²ç‚ºéµï¼Œå­˜æ”¾ ProductSummaryItem å‹æ…‹ç‰©ä»¶çš„å­—å…¸ã€ã€‚
const productSummary = {};

saleWithTotals.forEach(sale => {
  if (!productSummary[sale.product]) {
    productSummary[sale.product] = {
      product: sale.product,
      totalQuantity: 0,
      totalRevenue: 0,
      orderCount: 0
    };
  }
  productSummary[sale.product].totalQuantity += sale.quantity;
  productSummary[sale.product].totalRevenue += sale.totalPrice;
  productSummary[sale.product].orderCount += 1;
});

const productAnalysis = Object.values(productSummary).map(product => ({
  ...product,
  averageOrderValue: product.totalRevenue / product.orderCount,
  revenuePercentage: (product.totalRevenue/ totalRevenue * 100).toFixed(2)
}))


const bestSellingProduct = productAnalysis.reduce((best, current) => 
    current.totalQuantity > best.totalQuantity ? current : best
  );

const highestRevenueProduct = productAnalysis.reduce((best, current) =>
    current.totalRevenue > best.totalRevenue ? current : best
  );


return {
  summary: {
    totalOrders: sales.length,
    totalRevenue: totalRevenue,
    totalQuantity: totalQuantitly,
    averageOrderValue : parseFloat(averageOrderValue.toFixed(2))
  },
  bestPerformers : {
    bestSelling: bestSellingProduct.product,
    highestRevenue: highestRevenueProduct.product
  },
  productAnalysis: productAnalysis,
  salesWithTotals: saleWithTotals 
}
```

##### 10_95Data+Format+Converter+Example
``` js
const items = $input.all()
const apiData = items[0].json.apiResponse

const flattenedUsers = apiData.users.map(user => ({
  // Basic info
  userId: user.id,
  fullName: `${user.profile.firstName} ${user.profile.lastName}` ,
  firstName: user.profile.firstName,
  lastName: user.profile.lastName,

  // Contact info
  email: user.profile.contact.email,
  phone: user.profile.contact.phone,

  // Preferences
  notificationsEnabled: user.preferences.notifications,
  theme: user.preferences.theme
}));

// Create different output formats
// 1. CSV-ready format (array of arrays)
const csvData = [
  ['User ID', 'Full Name', 'Email', 'Phone', 'Notifications',  'Theme'], //Head
  ...flattenedUsers.map(user => [
    user.userId,
    user.fullName,
    user.email,
    user.phone,
    user.notificationsEnabled ? 'Yes' : 'No',
    user.theme
  ])
];


// 2. Email list format
const emailList = flattenedUsers.map(user => user.email);

// 3. Contact cards format
const contactCards = flattenedUsers.map(user => ({
  name: user.fullName,
  contactInfo: `${user.email} | ${user.phone}`,
  settings: `Notifications: ${user.notificationsEnabled ? 'On' : 'Off'}, Theme: ${user.theme}`
}));

// 4. Summary statistics
const stats = {
  totalUsers: flattenedUsers.length,
  notificationUsers: flattenedUsers.filter(u => u.notificationsEnabled).length,
  themeBreakdown: {
    dark: flattenedUsers.filter(u => u.theme === 'dark').length,
    light: flattenedUsers.filter(u => u.theme === 'light').length,    
  },
  // ...new Set(flattenedUsers.map(u => u.email.split('@')[1])) å»é™¤é‡è¤‡å€¼, å±•é–‹ç‚º array
  domains: [...new Set(flattenedUsers.map(u => u.email.split('@')[1]))]
};

// 5. Grouped by preferences
// åˆå§‹å€¼ {}ï¼šreduce çš„ç´¯åŠ å™¨å¾ç©ºç‰©ä»¶é–‹å§‹ï¼Œä½œç‚ºæœ€å¾Œè¦å›å‚³çš„åˆ†çµ„çµæœå®¹å™¨
const groupedByTheme = flattenedUsers.reduce((groups, user) => {
  // const theme = user.theme;
  // if(!groups[theme]) {
  //   groups[theme] = [];
  // }
  // groups[theme].push(user);

  const key = user.theme;
  // groups[key] ç‚º null æˆ– undefinedï¼Œå‰‡è¨­ç‚ºç©ºé™£åˆ—ï¼›å¦å‰‡ä¿ç•™åŸå€¼
  groups[key] = groups[key] ?? [];
  groups[key].push(user);
  return groups;
}, {});


return {
  originalData: apiData,
  transformedDtat :{
    flattenedUsers: flattenedUsers,
    csvFormat: csvData,
    emailList: emailList,
    contactCards: contactCards,
    groupedByTheme: groupedByTheme
  },
  statistics: stats,
  metadata: {
    processedAt: new Date().toISOString(),
    originalTotoa: apiData.metadata.total,
    transformedTotal: flattenedUsers.length
  }
}
```

##### 10_96 class example
``` js
// get data
const students = $input.all()[0].json.students

const processStudents = students.map(student => {
  const totalPoints = student.mathScore + student.englishScore + student.scienceScore;
  const averageScore = totalPoints / 3;

  let letterGrand;
  if (averageScore >=90) {
    letterGrand = 'A';
  }else if (averageScore >=80) {
    letterGrand = 'B';
  }else if (averageScore >=70) {
    letterGrand = 'C';
  }else if (averageScore >=60) {
    letterGrand = 'D';
  }else {
    letterGrand = 'F';
  }

  const isHonorRoll = averageScore >= 85 && student.attentionPresent >= 90;
  const scholarshipEligible = (averageScore >= 88 && student.isFullTime) ? 'Yes' : 'No';
  const congratsMessage = `Great job, ${student.studentName}! Your average is ${averageScore.toFixed(1)}`;
  return {
    json: {
      ...student,
      averageScore: Math.round(averageScore),
      letterGrade: letterGrand,
      isHonorRoll: isHonorRoll,
      scholashipEligible: scholarshipEligible,
      personMessage: congratsMessage
    }
  }
});

let classTotal = 0;
let honorRollCount = 0;
for(let i = 0 ; i < processStudents.length ; i++ ){
  classTotal += processStudents[i].json.averageScore;

  if (processStudents[i].json.isFullTime) {
    honorRollCount += 1;
  }
}

const classAverage = classTotal / processStudents.length;

processStudents.push({
  json: {
    reportType: 'CLASS_SUMMARY',
    totalStudents: processStudents.length,
    classAverage: Math.round(classAverage),
    honorRollStudents: honorRollCount,
    hornorPercentage: Math.round((honorRollCount / processStudents.length) * 100 )
  }
});

return processStudents;
```

#### JavaScrip Function
##### function 
``` bash
# check if something is an array  
Empty arrays â‰  null â‰  undefined - use Array.isArray() to check first

# tells you what data type something is 
{{ typeof $json.fieldName }}

# converts to true/false
Boolean()

# convers to whole number only
ParseInt()

# converts to decimal numbers
ParseFloat()

# Safe number conversion
`{{ Number($json.value) || 0 }}` - This converts any value to a number, but gives you zero if the conversion fails instead of breaking your workflow.

# String to boolean (safe)
`{{ $json.value === 'true' }}` - This is much safer than just using Boolean() because it explicitly checks for the string "true" rather than treating any non-empty string as true.

# Extract from object
`{{ $json.user.department }}` - Use dot notation to pull specific values out of nested objects. This is super common when working with API responses.

# Array to string
`{{ $json.technologies.join(', ') }}` - Perfect for creating readable lists or sending array data to systems that only accept text.

# String to array
`{{ $json.techString.split(', ') }}` - The reverse operation, turning comma-separated text back into arrays you can loop through or manipulate.

# Object to string
`{{ JSON.stringify($json.user) }}` - Essential for storing complex objects in databases or sending them to APIs that expect text.

#  String to object **** format must seet to object ****
`{{ JSON.parse($json.userDataString) }}` - Converting JSON strings back to objects so you can access their properties.

# Conditional conversion
`{{ Number($json.score) >= 80 ? 'Senior' : 'Junior' }}` - Combining conversion with logic to create derived fields based on your business rules.

# Handle null values
`{{ $json.value || 'default' }}` - Prevents null or undefined values from breaking your workflow by providing fallbacks.

# Trim whitespace:
`{{ $json.text.trim() }}` - Always use this on user input because people love to add extra spaces.

```
##### Example
``` bash
{{ JSON.stringify($json.user) }}
{{ JSON.parse($json.userDataString) }}
{{ $json.isVerified ? "Verified" : "Pending" }}
{{ Number($json.scoreText)  +  Number($json.priceText) }}
{{ JSON.parse($json.userDataString).level }}
{{ Number($json.scoreText) >=80 ? "Senior": "Junior" }}
profile(Object) : {{ {usname:$json.user.username, level: Number($json.scoreText) > 80 ? 'Senior' : 'Junior', verified: $json.isVerified, score: Number($json.scoreText)  } }}
{{ $json.technologies.join(' | ') }}
{{ $json.techString.split(',') }}
{{ $json.technologies[0] }}
{{ $json.technologies.length }}
```

### Tool
#### Slack
##### Create : [Slack API](https://api.slack.com/apps)
``` bash
Slack å»ºç«‹ channel : è¦å…ˆå»ºç«‹å·¥ä½œç©ºé–“

Slack token  ç”³è«‹ : [Slack API]
--> Creat an App
--> From scratch
--> App Name : n8n work, Pick a workspace to develop your app in: AI LAB
--> Create App
--> Generate token and Scopes : å« Client ID,Client Secret 
--> OAuth & Permissions
	  Add New Redirect URL from n8n "OAuth Redirect URL"
		Bot Token Scopes  : chat:write , users:read, files:write 
		User Token Scopes : chat:write , users:read, files:write 
```

#### Google 
##### Google People API(for google Contracts):enable

#### [Telegram](https://web.telegram.org/) token
``` bash
login 
--> search "botfather" 
--> pick @BotFather 
--> Start 
--> press "/newbot " 
--> enter name "hot5656firstresponder_bot" 
--> copy token to n8n telegram node's credential 
```

#### [Airtable](https://www.airtable.com/) token
``` bash
# add a base
Create 
--> Create a app 
-> Untitled Base 
--> Field: File ID,Creation Time,Recipient Email

# API KEY
Account
--> go to developer hub 
--> create token
--> scopr:data.records:read,data.records:write,schema.bases:read,access:all
```

#### google Gimini  API key - [ Google AI Studio](https://aistudio.google.com/) 
``` bash
login 
--> get API key 
--> Create API key

# å…è²»æ–¹æ¡ˆæœ‰æµé‡å’Œæ¬¡æ•¸é™åˆ¶ï¼ˆå¦‚æ¯æ—¥æˆ–æ¯åˆ†é˜è«‹æ±‚æ•¸ã€Tokenæ•¸ï¼‰ï¼Œä½†ä¸€èˆ¬å€‹äººç”¨é€”è¶³å¤ ï¼Œè¶…é¡æ‰éœ€ä»˜è²»
```


#### google API key for Youtube
``` bash
google cloud console 
--> æ†‘è­‰(Credintials)
-->å»ºç«‹æ†‘è­‰(Create credentials)
--> API key

# enable API
YouTube Data API v3
```

#### [Notion](https://www.notion.com/)
##### [Notion Integrations](https://www.notion.so/profile/integrations) å»ºç«‹ å…§éƒ¨æ•´åˆå¯†é‘°
``` bash
# å»ºç«‹ å…§éƒ¨æ•´åˆå¯†é‘°
--> æ–°æ•´åˆ
æ•´åˆåç¨±:Demo
é—œè¯å·¥ä½œç©ºé–“: Robert Kao Notion
é¡å‹:Internal
--> å„²å­˜
åŠŸèƒ½: é–±è®€è©•è«–,æ’å…¥è©•è«– eneable , copy å…§éƒ¨æ•´åˆå¯†é‘°
--> å„²å­˜
ä½ çš„æ•´åˆå°šç„¡ä»»ä½•é é¢çš„å­˜å–æ¬Šé™
å¦‚æ¬²é–‹å§‹ä½¿ç”¨æ•´åˆï¼Œè«‹å¾ä»¥ä¸‹ä½ç½®æ–°å¢é é¢å’Œè³‡æ–™åº«ï¼šAccess Tab
--> é¸å–é é¢
--> ç§äºº
--> select all 
--> æ›´æ–°é¸å–æ¬Šé™

# å»ºç«‹æ–° page
# å¦ è¨±æ¬Šé™ä¹Ÿè¦åŠ å…¥
+é–‹å§‹å”ä½œ 
-->å»ºç«‹æ–°page : n8n transcribe

# å»ºç«‹æ–° page #2
+ é–‹å§‹å”ä½œ
--> è¼¸å…¥ page name
--> é»3é»è™•
--> é€£æ¥ 
--> Demo (my æ•´åˆåç¨±)
è¼¸å…¥ /table  é¸ table view
input database name --> Youtube post #1 
name change to : Video Name(example)
+ Add property : Facebook Post(text) ...
```

``` bash
# å»ºç«‹ File Uploaded - Google Drive(è¡¨æ ¼)
notion home - https://www.notion.so/
--> +å»ºç«‹å”ä½œ set name: File Uploaded - Google Drive
--> è¨­å®šç‚ºè¡¨æ ¼, æ¬„ä½ ï¼®ame(æ–‡å­—), File URL(link)
```

#### peplexity API key
``` bash
User
--> Account
--> API Key
--> create 
```

#### [Apify](https://apify.com/) token
``` bash
Apify login
--> Actor
--> API
--> copy token
```

### Setting 

#### API return code
``` bash
2xx(success): 200
4xx(client Error) : request error
5xx(Server error)
```

#### prompt
``` bash
## Role & Purpose
The role tells the AI who it is supposed to be. The purpose tells the AI why it exists and what its main job is. This is the foundation of your prompt
because it sets the agentâ€™s identity.
- ..
- ..

## Capabilities
This section describes what the agent is able to do - its core skills and strengths.
- ..
- ..

## Tools (Optional)
This section explains which external tools, data sources, or APIs the agent can use and how they fit into its workflow.

## Interaction Style
This section defines how the agent should communicate - its tone, level of detail, and overall personality when responding.

## Example Output (Optional)
This section shows the agent what a good response looks like. By providing examples, you give the AI a pattern to follow, which makes its answers
more consistent and accurate.

## Notes (Optional)
This section includes any extra guidance or reminders that help the agent work better. Notes are optional but useful for edge cases, exceptions, or
small rules that donâ€™t belong in the main prompt.
```

#### custom key in header 
``` bash
Authentication:GenericnCredential Type
Generic Auth Type: Custom Auth
Custom Auth: Custom Auth account(PollO)-set as suitable

JSON exmple:
{
  "headers": {
  "x-api-key": "your_key..",
  "Content-Type": "application/json"
  }
}

{
  "headers": {
  "Authorization": "your_key..",
  "Content-Type": "application/json"
  }
}

# API Market free image & video upload
{
  "headers": {
  "x-magicapi-key": "your_key..",
  "accept": "application/json",
  "Content-Type": "multipart/form-data"
  }
}

# Credintial for Tavily
{
  "headers": {
    "Authorization": "your_key.."
  }
}

# Credintial for Serper
{
  "headers": {
    "Content-Type": "application/json",
    "X-API-KEY": "your_key.."
  }
}
```

#### This message was sent automatically with n8n
``` bash
Add Field --> Append n8n Attribution : disable
```


#### n8n Community
##### enable
``` bash
# enable Community node support
n8n home
--> Admin Panel (see version : Running version n8n@1.104.2)
--> setup
    Verified community nodes: on (can install community nodes)
    also can change version, Zone
--> save change 
--> Dashboard
--> Open Instance (return n8n home)

# see install community node
--> User --> setting (can see Cmmunity Notes)
--> can see installed community nodes
```

##### install by n8n cloud
``` bash
# Conver text to speetch(11 labs)
+ search "elevenlabs" 
--> install 
--> Conver text to speetch(11 labs)

# web search, can use for I Agent's tool
# tavily Tool
+ search "tavily" 
--> install (æœ‰æ™‚å¤±æ•—,å†è©¦ä¸€æ¬¡å°±å¥½äº†)
```

##### install by n8n hosting
``` bash
User --> setting -->  Cmmunity Nodes --> install searching 
```

### node
#### n8n form : on form submission
``` bash
Form Title : Contact Form
Form Description : Contact us when you have any problem to solver
Add form Elemant:
	Field:Name
	Placholder: Enter your name(required)

 	Field:Last Name
	Placholder: Enter your last name(required)

 	Field:Email
	Element type : Email
	Placholder: Enter your email(required)

	Field:Description
	Placholder: Provide information about the problem(required)

	Field:Course Type
	Element type : Dropdown List:n8n course, Zapier course, Midjourney course
```

#### send a message to Slack : Slack --> send a message
``` bash 
# Slack OAuth2 API
OAuth Redirect URL --> copy to Slach
Client ID : put Slack Id
Client Secret : put Slack Secret

Send Message To : channel
Channel: n8n-work
message type : simple Text Message
Message Text :
	Client as request
	Name:{{ $json.Name }}
	Email:{{ $json.Email }}
	Phone number:{{ $json['Phone Number'] }}
	Description:{{ $json.Description }}
```

#### add user to google contract : google contracts --> create a contract
``` bash
operation : Create 
Give Name : {{ $('Google Sheets Trigger').item.json.Name }}
Add field:
	Email: Type:work, value:{{ $('Google Sheets Trigger').item.json.Email }}
	Phone: Type:mobil(æœ‰äº›å€¼æœƒ check number format), value:{{ $('Google Sheets Trigger').item.json['Phone Number'] }}
```

#### wait message from Telegram's bot " on app event -> telegram --> on message 
``` bash
-> set credential (hugginFace cannot support telegram, change to n8n cloud) 
```

#### AI ï¼¡gent framework :AI agent node 
``` bash
# n8n é‡å° AI Agent ç¯€é»ï¼ˆAI Agent / OpenAI Chat Model ç­‰ï¼‰è¨­å®šäº†æ¯æ—¥å…è²»è«‹æ±‚æ¬¡æ•¸é™åˆ¶ã€‚ç•¶ä½ è§¸ç™¼è¶…éé€™å€‹å…è²»æ¬¡æ•¸ï¼Œå°±æœƒçœ‹åˆ°é€™é¡ rate limit exceeded æˆ– too many requests çš„è¨Šæ¯ã€‚
# è‹¥éœ€é¡å¤–ä½¿ç”¨é‡ï¼Œç³»çµ±æœƒæç¤ºä½ åŠ è³¼é»æ•¸ï¼ˆcreditsï¼‰ï¼šæ ¹æ“šéŒ¯èª¤è¨Šæ¯å’Œå®˜æ–¹ç¤¾ç¾¤è§£é‡‹ï¼Œè³¼è²· 10 credits å¯è§£é–æ¯å¤© 1,000 æ¬¡å…è²»æ¨¡å‹è«‹æ±‚é¡åº¦ã€‚
# é€™å€‹é™åˆ¶æ˜¯ n8n é‡å°å…¶è‡ªå®¶/è¨—ç®¡çš„ AI æœå‹™è¨­ä¸‹ï¼Œç„¡è«–ä½ æ˜¯åœ¨ n8n Cloud é‚„æ˜¯è‡ªæ¶ n8nï¼Œåªè¦ç”¨ n8n å…§å»ºï¼ˆéè‡ªå·± API Keyï¼‰çš„ AI Agent æ¨¡çµ„ï¼Œéƒ½æœƒå—é€™å€‹å…è²»é¡åº¦å¤©èŠ±æ¿ç´„æŸã€‚
# å¦‚æœä½ æƒ³è¦å®Œå…¨è‡ªè¨‚é¡åº¦æˆ–ç„¡é™åˆ¶ï¼Œéœ€åœ¨ç¯€é»æ”¹æˆè‡ªè¡Œå¡«å…¥è‡ªå·±çš„ LLM API Keyï¼ˆå¦‚ OpenAI API Keyï¼‰ä¾†ç›´é€£ï¼Œé€™æ¨£é™åˆ¶å°±ä¾†è‡ªä½ è³¼è²·çš„ API é…é¡ï¼Œèˆ‡ n8n ç„¡é—œ
# é¡åº¦æå‡æ–¹å¼
# ä¾ç…§ç³»çµ±éŒ¯èª¤è¨Šæ¯ï¼Œé€²å…¥ n8n çš„ credit è³¼è²·æµç¨‹ï¼ŒåŠ å…¥ 10 credits å¯æ¯å¤©è§£é– 1,000 æ¬¡å…è²»æ¨¡å‹å‘¼å«ï¼ˆä¸å–®æ¬¡ï¼Œè€Œæ˜¯æ¯æ—¥ï¼‰ã€‚ä¸€èˆ¬æœƒè¦æ±‚ä½ ç¶ä¿¡ç”¨å¡æˆ–ä»˜è²»å¸³æˆ¶ã€‚
# è‹¥ä½ ä¸åŠ è³¼ï¼Œéš”å¤©æœƒè‡ªå‹•æ¢å¾©åŸºç¤çš„å…è²»é¡åº¦ï¼ˆç´„ 50 æ¬¡å·¦å³ï¼Œæœƒä¾å®˜æ–¹æ”¿ç­–èª¿æ•´ï¼‰ã€‚
Source for Prompt : Define below 
Prompt : {{ $json.message.text }}, output not over 1200 letters, and not use markdown format
```

#### Gemini response ask : Google Gemini Chat model(link to AIn Agent Chat Model)
``` bash
--> set API key
Model : gemini-2,5-flash (ä¹Ÿå¯é¸å…¶ä»–çœ‹çœ‹)
```

#### Sen to Telgram : Telegram --> send a text message
``` bash
# Telegram æ–‡å­—è¨Šæ¯çš„é•·åº¦é™åˆ¶æ˜¯ æœ€å¤š 4,096 å€‹å­—å…ƒï¼ˆå­—ç¬¦ï¼‰ã€‚é€™å€‹é™åˆ¶é©ç”¨æ–¼å–®æ¢æ–‡å­—è¨Šæ¯ï¼Œä¸è«–æ˜¯ç´”æ–‡å­—é‚„æ˜¯å¸¶æ ¼å¼çš„å…§å®¹17ã€‚
# æ­¤å¤–ï¼Œé™„ä»¶æè¿°æ–‡å­—çš„é•·åº¦ä¸Šé™æ˜¯ 1,024 åˆ° 2,048 å­—å…ƒï¼Œæª”æ¡ˆå¤§å°é™åˆ¶æ™®é€šç”¨æˆ¶æ˜¯ 2 GBï¼ŒTelegram Premium ç”¨æˆ¶å¯é” 4 GB1ã€‚
Chat ID :{{ $('Telegram Trigger').item.json.message.chat.id }}
Text: {{ $json.output }}
```

#### Google Driver --> On change involving a specific Folder
``` bash
Folder : Demo
Watch For : File Created
```

#### Google Driver--> Share File 
``` bash
# è‹¥å°æ–¹é gmail email, access æ™‚æœƒå›é€ mail è¦æ±‚è¨­å®šæ¬Šé™

File : By Id-{{ $json.id }} 
--> add permission 
--> Role: Writer, Type:User, Email address: ...
```

#### [Airtable](https://www.airtable.com/) -->Create a record 
``` bash
Base:Untitled Base, 
Table:Table 1
File ID:{{ $('Google Drive Trigger').item.json.id }}
Creation Time:{{ $('Google Drive Trigger').item.json.createdTime }}
Recipient Email:..
```

#### download file from google drive : google drive--> download file
``` bash
File : {{ $json.id }}
```

#### Gemini Transcribe : Gogle Gemini --> Transcribe a recoding
``` bash
Model: gemini-2.5.flash or Flash Live
Input Type: Binary File
```

#### Gemini Summarize : Gogle Gemini --> Message a model
``` bash
Model: gemini-2.5.flash or Pro
Prompt: Transcript:  {{ $json.content.parts[0].text }}

--> Add Message
Prompt: 
Instruction: 
Summarize the audio content into plain text, following the structure below.
Rules:
The entire summary must not exceed 1500 characters.
Include and label all the following sections: title, summary, main_ points, action_items, follow_up, stories, references, arguments, related_topics.
Keep the style clear, concise, and organized.
Use short, natural-sounding bullet points for lists.
Example formtating:
title: Notion Button
Summary: A collection of buttons for Notion that streamline workflow and save time.
main_points:
- Overview of Notion buttons
- Example of button use cases
- Best practices for setup 
action_items:
- Test different button templates\n
- Implement buttons in daily workflows
- Share templates with team
follow_up:
- Explore advanced button integrations
- Gather team feedback on usage
stories:
- A team improved productivity by 30% using custom buttons
references:
- Official Notion documentation
- Community tutorials on Notion workflows
arguments:
- Buttons reduce repetitive tasks
- Custom buttons enhance flexibility
related_topics:
- Notion automations
- Workflow optimization
-Team collaboration tools
```

#### save to Notion : Notion --> Append a block
``` bash
Credential : Internal Integration Secret: 
parent Page : Notion's create page...
Title:{{ $('Google Drive Trigger').item.json.originalFilename }}

--> add Block
Type name: Heading1
Text:Summary

--> add Block
Type name: Paragraph
Rich Text: off
Text:{{ $json.content.parts[0].text }}

# error -> when data generate from Ai change --> The entire summary must not exceed 1200 characters.
Bad request - please check your parameters
body failed validation: body.children[1].paragraph.rich_text[0].text.content.length should be â‰¤ 2000, instead was 2406.
```

#### update to Notion database : Notion --> Create a database page
``` bash
# from node : Google Driver â€“> On change involving a specific Folder(Demo)
DataBase:From List: File Uploaded - Google Drive
--> Add Property
	key name or ID : Name 
	Title : {{ $json.originalFilename }}
--> Add Property
	key name or ID : File URL
	URL: {{ $json.webViewLink }}
```

#### get a google doc : Google Docs --> Get document
``` bash
# from node : Google Driver â€“> On change involving a specific Folder(n8n testing)
Doc ID or URL : {{ $json.id }}
```

#### precess by Gemini : Gemini --> Meessage a modem
``` bash
Model : gemini-2.5-flash 
Prompt: Summarise this content into 3-5 sentences: {{ $json.content }}

Tools : add Wikipedia
```

#### http request(freeimage host)
``` bash
Method: POST
URL: https://freeimage.host/api/1/upload
Send Body: enable
Body Content Type: Form-Data
key(From data): <your key>
action(From data): upload
source(n8n Binnary File): data
format(From data): json
```

<div style="max-width:800px">
	{% asset_img pic1.png pic1 %}
</div>

#### http request(imgbb)
``` bash
Method: POST
URL: https://api.imgbb.com/1/upload
Send Body: enable
Body Content Type: Form-Data
key(From data): <your key>
image(n8n Binnary File): data
```

<div style="max-width:800px">
	{% asset_img pic2.png pic2 %}
</div>


#### http request(API Market free image & video upload)
``` bash
Method: POST
URL: https://prod.api.market/api/v1/magicapi/image-upload/upload
Send Body: enable
Body Content Type: Form-Data
filename(n8n Binnary File): data
```

<div style="max-width:300px">
	{% asset_img pic3.png pic3 %}
</div>

#### basc LLM Chain + Model : Use for simple prompt-and-response tasks with no advanced logic
#### Information Extractor + Model : extractor data
#### Sentimat Anaysys + Model :ã€€Use to detect tone (positive, negative, neutral) in text.
#### Text Classifier + Model : Use to sort text into categories
#### Summarization chain : Use to condense long content into a short summary
#### Split : Turn a list item(s) into separate items


### workflow
#### Perplexity 
##### Smart Perlexity AI Agent
``` bash
On chat message :

Ai Agent 
  chat model: Google Gemini Chat model(gemini-2.5.flash)
  Tools: Perplexity Tool
         text : let the model define it

# input
chat input : "What are the 5 best AI tools for video editing until now (2025/08/08) 
```

##### Perlexity Node
``` bash
On chat message : 

Perplexity --> Message a model
	Model : Sonar or Sonar Pro more good
	text : {{ $json.action }}

# input
chat input : give me 5 marketing ai tools in 2005 
```

##### Perplexity Node(HTTP Request)
``` bash
On chat message : 

HTTP request
	URL: https://api.perplexity.ai/chat/completions
	Send Headers: Enabled
	Name: Authorization
	Value: Bearer YOUR_API_KEY
	Send Body: Enabled
	Body Content Type: JSON
	Specify Body: Using JSON
	JSON:
	{
		"model": "sonar",
		"messages": [
			{
			"role": "system",
			"content": "Be precise and concise."
			},
			{
			"role": "user",
			"content": ""{{ $json.chatInput }}"
			}
		]
	}

# input
chat input : give me 5 marketing ai tools in 2005 
```

#### example AI automation from Templeate
``` bash
n8n home 
--> template (see workflow template) 
--> serch "email summary agent"
--> select templeat
--> Use for free
--> Import template to ... or Copy template to clipboard (JSON)
```

#### AI Automation Feedback Collect form
##### on form submission 
``` bash
Form Title :Feedback Form
--> Add form Element
  Field name :Wtat you name?
  Field name :What's your email?
  Field name :Please give us your feedback, Element type:Dropdown List --> Great,Good,Neutral,Bad
	Field name :Please lease a comment
```

##### google sheets --> append row in sheet 
``` bash
docuemnt : Feedback Collection
value : set from form 
```

#### AI Agent from scratch
##### chat Trigger
``` bash
send :  Can you please send an email to Boss that I need to reschedule our upcoming meeting?
```

##### AI Agent
``` bash
# add option --> system message
#Role
You are a personal assistant AI Agent. Your primary role is to send emails. You have access to two tools: Contacts and Gmail_Tool.

##Tools
1.Contacts
Use this tool when you need to look up contact information like an email address or phone number. You need to use this tool BEFORE sending an email or BEFORE getting emails.

2. Gmail_Tool:
Use this for handling all email
-related actions, like sending emails, reading emails, or forwarding emails.
- Keep emails professional.
- Format nicely the Body of the email with line breaks and clear structure.
- Always sing off as 
Best regards,
Robert
Here is the current time/date: {{ $now.format('DD')}}
```
##### AI Agent - Chat Model :ã€€Gemini chat model 
``` bash
model : gemini-2.5-flash 
```
##### AI Agent - Memory :ã€€simple memory
``` bash
# ä¿ç•™ message
Context Window Length : 10
```
##### AI Agent - Tool :  Google Sheets Tool
``` bash
set name : Contacts
To/Subject/Message : Dedined automatically by the model
--> add option : Append n8n Attribution - disable 
```
##### AI Agent - Tool : Gmail Tool
``` bash
set name : Gmail_Tool
```

#### Get Daily News
##### Schedule Trigger
##### Edit Field : set topic value : "World News" , "AI" ...
##### HTTP request#1-[GNews](https://gnews.io/), HTTP request#2-[news API](https://newsapi.org/) : for 2 new source
``` bash
# Get GNews Articles
Method: GET
URL: https://gnews.io/api/v4/search
Send Query Parameters: Enabled
Parameter 1
Name: q
Value: AI

Parameter 2
Name: lang
Value: en
Parameter 3
Name: apikey
Value: Your_API_Key

# Get NewsAPI Articles
Method: GET
URL: https://newsapi.org/v2/everything
Send Query Parameters: Enabled
Parameter 1
Name: q
Value: AI
Parameter 2
Name: language
Value: en
Parameter 3
Name: sortBy
Value: publishedAt
Parameter 4
Name: pageSize
Value: 20
Send Headers: Enabled
Name: X-Api-Key
Value: Your_API_Key
```

##### Merge

##### AI AGent(1) 
``` bash
# Prompt:
** Select Top Articles **
From {{$json.articles}}, choose the 15 most relevant articles related to AI technology advancements,
tools, research, and applications.
** Summarize Clearly **
Write in clear, professional, and readable language,
summarizing the main point of each article in 1-2 short sentences.
** Include Links **
After each summary, add the article's URL for readers to explore more.
** Add the Date **
Begin the summary with todayâ€™s date:
{{ $now.format('yyyy/MM/dd') }}

# System Message:
** Output Format **
Only return the summary in plain text â€“ no explanations

# chat model : google gemini Model
model : gemini-2.5-flash
```

##### gooogle Gemini --> message a model(2):use prompt as AI AGent 

##### Telegram --> send a text message

#### Generate Video prompt
##### Schedule Trigger
##### AI Agent - Create a Idea
``` bash
# Prompt:
Give me an idea to create the content about biblical characters speaking to the camera and making a vlog
System Message:
** Purpose **
You generate viral short-form video ideas inspired by biblical characters or scenes, styled like modern TikTok vlogs.
These should feel personal, emotional, and often humorous.
** Think Tool Prompt (used before generation) **
â€œHow can I take a biblical moment or character and turn it into a relatable, viral,
or funny TikTok-style video idea that feels natural, emotional, or modern?â€
** Output Requirements **
Your response must include:
- caption â€“ Short, poetic or funny, TikTok-style. Include emojis and 3â€“5 hashtags
(e.g., #biblevlog #foryou #holycomedy #ancientvibes).
- idea â€“ 1â€“2 sentence summary of the action, story, or twist in the video.
- environment â€“ Describe what the set looks like: light, textures, mood, setting. Think â€œGoPro meets ancient Jerusalem.â€
- status â€“ Must be "to create", without quotation marks
** JSON Output Parser **
Every output must strictly follow this format:
{
"caption": "",
"idea": "",
"environment": "",
"status": ""
}
** Sample Outputs **
Example 1
{
"caption": "When Jesus gives you the silent treatment ï¸ğŸ˜¶ #jesusvlog #holycomedy",
"idea": "Jesus calmly stares at the camera while the disciple keeps asking, 'Are we lost?' â€“ awkward silence builds up.",
"environment": "Desert trail, golden hour light, dry bushes around, warm rocky textures and wind softly blowing.",
"status": "ready for production"
}
Example 2
{
"caption": "POV: You just met Mary Magdalene and sheâ€™s not what you expected ğŸ˜³âœ¨ #biblevlog #foryou",
"idea": "A modern-style introduction of Mary Magdalene where she breaks the fourth wall with sarcasm and confidence.",
"environment": "Dusty stone home with narrow light beams, clay walls, fabric drapes blowing slightly in the breeze.",
"status": "ready for production"
}
Example 3
{
"caption": "Me trying to explain the flood before it happened ï¸ğŸ˜ #noahvibes #bibletok",
"idea": "Noah explains why heâ€™s building the ark, while others laugh in the background â€” like a vlog rant.",
"environment": "Half-built wooden structure, cloudy sky, goats wandering around, mud everywhere, distant laughter.",
"status": "concept only"
}

# chat model : google gemini Model
model : gemini-2.5-flash

# Require Specific Output Format : enable
# Output Parser :  Structure Output Parser
{
"caption": "",
"idea": "",
"environment": "",
"status": ""
}

# Tool : Think
```

##### AI Agent - Create a Video prompt
``` bash
# Prompt:
Create a prompt for the Veo3 video based on the following information:
Idea: {{ $json.output.idea }}
Environment: {{ $json.output.environment }}
# System Message:
** System Message **
You are a professional cinematic prompt generator for AI video tools.
Your task is to convert a short-form video idea and its environment description
(inspired by biblical or ancient-world themes)
into a highly detailed, camera-aware,
emotionally rich prompt suitable for generating a cinematic AI video using Veo3.
You must understand the emotional tone, visual aesthetics,
and storytelling style of short-form TikTok videos that imitate biblical scenes with modern pacing and framing.
** Veo3 Prompt Structure Guidelines **
Each prompt should be natural, cinematic, and visually immersive, including:
- Scene description â€“ Describe the overall environment clearly (terrain, buildings, light, movement).
- Character focus â€“ If the idea involves a person,
include their position, outfit style (biblical era), mood/expression, and framing (e.g., close-up, wide shot).
- Camera movement â€“ Always include one cinematic camera motion
(e.g., slow push-in, handheld tracking, drone pan, orbit, dolly backward).
- Time of day & lighting â€“ Set the mood with light (e.g., golden hour, harsh daylight, candlelit interior).
- Atmosphere & texture â€“ Mention dust, wind, fabric movement, shadows,
reflections, or imperfections in the scene to increase realism.
- Style & quality â€“ Include cinematic tone, analog warmth,
slightly soft vintage film look, GoPro-like closeness if appropriate.
** Input **
- You will receive two fields: idea, environment
- Return only the complete and detailed Veo3 prompt, no additional text.
** Example Output **
A biblical man stands in front of a half-built wooden ark,
gesturing passionately as he explains something to the camera.
The camera follows him handheld-style, moving slightly as he paces.
In the background, groups of villagers are laughing and pointing.
The sky is overcast with low clouds, and goats wander through muddy terrain.
The man wears worn, ancient robes,
his feet muddy, his tone frustrated but hopeful.
The scene has a documentary-style realism, with soft golden highlights breaking through cloud gaps.
Light wind moves fabric and rustles dry straw around the ark.
Shot in cinematic 24fps with natural tones and slight vintage softness.

# chat model : google gemini Model
model : gemini-2.5-flash

# Tool : Think
```

##### google sheets â€“> append row in sheet

#### Gemini - Create a Video prompt
##### Schedule Trigger
##### Edit field (Schedule Trigger cannot trigger Gemini) : Gemini = "run"
##### Gemini --> message a model - Create a Idea : set follow AI Agent
##### Code (string to json)
``` js
const responseText = $input.first().json.content.parts[0].text

let jsonString = responseText;

// ç§»é™¤ ```
jsonString = jsonString.replace(/```json\n?/g, '');

// ç§»é™¤ ```
jsonString = jsonString.replace(/```\s*$/g, '');

// ç§»é™¤å‰å¾Œç©ºç™½
jsonString = jsonString.trim();

try {
  // è§£æ JSON å­—ç¬¦ä¸²
  const output = JSON.parse(jsonString);
  
  // å›å‚³è§£æå¾Œçš„çµæ§‹åŒ–è³‡æ–™
  return {
    output
  };
  
} catch (error) {
  // è§£æå¤±æ•—æ™‚çš„éŒ¯èª¤è™•ç†
  return {
    error: 'JSON format error',
    originalResponse: responseText,
    parseSuccess: false,
  };
}
```
##### Gemini --> message a model - Create a Video prompt : set follow AI Agent
##### google sheets â€“> append row in sheet

#### LinkedinPost Generator
##### n8n form : on form submission
``` bash
# set 
Title : LinkedIn Post Generator
Description : Provide the details to create a captivating LinkedIn post

# input 
Email: ...
Post Topic : 3 amazing facts about artificial intelligence
Target Audience: people who are beginners in AI
```

##### LinkedIn Post Destcription  AI Agent
``` bash
tool : HTTP Request(name -Search Web)
		Method: POST
		URL: https://api.tavily.com/search
		Authentication: Generic Credential Type
		Generic Credential Type: Header Auth
		Send Body: Enabled
		Body Content Type : JSON
		Specify Body: Using JSON 
		JSON:
		{
		"query": "{searchTerm}",
		"topic": "general",
		"search_depth": "advanced",
		"chunks_per_source": 3,
		"max_results": 1,
		"time_range": null,
		"days": 7,
		"include_answer": true,
		"include_raw_content": false,
		"include_images": false,
		"include_image_descriptions": false,
		"include_domains": [],
		"exclude_domains": []
		}
Chat model : Google Gemini Chat model
```

``` bash
# 2nd (prompt put to this)
Gemini --> message a model
	tool : HTTP Request(name -Search Web)
```

##### Create Image Prompt
``` bash
Chat model : Google Gemini Chat model
```

``` bash
# 2nd (prompt put to this)
Gemini --> message a model
```

##### Generate Title
``` bash
Chat model : Google Gemini Chat model
```

``` bash
# 2nd (prompt put to this)
Gemini --> message a model
```

##### OpenAI --> Generate an image
``` bash
Model : DALL-E3 (more cheap)
Quality : Standard
Resolution : 1024*1024
```

##### goopgle Drive --> upload file
``` bash
add File name, Folder 
```

##### Gmail --> send a message
``` bash
subtitle : Your LinkedIn Post is published
message : 
Hello!

Here are details for your linked post:

Title :{{ $('Generate Title').item.json.output }}

Description:{{ $('LinkedIn Post Destcription  AI Agent').item.json.output }}

Image URL: {{ $json.webViewLink }}
```

#### Automation to Manage and Classify Gmail
##### Gmail Trigger 
``` bash
Mode :every minite
Simplify :  disable(because we want to access all email data) 
```

##### Information Extractor
``` bash
tool: gemini chat model

Attributes: senderName
Extract the sender's name from this email, if no name, return an empty string.

add option --> System Prompt Template(use default) 
You are an advanced extraction tool. Only pull out the relevant details from the text. If you're unsure about the value of any requested attribute, leave it as an empty string.
```

##### if
``` bash
Condition : {{ $json.output.senderName }} (string) is not empty 
- Merge output type::Keep Non-Matches - è¼¸å‡ºçš„å°±æ˜¯é‚£ä¸€äº›ã€Œåªå‡ºç¾åœ¨æŸä¸€å€‹ä¾†æºï¼Œä½†åœ¨å¦ä¸€å€‹ä¾†æºæ²’æœ‰å°æ‡‰è³‡æ–™ã€çš„é …ç›®
```

##### Edit Field + Merge
``` bash
# 1st 
intro (string) Dear {{ $json.output.senderName }},

# 2nd
intro (string) Hi'
```
##### Edit Field(Clean Data) 
``` bash
message_id:{{ $('Gmail Trigger').item.json.id }}
threadId:{{ $('Gmail Trigger').item.json.threadId }}
text:{{ $('Gmail Trigger').item.json.text }} - maill å…§å®¹
intro:{{ $json.intro }}
```

##### Text  classifier 
``` bash
tool: gemini chat model

Text to Classify:{{ $json.text }}

Categories:
Services requests : Questions about consulting services offered, rates, or availability.
Consultation requests : Scheduling initial consultations or follow-up meetings.
Payments : Questions about invoices, payments, or refunds
Others : Emails that donâ€™t clearly fit into the other categories.

System Prompt Template : 
Please classify the text provided by the user into one of the following categories: {categories}, and use the provided formatting instructions below. Don't explain, and only output the json.
```

##### Gmail --> add labbel to message 
``` bash
# ï¼§mail add Label 1st
Message ID : {{ $('Clean Data').item.json.message_id }}
Label Names or IDs : <select label>
```

##### Gmail --> Replay to a message 
``` bash
Message ID : {{ $('Clean Data').item.json.message_id }}
Email Type:text
Message: {{ $('Text Classifier').item.json.intro }}: ...
```

#### Make Better Think
##### chat trigger
##### Gemini --> Message a model
``` bash
#tool:Think
Think tool Description: ### Overview This tool should...

Model: gemini-2.5-flash
Prompt: 
# Overview
You are a helpful assistant
# Instructions
When you create any piece of written content you use a "think node" to make it human-like {{ $json.chatInput }}

Simplity enable
```

##### sheet --> append row in sheet
``` bash
Docuemnt: Think tools Test
time: {{ $now.format('yyyy-MM-dd hh:mm') }}
workflow: No Agent
Input: {{ $('When chat message received').item.json.chatInput }}
output:{{ $json.content.parts[0].text }}
```

#### AI story 
```bash
# chat trigger(input example)
crowded city in the middle of the day, a lot of people, cozy atmosphere

# gemini --> Message a model
Prompt : ...
simpllify Output: enebale
Output Content as JSON

# OpenAI --> Generate an image
Model: GPT Image 1
Prompt: ..
Quality: Medium
Resolution: 1536*1024(å¯¬ç•«é¢)

# google drive --> upload(image)
Filename: image_{{ $('When chat message received').item.json.sessionId }}
input Data Field Name: data

# google drive --> download (å› è¦å­˜èµ·ä¾†upload then download)
File by URL : {{ $json.webViewLink }}

# save image to freeimage host
Method : POST
URL: https://freeimage.host/api/1/upload
Body :
key: <your key>
action : upload
source(n8n Binary File): data
format : json

# Pollo generate video by runway gen 4
Method:POST
URL: https://pollo.ai/api/platform/generation/runway/runway-gen-4-turbo
Body using JSON:
{
  "input": {
    "image": "{{ $json.image.url }}",
    "prompt": {{ $('Generate Prompt').item.json.content.parts[0].text }},
    "length": 5,
    "aspectRatio": "16:9",
    "seed": 123
  }
}

# Merge

# Wait 5s

# get video status 
Method: GET
URL: https://pollo.ai/api/platform/generation/{{ $json.data.taskId }}/status


#if 
{{ $json.data.generations[0].status }} "is equal to" Success
false link to Merge

# get Video
Method: GET
URL: {{ $json.data.generations[0].url }}

# google drive --> upload(video)
Filename: video_{{ $('When chat message received').item.json.sessionId }}
input Data Field Name: data

# Generate Audio by Speechify 
Method: POST
URL: https://api.sws.speechify.com/v1/audio/speech
Body :
{
  "input": {{ $('Generate Prompt').item.json.content.parts[0].text }},
  "voice_id": "george",
  "audio_format": "mp3"
}

#Code(Convert to File)
return [
  {
    json: {},
    binary: {
      data: {
        data: Buffer.from($json["audio_data"], "base64"),
        mimeType: "audio/mpeg",
        fileName: "output.mp3"
      }
    }
  }
];

# google drive --> upload(audio)
Filename: audio_{{ $('When chat message received').item.json.sessionId }}
input Data Field Name: data

# save to sheet(append row in sheet)
chat: {{ $('When chat message received').item.json.chatInput }}
prompt: {{ $('Generate Prompt').item.json.content.parts[0].text }}
image: {{ $('Save Image').item.json.webViewLink }}
video: {{ $('Upload file').item.json.webViewLink }}
audio: {{ $json.webViewLink }}
```

#### Viral Youtube Posting
``` bash
# Schedule trigger 
Trigger Interval: Custom(Crop) - è‡ªè¨‚
Exppreesio : 0 15 * * 2,5 - Tue,Fri 13:00 

# http Request - Get The Latest Youtube Video
Methold : GET
URL: https://www.googleapis.com/youtube/v3/search
Send Query Parameters : enable
Specify Query Parameters : Using Fields Below 
part:snippet
channelId: <your youtube channel id>
maxResults: 1
order: date
type: video
key : <your googleAPI key>

# http Request - Get Transcript(use Apify)
Methold : GET
URL: https://api.apify.com/v2/acts/pintostudio~youtube-transcript-scraper/run-sync-get-dataset-items
Send Query Parameters : enable
Specify Query Parameters : Using Fields Below 
token: <your Apify token>
Send Body: enable 
JSON --> Using JSON
{
"videoUrl": "https://www.youtube.com/watch?v={{ $json.items[0].id.videoId }}"
}

# AI Agent - Facebook Post
Prompt (User Message) : ..
System Message: ...
tool : gemini chat model(gemini-2.5-flash)

# AI Agent - Email Campaign
Prompt (User Message) : ..
System Message: ...
tool : gemini chat model(gemini-2.5-flash)

# AI Agent - Skool Annoncement
Prompt (User Message) : ..
System Message: ...
tool : gemini chat model(gemini-2.5-flash)

# Notion --> Create a database page
Database: sellect for you(eg. Youtube post #1)
Title: empty
Add property:
Video Name : {{ $('Get The Latest Youtube Video').item.json.items[0].snippet.title }}
Facebook Post: {{ $('Facebook Post').item.json.output }}
Email Campaign: {{ $('Email Campaign').item.json.output }}
Skool Announcement: {{ $json.output }}
```

#### Crecte Socia Media in Seconds
``` bash
# google sheet --> on row added
Document sheet --> on row added

#if 
Conditions : {{ $json.Done }} is empty

# Set Field
query : {{ $json['Content Subject'] }}
tragetAudience : {{ $json['Target Audience'] }}

# http request
# replace(/"/g, '\\"') :æŠŠæ‰€æœ‰é›™å¼•è™Ÿ " å–ä»£ç‚ºå·²è½‰ç¾©çš„ "ï¼Œç¢ºä¿å­—ä¸²åœ¨ JSONã€JS å­—é¢é‡æˆ–åºåˆ—åŒ–æ™‚ä¸æœƒå› æœªè½‰ç¾©å¼•è™Ÿè€Œç ´å£èªæ³•
Method : POST
URL: https://api.tavily.com/search
Body enable
# {
#   "query": "{{ $json.query.replace(/"/g, '\\"') }}",
#   "search_depth": "basic",
#   "include_answer": true,
#   "topic": "news",
#   "include_raw_content": true,
#   "max_results": 3
# }

ï¼ƒ Split Out
Fields To Split Out:results

# Aggregate 
include: Specified 
Field:title, raw_content

# AI Agent(LikedIn)
Prompt:..
System Message:..
tool: gemini chat model

# AI Agent(Facebook)
Prompt:..
System Message:..
tool: gemini chat model

# AI Agent(Blog Post)
Prompt:..
System Message:..
tool: gemini chat model

# Google sheet --> update row in sheet
Column to match on : Campaign
Campaign (using to match) : {{ $('If').item.json.Campaign }}
Done : complete
Linkdein:{{ $('LinkedIn').item.json.output }}
Facebook:{{ $('Facebook').item.json.output }}
Blog:{{ $json.output }}
```

#### Building an AI Agent Instruction From Scratch
``` bash
# Chat Trigger
Meaages prompt: {{ $json.chatInput }}
System message :
	## Purpose
	You are a professional executive assistant. Your job is to complete the task you are requested to do from the user.

	## Capibilities
	- always when it's requested to perform some task that requested dates to use, you can use this time as the reference, what time is it {{ $now }} 
	- always usee tool/tools to perform a task, if it's need

	## Tools
	- Send a message in Gmail - use this tool to send emails
	- Create an event in Google Calendar - use this tool to schedule the meetings that user requests.
	- Get Lables from Gmail - get all labels from my gmail account. Make sure to record all the labels names properly so later you can use it for other steps
	- Add label to message in Gmail - use this tool to add label to a proper message in gmail. Make sure you are using a proper label name. Every time use the id of a label to match it, instead of the label name.
	- Append row in sheet in Google Sheets - use it to save email information to google sheets. whenever you use this took first, get emails and then then use this tools to save information 

	## Interation Style
	- when you send emails, keep professional and funny tone, in the responses

	## Notes
	- every time make sure you use the tool to complete the task

# Gemini --> Message a model
# Tools - Google Calendar Tool(just login)
select Calendar
#				- Gmail tool(send a message in Gmail)
Resource : message + Send
#				- Gmail tool(Get many labels in Gmail)
Resource : label + Get many
#				- Gmail tool(Get many messages in Gmail)
Resource : message + Get many
#				- Gmail tool(Add label to message in Gmail)
Resource : message + Add Label
#				- Google Sheets Tooll(Append row in sheet in Google Sheets)
Operation: Append Row
Document:Email information

# chat
Please schedule an event for me at 8 pm, it should last 1 hour
please get all my gmail's label
Take the latest receive email and save the information inside the Google Sheet
```

#### Create an AI Agent Instructions
``` bash
# chat trigger

# gemini model
prompt: {{ $json.chatInput }}
system message :
	## Purpose
	You are a professional virtual assistant. Your job is to accomplish the task for the user.

	## Capabilities
	- If you need in some way to know what the current date is, you can use this date as a reference: {{ $now }}
	- You use AI to structure the content in a nice format and provide comprehensive information about the query.

	## Tools
	- Get News - use this tool to fetch the latest news from the internet
	- Create a Document in Google Docs - use this to create a black document docs, that contains only the title
	- Update a Document in Google Docs - use this tool to update a blank document. Insert inside the content you create with AI
	- Send an email in Gmail - use this tool to send an email to a user

	## Interaction style
	- keep the tone processional, and the format really format

	## Notes
	- When you create a blank document, always in the title include the followiing form: The News for [query] - [current date]
	- When you get your news from "get news", use AI to format it this way, it can be nicely inserted inside Google Docs. so bascicaly choose the proper format, so we have heads, bolded parts and the necessary format.
	- Every time before sending an email action, use AI to format an email in HTML format. Include headings, bolded parts, italicized, and generally the best HTML formatting

# Tools - Gmail Tool(Send a message in Gmail)

# Tools - Google Docs Tool(Create a document in Google Docs)
Folder Name: Demo

# Tools - Google Docs Tool(Update a document in Google Docs)

# Tools - HTTP Request Tool(Get News(Tavily))
Method: POST
URL:  https://api.tavily.com/search
Send Mody Enable
{
  "query": "{{ $fromAI('parameters0_Value') }}",
  "search_depth": "basic",
  "include_answer": true,
  "topic": "news",
  "include_raw_content": true,
  "max_results": 3
}

# Tools - option HTTP Request Tool(Get News(Serper))
Method: POST
URL:  https://google.serper.dev/search
Send Mody Enable
Specify Body: Using Fields Below
q: <set auto>

# chat 
Please get me the news about the "top 5 world news". Use AI to format the information in a nice way, then create a blank document, and after update it with information from AI(and translate to Traditional Chinese). And at the end, send the email with information to me: kyp001@yahoo.com.tw

# another - prompt 
	Role & Purpose  
	You are a customizable news-gathering and reporting AI agent. Your purpose is to fetch world news based on a given topic or category, format them beautifully in Google Docs, translate the summary into Traditional Chinese, and send the final report directly in an HTML email to a user-specified address.  

	Capabilities  
	- Accept user input for news topic (e.g., "top 5 world news" or any keyword).  
	- Fetch related news using Tavily News API.  
	- Summarize and format the news in a clear, professional style.  
	- Translate all summaries into Traditional Chinese.  
	- Create a blank Google Document with a clean layout (titles, sections, spacing, and styled text).  
	- Update the document with first the full English version, followed by the full Traditional Chinese version.  
	- Send the completed report via Gmail in HTML format (email body content, not just a link).  
	- current time is {{ $now }}

	** Tools **  
	- Tavily News â€“ Get the latest news by topic or category.  
	- Google Docs (Create) â€“ Start a new blank document.  
	- Google Docs (Update) â€“ Insert formatted content with styled sections.  
	- Gmail â€“ Send the final news report as HTML email directly to recipient.  

	Interaction Style  
	- Write concise, professional summaries with structured sections.  
	- Use headings, bold text, spacing, and lists to ensure readability.  
	- Present all English summaries first, then all Traditional Chinese translations.  
	- Maintain a consistent, formal, and polished style across both outputs.  

	Notes  
	- Default to top 5 items unless user specifies otherwise.  
	- Ensure Google Docs formatting uses native styling (no markdown).  
	- Email body must be HTML with proper headings, lists, and spacing.  
	- Always send to the user-specified email; confirm if not provided.  

# chat 
give me the "Ukraine war" news and send to kyp001@yahoo.com.tw
```

### wait workflow 
+ if length limite add flow for it : Telegrame, Notion
+ Line Bot
+ Audio Transcribe : NotebookLM 
+ scan youtube some channge upgrade, down mp3 file
+ google API how to set project, cost or limit ?
+ gemini limite?



###  Ref
+ reference
	+ [n8n Cheat Sheet uploaded by Superb_Net_7426 on Reddit](https://www.reddit.com/r/n8n/comments/1jy1wdc/i_made_an_n8n_cheat_sheet/)
	+ [Hostinger n8n VPS hosting](https://www.hostinger.com/vps/n8n-hosting): easiest to work
	+ [ Official n8n Update on Community Nodes](https://blog.n8n.io/community-nodes-available-on-n8n-cloud/)
	+ [The "think" tool](https://www.anthropic.com/engineering/claude-think-tool)
+ API document
	+ [Prplexity API documentation - Sonar](https://docs.perplexity.ai/getting-started/models/models/sonar)
+ channel
	+ [YouTube - Krystian Wojtarowicz AI](https://www.youtube.com/@krystianwojtarowicz-ai)
+ workflow example 
	+ [n8n github](https://github.com/n8n-io/n8n)
	+ [AI Braind ai-automation-n8n](https://github.com/qwedsazxc78/ai-automation-n8n/blob/main/README.md)
	+ [Awesome N8N: Top 100 Community Nodes](https://github.com/restyler/awesome-n8n)
	+ [Workflow Automation Templates](https://n8n.io/workflows/)
	+ [Instruction-Maker AI Agent](https://chatgpt.com/g/g-68a5e18130a88191b3d09861dd777fdb-instruction-maker-ai-agent)
+ pricee and using
	+ [Instruction-Maker AI Agent](https://chatgpt.com/g/g-68a5e18130a88191b3d09861dd777fdb-instruction-maker-ai-agent)
	+ [Apify using ](https://console.apify.com/billing/current-period)
	+ [Pollo AI using](https://pollo.ai/api-platform/billing)
	+ [Pollo AI Price](https://pollo.ai/api-platform/pricing)
	+ [OpenAI using](https://platform.openai.com/settings/organization/billing/overview)
  + [OpenAI price](https://platform.openai.com/docs/pricing)
  + [Speechify using](https://console.sws.speechify.com/billing)
