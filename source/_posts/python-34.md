---
title: (3) æ©Ÿå™¨å­¸ç¿’æœ€å¼·å…¥é–€:åŸºç¤æ•¸å­¸/æ©Ÿç‡/çµ±è¨ˆé‚å‘AIçœŸå¯¦æ•¸æ“š
abbrlink: acd3
date: 2024-08-05 15:22:28
categories: Coding
tags:
	- python
	- book
	- ML
mathjax: true
---

### æ”¯æ´å‘é‡æ©Ÿ - é³¶å°¾èŠ±,ä¹³ç™Œ,æ±½è»Šç‡ƒæ–™

<!--more-->

#### æ”¯æ´å‘é‡æ©ŸåŸºç¤è§€å¿µ
##### åŸºç¤è§€å¿µ
<div style="max-width:500px">
  {% asset_img pic1.png pic1 %}
</div>

##### æœ€å¤§å€é–“åˆ†éš”
<div style="max-width:500px">
  {% asset_img pic2.png pic2 %}
</div>

##### èªè­˜æ”¯æ´å‘é‡,æ±ºç­–é‚Šç•Œ èˆ‡ è¶…å¹³é¢
<div style="max-width:500px">
  {% asset_img pic3.png pic3 %}
</div>

##### è¶…å¹³é¢å…¬å¼(äºŒç¶­ç‚ºä¾‹)
åœ¨äºŒç¶­ç©ºé–“ä¸­ï¼Œè¶…å¹³é¢é€€åŒ–æˆä¸€æ¢ç›´ç·šã€‚æ”¯æ´å‘é‡æ©Ÿ (SVM) çš„ç›®æ¨™æ˜¯åœ¨äºŒç¶­å¹³é¢ä¸Šæ‰¾åˆ°ä¸€æ¢æœ€é©åˆçš„ç›´ç·šï¼Œå°‡ä¸åŒçš„æ•¸æ“šé»åˆ†é¡åˆ°å…©å€‹é¡åˆ¥ä¸­ï¼ŒåŒæ™‚æœ€å¤§åŒ–å…©é¡åˆ¥ä¹‹é–“çš„é‚Šç•Œã€‚
- è¶…å¹³é¢ï¼ˆç›´ç·šï¼‰å…¬å¼
	åœ¨äºŒç¶­ç©ºé–“ä¸­ï¼Œä¸€æ¢ç›´ç·šçš„æ–¹ç¨‹å¯ä»¥è¡¨ç¤ºç‚ºï¼š
	$w_1x_1 + w_2x_2 - b = 0$
	å…¶ä¸­ï¼š
	- $(x_1,x_2)æ˜¯äºŒç¶­å¹³é¢ä¸Šçš„ä¸€å€‹é»$
	- $(w_1,w_2)æ˜¯æ¬Šé‡å‘é‡ï¼Œæ±ºå®šäº†ç›´ç·šçš„æ–¹å‘$
	- b æ˜¯åç½®ï¼Œç”¨ä¾†èª¿æ•´ç›´ç·šçš„ä½ç½®
- æ±ºç­–é‚Šç•Œ
	é€™æ¢ç›´ç·šå°‡å¹³é¢åˆ†ç‚ºå…©éƒ¨åˆ†ã€‚åœ¨ SVM ä¸­ï¼Œé€™å€‹ç›´ç·šæ˜¯æ±ºç­–é‚Šç•Œï¼Œç”¨æ–¼å€åˆ†å…©å€‹é¡åˆ¥ã€‚å°æ–¼ä¸€å€‹æ•¸æ“šé»$(x_1,x_2)$ï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨æ±ºç­–å‡½æ•¸ä¾†æ±ºå®šå®ƒä½æ–¼ç›´ç·šçš„å“ªä¸€å´
	$f(x_1,x_2) = w_1x_1 + w_2x_2 - b$
	- $f(x_1,x_2)>0ï¼Œå‰‡é€™å€‹é»è¢«åˆ†é¡ç‚ºä¸€é¡ï¼ˆä¾‹å¦‚æ­£é¡ï¼Œæ¨™è¨˜ç‚º +1ï¼‰
	- $f(x_1,x_2)<0ï¼Œå‰‡é€™å€‹é»è¢«åˆ†é¡ç‚ºä¸€é¡ï¼ˆä¾‹å¦‚æ­£é¡ï¼Œæ¨™è¨˜ç‚º -1ï¼‰
- æ”¯æ´å‘é‡èˆ‡é–“éš”
	æ”¯æ´å‘é‡æ˜¯é›¢è¶…å¹³é¢æœ€è¿‘çš„æ•¸æ“šé»ã€‚å®ƒå€‘å®šç¾©äº†ã€Œé–“éš”ã€ï¼Œå³å¾è¶…å¹³é¢åˆ°æ”¯æ´å‘é‡çš„æœ€å°è·é›¢ã€‚SVM çš„ç›®æ¨™æ˜¯æœ€å¤§åŒ–é€™å€‹é–“éš”ï¼Œä»¥ä¾¿å¢åŠ æ¨¡å‹çš„é­„åŠ›å’Œå°æœªçŸ¥æ•¸æ“šçš„æ³›åŒ–èƒ½åŠ›ã€‚
	åœ¨äºŒç¶­ç©ºé–“ä¸­ï¼Œé–“éš”æ˜¯å¾è¶…å¹³é¢åˆ°æ”¯æ´å‘é‡çš„å‚ç›´è·é›¢ã€‚å…·é«”ä¾†èªªï¼Œå¦‚æœæˆ‘å€‘çš„æ•¸æ“šé»æ˜¯ç·šæ€§å¯åˆ†çš„ï¼ŒSVM æœƒæ‰¾åˆ°å…©æ¢å¹³è¡Œçš„	è™›ç·šï¼š
	- $ä¸€æ¢æ˜¯ w_1x_1 + w_2x_2 - b = 1$
	- $å¦ä¸€æ¢æ˜¯ w_1x_1 + w_2x_2 - b = -1$

	é€™å…©æ¢è™›ç·šä¹‹é–“çš„è·é›¢æ˜¯$\frac{2}{âˆ¥wâˆ¥}$ï¼Œç›®æ¨™æ˜¯æœ€å¤§åŒ–é€™å€‹è·é›¢
	âˆ¥wâˆ¥ å®šç¾©ç‚ºæ¬Šé‡å‘é‡ä¸­å„å€‹åˆ†é‡å¹³æ–¹å’Œçš„å¹³æ–¹æ ¹ï¼š
	$âˆ¥wâˆ¥=\sqrt{w_1^2+w_2^2...+w_n^2}$
	$å…¶ä¸­ï¼Œğ‘¤ = (w_1,w_2, ...,w_n) æ˜¯SVMæ¨¡å‹çš„æ¬Šé‡å‘é‡$

#### æ”¯æ´å‘é‡æ©Ÿ - åˆ†é¡é‹ç”¨çš„åŸºç¤å¯¦ä¾‹
##### ç¹ªè£½10å€‹æ•¸æ“šé»
``` py
import numpy as np
import matplotlib.pyplot as plt

# å»ºç«‹10å€‹é»,5å€‹ç‚ºåˆ†é¡A,5å€‹ç‚ºåˆ†é¡B
X = np.array([[1, 2.5], [0.5, 2], [2, 2], [1.5, 1], [2.5, 1.3],
              [3, 3.5], [4.5, 3.5], [4, 4], [2.5, 4.5], [3.5, 3] ])
y = np.array(['A','A','A','A','A','B','B','B','B','B',])

# ç¹ªè£½é»,A 'o', B '*'
for i, marker in zip(['A', 'B'], ['o', '*']):
    plt.scatter(X[y==i, 0], X[y==i, 1], marker=marker, label=i )

plt.xlim(0, 5)
plt.ylim(0, 5)
plt.xlabel(r'$x_{1}$', fontsize=14)
plt.ylabel(r'$x_{2}$', fontsize=14)
plt.legend()
plt.show()
```

<div style="max-width:500px">
  {% asset_img pic4.png pic4 %}
</div>

##### æ”¯æ´å‘é‡èªæ³•
``` py
import numpy as np
from sklearn import svm

# å»ºç«‹10å€‹é»,5å€‹ç‚ºåˆ†é¡A,5å€‹ç‚ºåˆ†é¡B
X = np.array([[1, 2.5], [0.5, 2], [2, 2], [1.5, 1], [2.5, 1.3],
              [3, 3.5], [4.5, 3.5], [4, 4], [2.5, 4.5], [3.5, 3] ])
y = np.array(['A','A','A','A','A','B','B','B','B','B',])

# å»ºç«‹ linear svc+è€¦åˆ
svc = svm.SVC(kernel='linear')
svc.fit(X, y)

# æ”¯æŒå‘é‡ è¡¨ æ±ºç­–é‚Šçš„å‘é‡
print(f'æ¬Šé‡ä¿‚æ•¸         :{svc.coef_}')
print(f'æˆªè·(åç½®)       :{svc.intercept_}')
print(f'æ”¯æŒå‘é‡ç´¢å¼•     :{svc.support_}')
print(f'æ”¯æŒå‘é‡         :\n{svc.support_vectors_}')
print(f'æ¯å€‹é¡åˆ¥æ”¯æ´å‘é‡æ•¸:{svc.n_support_}')

# æ¬Šé‡ä¿‚æ•¸         :[[0.79988954 0.80016569]]
# æˆªè·(åç½®)       :[-4.20015648]
# æ”¯æŒå‘é‡ç´¢å¼•     :[2 5 9]
# æ”¯æŒå‘é‡         :[[2.  2. ]
#  [3.  3.5]
#  [3.5 3. ]]
# æ¯å€‹é¡åˆ¥æ”¯æ´å‘é‡æ•¸:[1 2]
#   w1 = 0.79988954
#   w2 = 0.80016569
#   d = -4.20015648
```

##### æ¨å°è¶…å¹³é¢æ–œç‡
$g(x) = w_1x_1 + w_2x_2 + b = 0$
$æ‰€ä»¥ç¶“éé» (0,\frac{-b}{w_2}) and (\frac{-b}{w_1},0)$
$æ–œç‡(slope) = \frac{\Delta{y}}{\Delta{x}} = \frac{\frac{-b}{w_2}}{\frac{b}{w_1}} = \frac{-w_1}{w_2} $

##### ç¹ªè£½è¶…å¹³é¢å’Œæ±ºç­–é‚Šç•Œ
``` py
import numpy as np
from sklearn import svm
import matplotlib.pyplot as plt
from joblib import dump

# windows ä½¿ç”¨ å¾®è»Ÿæ­£é»‘é«”
plt.rcParams["font.family"] = ["Microsoft JhengHei"]

# å»ºç«‹10å€‹é»,5å€‹ç‚ºåˆ†é¡A,5å€‹ç‚ºåˆ†é¡B
X = np.array([[1, 2.5], [0.5, 2], [2, 2], [1.5, 1], [2.5, 1.3],
              [3, 3.5], [4.5, 3.5], [4, 4], [2.5, 4.5], [3.5, 3] ])
y = np.array(['A','A','A','A','A','B','B','B','B','B',])

# ç¹ªè£½é»,A 'o', B '*'
for i, marker in zip(['A', 'B'], ['o', '*']):
    plt.scatter(X[y==i, 0], X[y==i, 1], marker=marker, label=i )

# å»ºç«‹ linear svc+è€¦åˆ
svc = svm.SVC(kernel='linear')
svc.fit(X, y)

# æ¬Šé‡, åç½®å€¼
w = svc.coef_[0]
slope = -w[0] / w[1]
b = svc.intercept_[0]
# å„²å­˜æ¨¡å‹
dump(svc, 'svc28_3.joblib')

# ç¹ªè£½è¶…å¹³é¢
xx = np.linspace(0, 5)
# same as yy = (-b - w[0] * xx)/w[1], but use slope
# yy_slope = slope * xx - ( b / w[1])
yy = (-b - w[0] * xx)/w[1]
plt.plot(xx, yy, linewidth=2, color='green')

# ç¹ªè£½é‚Šç•Œ1
sv = svc.support_vectors_[0]
# b = -(w[0]*sv[0] + w[1]*sv[1])
yy_1 = ((w[0]*sv[0] + w[1]*sv[1]) - w[0] * xx)/w[1]
plt.plot(xx, yy_1, 'b--')

# ç¹ªè£½é‚Šç•Œ2
sv = svc.support_vectors_[-1]
yy_2 = ((w[0]*sv[0] + w[1]*sv[1]) - w[0] * xx)/w[1]
plt.plot(xx, yy_2, 'b--')

# xx = np.linspace(0, 5)
# same as yy = (-b - w[0] * xx)/w[1], but use slope
# yy_slope = slope * xx - ( b / w[1])
# yy = (-b - w[0] * xx)/w[1]
# plt.plot(xx, yy, linewidth=2, color='green')

# ç”¨åœ“åœˆç¹ªè£½æ”¯æ´å‘é‡
# s=100 è¨­ç½®æ¯å€‹æ•£é»çš„å¤§å°
# facecolors='none', 'none' è¡¨ç¤ºé»æ²’æœ‰å¡«å……é¡è‰²
# edgecolors='k', è¨­ç½®é»çš„é‚Šç•Œé¡è‰² 'k' æ˜¯é»‘è‰²çš„ç¸®å¯«
plt.scatter(svc.support_vectors_[:,0], svc.support_vectors_[:,1],
            s=100, facecolors='none', edgecolors='k')

plt.xlim(0, 5)
plt.ylim(0, 5)
plt.title('æ”¯æ´å‘é‡æ©Ÿ-ç¹ªè£½è¶…å¹³é¢åŠæ±ºç­–é‚Šç•Œ')
plt.xlabel(r'$x_{1}$', fontsize=14)
plt.ylabel(r'$x_{2}$', fontsize=14)
plt.legend()
plt.show()
```

<div style="max-width:500px">
  {% asset_img pic5.png pic5 %}
</div>

##### æ•¸æ“šåˆ†é¡
``` py
from joblib import load

# è¼‰å…¥æ¨¡å‹
svc = load('svc28_3.joblib')

while(1):
    x = eval(input("è«‹è¼¸å…¥ x åº§æ¨™:"))
    y = eval(input("è«‹è¼¸å…¥ y åº§æ¨™:"))
    print(f"({x},{y}) åˆ†é¡æ˜¯:{svc.predict([[x,y]])[0]}")
    z = input(f'æ˜¯å¦ç¹¼çºŒ(y/n) : ')
    if z == 'n' or z == 'N':
        break

# è«‹è¼¸å…¥ x åº§æ¨™:3
# è«‹è¼¸å…¥ y åº§æ¨™:3
# (3,3) åˆ†é¡æ˜¯:B
# æ˜¯å¦ç¹¼çºŒ(y/n) : y
# è«‹è¼¸å…¥ x åº§æ¨™:2
# è«‹è¼¸å…¥ y åº§æ¨™:2
# (2,2) åˆ†é¡æ˜¯:A
```

##### decision_function()