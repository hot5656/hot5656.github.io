<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hot5656.github.io","root":"/","images":"/images","scheme":"Gemini","version":"8.2.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜尋...","empty":"我們無法找到任何有關 ${query} 的搜索結果","hits_time":"${hits} 找到 ${time} 個結果","hits":"找到 ${hits} 個結果"},"path":"/search.json","localsearch":{"enable":"enable","trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false}};
  </script>
<meta name="description" content="install n8nHostinger n8n VPS hosting123456install as guide flow# udgrade n8n for the Ubuntu docker compose pulldocker compose downdocker compose up -d">
<meta property="og:type" content="article">
<meta property="og:title" content="n8n - AI Agents, AI Automations &amp; AI Voice Agents (1)">
<meta property="og:url" content="https://hot5656.github.io/2025/07/28/n8n-2/index.html">
<meta property="og:site_name" content="Robert 雜記">
<meta property="og:description" content="install n8nHostinger n8n VPS hosting123456install as guide flow# udgrade n8n for the Ubuntu docker compose pulldocker compose downdocker compose up -d">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://hot5656.github.io/2025/07/28/n8n-2/pic1.png">
<meta property="og:image" content="https://hot5656.github.io/2025/07/28/n8n-2/pic2.png">
<meta property="og:image" content="https://hot5656.github.io/2025/07/28/n8n-2/pic3.png">
<meta property="article:published_time" content="2025-07-28T02:37:03.000Z">
<meta property="article:modified_time" content="2025-12-04T07:50:14.651Z">
<meta property="article:author" content="Robert Kao">
<meta property="article:tag" content="n8n">
<meta property="article:tag" content="udemy">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hot5656.github.io/2025/07/28/n8n-2/pic1.png">


<link rel="canonical" href="https://hot5656.github.io/2025/07/28/n8n-2/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-TW'
  };
</script>
<title>n8n - AI Agents, AI Automations & AI Voice Agents (1) | Robert 雜記</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Robert 雜記</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首頁</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>標籤</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分類</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>歸檔列表</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜尋
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜尋..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#install-n8n"><span class="nav-number">1.</span> <span class="nav-text">install n8n</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Hostinger-n8n-VPS-hosting"><span class="nav-number">1.1.</span> <span class="nav-text">Hostinger n8n VPS hosting</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#install-in-windows-Node-js"><span class="nav-number">1.2.</span> <span class="nav-text">install in windows(Node.js)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#install-in-Mac-Node-js"><span class="nav-number">1.3.</span> <span class="nav-text">install in Mac(Node.js)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#coding"><span class="nav-number">2.</span> <span class="nav-text">coding</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#JSON-or-%E2%80%9CSet-Field%E2%80%9D"><span class="nav-number">2.1.</span> <span class="nav-text">JSON or “Set Field”</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Genernal"><span class="nav-number">2.1.1.</span> <span class="nav-text">Genernal</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E2%9D%87%EF%B8%8F-Translate-JSON-string-to-json"><span class="nav-number">2.1.2.</span> <span class="nav-text">❇️ Translate JSON string to json</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E2%9D%87%EF%B8%8F-Edit-field-2-condition-%E5%83%85%E5%B0%8D%E5%96%AE%E4%B8%80-%E8%BC%B8%E5%85%A5-node-%E6%9C%89%E7%94%A8"><span class="nav-number">2.1.3.</span> <span class="nav-text">❇️ Edit field - 2 condition(僅對單一 輸入 node 有用)</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Google-Drive"><span class="nav-number">2.2.</span> <span class="nav-text">Google Drive</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Regular-Expression"><span class="nav-number">2.3.</span> <span class="nav-text">Regular Expression</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%9D%87%EF%B8%8F-Code"><span class="nav-number">2.4.</span> <span class="nav-text">❇️ Code</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#array-to-json-output"><span class="nav-number">2.4.1.</span> <span class="nav-text">array to json output</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#convert-data-to-a-file-mp3"><span class="nav-number">2.4.2.</span> <span class="nav-text">convert data to a file mp3</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#remove-special-character"><span class="nav-number">2.4.3.</span> <span class="nav-text">remove special character</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#string-to-json"><span class="nav-number">2.4.4.</span> <span class="nav-text">string to json</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#10-95Customer-Data-Processor-Complex-Data-Cleaning-Example"><span class="nav-number">2.4.5.</span> <span class="nav-text">10_95Customer+Data+Processor+Complex+(Data+Cleaning+Example)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#10-95Weather-Message-Generator-Example"><span class="nav-number">2.4.6.</span> <span class="nav-text">10_95Weather+Message+Generator+Example</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#10-95Sales-Calculator-Example"><span class="nav-number">2.4.7.</span> <span class="nav-text">10_95Sales+Calculator+Example</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#10-95Data-Format-Converter-Example"><span class="nav-number">2.4.8.</span> <span class="nav-text">10_95Data+Format+Converter+Example</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#10-96-class-example"><span class="nav-number">2.4.9.</span> <span class="nav-text">10_96 class example</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#10-106-add-additional-field"><span class="nav-number">2.4.10.</span> <span class="nav-text">10_106 add additional field</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#10-106-await-and-call-API"><span class="nav-number">2.4.11.</span> <span class="nav-text">10_106 await and call API</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#10-106-reduce-process-data"><span class="nav-number">2.4.12.</span> <span class="nav-text">10_106 reduce process data</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#10-106-create-csv-binary-file"><span class="nav-number">2.4.13.</span> <span class="nav-text">10_106 create csv binary file</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E2%9D%87%EF%B8%8F-11-119-AI-Agent-output-string-convert-to-json"><span class="nav-number">2.4.14.</span> <span class="nav-text">❇️ 11_119 AI Agent output string,convert to json</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E2%9D%87%EF%B8%8F-code-check-from-2-source"><span class="nav-number">2.4.15.</span> <span class="nav-text">❇️ code check from 2 source</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E2%9D%87%EF%B8%8F-data-string-%E5%88%86%E6%AE%B5"><span class="nav-number">2.4.16.</span> <span class="nav-text">❇️ data string 分段</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JavaScrip-Function"><span class="nav-number">2.5.</span> <span class="nav-text">JavaScrip Function</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#function-string"><span class="nav-number">2.5.1.</span> <span class="nav-text">function string</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#function-number"><span class="nav-number">2.5.2.</span> <span class="nav-text">function number</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#function-array"><span class="nav-number">2.5.3.</span> <span class="nav-text">function array</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#function-object-amp-amp-bollen"><span class="nav-number">2.5.4.</span> <span class="nav-text">function object &amp;&amp; bollen</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#function-Other"><span class="nav-number">2.5.5.</span> <span class="nav-text">function Other</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#function"><span class="nav-number">2.5.6.</span> <span class="nav-text">function</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Example"><span class="nav-number">2.5.7.</span> <span class="nav-text">Example</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Tool"><span class="nav-number">3.</span> <span class="nav-text">Tool</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Slack"><span class="nav-number">3.1.</span> <span class="nav-text">Slack</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Create-Slack-API"><span class="nav-number">3.1.1.</span> <span class="nav-text">Create : Slack API</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Google"><span class="nav-number">3.2.</span> <span class="nav-text">Google</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#google-standard-node"><span class="nav-number">3.2.1.</span> <span class="nav-text">google standard node</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#google-HTTP-Request-YouTube-Youtube-PlaylistItems-Doc-or-Youtube-PlaylistItems-Doc-TW"><span class="nav-number">3.2.2.</span> <span class="nav-text">google HTTP Request(YouTube) - Youtube PlaylistItems Doc or Youtube PlaylistItems Doc-TW</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Telegram-token"><span class="nav-number">3.3.</span> <span class="nav-text">Telegram token</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Airtable-token"><span class="nav-number">3.4.</span> <span class="nav-text">Airtable token</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%9D%87%EF%B8%8Fgoogle-Gemini-API-key-Google-AI-Studio-%E2%9D%87%EF%B8%8FUsage-%E2%9D%87%EF%B8%8FCondition"><span class="nav-number">3.5.</span> <span class="nav-text">❇️google Gemini  API key -  Google AI Studio - ❇️Usage, ❇️Condition</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#google-API-key-for-Youtube"><span class="nav-number">3.6.</span> <span class="nav-text">google API key for Youtube</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Reddit-App"><span class="nav-number">3.7.</span> <span class="nav-text">Reddit App</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Notion"><span class="nav-number">3.8.</span> <span class="nav-text">Notion</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Notion-Integrations-%E5%BB%BA%E7%AB%8B-%E5%85%A7%E9%83%A8%E6%95%B4%E5%90%88%E5%AF%86%E9%91%B0"><span class="nav-number">3.8.1.</span> <span class="nav-text">Notion Integrations 建立 內部整合密鑰</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#peplexity-API-key"><span class="nav-number">3.9.</span> <span class="nav-text">peplexity API key</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Apify-token"><span class="nav-number">3.10.</span> <span class="nav-text">Apify token</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Supabase"><span class="nav-number">3.11.</span> <span class="nav-text">Supabase</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Supabase-use-for-RAG"><span class="nav-number">3.11.1.</span> <span class="nav-text">Supabase use for RAG</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Supabase-use-for-whatsapp"><span class="nav-number">3.11.2.</span> <span class="nav-text">Supabase use for whatsapp</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Supabase-use-for-recorded-communication-and-RAG-Supabase-Vector-Store-node-%E2%80%93-gt-quickstart-for-setting-up-your-vector-store"><span class="nav-number">3.11.3.</span> <span class="nav-text">Supabase use for recorded communication and  RAG : Supabase Vector Store node –&gt; quickstart for setting up your vector store</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#facebook-developer-WhatsApp"><span class="nav-number">3.12.</span> <span class="nav-text">facebook developer WhatsApp</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BB%BA%E7%AB%8B%E6%87%89%E7%94%A8%E7%A8%8B%E5%BC%8F"><span class="nav-number">3.12.1.</span> <span class="nav-text">建立應用程式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Client-ID-amp-ient-Secret-receive-from-WhatsApp"><span class="nav-number">3.12.2.</span> <span class="nav-text">Client ID &amp; ient Secret(receive from WhatsApp)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%AC%8A%E6%9D%96-%E5%8F%8A-Account-ID-send-to-WhatsApp"><span class="nav-number">3.12.3.</span> <span class="nav-text">權杖 及 Account ID(send to WhatsApp)</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Rapid-zillow-By-Sabri"><span class="nav-number">3.13.</span> <span class="nav-text">Rapid - zillow(By Sabri)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#pinecorn-for-RAG"><span class="nav-number">3.14.</span> <span class="nav-text">pinecorn - for RAG</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#groq-for-mamny-LLM-free-limit-support-Model"><span class="nav-number">3.15.</span> <span class="nav-text">groq - for mamny LLM, free limit, support Model</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SerpAPI-free-250-searches-x2F-month"><span class="nav-number">3.16.</span> <span class="nav-text">SerpAPI - free 250 searches &#x2F; month</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Setting"><span class="nav-number">4.</span> <span class="nav-text">Setting</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#API-return-code"><span class="nav-number">4.1.</span> <span class="nav-text">API return code</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#prompt"><span class="nav-number">4.2.</span> <span class="nav-text">prompt</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%9D%87%EF%B8%8F-custom-key-in-header"><span class="nav-number">4.3.</span> <span class="nav-text">❇️ custom key in header</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%9D%87%EF%B8%8F-twelvedata-set-key-at-Query-Parameters"><span class="nav-number">4.4.</span> <span class="nav-text">❇️ twelvedata - set key at Query Parameters</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GNews-set-key-at-Query-Parameters"><span class="nav-number">4.5.</span> <span class="nav-text">GNews - set key at Query Parameters</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NewsAPI-set-key-at-Query-Parameters"><span class="nav-number">4.6.</span> <span class="nav-text">NewsAPI - set key at Query Parameters</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Twitter-API"><span class="nav-number">4.7.</span> <span class="nav-text">Twitter API</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Perplexity-ask-Perplexity-API"><span class="nav-number">4.8.</span> <span class="nav-text">Perplexity - ask Perplexity API</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Rapid-zillow"><span class="nav-number">4.9.</span> <span class="nav-text">Rapid - zillow</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#This-message-was-sent-automatically-with-n8n"><span class="nav-number">4.10.</span> <span class="nav-text">This message was sent automatically with n8n</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#n8n-Community"><span class="nav-number">4.11.</span> <span class="nav-text">n8n Community</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#enable"><span class="nav-number">4.11.1.</span> <span class="nav-text">enable</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#install-by-n8n-cloud"><span class="nav-number">4.11.2.</span> <span class="nav-text">install by n8n cloud</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#install-by-n8n-hosting"><span class="nav-number">4.11.3.</span> <span class="nav-text">install by n8n hosting</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#node"><span class="nav-number">5.</span> <span class="nav-text">node</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#n8n-form-on-form-submission"><span class="nav-number">5.1.</span> <span class="nav-text">n8n form : on form submission</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#send-a-message-to-Slack-Slack-%E2%80%93-gt-send-a-message"><span class="nav-number">5.2.</span> <span class="nav-text">send a message to Slack : Slack –&gt; send a message</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#add-user-to-google-contract-google-contracts-%E2%80%93-gt-create-a-contract"><span class="nav-number">5.3.</span> <span class="nav-text">add user to google contract : google contracts –&gt; create a contract</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#wait-message-from-Telegram%E2%80%99s-bot-%E2%80%9C-on-app-event-gt-telegram-%E2%80%93-gt-on-message"><span class="nav-number">5.4.</span> <span class="nav-text">wait message from Telegram’s bot “ on app event -&gt; telegram –&gt; on message</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AI-Agent-framework-AI-agent-node"><span class="nav-number">5.5.</span> <span class="nav-text">AI Ａgent framework :AI agent node</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Gemini-response-ask-Google-Gemini-Chat-model-link-to-AIn-Agent-Chat-Model"><span class="nav-number">5.6.</span> <span class="nav-text">Gemini response ask : Google Gemini Chat model(link to AIn Agent Chat Model)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Sen-to-Telgram-Telegram-%E2%80%93-gt-send-a-text-message"><span class="nav-number">5.7.</span> <span class="nav-text">Sen to Telgram : Telegram –&gt; send a text message</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Google-Driver-%E2%80%93-gt-On-change-involving-a-specific-Folder"><span class="nav-number">5.8.</span> <span class="nav-text">Google Driver –&gt; On change involving a specific Folder</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Google-Driver%E2%80%93-gt-Share-File"><span class="nav-number">5.9.</span> <span class="nav-text">Google Driver–&gt; Share File</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Airtable-%E2%80%93-gt-Create-a-record"><span class="nav-number">5.10.</span> <span class="nav-text">Airtable –&gt;Create a record</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#download-file-from-google-drive-google-drive%E2%80%93-gt-download-file"><span class="nav-number">5.11.</span> <span class="nav-text">download file from google drive : google drive–&gt; download file</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Gemini-Transcribe-Gogle-Gemini-%E2%80%93-gt-Transcribe-a-recoding"><span class="nav-number">5.12.</span> <span class="nav-text">Gemini Transcribe : Gogle Gemini –&gt; Transcribe a recoding</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Gemini-Summarize-Gogle-Gemini-%E2%80%93-gt-Message-a-model"><span class="nav-number">5.13.</span> <span class="nav-text">Gemini Summarize : Gogle Gemini –&gt; Message a model</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#save-to-Notion-Notion-%E2%80%93-gt-Append-a-block"><span class="nav-number">5.14.</span> <span class="nav-text">save to Notion : Notion –&gt; Append a block</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#update-to-Notion-database-Notion-%E2%80%93-gt-Create-a-database-page"><span class="nav-number">5.15.</span> <span class="nav-text">update to Notion database : Notion –&gt; Create a database page</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#get-a-google-doc-Google-Docs-%E2%80%93-gt-Get-document"><span class="nav-number">5.16.</span> <span class="nav-text">get a google doc : Google Docs –&gt; Get document</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#precess-by-Gemini-Gemini-%E2%80%93-gt-Meessage-a-modem"><span class="nav-number">5.17.</span> <span class="nav-text">precess by Gemini : Gemini –&gt; Meessage a modem</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#http-request-freeimage-host"><span class="nav-number">5.18.</span> <span class="nav-text">http request(freeimage host)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#http-request-imgbb"><span class="nav-number">5.19.</span> <span class="nav-text">http request(imgbb)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#http-request-API-Market-free-image-amp-video-upload"><span class="nav-number">5.20.</span> <span class="nav-text">http request(API Market free image &amp; video upload)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#basc-LLM-Chain-Model-Use-for-simple-prompt-and-response-tasks-with-no-advanced-logic"><span class="nav-number">5.21.</span> <span class="nav-text">basc LLM Chain + Model : Use for simple prompt-and-response tasks with no advanced logic</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Information-Extractor-Model-extractor-data"><span class="nav-number">5.22.</span> <span class="nav-text">Information Extractor + Model : extractor data</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Sentimat-Anaysys-Model-Use-to-detect-tone-positive-negative-neutral-in-text"><span class="nav-number">5.23.</span> <span class="nav-text">Sentimat Anaysys + Model :　Use to detect tone (positive, negative, neutral) in text.</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Text-Classifier-Model-Use-to-sort-text-into-categories"><span class="nav-number">5.24.</span> <span class="nav-text">Text Classifier + Model : Use to sort text into categories</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Summarization-chain-Use-to-condense-long-content-into-a-short-summary"><span class="nav-number">5.25.</span> <span class="nav-text">Summarization chain : Use to condense long content into a short summary</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Split-Turn-a-list-item-s-into-separate-items"><span class="nav-number">5.26.</span> <span class="nav-text">Split : Turn a list item(s) into separate items</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Splitter"><span class="nav-number">5.27.</span> <span class="nav-text">Splitter</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#workflow"><span class="nav-number">6.</span> <span class="nav-text">workflow</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Perplexity"><span class="nav-number">6.1.</span> <span class="nav-text">Perplexity</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Smart-Perlexity-AI-Agent"><span class="nav-number">6.1.1.</span> <span class="nav-text">Smart Perlexity AI Agent</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Perlexity-Node"><span class="nav-number">6.1.2.</span> <span class="nav-text">Perlexity Node</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Perplexity-Node-HTTP-Request"><span class="nav-number">6.1.3.</span> <span class="nav-text">Perplexity Node(HTTP Request)</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#example-AI-automation-from-Templeate"><span class="nav-number">6.2.</span> <span class="nav-text">example AI automation from Templeate</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AI-Automation-Feedback-Collect-form"><span class="nav-number">6.3.</span> <span class="nav-text">AI Automation Feedback Collect form</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#on-form-submission"><span class="nav-number">6.3.1.</span> <span class="nav-text">on form submission</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#google-sheets-%E2%80%93-gt-append-row-in-sheet"><span class="nav-number">6.3.2.</span> <span class="nav-text">google sheets –&gt; append row in sheet</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AI-Agent-from-scratch"><span class="nav-number">6.4.</span> <span class="nav-text">AI Agent from scratch</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#chat-Trigger"><span class="nav-number">6.4.1.</span> <span class="nav-text">chat Trigger</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#AI-Agent"><span class="nav-number">6.4.2.</span> <span class="nav-text">AI Agent</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#AI-Agent-Chat-Model-Gemini-chat-model"><span class="nav-number">6.4.3.</span> <span class="nav-text">AI Agent - Chat Model :　Gemini chat model</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#AI-Agent-Memory-simple-memory"><span class="nav-number">6.4.4.</span> <span class="nav-text">AI Agent - Memory :　simple memory</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#AI-Agent-Tool-Google-Sheets-Tool"><span class="nav-number">6.4.5.</span> <span class="nav-text">AI Agent - Tool :  Google Sheets Tool</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#AI-Agent-Tool-Gmail-Tool"><span class="nav-number">6.4.6.</span> <span class="nav-text">AI Agent - Tool : Gmail Tool</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Get-Daily-News"><span class="nav-number">6.5.</span> <span class="nav-text">Get Daily News</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Schedule-Trigger"><span class="nav-number">6.5.1.</span> <span class="nav-text">Schedule Trigger</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Edit-Field-set-topic-value-%E2%80%9CWorld-News%E2%80%9D-%E2%80%9CAI%E2%80%9D-%E2%80%A6"><span class="nav-number">6.5.2.</span> <span class="nav-text">Edit Field : set topic value : “World News” , “AI” …</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#HTTP-request-1-GNews-HTTP-request-2-news-API-for-2-new-source"><span class="nav-number">6.5.3.</span> <span class="nav-text">HTTP request#1-GNews, HTTP request#2-news API : for 2 new source</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Merge"><span class="nav-number">6.5.4.</span> <span class="nav-text">Merge</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#AI-AGent-1"><span class="nav-number">6.5.5.</span> <span class="nav-text">AI AGent(1)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#gooogle-Gemini-%E2%80%93-gt-message-a-model-2-use-prompt-as-AI-AGent"><span class="nav-number">6.5.6.</span> <span class="nav-text">gooogle Gemini –&gt; message a model(2):use prompt as AI AGent</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Telegram-%E2%80%93-gt-send-a-text-message"><span class="nav-number">6.5.7.</span> <span class="nav-text">Telegram –&gt; send a text message</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Generate-Video-prompt"><span class="nav-number">6.6.</span> <span class="nav-text">Generate Video prompt</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Schedule-Trigger-1"><span class="nav-number">6.6.1.</span> <span class="nav-text">Schedule Trigger</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#AI-Agent-Create-a-Idea"><span class="nav-number">6.6.2.</span> <span class="nav-text">AI Agent - Create a Idea</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#AI-Agent-Create-a-Video-prompt"><span class="nav-number">6.6.3.</span> <span class="nav-text">AI Agent - Create a Video prompt</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#google-sheets-%E2%80%93-gt-append-row-in-sheet-1"><span class="nav-number">6.6.4.</span> <span class="nav-text">google sheets –&gt; append row in sheet</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Gemini-Create-a-Video-prompt"><span class="nav-number">6.7.</span> <span class="nav-text">Gemini - Create a Video prompt</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Schedule-Trigger-2"><span class="nav-number">6.7.1.</span> <span class="nav-text">Schedule Trigger</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Edit-field-Schedule-Trigger-cannot-trigger-Gemini-Gemini-x3D-%E2%80%9Crun%E2%80%9D"><span class="nav-number">6.7.2.</span> <span class="nav-text">Edit field (Schedule Trigger cannot trigger Gemini) : Gemini &#x3D; “run”</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Gemini-%E2%80%93-gt-message-a-model-Create-a-Idea-set-follow-AI-Agent"><span class="nav-number">6.7.3.</span> <span class="nav-text">Gemini –&gt; message a model - Create a Idea : set follow AI Agent</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Code-string-to-json"><span class="nav-number">6.7.4.</span> <span class="nav-text">Code (string to json)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Gemini-%E2%80%93-gt-message-a-model-Create-a-Video-prompt-set-follow-AI-Agent"><span class="nav-number">6.7.5.</span> <span class="nav-text">Gemini –&gt; message a model - Create a Video prompt : set follow AI Agent</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#google-sheets-%E2%80%93-gt-append-row-in-sheet-2"><span class="nav-number">6.7.6.</span> <span class="nav-text">google sheets –&gt; append row in sheet</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#LinkedinPost-Generator"><span class="nav-number">6.8.</span> <span class="nav-text">LinkedinPost Generator</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#n8n-form-on-form-submission-1"><span class="nav-number">6.8.1.</span> <span class="nav-text">n8n form : on form submission</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#LinkedIn-Post-Destcription-AI-Agent"><span class="nav-number">6.8.2.</span> <span class="nav-text">LinkedIn Post Destcription  AI Agent</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Create-Image-Prompt"><span class="nav-number">6.8.3.</span> <span class="nav-text">Create Image Prompt</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Generate-Title"><span class="nav-number">6.8.4.</span> <span class="nav-text">Generate Title</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#OpenAI-%E2%80%93-gt-Generate-an-image"><span class="nav-number">6.8.5.</span> <span class="nav-text">OpenAI –&gt; Generate an image</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#goopgle-Drive-%E2%80%93-gt-upload-file"><span class="nav-number">6.8.6.</span> <span class="nav-text">goopgle Drive –&gt; upload file</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Gmail-%E2%80%93-gt-send-a-message"><span class="nav-number">6.8.7.</span> <span class="nav-text">Gmail –&gt; send a message</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Automation-to-Manage-and-Classify-Gmail"><span class="nav-number">6.9.</span> <span class="nav-text">Automation to Manage and Classify Gmail</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Gmail-Trigger"><span class="nav-number">6.9.1.</span> <span class="nav-text">Gmail Trigger</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Information-Extractor"><span class="nav-number">6.9.2.</span> <span class="nav-text">Information Extractor</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#if"><span class="nav-number">6.9.3.</span> <span class="nav-text">if</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Edit-Field-Merge"><span class="nav-number">6.9.4.</span> <span class="nav-text">Edit Field + Merge</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Edit-Field-Clean-Data"><span class="nav-number">6.9.5.</span> <span class="nav-text">Edit Field(Clean Data)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Text-classifier"><span class="nav-number">6.9.6.</span> <span class="nav-text">Text  classifier</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Gmail-%E2%80%93-gt-add-labbel-to-message"><span class="nav-number">6.9.7.</span> <span class="nav-text">Gmail –&gt; add labbel to message</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Gmail-%E2%80%93-gt-Replay-to-a-message"><span class="nav-number">6.9.8.</span> <span class="nav-text">Gmail –&gt; Replay to a message</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Make-Better-Think"><span class="nav-number">6.10.</span> <span class="nav-text">Make Better Think</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#chat-trigger"><span class="nav-number">6.10.1.</span> <span class="nav-text">chat trigger</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Gemini-%E2%80%93-gt-Message-a-model"><span class="nav-number">6.10.2.</span> <span class="nav-text">Gemini –&gt; Message a model</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#sheet-%E2%80%93-gt-append-row-in-sheet"><span class="nav-number">6.10.3.</span> <span class="nav-text">sheet –&gt; append row in sheet</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AI-story"><span class="nav-number">6.11.</span> <span class="nav-text">AI story</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Viral-Youtube-Posting"><span class="nav-number">6.12.</span> <span class="nav-text">Viral Youtube Posting</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Crecte-Socia-Media-in-Seconds"><span class="nav-number">6.13.</span> <span class="nav-text">Crecte Socia Media in Seconds</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Building-an-AI-Agent-Instruction-From-Scratch"><span class="nav-number">6.14.</span> <span class="nav-text">Building an AI Agent Instruction From Scratch</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Create-an-AI-Agent-Instructions"><span class="nav-number">6.15.</span> <span class="nav-text">Create an AI Agent Instructions</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#wait-workflow"><span class="nav-number">7.</span> <span class="nav-text">wait workflow</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ref"><span class="nav-number">8.</span> <span class="nav-text">Ref</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Robert Kao"
      src="/images/head.png">
  <p class="site-author-name" itemprop="name">Robert Kao</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">171</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">66</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
        <div class="back-to-top animated" role="button">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://hot5656.github.io/2025/07/28/n8n-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="Robert Kao">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Robert 雜記">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          n8n - AI Agents, AI Automations & AI Voice Agents (1)
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2025-07-28 10:37:03" itemprop="dateCreated datePublished" datetime="2025-07-28T10:37:03+08:00">2025-07-28</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2025-12-04 15:50:14" itemprop="dateModified" datetime="2025-12-04T15:50:14+08:00">2025-12-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/AI/" itemprop="url" rel="index"><span itemprop="name">AI</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2025/07/28/n8n-2/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2025/07/28/n8n-2/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>76k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>1:09</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h3 id="install-n8n"><a href="#install-n8n" class="headerlink" title="install n8n"></a>install n8n</h3><h4 id="Hostinger-n8n-VPS-hosting"><a href="#Hostinger-n8n-VPS-hosting" class="headerlink" title="Hostinger n8n VPS hosting"></a>Hostinger n8n VPS hosting</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">install as guide flow</span><br><span class="line"></span><br><span class="line"><span class="comment"># udgrade n8n for the Ubuntu </span></span><br><span class="line">docker compose pull</span><br><span class="line">docker compose down</span><br><span class="line">docker compose up -d</span><br></pre></td></tr></table></figure>

<span id="more"></span>

<h4 id="install-in-windows-Node-js"><a href="#install-in-windows-Node-js" class="headerlink" title="install in windows(Node.js)"></a>install in windows(Node.js)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1. search n8n github</span><br><span class="line">2. Node.js install or nvm install(<span class="keyword">for</span> Node.js version control)</span><br><span class="line">3. npm install -g n8n</span><br><span class="line">4. re-open cmd : run <span class="string">&quot;n8n&quot;</span></span><br><span class="line">5. browser run : http://<span class="built_in">local</span>:5678</span><br><span class="line"></span><br><span class="line"><span class="comment"># udgrade n8n </span></span><br><span class="line">1. npm update -g n8n</span><br><span class="line">2. n8n</span><br></pre></td></tr></table></figure>

<h4 id="install-in-Mac-Node-js"><a href="#install-in-Mac-Node-js" class="headerlink" title="install in Mac(Node.js)"></a>install in Mac(Node.js)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1. node.js install</span><br><span class="line">2. oper terminal : sudo npm install -g n8n </span><br><span class="line">3. n8n </span><br><span class="line">4. browser run: http://<span class="built_in">local</span>:5678</span><br><span class="line"></span><br><span class="line"><span class="comment"># udgrade n8n </span></span><br><span class="line">1. npm update -g n8n</span><br><span class="line">2. n8n</span><br></pre></td></tr></table></figure>

<h3 id="coding"><a href="#coding" class="headerlink" title="coding"></a>coding</h3><h4 id="JSON-or-“Set-Field”"><a href="#JSON-or-“Set-Field”" class="headerlink" title="JSON or “Set Field”"></a>JSON or “Set Field”</h4><h5 id="Genernal"><a href="#Genernal" class="headerlink" title="Genernal"></a>Genernal</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Selectors (`.first()`, `.last()`, `.all()`)</span></span><br><span class="line">&#123;&#123; $(<span class="string">&#x27;Source Data&#x27;</span>).last().json.name &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># JS function</span></span><br><span class="line">&#123;&#123; $(<span class="string">&#x27;Source Data&#x27;</span>).last().json.name.toUpperCase() &#125;&#125;</span><br><span class="line">&#123;&#123; Math.round($(<span class="string">&#x27;Source Data&#x27;</span>).last().json.age / 7) &#125;&#125;</span><br><span class="line">&#123;&#123; typeof $(<span class="string">&#x27;Source Data&#x27;</span>).last().json.age &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># get key</span></span><br><span class="line">&#123;&#123; Object.keys($(<span class="string">&#x27;Source Data&#x27;</span>).last().json.contact) &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># convert a structured JSON object into a single string</span></span><br><span class="line">&#123;&#123; JSON.stringify($(<span class="string">&#x27;Source Data&#x27;</span>).last().json.contact, null, 2) &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># join all list to a string</span></span><br><span class="line">&#123;&#123; $(<span class="string">&#x27;Split Out Skills&#x27;</span>).all().map(item =&gt; item.json.skills).join(<span class="string">&#x27;, &#x27;</span>) &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># String to object **** format must seet to object ****</span></span><br><span class="line">&#123;&#123; JSON.parse($(<span class="string">&#x27;8. Utility Functions&#x27;</span>).item.json.contact_as_string) &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># load file name - cv0 為傳入之檔名</span></span><br><span class="line">&#123;&#123; <span class="variable">$node</span>[<span class="string">&#x27;Text Classifier&#x27;</span>].binary[<span class="string">&quot;cv0&quot;</span>].fileName &#125;&#125;</span><br><span class="line"><span class="comment"># 以下也可以 - attachment_0 為傳入之檔名</span></span><br><span class="line">&#123;&#123;$(<span class="string">&#x27;Gmail Trigger&#x27;</span>).first().binary.attachment_0.fileName&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># get file keys(input names)</span></span><br><span class="line">&#123;&#123;$(<span class="string">&#x27;Gmail Trigger&#x27;</span>).first().binary.keys()&#125;&#125;</span><br></pre></td></tr></table></figure>

<h5 id="❇️-Translate-JSON-string-to-json"><a href="#❇️-Translate-JSON-string-to-json" class="headerlink" title="❇️ Translate JSON string to json"></a>❇️ Translate JSON string to json</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基本轉換：JSON.stringify(&#123; name: &quot;John&quot;, age: 30 &#125;) 會得到 &#123;&quot;name&quot;:&quot;John&quot;,&quot;age&quot;:30&#125; 字串</span></span><br><span class="line"><span class="comment"># 美化輸出：JSON.stringify(&#123; x: 5, y: 6 &#125;, null, 2) 會以兩格縮排排版，便於閱讀</span></span><br><span class="line"><span class="comment"># 過濾屬性：JSON.stringify(obj, [&quot;id&quot;, &quot;name&quot;]) 僅輸出 id 與 name 資料</span></span><br><span class="line"><span class="comment"># 使用函式轉換：JSON.stringify(obj, (key, value) =&gt; typeof value === &quot;string&quot; ? value.toUpperCase() : value) 可在序列化時調整值.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># null 代表不使用 replacer，因此不過濾、不改寫屬性</span></span><br><span class="line"><span class="comment"># space 2 縮排(美化)</span></span><br><span class="line"><span class="comment"># (?:json)? 表含或不含 json 用 (json)? 存起資料較占空間 故用 (?:json)</span></span><br><span class="line"><span class="comment"># \s* : 表刪除接著所有空白</span></span><br><span class="line"><span class="comment"># g 表 所有符合條件</span></span><br><span class="line"><span class="comment"># /.../ 歸哲表達是除裡範圍</span></span><br><span class="line">&#123;&#123; </span><br><span class="line">  JSON.stringify(</span><br><span class="line">    JSON.parse(</span><br><span class="line">      <span class="variable">$json</span>.content.parts.first().text</span><br><span class="line">      .replace(/```(?:json)?\s*/g, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">      .trim() </span><br><span class="line">    ),</span><br><span class="line">    null, </span><br><span class="line">    2 </span><br><span class="line">  )</span><br><span class="line">&#125;&#125;</span><br></pre></td></tr></table></figure>

<h5 id="❇️-Edit-field-2-condition-僅對單一-輸入-node-有用"><a href="#❇️-Edit-field-2-condition-僅對單一-輸入-node-有用" class="headerlink" title="❇️ Edit field - 2 condition(僅對單一 輸入 node 有用)"></a>❇️ Edit field - 2 condition(僅對單一 輸入 node 有用)</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; $json.message.text != <span class="literal">null</span> ? $json.message.text : </span><br><span class="line">  $json.content.parts[<span class="number">0</span>].text != <span class="literal">null</span> ? $json.content.parts[<span class="number">0</span>].text : <span class="string">&#x27;&#x27;</span>&#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Google-Drive"><a href="#Google-Drive" class="headerlink" title="Google Drive"></a>Google Drive</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Drive --&gt; Search files and folders</span></span><br><span class="line">Search Method: Advanced Search</span><br><span class="line"><span class="comment"># 查詢會列出指定父資料夾底下尚未被刪除的所有檔案與子資料夾</span></span><br><span class="line">Query String: <span class="string">&#x27;&#123;&#123; $json.id &#125;&#125;&#x27;</span> <span class="keyword">in</span> parents and trashed = <span class="literal">false</span></span><br></pre></td></tr></table></figure>

<h4 id="Regular-Expression"><a href="#Regular-Expression" class="headerlink" title="Regular Expression"></a>Regular Expression</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 把所有雙引號 &quot; 取代為已轉義的 &quot;，確保字串在 JSON、JS 字面量或序列化時不會因未轉義引號而破壞語法</span></span><br><span class="line">replace(/<span class="string">&quot;/g, &#x27;\\&quot;</span><span class="string">&#x27;) </span></span><br></pre></td></tr></table></figure>

<h4 id="❇️-Code"><a href="#❇️-Code" class="headerlink" title="❇️ Code"></a>❇️ Code</h4><h5 id="array-to-json-output"><a href="#array-to-json-output" class="headerlink" title="array to json output"></a>array to json output</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> items = [</span><br><span class="line">  &#123;</span><br><span class="line">    name: <span class="string">&#x27;John&#x27;</span>,</span><br><span class="line">    email: <span class="string">&#x27;john@example.com&#x27;</span>,</span><br><span class="line">    age: <span class="number">25</span>,</span><br><span class="line">    status: <span class="string">&#x27;active&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    name: <span class="string">&#x27;Sarah&#x27;</span>,</span><br><span class="line">    email: <span class="string">&#x27;sarah@example.com&#x27;</span>, </span><br><span class="line">    age: <span class="number">30</span>,</span><br><span class="line">    status: <span class="string">&#x27;inactive&#x27;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    name: <span class="string">&#x27;Mike&#x27;</span>,</span><br><span class="line">    email: <span class="string">&#x27;mike@example.com&#x27;</span>,</span><br><span class="line">    age: <span class="number">28</span>,</span><br><span class="line">    status: <span class="string">&#x27;active&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> items.map(<span class="function"><span class="params">item</span> =&gt;</span> (&#123; <span class="attr">json</span>: item &#125;));</span><br></pre></td></tr></table></figure>

<h5 id="convert-data-to-a-file-mp3"><a href="#convert-data-to-a-file-mp3" class="headerlink" title="convert data to a file mp3"></a>convert data to a file mp3</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> [</span><br><span class="line">  &#123;</span><br><span class="line">    json: &#123;&#125;,</span><br><span class="line">    binary: &#123;</span><br><span class="line">      data: &#123;</span><br><span class="line">        data: Buffer.from($json[<span class="string">&quot;audio_data&quot;</span>], <span class="string">&quot;base64&quot;</span>),</span><br><span class="line">        mimeType: <span class="string">&quot;audio/mpeg&quot;</span>,</span><br><span class="line">        fileName: <span class="string">&quot;output.mp3&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<h5 id="remove-special-character"><a href="#remove-special-character" class="headerlink" title="remove special character"></a>remove special character</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// n8n code node 轉換前面資料</span></span><br><span class="line"><span class="keyword">return</span> items.map(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> text = item.json.output; <span class="comment">// 取得前面節點傳來的 output 文字</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 範例：把所有文字轉成大寫</span></span><br><span class="line">  <span class="comment">// text = text.toUpperCase();</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 範例：跳脫 Telegram MarkdownV2 的特殊字元（部分）</span></span><br><span class="line">  text = text.replace(<span class="regexp">/([_*[\]()~`&gt;#+-=|&#123;&#125;.!])/g</span>, <span class="string">&#x27;\\$1&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 將處理後的文字存回新的欄位或覆蓋原本欄位</span></span><br><span class="line">  item.json.processedText = text;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> item;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="string-to-json"><a href="#string-to-json" class="headerlink" title="string to json"></a>string to json</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> responseText = $input.first().json.content.parts[<span class="number">0</span>].text</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> jsonString = responseText;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 移除 ```</span></span><br><span class="line">jsonString = jsonString.replace(<span class="regexp">/```json\n?/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 移除 ```</span></span><br><span class="line">jsonString = jsonString.replace(<span class="regexp">/```\s*$/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 移除前後空白</span></span><br><span class="line">jsonString = jsonString.trim();</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="comment">// 解析 JSON 字符串</span></span><br><span class="line">  <span class="keyword">const</span> output = <span class="built_in">JSON</span>.parse(jsonString);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 回傳解析後的結構化資料</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    output</span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">  <span class="comment">// 解析失敗時的錯誤處理</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    error: <span class="string">&#x27;JSON format error&#x27;</span>,</span><br><span class="line">    originalResponse: responseText,</span><br><span class="line">    parseSuccess: <span class="literal">false</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="10-95Customer-Data-Processor-Complex-Data-Cleaning-Example"><a href="#10-95Customer-Data-Processor-Complex-Data-Cleaning-Example" class="headerlink" title="10_95Customer+Data+Processor+Complex+(Data+Cleaning+Example)"></a>10_95Customer+Data+Processor+Complex+(Data+Cleaning+Example)</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> items = $input.all();</span><br><span class="line"><span class="keyword">const</span> customers = items[<span class="number">0</span>].json.customers;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> processedCustomers = customers.map(<span class="function"><span class="params">customer</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// Convert revenue string to actual number</span></span><br><span class="line">  <span class="keyword">const</span> revenueNumber = <span class="built_in">parseFloat</span>(customer.revenue.replace(<span class="regexp">/[$,]/g</span>, <span class="string">&#x27;&#x27;</span>))</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">let</span> tier ;</span><br><span class="line">  <span class="keyword">if</span> (revenueNumber &gt;= <span class="number">40000</span>) &#123;</span><br><span class="line">    tier = <span class="string">&#x27;Premium&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span>  (revenueNumber &gt;= <span class="number">20000</span>) &#123;</span><br><span class="line">    tier = <span class="string">&#x27;Standard&#x27;</span>;</span><br><span class="line">  &#125; </span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    tier = <span class="string">&#x27;Basic&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> domain = customer.email.split(<span class="string">&#x27;@&#x27;</span>)[<span class="number">1</span>];</span><br><span class="line">  <span class="keyword">const</span> isUK = domain.includes(<span class="string">&#x27;.uk&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> country = isUK ? <span class="string">&#x27;United Kingdom&#x27;</span> : <span class="string">&#x27;United States&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> formattedPhone = <span class="string">`(<span class="subst">$&#123;customer.phone.slice(<span class="number">0</span>,<span class="number">3</span>)&#125;</span>) -<span class="subst">$&#123;customer.phone.slice(<span class="number">4</span>,<span class="number">6</span>)&#125;</span>-<span class="subst">$&#123;customer.phone.slice(<span class="number">6</span>,<span class="number">7</span>)&#125;</span>-<span class="subst">$&#123;customer.phone.slice(<span class="number">8</span>)&#125;</span>`</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="comment">// Original data (cleaned)</span></span><br><span class="line">    name: customer.name,</span><br><span class="line">    email: customer.email,</span><br><span class="line">    phone: formattedPhone,</span><br><span class="line">    company: customer.company,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// NEW calculated fields</span></span><br><span class="line">    revenueAmount : revenueNumber,</span><br><span class="line">    customerTier : tier,</span><br><span class="line">    country: country,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Business logic fields</span></span><br><span class="line">    isHighValue : revenueNumber &gt;= <span class="number">25000</span>,</span><br><span class="line">    needsAccountManager : tier === <span class="string">&#x27;Premium&#x27;</span>,</span><br><span class="line">    emailDomain : domain</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// sum 初值為 0,傳回加總值 </span></span><br><span class="line"><span class="keyword">const</span> totalRevenue = processedCustomers.reduce(<span class="function">(<span class="params">sum, customer</span>) =&gt;</span> sum + customer.revenueAmount, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">const</span> averageRevenue = totalRevenue / processedCustomers.length;</span><br><span class="line"><span class="comment">// 傳回 c.isHighValue&#x27;s length</span></span><br><span class="line"><span class="keyword">const</span> highValueCount = processedCustomers.filter(<span class="function"><span class="params">c</span> =&gt;</span> c.isHighValue).length;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">  processedCustomers : processedCustomers,</span><br><span class="line">  summary :&#123;</span><br><span class="line">    totalCustomers : processedCustomers.length,</span><br><span class="line">    totalRevenue : totalRevenue,</span><br><span class="line">    averageRevenue : <span class="built_in">Math</span>.round(averageRevenue),</span><br><span class="line">    highValueCustomers: highValueCount,</span><br><span class="line">    premiumCustomers: processedCustomers.filter(<span class="function"><span class="params">c</span> =&gt;</span> c.customerTier === <span class="string">&#x27;Premium&#x27;</span>).length</span><br><span class="line">  &#125;,</span><br><span class="line">  </span><br><span class="line">  message: <span class="string">`Processed <span class="subst">$&#123;processedCustomers.length&#125;</span> customers with advanced business logic`</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="10-95Weather-Message-Generator-Example"><a href="#10-95Weather-Message-Generator-Example" class="headerlink" title="10_95Weather+Message+Generator+Example"></a>10_95Weather+Message+Generator+Example</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> items = $input.all();</span><br><span class="line"><span class="keyword">const</span> locations = items[<span class="number">0</span>].json.locations;</span><br><span class="line"><span class="keyword">const</span> weatherReports = locations.map( <span class="function"><span class="params">location</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> message = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="keyword">let</span> recommendation = <span class="string">&#x27;&#x27;</span>;  </span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (location.temperature &lt; <span class="number">10</span>) &#123;</span><br><span class="line">    message = <span class="string">`It&#x27;s chilly in <span class="subst">$&#123;location.city&#125;</span> at <span class="subst">$&#123;location.temperature&#125;</span>°C`</span>;</span><br><span class="line">    recommendation = <span class="string">&#x27;Dress warm and bring a jacket!&#x27;</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (location.temperature &gt; <span class="number">25</span>) &#123;</span><br><span class="line">    message = <span class="string">`It&#x27;s hot in <span class="subst">$&#123;location.city&#125;</span> at <span class="subst">$&#123;location.temperature&#125;</span>°C`</span>;</span><br><span class="line">    recommendation = <span class="string">&#x27;Perfect t-shirt weather!&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    message = <span class="string">`Bice weather in <span class="subst">$&#123;location.city&#125;</span> at <span class="subst">$&#123;location.temperature&#125;</span>°C`</span>;</span><br><span class="line">    recommendation = <span class="string">&#x27;Comfortable temperature today!&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (location.condition.includes(<span class="string">&#x27;rain&#x27;</span>))&#123;</span><br><span class="line">    recommendation += <span class="string">&#x27; Don\&#x27;t forget your umbrella!&#x27;</span>; </span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (location.condition.includes(<span class="string">&#x27;snow&#x27;</span>))&#123;</span><br><span class="line">    recommendation += <span class="string">&#x27; Watch out for slippery roads!&#x27;</span>; </span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (location.condition.includes(<span class="string">&#x27;sunny&#x27;</span>))&#123;</span><br><span class="line">    recommendation += <span class="string">&#x27; great day to be outside!&#x27;</span>; </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> (location.humidity &gt; <span class="number">80</span> )&#123;</span><br><span class="line">    recommendation += <span class="string">&#x27; High humidity - stay hydrated!&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    city: location.city,</span><br><span class="line">    originalDate: location,</span><br><span class="line">    weatherMessage: message,</span><br><span class="line">    recommendation: recommendation,</span><br><span class="line">    alertLevel: location.temperature &lt; <span class="number">0</span> ? <span class="string">&#x27;extreme&#x27;</span> : </span><br><span class="line">      location.temperature &lt; <span class="number">10</span> ? <span class="string">&#x27;low&#x27;</span> :</span><br><span class="line">      location.temperature &gt; <span class="number">30</span> ? <span class="string">&#x27;high&#x27;</span> : <span class="string">&#x27;normal&#x27;</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">  totalLocations: locations.length,</span><br><span class="line">  weatherReports : weatherReports,</span><br><span class="line">  generatedAt: <span class="keyword">new</span> <span class="built_in">Date</span>().toISOString()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="10-95Sales-Calculator-Example"><a href="#10-95Sales-Calculator-Example" class="headerlink" title="10_95Sales+Calculator+Example"></a>10_95Sales+Calculator+Example</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> items = $input.all();</span><br><span class="line"><span class="keyword">const</span> sales = items[<span class="number">0</span>].json.salesData;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> saleWithTotals = sales.map(<span class="function"><span class="params">sale</span> =&gt;</span> (&#123;</span><br><span class="line">  ...sale,</span><br><span class="line">  totalPrice: sale.quantity * sale.unitPrice</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> totalRevenue = saleWithTotals.reduce(<span class="function">(<span class="params">sum, sale</span>) =&gt;</span> sum + sale.totalPrice, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">const</span> totalQuantitly = saleWithTotals.reduce(<span class="function">(<span class="params">sum, sale</span>) =&gt;</span> sum + sale.quantity, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">const</span> averageOrderValue = totalRevenue / sales.length;</span><br><span class="line"></span><br><span class="line"><span class="comment">// const productSummary = &#123;&#125;;</span></span><br><span class="line"><span class="comment">// saleWithTotals.forEach(sale =&gt; &#123;</span></span><br><span class="line"><span class="comment">//   if (!productSummary[sale.product]) &#123;</span></span><br><span class="line"><span class="comment">//     productSummary[sale.product] = &#123;</span></span><br><span class="line"><span class="comment">//       product: sale.product,</span></span><br><span class="line"><span class="comment">//       totalQuantity: 0,</span></span><br><span class="line"><span class="comment">//       totalRevenue: 0,</span></span><br><span class="line"><span class="comment">//       orderCount: 0</span></span><br><span class="line"><span class="comment">//     &#125;;</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">//   productSummary[sale.product].totalQuantity += sale.quantity;</span></span><br><span class="line"><span class="comment">//   productSummary[sale.product].totalRevenue +=  sale.totalPrice;</span></span><br><span class="line"><span class="comment">//   productSummary[sale.product].orderCount += 1</span></span><br><span class="line"><span class="comment">// &#125;);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用註解標注屬性</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@typedef <span class="type">&#123;Object&#125;</span> <span class="variable">ProductSummaryItem</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@property <span class="type">&#123;string&#125;</span> <span class="variable">product</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@property <span class="type">&#123;number&#125;</span> <span class="variable">totalQuantity</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@property <span class="type">&#123;number&#125;</span> <span class="variable">totalRevenue</span></span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@property <span class="type">&#123;number&#125;</span> <span class="variable">orderCount</span></span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** <span class="doctag">@type <span class="type">&#123;Object.&lt;string, ProductSummaryItem&gt;&#125;</span> </span>*/</span></span><br><span class="line"><span class="comment">// JSDoc 的型別註解語法，用來告訴編輯器或其他工具，這個變數是一個物件（Object），並且：</span></span><br><span class="line"><span class="comment">// 物件的鍵（key）是字串（string）型態</span></span><br><span class="line"><span class="comment">// 物件的值（value）是你自己定義的 ProductSummaryItem 結構物件</span></span><br><span class="line"><span class="comment">// 這裡的 Object.&lt;string, ProductSummaryItem&gt; 表示「一個以字串為鍵，存放 ProductSummaryItem 型態物件的字典」。</span></span><br><span class="line"><span class="keyword">const</span> productSummary = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">saleWithTotals.forEach(<span class="function"><span class="params">sale</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (!productSummary[sale.product]) &#123;</span><br><span class="line">    productSummary[sale.product] = &#123;</span><br><span class="line">      product: sale.product,</span><br><span class="line">      totalQuantity: <span class="number">0</span>,</span><br><span class="line">      totalRevenue: <span class="number">0</span>,</span><br><span class="line">      orderCount: <span class="number">0</span></span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  productSummary[sale.product].totalQuantity += sale.quantity;</span><br><span class="line">  productSummary[sale.product].totalRevenue += sale.totalPrice;</span><br><span class="line">  productSummary[sale.product].orderCount += <span class="number">1</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> productAnalysis = <span class="built_in">Object</span>.values(productSummary).map(<span class="function"><span class="params">product</span> =&gt;</span> (&#123;</span><br><span class="line">  ...product,</span><br><span class="line">  averageOrderValue: product.totalRevenue / product.orderCount,</span><br><span class="line">  revenuePercentage: (product.totalRevenue/ totalRevenue * <span class="number">100</span>).toFixed(<span class="number">2</span>)</span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bestSellingProduct = productAnalysis.reduce(<span class="function">(<span class="params">best, current</span>) =&gt;</span> </span><br><span class="line">    current.totalQuantity &gt; best.totalQuantity ? current : best</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> highestRevenueProduct = productAnalysis.reduce(<span class="function">(<span class="params">best, current</span>) =&gt;</span></span><br><span class="line">    current.totalRevenue &gt; best.totalRevenue ? current : best</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">  summary: &#123;</span><br><span class="line">    totalOrders: sales.length,</span><br><span class="line">    totalRevenue: totalRevenue,</span><br><span class="line">    totalQuantity: totalQuantitly,</span><br><span class="line">    averageOrderValue : <span class="built_in">parseFloat</span>(averageOrderValue.toFixed(<span class="number">2</span>))</span><br><span class="line">  &#125;,</span><br><span class="line">  bestPerformers : &#123;</span><br><span class="line">    bestSelling: bestSellingProduct.product,</span><br><span class="line">    highestRevenue: highestRevenueProduct.product</span><br><span class="line">  &#125;,</span><br><span class="line">  productAnalysis: productAnalysis,</span><br><span class="line">  salesWithTotals: saleWithTotals </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="10-95Data-Format-Converter-Example"><a href="#10-95Data-Format-Converter-Example" class="headerlink" title="10_95Data+Format+Converter+Example"></a>10_95Data+Format+Converter+Example</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> items = $input.all()</span><br><span class="line"><span class="keyword">const</span> apiData = items[<span class="number">0</span>].json.apiResponse</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> flattenedUsers = apiData.users.map(<span class="function"><span class="params">user</span> =&gt;</span> (&#123;</span><br><span class="line">  <span class="comment">// Basic info</span></span><br><span class="line">  userId: user.id,</span><br><span class="line">  fullName: <span class="string">`<span class="subst">$&#123;user.profile.firstName&#125;</span> <span class="subst">$&#123;user.profile.lastName&#125;</span>`</span> ,</span><br><span class="line">  firstName: user.profile.firstName,</span><br><span class="line">  lastName: user.profile.lastName,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Contact info</span></span><br><span class="line">  email: user.profile.contact.email,</span><br><span class="line">  phone: user.profile.contact.phone,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Preferences</span></span><br><span class="line">  notificationsEnabled: user.preferences.notifications,</span><br><span class="line">  theme: user.preferences.theme</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Create different output formats</span></span><br><span class="line"><span class="comment">// 1. CSV-ready format (array of arrays)</span></span><br><span class="line"><span class="keyword">const</span> csvData = [</span><br><span class="line">  [<span class="string">&#x27;User ID&#x27;</span>, <span class="string">&#x27;Full Name&#x27;</span>, <span class="string">&#x27;Email&#x27;</span>, <span class="string">&#x27;Phone&#x27;</span>, <span class="string">&#x27;Notifications&#x27;</span>,  <span class="string">&#x27;Theme&#x27;</span>], <span class="comment">//Head</span></span><br><span class="line">  ...flattenedUsers.map(<span class="function"><span class="params">user</span> =&gt;</span> [</span><br><span class="line">    user.userId,</span><br><span class="line">    user.fullName,</span><br><span class="line">    user.email,</span><br><span class="line">    user.phone,</span><br><span class="line">    user.notificationsEnabled ? <span class="string">&#x27;Yes&#x27;</span> : <span class="string">&#x27;No&#x27;</span>,</span><br><span class="line">    user.theme</span><br><span class="line">  ])</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. Email list format</span></span><br><span class="line"><span class="keyword">const</span> emailList = flattenedUsers.map(<span class="function"><span class="params">user</span> =&gt;</span> user.email);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. Contact cards format</span></span><br><span class="line"><span class="keyword">const</span> contactCards = flattenedUsers.map(<span class="function"><span class="params">user</span> =&gt;</span> (&#123;</span><br><span class="line">  name: user.fullName,</span><br><span class="line">  contactInfo: <span class="string">`<span class="subst">$&#123;user.email&#125;</span> | <span class="subst">$&#123;user.phone&#125;</span>`</span>,</span><br><span class="line">  settings: <span class="string">`Notifications: <span class="subst">$&#123;user.notificationsEnabled ? <span class="string">&#x27;On&#x27;</span> : <span class="string">&#x27;Off&#x27;</span>&#125;</span>, Theme: <span class="subst">$&#123;user.theme&#125;</span>`</span></span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. Summary statistics</span></span><br><span class="line"><span class="keyword">const</span> stats = &#123;</span><br><span class="line">  totalUsers: flattenedUsers.length,</span><br><span class="line">  notificationUsers: flattenedUsers.filter(<span class="function"><span class="params">u</span> =&gt;</span> u.notificationsEnabled).length,</span><br><span class="line">  themeBreakdown: &#123;</span><br><span class="line">    dark: flattenedUsers.filter(<span class="function"><span class="params">u</span> =&gt;</span> u.theme === <span class="string">&#x27;dark&#x27;</span>).length,</span><br><span class="line">    light: flattenedUsers.filter(<span class="function"><span class="params">u</span> =&gt;</span> u.theme === <span class="string">&#x27;light&#x27;</span>).length,    </span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">// ...new Set(flattenedUsers.map(u =&gt; u.email.split(&#x27;@&#x27;)[1])) 去除重複值, 展開為 array</span></span><br><span class="line">  domains: [...new <span class="built_in">Set</span>(flattenedUsers.map(<span class="function"><span class="params">u</span> =&gt;</span> u.email.split(<span class="string">&#x27;@&#x27;</span>)[<span class="number">1</span>]))]</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5. Grouped by preferences</span></span><br><span class="line"><span class="comment">// 初始值 &#123;&#125;：reduce 的累加器從空物件開始，作為最後要回傳的分組結果容器</span></span><br><span class="line"><span class="keyword">const</span> groupedByTheme = flattenedUsers.reduce(<span class="function">(<span class="params">groups, user</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// const theme = user.theme;</span></span><br><span class="line">  <span class="comment">// if(!groups[theme]) &#123;</span></span><br><span class="line">  <span class="comment">//   groups[theme] = [];</span></span><br><span class="line">  <span class="comment">// &#125;</span></span><br><span class="line">  <span class="comment">// groups[theme].push(user);</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> key = user.theme;</span><br><span class="line">  <span class="comment">// groups[key] 為 null 或 undefined，則設為空陣列；否則保留原值</span></span><br><span class="line">  groups[key] = groups[key] ?? [];</span><br><span class="line">  groups[key].push(user);</span><br><span class="line">  <span class="keyword">return</span> groups;</span><br><span class="line">&#125;, &#123;&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">  originalData: apiData,</span><br><span class="line">  transformedDtat :&#123;</span><br><span class="line">    flattenedUsers: flattenedUsers,</span><br><span class="line">    csvFormat: csvData,</span><br><span class="line">    emailList: emailList,</span><br><span class="line">    contactCards: contactCards,</span><br><span class="line">    groupedByTheme: groupedByTheme</span><br><span class="line">  &#125;,</span><br><span class="line">  statistics: stats,</span><br><span class="line">  metadata: &#123;</span><br><span class="line">    processedAt: <span class="keyword">new</span> <span class="built_in">Date</span>().toISOString(),</span><br><span class="line">    originalTotoa: apiData.metadata.total,</span><br><span class="line">    transformedTotal: flattenedUsers.length</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="10-96-class-example"><a href="#10-96-class-example" class="headerlink" title="10_96 class example"></a>10_96 class example</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// get data</span></span><br><span class="line"><span class="keyword">const</span> students = $input.all()[<span class="number">0</span>].json.students</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> processStudents = students.map(<span class="function"><span class="params">student</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> totalPoints = student.mathScore + student.englishScore + student.scienceScore;</span><br><span class="line">  <span class="keyword">const</span> averageScore = totalPoints / <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> letterGrand;</span><br><span class="line">  <span class="keyword">if</span> (averageScore &gt;=<span class="number">90</span>) &#123;</span><br><span class="line">    letterGrand = <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span> (averageScore &gt;=<span class="number">80</span>) &#123;</span><br><span class="line">    letterGrand = <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span> (averageScore &gt;=<span class="number">70</span>) &#123;</span><br><span class="line">    letterGrand = <span class="string">&#x27;C&#x27;</span>;</span><br><span class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span> (averageScore &gt;=<span class="number">60</span>) &#123;</span><br><span class="line">    letterGrand = <span class="string">&#x27;D&#x27;</span>;</span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    letterGrand = <span class="string">&#x27;F&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> isHonorRoll = averageScore &gt;= <span class="number">85</span> &amp;&amp; student.attentionPresent &gt;= <span class="number">90</span>;</span><br><span class="line">  <span class="keyword">const</span> scholarshipEligible = (averageScore &gt;= <span class="number">88</span> &amp;&amp; student.isFullTime) ? <span class="string">&#x27;Yes&#x27;</span> : <span class="string">&#x27;No&#x27;</span>;</span><br><span class="line">  <span class="keyword">const</span> congratsMessage = <span class="string">`Great job, <span class="subst">$&#123;student.studentName&#125;</span>! Your average is <span class="subst">$&#123;averageScore.toFixed(<span class="number">1</span>)&#125;</span>`</span>;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    json: &#123;</span><br><span class="line">      ...student,</span><br><span class="line">      averageScore: <span class="built_in">Math</span>.round(averageScore),</span><br><span class="line">      letterGrade: letterGrand,</span><br><span class="line">      isHonorRoll: isHonorRoll,</span><br><span class="line">      scholashipEligible: scholarshipEligible,</span><br><span class="line">      personMessage: congratsMessage</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> classTotal = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">let</span> honorRollCount = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span> ; i &lt; processStudents.length ; i++ )&#123;</span><br><span class="line">  classTotal += processStudents[i].json.averageScore;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (processStudents[i].json.isFullTime) &#123;</span><br><span class="line">    honorRollCount += <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> classAverage = classTotal / processStudents.length;</span><br><span class="line"></span><br><span class="line">processStudents.push(&#123;</span><br><span class="line">  json: &#123;</span><br><span class="line">    reportType: <span class="string">&#x27;CLASS_SUMMARY&#x27;</span>,</span><br><span class="line">    totalStudents: processStudents.length,</span><br><span class="line">    classAverage: <span class="built_in">Math</span>.round(classAverage),</span><br><span class="line">    honorRollStudents: honorRollCount,</span><br><span class="line">    hornorPercentage: <span class="built_in">Math</span>.round((honorRollCount / processStudents.length) * <span class="number">100</span> )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> processStudents;</span><br></pre></td></tr></table></figure>

<h5 id="10-106-add-additional-field"><a href="#10-106-add-additional-field" class="headerlink" title="10_106 add additional field"></a>10_106 add additional field</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = $input.item.json;</span><br><span class="line"><span class="keyword">const</span> fullName = <span class="string">`<span class="subst">$&#123;user.firstName&#125;</span> <span class="subst">$&#123;user.lastName&#125;</span>`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span>  birthDate = <span class="keyword">new</span> <span class="built_in">Date</span>(user.birthDate)</span><br><span class="line"><span class="keyword">const</span> ageDiffMs = <span class="built_in">Date</span>.now() - birthDate.getTime();</span><br><span class="line"><span class="keyword">const</span> ageDate = <span class="keyword">new</span> <span class="built_in">Date</span>(ageDiffMs);</span><br><span class="line"><span class="keyword">const</span> age = <span class="built_in">Math</span>.abs(ageDate.getFullYear()-<span class="number">1970</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">`name:<span class="subst">$&#123;fullName&#125;</span> age:<span class="subst">$&#123;age&#125;</span>`</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">  ...user,</span><br><span class="line">  fullName,</span><br><span class="line">  age</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="10-106-await-and-call-API"><a href="#10-106-await-and-call-API" class="headerlink" title="10_106 await and call API"></a>10_106 await and call API</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = $input.item.json;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> url = <span class="string">`https://api.genderize.io?name=<span class="subst">$&#123;user.firstName&#125;</span>`</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// wait http response</span></span><br><span class="line"><span class="keyword">const</span> response = <span class="keyword">await</span> <span class="built_in">this</span>.helpers.httpRequest(&#123;<span class="attr">url</span>: url, <span class="attr">json</span>: <span class="literal">true</span>&#125;);</span><br><span class="line"><span class="comment">// const response = await this.helpers.httpRequest(&#123; url: url, json: true &#125;);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span>&#123;</span><br><span class="line">  ...user,</span><br><span class="line">  gender: response.gender ,</span><br><span class="line">  genderProbability: response.probability</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="10-106-reduce-process-data"><a href="#10-106-reduce-process-data" class="headerlink" title="10_106 reduce process data"></a>10_106 reduce process data</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> users = $items();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> totalAge = users.reduce(<span class="function">(<span class="params">sum,user</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> sum + user.json.age</span><br><span class="line">&#125;, <span class="number">0</span>);</span><br><span class="line">  </span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">  totalUsers: users.length,</span><br><span class="line">  averageAge: <span class="built_in">parseFloat</span>(totalAge / users.length)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="10-106-create-csv-binary-file"><a href="#10-106-create-csv-binary-file" class="headerlink" title="10_106 create csv binary file"></a>10_106 create csv binary file</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> allUsers = $(<span class="string">&quot;4. Fetch External Data (Advanced)&quot;</span>).all()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> csvContent = <span class="string">&quot;FullName, Age, GenderGuss, ProcessedBy\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">const</span> item <span class="keyword">of</span> allUsers) &#123;</span><br><span class="line">  <span class="keyword">const</span> user = item.json;</span><br><span class="line">  <span class="keyword">const</span> row = <span class="string">`&quot;<span class="subst">$&#123;user.fullName&#125;</span>&quot;,<span class="subst">$&#123;user.age&#125;</span>,<span class="subst">$&#123;user.gender&#125;</span>,n8n`</span>;</span><br><span class="line">  csvContent += row + <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// string to bin</span></span><br><span class="line"><span class="keyword">const</span> binaryData = <span class="keyword">await</span> <span class="built_in">this</span>.helpers.prepareBinaryData(Buffer.from(csvContent), <span class="string">&#x27;user_report2.csv&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">  json :&#123;</span><br><span class="line">    reportGenerated : <span class="keyword">new</span> <span class="built_in">Date</span>().toISOString(),</span><br><span class="line">    userCount : allUsers.length</span><br><span class="line">  &#125;,</span><br><span class="line">  binary: &#123;</span><br><span class="line">    report: binaryData</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="❇️-11-119-AI-Agent-output-string-convert-to-json"><a href="#❇️-11-119-AI-Agent-output-string-convert-to-json" class="headerlink" title="❇️ 11_119 AI Agent output string,convert to json"></a>❇️ 11_119 AI Agent output string,convert to json</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Get the full response string from the previous step (usually &quot;AI Agent&quot; or similar)</span></span><br><span class="line"><span class="comment">// 第0筆, json output 欄位</span></span><br><span class="line"><span class="comment">// const output = items[0].json.output;</span></span><br><span class="line"><span class="keyword">const</span> output = $(<span class="string">&#x27;AI Agent&#x27;</span>).first().json.output;</span><br><span class="line"></span><br><span class="line"><span class="comment">// show type </span></span><br><span class="line"><span class="comment">// ? 是「可選鏈結運算子」（optional chaining）；它會在左邊為 null 或 undefined 時直接回傳 undefined，而不是丟錯</span></span><br><span class="line"><span class="comment">// check array and array</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;typeof output:&#x27;</span>, <span class="keyword">typeof</span> items?.[<span class="number">0</span>]?.json?.output);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;isArray:&#x27;</span>, <span class="built_in">Array</span>.isArray(items?.[<span class="number">0</span>]?.json?.output));</span><br><span class="line"></span><br><span class="line"><span class="comment">// Try to extract the JSON array from the output string</span></span><br><span class="line"><span class="comment">// 過濾前後 ```json\n , \n``` 字串</span></span><br><span class="line"><span class="keyword">const</span> jsonStart = output.indexOf(<span class="string">&#x27;[&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> jsonEnd = output.lastIndexOf(<span class="string">&#x27;]&#x27;</span>) + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">const</span> jsonString = output.slice(jsonStart, jsonEnd);</span><br><span class="line"><span class="comment">// Parse the JSON array</span></span><br><span class="line"><span class="keyword">const</span> contacts = <span class="built_in">JSON</span>.parse(jsonString);</span><br><span class="line"></span><br><span class="line"><span class="comment">// compare contacts vs contacts.map(contact =&gt; (&#123; json: contact &#125;))</span></span><br><span class="line"><span class="comment">// console.log(contacts);</span></span><br><span class="line"><span class="comment">// console.log(contacts.map(contact =&gt; (&#123; json: contact &#125;)));</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// console.log(&#x27;contacts:&#x27;, typeof contacts?.[0]?.json?.Name);</span></span><br><span class="line"><span class="comment">// 奇怪在 AI Agent 後, 程式中執行 contacts.map(contact =&gt; (&#123; json: contact &#125;)) 就會出問題</span></span><br><span class="line"><span class="comment">//console.log(&#x27;contacts map:&#x27;, typeof contacts.map(contact =&gt; (&#123; json: contact &#125;)).[0]?.json?.Name);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Optionally, return each contact as a separate item for downstream nodes (like Sheets)</span></span><br><span class="line"><span class="comment">// 因 n8n 是透過 json 溝通, 其實沒有差別</span></span><br><span class="line"><span class="comment">//return contacts.map(contact =&gt; (&#123; json: contact &#125;));</span></span><br><span class="line"><span class="keyword">return</span> contacts;</span><br></pre></td></tr></table></figure>

<h5 id="❇️-code-check-from-2-source"><a href="#❇️-code-check-from-2-source" class="headerlink" title="❇️ code check from 2 source"></a>❇️ code check from 2 source</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> text = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">let</span> voice = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	text = $input.all(<span class="number">0</span>)[<span class="number">0</span>].json.message.text;</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">	<span class="built_in">console</span>.log(<span class="string">&quot;01:&quot;</span>, e);</span><br><span class="line">	<span class="comment">// ..</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">	voice = $input.all(<span class="number">1</span>)[<span class="number">0</span>].json.content.parts[<span class="number">0</span>].text;</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">	<span class="comment">// ..</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> output = &#123;</span><br><span class="line">	text : text ? text : voice ? voice : <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> output ;</span><br></pre></td></tr></table></figure>

<h5 id="❇️-data-string-分段"><a href="#❇️-data-string-分段" class="headerlink" title="❇️ data string 分段"></a>❇️ data string 分段</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> inputData = $input.first();</span><br><span class="line"><span class="keyword">const</span> longText = inputData.json.output;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 分割長訊息</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">splitMessage</span>(<span class="params">message, limit = <span class="number">4096</span></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> messages = [];</span><br><span class="line">  <span class="keyword">let</span> currentChunk = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="keyword">const</span> words = message.split(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">const</span> word <span class="keyword">of</span> words) &#123;</span><br><span class="line">    <span class="keyword">if</span> ((currentChunk + <span class="string">&#x27; &#x27;</span> + word).length &gt; limit) &#123;</span><br><span class="line">      messages.push(currentChunk);</span><br><span class="line">      currentChunk = word;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      currentChunk += (currentChunk ? <span class="string">&#x27; &#x27;</span> : <span class="string">&#x27;&#x27;</span>) + word;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (currentChunk) messages.push(currentChunk);</span><br><span class="line">  <span class="keyword">return</span> messages;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 分段後，轉成 n8n 的 items 格式</span></span><br><span class="line"><span class="keyword">const</span> chunks = splitMessage(longText, <span class="number">3600</span>);</span><br><span class="line"><span class="keyword">const</span> items = chunks.map(<span class="function"><span class="params">chunk</span> =&gt;</span> (&#123;</span><br><span class="line">  json: &#123;</span><br><span class="line">    ...inputData.json,   <span class="comment">// 保留原始 json 內容</span></span><br><span class="line">    output: chunk         <span class="comment">// 把 output 改成當前這一段</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> items;</span><br></pre></td></tr></table></figure>

<h4 id="JavaScrip-Function"><a href="#JavaScrip-Function" class="headerlink" title="JavaScrip Function"></a>JavaScrip Function</h4><h5 id="function-string"><a href="#function-string" class="headerlink" title="function string"></a>function string</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">.length</span><br><span class="line">.base64Encode()</span><br><span class="line">.base64Decode()</span><br><span class="line">.concat()</span><br><span class="line">.extractDomain()</span><br><span class="line">.extractUrl()</span><br><span class="line">.extractUrlPath()</span><br><span class="line">.<span class="built_in">hash</span>() - default MD5 <span class="built_in">hash</span></span><br><span class="line">.quote()</span><br><span class="line">.removeMarkdown()</span><br><span class="line">.removeTags() - HTML</span><br><span class="line">.replaceSpecialChars()</span><br><span class="line">.slice(1,5)</span><br><span class="line">.substring(8,10)</span><br><span class="line"></span><br><span class="line">JSON.stringify( )</span><br><span class="line">.trim()</span><br><span class="line">i.ndexOf(<span class="string">&#x27;We&#x27;</span>)</span><br><span class="line">.lastIndexOf(<span class="string">&#x27;e&#x27;</span>)</span><br><span class="line">.match(/\s.*/) : regular expression</span><br><span class="line">.search(<span class="string">&#x27;AI&#x27;</span>)</span><br><span class="line">.isDomain() </span><br><span class="line">.isEmail() </span><br><span class="line">toLowerCase()</span><br><span class="line">.toUpperCase()</span><br><span class="line">.toSnakeCase()</span><br><span class="line">.toDateTime()</span><br><span class="line">.toNumber()</span><br></pre></td></tr></table></figure>

<h5 id="function-number"><a href="#function-number" class="headerlink" title="function number"></a>function number</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(4.135678).round(3)</span><br><span class="line">(4.9135678).floor()</span><br><span class="line">(4.135678).ceil()</span><br><span class="line">(4092111).format(<span class="string">&#x27;en-US&#x27;</span>)</span><br><span class="line">(4092111).isEven() </span><br><span class="line">(4092111).isOdd()</span><br><span class="line">(4092111.32).isInteger()</span><br><span class="line">(4092111).toBoolean()</span><br><span class="line">(34-1-33).toDateTime()</span><br><span class="line">(1342).toLocaleString():numbet to locale using format</span><br><span class="line">(1342).toString()</span><br></pre></td></tr></table></figure>

<h5 id="function-array"><a href="#function-array" class="headerlink" title="function array"></a>function array</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$json</span>.array.length</span><br><span class="line"><span class="variable">$json</span>.array.last()</span><br><span class="line"><span class="variable">$json</span>.array.first()</span><br><span class="line"><span class="variable">$json</span>.array.includes(<span class="string">&#x27;n8n&#x27;</span>)</span><br><span class="line"><span class="variable">$json</span>.array.append(<span class="string">&#x27;google&#x27;</span>, <span class="string">&#x27;Opera&#x27;</span>)</span><br><span class="line"><span class="variable">$json</span>.array.append(&#123;<span class="string">&quot;name&quot;</span>:<span class="string">&quot;Robert&quot;</span>&#125;): append object</span><br><span class="line"><span class="variable">$json</span>.array.chunk(3) : every array 3 item(start 1st) </span><br><span class="line">[<span class="string">&quot;Bill&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;Jonn&quot;</span>, <span class="string">&quot;Ton&quot;</span>, <span class="string">&quot;&quot;</span>].compact(3): remove blank item</span><br><span class="line">[<span class="string">&quot;Bill&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;Jonn&quot;</span>, <span class="string">&quot;Ton&quot;</span>, <span class="string">&quot;&quot;</span>].concat(<span class="string">&quot;jay&quot;</span>, <span class="string">&quot;chen&quot;</span>): same as append</span><br><span class="line">[1,2,3,4,5].difference([2,4]): retuen no select array items</span><br><span class="line">[1,2,3,4,5].find(number =&gt; number &gt; 3) : get 1st condtion item</span><br><span class="line"><span class="variable">$json</span>.array.indexOf(<span class="string">&#x27;n8n&#x27;</span>) : <span class="built_in">return</span> item index</span><br><span class="line">[1,2,3,4,5].intersection([2,10,3,5]: item <span class="keyword">in</span> 2 array</span><br><span class="line">[1,2,3,4,5].isEmpty()</span><br><span class="line">[1,2,3,4,5].isNotEmpty()</span><br><span class="line">[1,2,3,4,5].join(<span class="string">&#x27; + &#x27;</span>) : join to a string</span><br><span class="line">[&#123;nama:<span class="string">&#x27;Robert&#x27;</span>&#125;,&#123;agg:42&#125;].merge([&#123;city:<span class="string">&#x27;Taipei&#x27;</span>&#125;,&#123;country:<span class="string">&quot;Taiwan&quot;</span>&#125;]): merge 2 object array to one object</span><br><span class="line">[&#123;name:<span class="string">&#x27;Robert&#x27;</span>,age:42&#125;,&#123;name:<span class="string">&#x27;Taipei&#x27;</span>,country:<span class="string">&quot;Taiwan&quot;</span>&#125;].pluck(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;age&#x27;</span>): get the data have same key</span><br><span class="line"><span class="variable">$json</span>.array.randomItem()</span><br><span class="line">[&#123;name:<span class="string">&#x27;Robert&#x27;</span>,age:42&#125;,&#123;name:<span class="string">&#x27;Taipei&#x27;</span>,country:<span class="string">&quot;Taiwan&quot;</span>&#125;].renameKeys(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;new&#x27;</span>) : change key</span><br><span class="line"><span class="variable">$json</span>.array.reverse(): reverse orginal array</span><br><span class="line"><span class="variable">$json</span>.array.slice(1,3): slice array</span><br><span class="line">[&#123;course:<span class="string">&#x27;n8n&#x27;</span>, students:1000&#125;,&#123;course:<span class="string">&#x27;Midjourney&#x27;</span>, students: <span class="string">&#x27;2231&#x27;</span>&#125;].smartJoin(<span class="string">&#x27;course&#x27;</span>, <span class="string">&#x27;students&#x27;</span>): output object <span class="string">&quot;course value&quot;</span> is key and <span class="string">&quot;students value&quot;</span> is value </span><br><span class="line"><span class="variable">$json</span>.array.sort() : sort original array</span><br><span class="line"><span class="variable">$json</span>.array.toJsonString(): array to string</span><br><span class="line"><span class="variable">$json</span>.array.toSpliced(1,2) : remove array item, from index 1 remove 2 </span><br><span class="line"><span class="variable">$json</span>.array.toSpliced(1,0, <span class="string">&#x27;google&#x27;</span>): remove 0 and add item <span class="string">&#x27;google&#x27;</span></span><br><span class="line">[1,2,3].union([2,4,6]): merage 2 array, but remove same item(reserve just 1)</span><br><span class="line">[1,2,3,4,2,6].unique(): 1 array remove duplicate item(reserve just 1)</span><br><span class="line"><span class="variable">$json</span>.array.map(item =&gt; item.toUpperCase()):run <span class="keyword">for</span> all item</span><br><span class="line">[1,2,4,5,3].filter(item =&gt; item &lt; 4)</span><br><span class="line">&#123;&#123;[1,2,4,5,3].reduce((last, current) =&gt; last + current)&#125;&#125;</span><br></pre></td></tr></table></figure>

<h5 id="function-object-amp-amp-bollen"><a href="#function-object-amp-amp-bollen" class="headerlink" title="function object &amp;&amp; bollen"></a>function object &amp;&amp; bollen</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$json</span>.object.keys()</span><br><span class="line"><span class="variable">$json</span>.object.values()</span><br><span class="line"><span class="variable">$json</span>.object.isEmpty()</span><br><span class="line"><span class="variable">$json</span>.object.isNotEmpty()</span><br><span class="line"><span class="variable">$json</span>.object.hasField(<span class="string">&#x27;courseName&#x27;</span>)</span><br><span class="line"><span class="variable">$json</span>.object.compact() : remove item null, undefined, blank..</span><br><span class="line"><span class="variable">$json</span>.object.keepFieldsContaining(<span class="string">&#x27;a&#x27;</span>): value include something</span><br><span class="line"><span class="variable">$json</span>.object.removeField(<span class="string">&#x27;instructor&#x27;</span>)</span><br><span class="line"><span class="variable">$json</span>.object.removeFieldsContaining(<span class="string">&#x27;o&#x27;</span>) </span><br><span class="line"><span class="variable">$json</span>.object.toJsonString()</span><br><span class="line">http://example.com/?&#123;&#123; <span class="variable">$json</span>.object.urlEncode() &#125;&#125; : http://example.com/?courseName=n8n+course&amp;studentsEnrolled=10000&amp;instructor=Krystian+Wojtarowicz</span><br><span class="line"></span><br><span class="line"><span class="variable">$json</span>.bool.toNumber()</span><br><span class="line"><span class="variable">$json</span>.bool.toString()</span><br></pre></td></tr></table></figure>

<h5 id="function-Other"><a href="#function-Other" class="headerlink" title="function Other"></a>function Other</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;<span class="variable">$now</span>&#125;&#125; : [DateTime: 2025-09-27T23:26:01.837+08:00]</span><br><span class="line">&#123;&#123;<span class="variable">$today</span>&#125;&#125;:[DateTime: 2025-09-27T00:00:00.000+08:00]</span><br><span class="line">&#123;&#123;<span class="variable">$now</span>.format(<span class="string">&#x27;yyyy-MM-dd HH:mm&#x27;</span>)&#125;&#125;: 2025-09-27 23:30</span><br><span class="line">&#123;&#123;<span class="variable">$now</span>.plus(7, <span class="string">&#x27;days&#x27;</span>).format(<span class="string">&#x27;yyyy-MM-dd HH:mm&#x27;</span>)&#125;&#125;: 2025-10-04 23:32</span><br><span class="line">&#123;&#123;<span class="variable">$now</span>.minus(7, <span class="string">&#x27;days&#x27;</span>).format(<span class="string">&#x27;yyyy-MM-dd HH:mm&#x27;</span>)&#125;&#125;: 2025-09-20 23:33</span><br><span class="line">&#123;&#123;<span class="string">&quot;9/26/2025&quot;</span>.toDateTime().diffTo(<span class="variable">$now</span>.format(<span class="string">&#x27;yyyy-MM-dd&#x27;</span>), <span class="string">&#x27;days&#x27;</span>)&#125;&#125;:-1</span><br><span class="line">5:30/10:49</span><br><span class="line">&#123;&#123;<span class="variable">$if</span>( <span class="variable">$now</span>.day &gt; 29 ,<span class="string">&#x27;hello&#x27;</span> , <span class="string">&#x27;goodbye&#x27;</span>)&#125;&#125; : goodbye</span><br><span class="line">&#123;&#123;JSON.stringify(<span class="variable">$json</span>.object)&#125;&#125; : <span class="string">&quot;&#123;\&quot;courseName\&quot;:\&quot;n8n course\&quot;,\&quot;studentsEnrolled\&quot;:10000,\&quot;instructor\&quot;:\&quot;Krystian Wojtarowicz\&quot;&#125;&quot;</span></span><br><span class="line">&#123;&#123;[1,2,3,4,5].max()&#125;&#125;: 5</span><br><span class="line">&#123;&#123;[1,2,3,4,5].min()&#125;&#125;: 1</span><br><span class="line">&#123;&#123;<span class="variable">$workflow</span>.id&#125;&#125;: qdMW0He05AtJPV0m(also support name, active)</span><br></pre></td></tr></table></figure>


<h5 id="function"><a href="#function" class="headerlink" title="function"></a>function</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># check if something is an array  </span></span><br><span class="line">Empty arrays ≠ null ≠ undefined - use Array.isArray() to check first</span><br><span class="line"></span><br><span class="line"><span class="comment"># tells you what data type something is </span></span><br><span class="line">&#123;&#123; typeof <span class="variable">$json</span>.fieldName &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># converts to true/false</span></span><br><span class="line">Boolean()</span><br><span class="line"></span><br><span class="line"><span class="comment"># convers to whole number only</span></span><br><span class="line">ParseInt()</span><br><span class="line"></span><br><span class="line"><span class="comment"># converts to decimal numbers</span></span><br><span class="line">ParseFloat()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Safe number conversion</span></span><br><span class="line">`&#123;&#123; Number(<span class="variable">$json</span>.value) || 0 &#125;&#125;` - This converts any value to a number, but gives you zero <span class="keyword">if</span> the conversion fails instead of breaking your workflow.</span><br><span class="line"></span><br><span class="line"><span class="comment"># String to boolean (safe)</span></span><br><span class="line">`&#123;&#123; <span class="variable">$json</span>.value === <span class="string">&#x27;true&#x27;</span> &#125;&#125;` - This is much safer than just using Boolean() because it explicitly checks <span class="keyword">for</span> the string <span class="string">&quot;true&quot;</span> rather than treating any non-empty string as <span class="literal">true</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment"># Extract from object</span></span><br><span class="line">`&#123;&#123; <span class="variable">$json</span>.user.department &#125;&#125;` - Use dot notation to pull specific values out of nested objects. This is super common when working with API responses.</span><br><span class="line"></span><br><span class="line"><span class="comment"># Array to string</span></span><br><span class="line">`&#123;&#123; <span class="variable">$json</span>.technologies.join(<span class="string">&#x27;, &#x27;</span>) &#125;&#125;` - Perfect <span class="keyword">for</span> creating readable lists or sending array data to systems that only accept text.</span><br><span class="line"></span><br><span class="line"><span class="comment"># String to array</span></span><br><span class="line">`&#123;&#123; <span class="variable">$json</span>.techString.split(<span class="string">&#x27;, &#x27;</span>) &#125;&#125;` - The reverse operation, turning comma-separated text back into arrays you can loop through or manipulate.</span><br><span class="line"></span><br><span class="line"><span class="comment"># Object to string</span></span><br><span class="line">`&#123;&#123; JSON.stringify(<span class="variable">$json</span>.user) &#125;&#125;` - Essential <span class="keyword">for</span> storing complex objects <span class="keyword">in</span> databases or sending them to APIs that expect text.</span><br><span class="line"></span><br><span class="line"><span class="comment">#  String to object **** format must seet to object ****</span></span><br><span class="line">`&#123;&#123; JSON.parse(<span class="variable">$json</span>.userDataString) &#125;&#125;` - Converting JSON strings back to objects so you can access their properties.</span><br><span class="line"></span><br><span class="line"><span class="comment"># Conditional conversion</span></span><br><span class="line">`&#123;&#123; Number(<span class="variable">$json</span>.score) &gt;= 80 ? <span class="string">&#x27;Senior&#x27;</span> : <span class="string">&#x27;Junior&#x27;</span> &#125;&#125;` - Combining conversion with logic to create derived fields based on your business rules.</span><br><span class="line"></span><br><span class="line"><span class="comment"># Handle null values</span></span><br><span class="line">`&#123;&#123; <span class="variable">$json</span>.value || <span class="string">&#x27;default&#x27;</span> &#125;&#125;` - Prevents null or undefined values from breaking your workflow by providing fallbacks.</span><br><span class="line"></span><br><span class="line"><span class="comment"># Trim whitespace:</span></span><br><span class="line">`&#123;&#123; <span class="variable">$json</span>.text.trim() &#125;&#125;` - Always use this on user input because people love to add extra spaces.</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h5 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; JSON.stringify(<span class="variable">$json</span>.user) &#125;&#125;</span><br><span class="line">&#123;&#123; JSON.parse(<span class="variable">$json</span>.userDataString) &#125;&#125;</span><br><span class="line">&#123;&#123; <span class="variable">$json</span>.isVerified ? <span class="string">&quot;Verified&quot;</span> : <span class="string">&quot;Pending&quot;</span> &#125;&#125;</span><br><span class="line">&#123;&#123; Number(<span class="variable">$json</span>.scoreText)  +  Number(<span class="variable">$json</span>.priceText) &#125;&#125;</span><br><span class="line">&#123;&#123; JSON.parse(<span class="variable">$json</span>.userDataString).level &#125;&#125;</span><br><span class="line">&#123;&#123; Number(<span class="variable">$json</span>.scoreText) &gt;=80 ? <span class="string">&quot;Senior&quot;</span>: <span class="string">&quot;Junior&quot;</span> &#125;&#125;</span><br><span class="line">profile(Object) : &#123;&#123; &#123;usname:<span class="variable">$json</span>.user.username, level: Number(<span class="variable">$json</span>.scoreText) &gt; 80 ? <span class="string">&#x27;Senior&#x27;</span> : <span class="string">&#x27;Junior&#x27;</span>, verified: <span class="variable">$json</span>.isVerified, score: Number(<span class="variable">$json</span>.scoreText)  &#125; &#125;&#125;</span><br><span class="line">&#123;&#123; <span class="variable">$json</span>.technologies.join(<span class="string">&#x27; | &#x27;</span>) &#125;&#125;</span><br><span class="line">&#123;&#123; <span class="variable">$json</span>.techString.split(<span class="string">&#x27;,&#x27;</span>) &#125;&#125;</span><br><span class="line">&#123;&#123; <span class="variable">$json</span>.technologies[0] &#125;&#125;</span><br><span class="line">&#123;&#123; <span class="variable">$json</span>.technologies.length &#125;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Tool"><a href="#Tool" class="headerlink" title="Tool"></a>Tool</h3><h4 id="Slack"><a href="#Slack" class="headerlink" title="Slack"></a>Slack</h4><h5 id="Create-Slack-API"><a href="#Create-Slack-API" class="headerlink" title="Create : Slack API"></a>Create : <a target="_blank" rel="noopener" href="https://api.slack.com/apps">Slack API</a></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. Slack 建立 channel : 要先建立工作空間(一個組織或團隊的工作空間（Workspace）) </span></span><br><span class="line"><span class="comment"># n8n_discuss2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. https://api.slack.com/apps </span></span><br><span class="line">Create New App</span><br><span class="line">--&gt; From Scratch </span><br><span class="line">--&gt; App Name: Testing2, Pick a workspace to develop your app <span class="keyword">in</span>:  AI LAB(my work space)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. n8n Credeintal OAuth2</span></span><br><span class="line">select Slack OAuth2 API</span><br><span class="line">  --&gt; connect my account</span><br><span class="line">  --&gt; select Workspace (若已有選 Workspace, 要先選其他在選回來,中間可能會先跳到 Slack 畫面)</span><br><span class="line">  --&gt; 安裝 n8n.cloud </span><br><span class="line">  --&gt; Access connected</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. to new app(Testing2)</span></span><br><span class="line">--&gt; OAuth &amp; Permissions</span><br><span class="line">--&gt; Bot Token Scopes</span><br><span class="line">--&gt; Add an OAuth Scope</span><br><span class="line">	app_mentions:<span class="built_in">read</span></span><br><span class="line">	channels:<span class="built_in">read</span></span><br><span class="line">	chat:write</span><br><span class="line">	channels:join</span><br><span class="line">	groups:<span class="built_in">read</span></span><br><span class="line">--&gt; OAuth Tokens</span><br><span class="line">--&gt; Install to AI LAB</span><br><span class="line">--&gt; 安裝 Testing2</span><br><span class="line">--&gt; copy <span class="string">&quot;Bot User OAuth Token&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. n8n Credeintal Access</span></span><br><span class="line">select Access token</span><br><span class="line">--&gt; Access Token *: 填入 <span class="string">&quot;Bot User OAuth Token&quot;</span></span><br><span class="line">--&gt; Signature Secret: 填入 new app --&gt; Basic Information --&gt; Signing Secret </span><br><span class="line">--&gt; Eescute step --&gt; some error(app 尚未受邀)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 6. 回到 Slack , channel n8n_discuss2</span></span><br><span class="line">下 @Testing2 hi</span><br><span class="line">--&gt; 選新增提及使用者</span><br><span class="line">--&gt; 再回去執行即 ok</span><br><span class="line"></span><br><span class="line"><span class="comment"># 7. 至 Slack Trigger node </span></span><br><span class="line">選 Webhook URLs(注意有 <span class="built_in">test</span> URL and Production URL)</span><br><span class="line">copy URL to new App(Testing2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 8.Slack App testing2 </span></span><br><span class="line">OAuth &amp; Permissions</span><br><span class="line">--&gt; Event Subscripts </span><br><span class="line">--&gt; Enable Events: Enable</span><br><span class="line">--&gt; Request URL: 填入 <span class="string">&quot;Slack Trigger node&quot;</span> 之 Webhook URLs</span><br><span class="line"></span><br><span class="line"><span class="comment"># 9. 至 Slack Trigger node </span></span><br><span class="line">執行</span><br><span class="line"></span><br><span class="line"><span class="comment"># 10.Slack App testing2 </span></span><br><span class="line">Request URL --&gt; Retry (會show Verified)</span><br><span class="line">--&gt; Subscribe to bot events</span><br><span class="line">--&gt; Add Bot User Event</span><br><span class="line">--&gt; app_mention</span><br><span class="line">--&gt; Save change</span><br><span class="line"></span><br><span class="line"><span class="comment"># 11. n8n_discuss2</span></span><br><span class="line">@Testing2 hello --&gt; Slack trigger node 即可收到 </span><br><span class="line"></span><br><span class="line"><span class="comment"># other record</span></span><br><span class="line">Slack token  申請 : [Slack API]</span><br><span class="line">--&gt; Creat an App</span><br><span class="line">--&gt; From scratch</span><br><span class="line">--&gt; App Name : n8n work, Pick a workspace to develop your app <span class="keyword">in</span>: AI LAB</span><br><span class="line">--&gt; Create App</span><br><span class="line">--&gt; Generate token and Scopes : 含 Client ID,Client Secret </span><br><span class="line">--&gt; OAuth &amp; Permissions</span><br><span class="line">	  Add New Redirect URL from n8n <span class="string">&quot;OAuth Redirect URL&quot;</span></span><br><span class="line">		Bot Token Scopes  : chat:write , users:<span class="built_in">read</span>, files:write </span><br><span class="line">		User Token Scopes : chat:write , users:<span class="built_in">read</span>, files:write </span><br></pre></td></tr></table></figure>

<h4 id="Google"><a href="#Google" class="headerlink" title="Google"></a>Google</h4><h5 id="google-standard-node"><a href="#google-standard-node" class="headerlink" title="google standard node"></a>google standard node</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># get API</span></span><br><span class="line">google cloud --&gt; console(控制台)</span><br><span class="line">  --&gt; API 服務 </span><br><span class="line">  --&gt; OAuth 同意畫面</span><br><span class="line">  --&gt; 用戶端(若需要 建立用戶端)		</span><br><span class="line">    已授權的重新導向 URI : 填入 n8n node OAuth Redirect URL</span><br><span class="line">    用戶端 ID: 填至 n8n node Client ID *</span><br><span class="line">    用戶端密碼: 填至 n8n node Client Secret *(產生後就不能讀取)</span><br><span class="line"></span><br><span class="line"><span class="comment"># google API 啟用</span></span><br><span class="line">Google Sheets API --&gt; 啟用</span><br><span class="line">search google drive API --&gt; 啟用</span><br><span class="line">YouTube Data API v3  --&gt; 啟用</span><br><span class="line">google People API(<span class="keyword">for</span> google Contracts) --&gt; 啟用(似乎用不到,先關掉)</span><br></pre></td></tr></table></figure>

<h5 id="google-HTTP-Request-YouTube-Youtube-PlaylistItems-Doc-or-Youtube-PlaylistItems-Doc-TW"><a href="#google-HTTP-Request-YouTube-Youtube-PlaylistItems-Doc-or-Youtube-PlaylistItems-Doc-TW" class="headerlink" title="google HTTP Request(YouTube) - Youtube PlaylistItems Doc or Youtube PlaylistItems Doc-TW"></a>google HTTP Request(YouTube) - <a target="_blank" rel="noopener" href="https://developers.google.com/youtube/v3/docs/playlistItems/list">Youtube PlaylistItems Doc</a> or <a target="_blank" rel="noopener" href="https://developers.google.com/youtube/v3/docs/playlistItems?hl=zh-tw">Youtube PlaylistItems Doc-TW</a></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># channel </span></span><br><span class="line">Method: GET</span><br><span class="line">URL: https://www.googleapis.com/youtube/v3/channels</span><br><span class="line">Authentication: Predefined Credential Type</span><br><span class="line">Credential Type: Google OAuth2 API</span><br><span class="line">Google OAuth2 API: </span><br><span class="line">	OAuth Redirect URL: copy to google cloud 用戶端 已授權的重新導向 URI</span><br><span class="line">	Client ID *: copy from google cloud 用戶端 用戶端 ID</span><br><span class="line">	Client Secret *: copy from google cloud 用戶端 用戶端密碼</span><br><span class="line">	Scope: https://www.googleapis.com/auth/youtube.readonly</span><br><span class="line">Send Query Parameters: Enable</span><br><span class="line">Query Parameters</span><br><span class="line">	part: contentDetails</span><br><span class="line">	mine: <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># playlist</span></span><br><span class="line">Method: GET</span><br><span class="line">URL: https://www.googleapis.com/youtube/v3/playlistItems</span><br><span class="line">Authentication: Predefined Credential Type</span><br><span class="line">Credential Type: Google OAuth2 API</span><br><span class="line">Google OAuth2 API: </span><br><span class="line">	same previous</span><br><span class="line">Send Query Parameters: Enable</span><br><span class="line">	Query Parameters</span><br><span class="line">	part: snippet,status</span><br><span class="line">	playlistId: &#123;&#123; <span class="variable">$json</span>.items[0].contentDetails.relatedPlaylists.uploads &#125;&#125;</span><br><span class="line">	maxResults: 20</span><br><span class="line">	order: date</span><br></pre></td></tr></table></figure>

<h4 id="Telegram-token"><a href="#Telegram-token" class="headerlink" title="Telegram token"></a><a target="_blank" rel="noopener" href="https://web.telegram.org/">Telegram</a> token</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">login </span><br><span class="line">--&gt; search <span class="string">&quot;botfather&quot;</span> </span><br><span class="line">--&gt; pick @BotFather </span><br><span class="line">--&gt; Start </span><br><span class="line">--&gt; press <span class="string">&quot;/newbot &quot;</span> </span><br><span class="line">--&gt; enter name <span class="string">&quot;hot5656firstresponder_bot&quot;</span> </span><br><span class="line">--&gt; copy token to n8n telegram node credential </span><br><span class="line"></span><br><span class="line"><span class="comment"># create 2nd Bot</span></span><br><span class="line">Telegram </span><br><span class="line">	--&gt; BotFather </span><br><span class="line">	--&gt; press <span class="string">&quot;/newbot &quot;</span> </span><br><span class="line">	--&gt; press <span class="string">&quot;Nutritionist_Agent&quot;</span></span><br><span class="line">	--&gt; press <span class="string">&quot;hot5656_Nutritionist_bot&quot;</span></span><br><span class="line">	--&gt; copy token to n8n telegram node<span class="string">&#x27;s credential </span></span><br><span class="line"><span class="string">	--&gt; search &quot;Nutritionist_Agent&quot;</span></span><br><span class="line"><span class="string">	--&gt; pick from BotFather</span></span><br></pre></td></tr></table></figure>

<h4 id="Airtable-token"><a href="#Airtable-token" class="headerlink" title="Airtable token"></a><a target="_blank" rel="noopener" href="https://www.airtable.com/">Airtable</a> token</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># add a base</span></span><br><span class="line">Create </span><br><span class="line">--&gt; Create a app </span><br><span class="line">-&gt; Untitled Base </span><br><span class="line">--&gt; Field: File ID,Creation Time,Recipient Email</span><br><span class="line"></span><br><span class="line"><span class="comment"># API KEY</span></span><br><span class="line">Account</span><br><span class="line">--&gt; go to developer hub </span><br><span class="line">--&gt; create token</span><br><span class="line">--&gt; scopr:data.records:<span class="built_in">read</span>,data.records:write,schema.bases:<span class="built_in">read</span>,access:all</span><br></pre></td></tr></table></figure>

<h4 id="❇️google-Gemini-API-key-Google-AI-Studio-❇️Usage-❇️Condition"><a href="#❇️google-Gemini-API-key-Google-AI-Studio-❇️Usage-❇️Condition" class="headerlink" title="❇️google Gemini  API key -  Google AI Studio - ❇️Usage, ❇️Condition"></a>❇️google Gemini  API key - <a target="_blank" rel="noopener" href="https://aistudio.google.com/"> Google AI Studio</a> - ❇️<a target="_blank" rel="noopener" href="https://ai.dev/usage?tab=rate-limit">Usage</a>, ❇️<a target="_blank" rel="noopener" href="https://ai.google.dev/gemini-api/docs/rate-limits">Condition</a></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">login </span><br><span class="line">--&gt; get API key </span><br><span class="line">--&gt; Create API key</span><br><span class="line"></span><br><span class="line"><span class="comment"># 頻率限制:</span></span><br><span class="line">每分鐘要求數 (RPM)</span><br><span class="line">每分鐘權杖數 (輸入) (TPM)</span><br><span class="line">每日要求數 (RPD)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 免費方案有流量和次數限制（如每日或每分鐘請求數、Token數），但一般個人用途足夠，超額才需付費</span></span><br></pre></td></tr></table></figure>


<h4 id="google-API-key-for-Youtube"><a href="#google-API-key-for-Youtube" class="headerlink" title="google API key for Youtube"></a>google API key for Youtube</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">google cloud console </span><br><span class="line">--&gt; 憑證(Credintials)</span><br><span class="line">--&gt;建立憑證(Create credentials)</span><br><span class="line">--&gt; API key</span><br><span class="line"></span><br><span class="line"><span class="comment"># enable API</span></span><br><span class="line">YouTube Data API v3</span><br></pre></td></tr></table></figure>

<h4 id="Reddit-App"><a href="#Reddit-App" class="headerlink" title="Reddit App"></a><a target="_blank" rel="noopener" href="https://www.reddit.com/prefs/apps">Reddit App</a></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">https://www.reddit.com/prefs/apps </span><br><span class="line">  --&gt; create pp </span><br><span class="line">    name: n8n automation</span><br><span class="line">    web app(select)</span><br><span class="line">    redirect uri :copy from reddit credential<span class="string">&#x27;s OAuth Redirect URL</span></span><br><span class="line"><span class="string">    --&gt; creat app</span></span><br><span class="line"><span class="string">  --&gt; copy secret and web app(id)</span></span><br></pre></td></tr></table></figure>

<h4 id="Notion"><a href="#Notion" class="headerlink" title="Notion"></a><a target="_blank" rel="noopener" href="https://www.notion.com/">Notion</a></h4><h5 id="Notion-Integrations-建立-內部整合密鑰"><a href="#Notion-Integrations-建立-內部整合密鑰" class="headerlink" title="Notion Integrations 建立 內部整合密鑰"></a><a target="_blank" rel="noopener" href="https://www.notion.so/profile/integrations">Notion Integrations</a> 建立 內部整合密鑰</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 建立 內部整合密鑰</span></span><br><span class="line">--&gt; 新整合</span><br><span class="line">整合名稱:Demo</span><br><span class="line">關聯工作空間: Robert Kao Notion</span><br><span class="line">類型:Internal</span><br><span class="line">--&gt; 儲存</span><br><span class="line">功能: 閱讀評論,插入評論 eneable , copy 內部整合密鑰</span><br><span class="line">--&gt; 儲存</span><br><span class="line">你的整合尚無任何頁面的存取權限</span><br><span class="line">如欲開始使用整合，請從以下位置新增頁面和資料庫：Access Tab</span><br><span class="line">--&gt; 選取頁面</span><br><span class="line">--&gt; 私人</span><br><span class="line">--&gt; select all </span><br><span class="line">--&gt; 更新選取權限</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立新 page</span></span><br><span class="line"><span class="comment"># 另 許權限也要加入</span></span><br><span class="line">+開始協作 </span><br><span class="line">--&gt;建立新page : n8n transcribe</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立新 page #2</span></span><br><span class="line">+ 開始協作</span><br><span class="line">--&gt; 輸入 page name</span><br><span class="line">--&gt; 點3點處</span><br><span class="line">--&gt; 連接 </span><br><span class="line">--&gt; Demo (my 整合名稱)</span><br><span class="line">輸入 /table  選 table view</span><br><span class="line">input database name --&gt; Youtube post <span class="comment">#1 </span></span><br><span class="line">name change to : Video Name(example)</span><br><span class="line">+ Add property : Facebook Post(text) ...</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 建立 File Uploaded - Google Drive(表格)</span></span><br><span class="line">notion home - https://www.notion.so/</span><br><span class="line">--&gt; +建立協作 <span class="built_in">set</span> name: File Uploaded - Google Drive</span><br><span class="line">--&gt; 設定為表格, 欄位 Ｎame(文字), File URL(link)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">** duplicate other database</span><br><span class="line">--&gt; 點3點處</span><br><span class="line">--&gt; 連接</span><br><span class="line">--&gt; Demo (my 整合名稱)</span><br></pre></td></tr></table></figure>

<h4 id="peplexity-API-key"><a href="#peplexity-API-key" class="headerlink" title="peplexity API key"></a>peplexity API key</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">User</span><br><span class="line">--&gt; Account</span><br><span class="line">--&gt; API Key</span><br><span class="line">--&gt; create </span><br></pre></td></tr></table></figure>

<h4 id="Apify-token"><a href="#Apify-token" class="headerlink" title="Apify token"></a><a target="_blank" rel="noopener" href="https://apify.com/">Apify</a> token</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Apify login</span><br><span class="line">--&gt; Actor</span><br><span class="line">--&gt; API</span><br><span class="line">--&gt; copy token</span><br></pre></td></tr></table></figure>

<h4 id="Supabase"><a href="#Supabase" class="headerlink" title="Supabase"></a><a target="_blank" rel="noopener" href="https://supabase.com/">Supabase</a></h4><h5 id="Supabase-use-for-RAG"><a href="#Supabase-use-for-RAG" class="headerlink" title="Supabase use for RAG"></a>Supabase use for RAG</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">New Project --&gt; </span><br><span class="line">	name :RAG Restaurant Demo </span><br><span class="line">	generate passowrd (must copy)</span><br><span class="line">	--&gt; create New Porject</span><br><span class="line">--&gt; connect</span><br><span class="line">--&gt; Transaction pooler --&gt; view parameter see all <span class="keyword">for</span> n8n </span><br><span class="line">	host: aws-1-us-east-1...</span><br><span class="line">	port:	6543</span><br><span class="line">	database: postgres</span><br><span class="line">	user: postgres...</span><br><span class="line">	pool_mode: transaction</span><br><span class="line"></span><br><span class="line"><span class="comment"># see information</span></span><br><span class="line">table can see :</span><br><span class="line">	n8n_chat_histories</span><br><span class="line">	n8n_vectors</span><br><span class="line"></span><br><span class="line"><span class="comment"># send &quot;Test step&quot; for check database is ok(it also available for Simple Vector Store)</span></span><br><span class="line">send <span class="string">&quot;Test step&quot;</span> to Postgres PGvector Store , <span class="keyword">then</span> give me the response <span class="keyword">for</span> <span class="built_in">test</span> it</span><br></pre></td></tr></table></figure>

<h5 id="Supabase-use-for-whatsapp"><a href="#Supabase-use-for-whatsapp" class="headerlink" title="Supabase use for whatsapp"></a>Supabase use for whatsapp</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">New Project --&gt; </span><br><span class="line">	name :whatsapp longterm memory </span><br><span class="line">	generate passowrd (must copy)</span><br><span class="line">	database --&gt; teable</span><br><span class="line">		--&gt; create a table </span><br><span class="line">		--&gt;name:ChatMemory </span><br><span class="line">		--&gt; add column</span><br><span class="line">			message - text</span><br><span class="line">			recipient text</span><br><span class="line">			sender text</span><br><span class="line">	Project Settings:</span><br><span class="line">			--&gt; Data API<span class="string">&#x27;s URL (Credential&#x27;</span>s URL)</span><br><span class="line">			--&gt; Data API<span class="string">&#x27;s service_rolesecret(Credential&#x27;</span>s Service Role Secret)</span><br></pre></td></tr></table></figure>

<h5 id="Supabase-use-for-recorded-communication-and-RAG-Supabase-Vector-Store-node-–-gt-quickstart-for-setting-up-your-vector-store"><a href="#Supabase-use-for-recorded-communication-and-RAG-Supabase-Vector-Store-node-–-gt-quickstart-for-setting-up-your-vector-store" class="headerlink" title="Supabase use for recorded communication and  RAG : Supabase Vector Store node –&gt; quickstart for setting up your vector store"></a>Supabase use for recorded communication and  RAG : <a target="_blank" rel="noopener" href="https://docs.n8n.io/integrations/builtin/cluster-nodes/root-nodes/n8n-nodes-langchain.vectorstoresupabase/">Supabase Vector Store node</a> –&gt; <a target="_blank" rel="noopener" href="https://supabase.com/docs/guides/ai/langchain?database-method=sql">quickstart for setting up your vector store</a></h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">New Project --&gt; </span><br><span class="line">	name :Remeber AI Agent </span><br><span class="line">	generate passowrd (must copy, ✅ use <span class="keyword">for</span> Postgres Chat Memory)</span><br><span class="line">	--&gt; create New Porject</span><br><span class="line">--&gt; connect</span><br><span class="line">  select Method: Transaction pooler</span><br><span class="line">  --&gt; view parameters (✅ use <span class="keyword">for</span> Postgres Chat Memory)</span><br><span class="line">    host: aws-1-ap-southeast-2.pooler.supabase.com</span><br><span class="line">    port: 6543</span><br><span class="line">    database: postgres</span><br><span class="line">    user: ...</span><br><span class="line">    pool_mode: transaction</span><br><span class="line"></span><br><span class="line">Project Setting</span><br><span class="line">  --&gt; Data API</span><br><span class="line">    URL: ... (✅ use <span class="keyword">for</span> Supabase Vector Storey)</span><br><span class="line">  --&gt; API key --&gt; Legacy API Keys</span><br><span class="line">    service_rolesecret: ... (✅ use <span class="keyword">for</span> Supabase Vector Store)</span><br><span class="line"></span><br><span class="line"><span class="comment"># create Table for Supabase Vector Store</span></span><br><span class="line">--&gt; SQL Edit </span><br><span class="line">  --&gt; copy SQL form [quickstart <span class="keyword">for</span> setting up your vector store] to SQL Edit</span><br><span class="line">  --&gt; 🔷 change vector(1536) to vector(768) <span class="keyword">for</span> Gemini</span><br><span class="line">  --&gt; 🔷 need Enable RLS (Authentication --&gt; Policies)</span><br><span class="line">  --&gt; Run</span><br><span class="line">  --&gt; 🔷 change <span class="string">&quot;create extension vector&quot;</span> to <span class="string">&quot;create extension if not exists vector&quot;</span></span><br><span class="line">  --&gt; 🔷 change <span class="string">&quot;embedding extensions.vector(768)&quot;</span> to <span class="string">&quot;embedding vector(768)&quot;</span></span><br><span class="line">  --&gt; 🔷 <span class="keyword">if</span> found <span class="string">&#x27;Error: Failed to run sql query: ERROR: 42P07: relation &quot;documents&quot; already exists&#x27;</span>, delete Table <span class="string">&quot;documents&quot;</span></span><br><span class="line">  --&gt; 🔷 <span class="keyword">if</span> found <span class="string">&#x27;Error: Failed to run sql query: ERROR: 42723: function &quot;match_documents&quot; already exists with same argument types&#x27;</span>, change <span class="string">&quot;create function match_documents&quot;</span> to <span class="string">&quot;create or replace function match_documents&quot;</span></span><br><span class="line">  --&gt; check Table have <span class="string">&quot;documents&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Enable RLS</span></span><br><span class="line">Authentication </span><br><span class="line">  --&gt; Policies</span><br><span class="line">  --&gt; <span class="built_in">enable</span> <span class="string">&quot;documents&quot;</span> and <span class="string">&quot;n8n_chat_histories&quot;</span> RLS</span><br><span class="line"></span><br><span class="line"><span class="comment"># n8n have 2 Credential</span></span><br><span class="line">🟢Postgres Chat Memory:　directly use the Database</span><br><span class="line">🟢Supabase Vector Store:  use the Supabase REST API</span><br></pre></td></tr></table></figure>

<h4 id="facebook-developer-WhatsApp"><a href="#facebook-developer-WhatsApp" class="headerlink" title="facebook developer WhatsApp"></a><a target="_blank" rel="noopener" href="https://developers.facebook.com/?locale=zh_TW">facebook developer</a> WhatsApp</h4><h5 id="建立應用程式"><a href="#建立應用程式" class="headerlink" title="建立應用程式"></a>建立應用程式</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">facebook developer</span><br><span class="line">	--&gt; 我的應用程式	</span><br><span class="line">	--&gt; 建立應用程式</span><br><span class="line"></span><br><span class="line">create APP </span><br><span class="line">	--&gt; name + mail </span><br><span class="line">	--&gt; <span class="keyword">case</span>:other </span><br><span class="line">	--&gt; <span class="built_in">type</span>:business </span><br><span class="line">	--&gt; correct App</span><br><span class="line"></span><br><span class="line">WhatsApp </span><br><span class="line">	--&gt; Setup </span><br><span class="line">	--&gt; App Setting Setting </span><br><span class="line">	--&gt; Basic </span><br><span class="line">	--&gt; get id and pass </span><br><span class="line"></span><br><span class="line">whatApp --&gt; API Setup</span><br><span class="line">	加入號碼(保留 <span class="built_in">test</span> phone number)</span><br><span class="line">	--&gt; generate access token</span><br><span class="line">	--&gt; 選擇可以存取所有目前和日後的WhatsApp 帳號</span><br></pre></td></tr></table></figure>

<h5 id="Client-ID-amp-ient-Secret-receive-from-WhatsApp"><a href="#Client-ID-amp-ient-Secret-receive-from-WhatsApp" class="headerlink" title="Client ID &amp; ient Secret(receive from WhatsApp)"></a>Client ID &amp; ient Secret(receive from WhatsApp)</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">--&gt; 我的應用程式</span><br><span class="line">--&gt; n8n Agent(目前我用的)</span><br><span class="line">--&gt; 應用程式設定 </span><br><span class="line">--&gt; 基本資料:應用程式編號,應用程式密鑰</span><br></pre></td></tr></table></figure>

<h5 id="權杖-及-Account-ID-send-to-WhatsApp"><a href="#權杖-及-Account-ID-send-to-WhatsApp" class="headerlink" title="權杖 及 Account ID(send to WhatsApp)"></a>權杖 及 Account ID(send to WhatsApp)</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">--&gt; 我的應用程式</span><br><span class="line">--&gt; n8n Agent(目前我用的)</span><br><span class="line">--&gt; WhatsApp</span><br><span class="line">--&gt; API 設定</span><br><span class="line">--&gt; 產生存取權杖(僅能用數小時), WhatsApp Business 帳號編號</span><br><span class="line">--&gt; 工具(延伸至90天)</span><br><span class="line">	--&gt; 存取權杖偵錯工具</span><br><span class="line">	--&gt; 存取權杖</span><br><span class="line">	--&gt; 填入權杖 </span><br><span class="line">	--&gt; 偵錯</span><br><span class="line">	--&gt; 延伸存取權杖</span><br></pre></td></tr></table></figure>

<h4 id="Rapid-zillow-By-Sabri"><a href="#Rapid-zillow-By-Sabri" class="headerlink" title="Rapid - zillow(By Sabri)"></a><a target="_blank" rel="noopener" href="https://rapidapi.com/">Rapid</a> - zillow(By Sabri)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># get Aillow key</span></span><br><span class="line">zillow --&gt; subscribe to <span class="built_in">test</span> --&gt; <span class="built_in">test</span> endpoint(30 per month)</span><br><span class="line">  url: https://zillow56.p.rapidapi.com/search?</span><br><span class="line">  x-rapidapi-key: fb...</span><br></pre></td></tr></table></figure>

<h4 id="pinecorn-for-RAG"><a href="#pinecorn-for-RAG" class="headerlink" title="pinecorn - for RAG"></a><a target="_blank" rel="noopener" href="https://app.pinecone.io/">pinecorn</a> - for RAG</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Pinecorn --&gt; Create index</span><br><span class="line">  --&gt; n8nragagent</span><br><span class="line">  --&gt; Configuration</span><br><span class="line">  --&gt; text-embedding-3-small </span><br><span class="line">  --&gt; Custom setting:</span><br><span class="line">  --&gt; Dimension :768 (<span class="keyword">for</span> Gemini need <span class="built_in">set</span> to 768, OpenAI <span class="built_in">set</span> to 1536)</span><br><span class="line">  --&gt; API keys</span><br><span class="line">  --&gt; Create API key</span><br><span class="line">  --&gt; n8nragagent (recorded APi key)</span><br></pre></td></tr></table></figure>

<h4 id="groq-for-mamny-LLM-free-limit-support-Model"><a href="#groq-for-mamny-LLM-free-limit-support-Model" class="headerlink" title="groq - for mamny LLM, free limit, support Model"></a><a target="_blank" rel="noopener" href="https://console.groq.com/">groq</a> - for mamny LLM, <a target="_blank" rel="noopener" href="https://console.groq.com/settings/limits">free limit</a>, <a target="_blank" rel="noopener" href="https://console.groq.com/docs/models">support Model</a></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># API keys</span></span><br><span class="line">Default Project --&gt; API Keys</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use infomation </span></span><br><span class="line">Dashboard --&gt; Usage --&gt; Activity</span><br><span class="line">Dashboard --&gt; logs</span><br></pre></td></tr></table></figure>

<h4 id="SerpAPI-free-250-searches-x2F-month"><a href="#SerpAPI-free-250-searches-x2F-month" class="headerlink" title="SerpAPI - free 250 searches &#x2F; month"></a><a target="_blank" rel="noopener" href="https://serpapi.com/">SerpAPI</a> - free 250 searches &#x2F; month</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># API Key : get API</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># YOur Searches: Search data</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Your API Mertrics: userage information</span></span><br></pre></td></tr></table></figure>



<h3 id="Setting"><a href="#Setting" class="headerlink" title="Setting"></a>Setting</h3><h4 id="API-return-code"><a href="#API-return-code" class="headerlink" title="API return code"></a>API return code</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2xx(success): 200</span><br><span class="line">4xx(client Error) : request error</span><br><span class="line">5xx(Server error)</span><br></pre></td></tr></table></figure>

<h4 id="prompt"><a href="#prompt" class="headerlink" title="prompt"></a>prompt</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Role &amp; Purpose</span></span><br><span class="line">The role tells the AI who it is supposed to be. The purpose tells the AI why it exists and what its main job is. This is the foundation of your prompt</span><br><span class="line">because it sets the agent’s identity.</span><br><span class="line">- ..</span><br><span class="line">- ..</span><br><span class="line"></span><br><span class="line"><span class="comment">## Capabilities</span></span><br><span class="line">This section describes what the agent is able to <span class="keyword">do</span> - its core skills and strengths.</span><br><span class="line">- ..</span><br><span class="line">- ..</span><br><span class="line"></span><br><span class="line"><span class="comment">## Tools (Optional)</span></span><br><span class="line">This section explains <span class="built_in">which</span> external tools, data sources, or APIs the agent can use and how they fit into its workflow.</span><br><span class="line"></span><br><span class="line"><span class="comment">## Interaction Style</span></span><br><span class="line">This section defines how the agent should communicate - its tone, level of detail, and overall personality when responding.</span><br><span class="line"></span><br><span class="line"><span class="comment">## Example Output (Optional)</span></span><br><span class="line">This section shows the agent what a good response looks like. By providing examples, you give the AI a pattern to follow, <span class="built_in">which</span> makes its answers</span><br><span class="line">more consistent and accurate.</span><br><span class="line"></span><br><span class="line"><span class="comment">## Notes (Optional)</span></span><br><span class="line">This section includes any extra guidance or reminders that <span class="built_in">help</span> the agent work better. Notes are optional but useful <span class="keyword">for</span> edge cases, exceptions, or</span><br><span class="line">small rules that don’t belong <span class="keyword">in</span> the main prompt.</span><br></pre></td></tr></table></figure>

<h4 id="❇️-custom-key-in-header"><a href="#❇️-custom-key-in-header" class="headerlink" title="❇️ custom key in header"></a>❇️ custom key in header</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">Authentication:GenericnCredential Type</span><br><span class="line">Generic Auth Type: Custom Auth</span><br><span class="line">Custom Auth: Custom Auth account(PollO)-<span class="built_in">set</span> as suitable</span><br><span class="line"></span><br><span class="line">JSON exmple:</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;headers&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;x-api-key&quot;</span>: <span class="string">&quot;your_key..&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;headers&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;Authorization&quot;</span>: <span class="string">&quot;your_key..&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># API Market free image &amp; video upload</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;headers&quot;</span>: &#123;</span><br><span class="line">  <span class="string">&quot;x-magicapi-key&quot;</span>: <span class="string">&quot;your_key..&quot;</span>,</span><br><span class="line">  <span class="string">&quot;accept&quot;</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">  <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;multipart/form-data&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Credintial for Tavily</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;headers&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;Authorization&quot;</span>: <span class="string">&quot;your_key..&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Credintial for Serper</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;headers&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">    <span class="string">&quot;X-API-KEY&quot;</span>: <span class="string">&quot;your_key..&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="❇️-twelvedata-set-key-at-Query-Parameters"><a href="#❇️-twelvedata-set-key-at-Query-Parameters" class="headerlink" title="❇️ twelvedata - set key at Query Parameters"></a>❇️ <a target="_blank" rel="noopener" href="https://twelvedata.com/">twelvedata</a> - set key at Query Parameters</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. set at Query Parameters</span></span><br><span class="line">Name: apikey</span><br><span class="line">Value: your_api_key</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. set at Authentication</span></span><br><span class="line">Authentication: Generic Credential Type</span><br><span class="line">Generic Auth Type: Query Auth</span><br><span class="line">Query Auth: Query Auth (twelvedata) - add it</span><br><span class="line">  Name: apikey</span><br><span class="line">  Value: your_api_key</span><br><span class="line"></span><br><span class="line"><span class="comment"># Setting</span></span><br><span class="line">Method: GET</span><br><span class="line">URL: https://api.twelvedata.com/time_series</span><br><span class="line">Send Query Parameters: Enable</span><br><span class="line">  symbol: &#123;&#123; <span class="variable">$json</span>.message.text &#125;&#125;</span><br><span class="line">  interval: 1min</span><br><span class="line">  outputsize: 100</span><br></pre></td></tr></table></figure>

<h4 id="GNews-set-key-at-Query-Parameters"><a href="#GNews-set-key-at-Query-Parameters" class="headerlink" title="GNews - set key at Query Parameters"></a><a target="_blank" rel="noopener" href="https://gnews.io/">GNews</a> - set key at Query Parameters</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># set at Authentication</span></span><br><span class="line">Authentication: Generic Credential Type</span><br><span class="line">Generic Auth Type: Query Auth</span><br><span class="line">Query Auth:Query Auth (Gnews)</span><br><span class="line">  Name: apikey</span><br><span class="line">  Value: your_api_key</span><br><span class="line"></span><br><span class="line"><span class="comment"># setting</span></span><br><span class="line">Method: GET</span><br><span class="line">URL: https://gnews.io/api/v4/search</span><br><span class="line">Send Query Parameters: Enable</span><br><span class="line">	q:　&#123;&#123; <span class="variable">$json</span>.topic &#125;&#125;</span><br><span class="line">	lang: en</span><br></pre></td></tr></table></figure>

<h4 id="NewsAPI-set-key-at-Query-Parameters"><a href="#NewsAPI-set-key-at-Query-Parameters" class="headerlink" title="NewsAPI - set key at Query Parameters"></a><a target="_blank" rel="noopener" href="https://newsapi.org/">NewsAPI</a> - set key at Query Parameters</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># set at Authentication</span></span><br><span class="line">Authentication: Generic Credential Type</span><br><span class="line">Generic Auth Type: Query Auth</span><br><span class="line">Query Auth: Query Auth (twelvedata) - add it</span><br><span class="line">  Name: apikey</span><br><span class="line">  Value: your_api_key</span><br><span class="line"></span><br><span class="line"><span class="comment"># setting</span></span><br><span class="line">Method: GET</span><br><span class="line">URL: https://newsapi.org/v2/everything</span><br><span class="line">Send Query Parameters: Enable</span><br><span class="line">  q:　&#123;&#123; <span class="variable">$json</span>.message.text &#125;&#125;</span><br><span class="line">  from: &#123;&#123; <span class="variable">$today</span>.minus(&#123; days: 2 &#125;).toFormat(<span class="string">&#x27;yyyy-MM-dd&#x27;</span>) &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># setting #2</span></span><br><span class="line">  Query Parameters: Enable</span><br><span class="line">  q: &#123;&#123; <span class="variable">$json</span>.topic &#125;&#125;</span><br><span class="line">  language: en</span><br><span class="line">  sortBy: publishedAt</span><br><span class="line">  pageSize: 20</span><br></pre></td></tr></table></figure>

<h4 id="Twitter-API"><a href="#Twitter-API" class="headerlink" title="Twitter API"></a><a target="_blank" rel="noopener" href="https://twitterapi.io/">Twitter API</a></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># set at Authentication</span></span><br><span class="line">Authentication: Generic Credential Type</span><br><span class="line">Generic Auth Type: Header Auth</span><br><span class="line">Header Auth: Header Auth (twitterapi) - add it</span><br><span class="line">  Name: X-API-Key</span><br><span class="line">  Value: your_api_key</span><br><span class="line"></span><br><span class="line"><span class="comment"># setting </span></span><br><span class="line">Method: GET</span><br><span class="line">URL: https://api.twitterapi.io/twitter/tweet/advanced_search</span><br><span class="line">Send Query Parameters: Enable</span><br><span class="line">Query Parameters</span><br><span class="line">  query: openai       -- search data</span><br><span class="line">  queryType: Top</span><br><span class="line">Pagination</span><br><span class="line">  Pagination Mode: Response Contains Next URL</span><br><span class="line">  Next URL: https://api.twitterapi.io/twitter/tweet/advanced_search?cursor=&#123;&#123; <span class="variable">$response</span>.body.next_cursor &#125;&#125;</span><br><span class="line">  Pagination Complete When: Other</span><br><span class="line">  Complete Expression: &#123;&#123; <span class="variable">$response</span>.body.has_next_page == <span class="literal">false</span> &#125;&#125;</span><br><span class="line">  Limit Pages Fetched: Enable</span><br><span class="line">  Max Pages: 5</span><br><span class="line">  Interval Between Requests (ms): 3000 -- 若有問題增加 6000</span><br></pre></td></tr></table></figure>

<h4 id="Perplexity-ask-Perplexity-API"><a href="#Perplexity-ask-Perplexity-API" class="headerlink" title="Perplexity - ask Perplexity API"></a><a target="_blank" rel="noopener" href="https://www.perplexity.ai/">Perplexity</a> - <a target="_blank" rel="noopener" href="https://www.perplexity.ai/search/perplexity-ai-support-ai-key-z-Bd5_CNBCQGSof8zDE6oWoQ#0">ask Perplexity API</a></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># set at Authentication</span></span><br><span class="line">Authentication: Generic Credential Type</span><br><span class="line">Generic Auth Type: Bearer Auth</span><br><span class="line">Bearer Auth: Bearer Auth (Perplxity) - add it</span><br><span class="line">	Bearer Token: &lt;api_key&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># set API key - Send Headers</span></span><br><span class="line">Send Headers: Enable</span><br><span class="line">Specify Headers: Using Fields Below</span><br><span class="line">Header Parameters</span><br><span class="line">	Name: Authorization</span><br><span class="line">	Value: Bearer &lt;api_key&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Setting </span></span><br><span class="line">Method: POST</span><br><span class="line">URL: https://api.perplexity.ai/chat/completions</span><br><span class="line">Send Body: Enable</span><br><span class="line">Body Content Type:JSON</span><br><span class="line">Specify Body:Using JSON</span><br><span class="line">JSON:</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;model&quot;</span>: <span class="string">&quot;sonar&quot;</span>,</span><br><span class="line">  <span class="string">&quot;messages&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>,</span><br><span class="line">      <span class="string">&quot;content&quot;</span>: <span class="string">&quot;Be precise and concise.&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">      <span class="string">&quot;content&quot;</span>: <span class="string">&quot;&#123;&#123; <span class="variable">$json</span>.chatInput &#125;&#125;&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Rapid-zillow"><a href="#Rapid-zillow" class="headerlink" title="Rapid - zillow"></a>Rapid - zillow</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">URL:　x-rapidapi-host<span class="string">&#x27;s value</span></span><br><span class="line"><span class="string">Authentication:GenericnCredential Type</span></span><br><span class="line"><span class="string">Generic Auth Type: Header Auth</span></span><br><span class="line"><span class="string">Name: x-rapidapi-key</span></span><br><span class="line"><span class="string">Value: x-rapidapi-key&#x27;</span>s value</span><br></pre></td></tr></table></figure>

<h4 id="This-message-was-sent-automatically-with-n8n"><a href="#This-message-was-sent-automatically-with-n8n" class="headerlink" title="This message was sent automatically with n8n"></a>This message was sent automatically with n8n</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Add Field --&gt; Append n8n Attribution : <span class="built_in">disable</span></span><br></pre></td></tr></table></figure>


<h4 id="n8n-Community"><a href="#n8n-Community" class="headerlink" title="n8n Community"></a>n8n Community</h4><h5 id="enable"><a href="#enable" class="headerlink" title="enable"></a>enable</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># enable Community node support</span></span><br><span class="line">n8n home</span><br><span class="line">--&gt; Admin Panel (see version : Running version n8n@1.104.2)</span><br><span class="line">--&gt; setup</span><br><span class="line">    Verified community nodes: on (can install community nodes)</span><br><span class="line">    also can change version, Zone</span><br><span class="line">--&gt; save change </span><br><span class="line">--&gt; Dashboard</span><br><span class="line">--&gt; Open Instance (<span class="built_in">return</span> n8n home)</span><br><span class="line"></span><br><span class="line"><span class="comment"># see install community node</span></span><br><span class="line">--&gt; User --&gt; setting (can see Cmmunity Notes)</span><br><span class="line">--&gt; can see installed community nodes</span><br></pre></td></tr></table></figure>

<h5 id="install-by-n8n-cloud"><a href="#install-by-n8n-cloud" class="headerlink" title="install by n8n cloud"></a>install by n8n cloud</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Conver text to speetch(11 labs)</span></span><br><span class="line">+ search <span class="string">&quot;elevenlabs&quot;</span> </span><br><span class="line">--&gt; install </span><br><span class="line">--&gt; Conver text to speetch(11 labs)</span><br><span class="line"></span><br><span class="line"><span class="comment"># web search, can use for I Agent&#x27;s tool</span></span><br><span class="line"><span class="comment"># tavily Tool</span></span><br><span class="line">+ search <span class="string">&quot;tavily&quot;</span> </span><br><span class="line">--&gt; install (有時失敗,再試一次就好了)</span><br></pre></td></tr></table></figure>

<h5 id="install-by-n8n-hosting"><a href="#install-by-n8n-hosting" class="headerlink" title="install by n8n hosting"></a>install by n8n hosting</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User --&gt; setting --&gt;  Cmmunity Nodes --&gt; install searching </span><br></pre></td></tr></table></figure>

<h3 id="node"><a href="#node" class="headerlink" title="node"></a>node</h3><h4 id="n8n-form-on-form-submission"><a href="#n8n-form-on-form-submission" class="headerlink" title="n8n form : on form submission"></a>n8n form : on form submission</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Form Title : Contact Form</span><br><span class="line">Form Description : Contact us when you have any problem to solver</span><br><span class="line">Add form Elemant:</span><br><span class="line">	Field:Name</span><br><span class="line">	Placholder: Enter your name(required)</span><br><span class="line"></span><br><span class="line"> 	Field:Last Name</span><br><span class="line">	Placholder: Enter your last name(required)</span><br><span class="line"></span><br><span class="line"> 	Field:Email</span><br><span class="line">	Element <span class="built_in">type</span> : Email</span><br><span class="line">	Placholder: Enter your email(required)</span><br><span class="line"></span><br><span class="line">	Field:Description</span><br><span class="line">	Placholder: Provide information about the problem(required)</span><br><span class="line"></span><br><span class="line">	Field:Course Type</span><br><span class="line">	Element <span class="built_in">type</span> : Dropdown List:n8n course, Zapier course, Midjourney course</span><br></pre></td></tr></table></figure>

<h4 id="send-a-message-to-Slack-Slack-–-gt-send-a-message"><a href="#send-a-message-to-Slack-Slack-–-gt-send-a-message" class="headerlink" title="send a message to Slack : Slack –&gt; send a message"></a>send a message to Slack : Slack –&gt; send a message</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Slack OAuth2 API</span></span><br><span class="line">OAuth Redirect URL --&gt; copy to Slach</span><br><span class="line">Client ID : put Slack Id</span><br><span class="line">Client Secret : put Slack Secret</span><br><span class="line"></span><br><span class="line">Send Message To : channel</span><br><span class="line">Channel: n8n-work</span><br><span class="line">message <span class="built_in">type</span> : simple Text Message</span><br><span class="line">Message Text :</span><br><span class="line">	Client as request</span><br><span class="line">	Name:&#123;&#123; <span class="variable">$json</span>.Name &#125;&#125;</span><br><span class="line">	Email:&#123;&#123; <span class="variable">$json</span>.Email &#125;&#125;</span><br><span class="line">	Phone number:&#123;&#123; <span class="variable">$json</span>[<span class="string">&#x27;Phone Number&#x27;</span>] &#125;&#125;</span><br><span class="line">	Description:&#123;&#123; <span class="variable">$json</span>.Description &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="add-user-to-google-contract-google-contracts-–-gt-create-a-contract"><a href="#add-user-to-google-contract-google-contracts-–-gt-create-a-contract" class="headerlink" title="add user to google contract : google contracts –&gt; create a contract"></a>add user to google contract : google contracts –&gt; create a contract</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">operation : Create </span><br><span class="line">Give Name : &#123;&#123; $(<span class="string">&#x27;Google Sheets Trigger&#x27;</span>).item.json.Name &#125;&#125;</span><br><span class="line">Add field:</span><br><span class="line">	Email: Type:work, value:&#123;&#123; $(<span class="string">&#x27;Google Sheets Trigger&#x27;</span>).item.json.Email &#125;&#125;</span><br><span class="line">	Phone: Type:mobil(有些值會 check number format), value:&#123;&#123; $(<span class="string">&#x27;Google Sheets Trigger&#x27;</span>).item.json[<span class="string">&#x27;Phone Number&#x27;</span>] &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="wait-message-from-Telegram’s-bot-“-on-app-event-gt-telegram-–-gt-on-message"><a href="#wait-message-from-Telegram’s-bot-“-on-app-event-gt-telegram-–-gt-on-message" class="headerlink" title="wait message from Telegram’s bot “ on app event -&gt; telegram –&gt; on message"></a>wait message from Telegram’s bot “ on app event -&gt; telegram –&gt; on message</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-&gt; <span class="built_in">set</span> credential (hugginFace cannot support telegram, change to n8n cloud) </span><br></pre></td></tr></table></figure>

<h4 id="AI-Agent-framework-AI-agent-node"><a href="#AI-Agent-framework-AI-agent-node" class="headerlink" title="AI Ａgent framework :AI agent node"></a>AI Ａgent framework :AI agent node</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># n8n 針對 AI Agent 節點（AI Agent / OpenAI Chat Model 等）設定了每日免費請求次數限制。當你觸發超過這個免費次數，就會看到這類 rate limit exceeded 或 too many requests 的訊息。</span></span><br><span class="line"><span class="comment"># 若需額外使用量，系統會提示你加購點數（credits）：根據錯誤訊息和官方社群解釋，購買 10 credits 可解鎖每天 1,000 次免費模型請求額度。</span></span><br><span class="line"><span class="comment"># 這個限制是 n8n 針對其自家/託管的 AI 服務設下，無論你是在 n8n Cloud 還是自架 n8n，只要用 n8n 內建（非自己 API Key）的 AI Agent 模組，都會受這個免費額度天花板約束。</span></span><br><span class="line"><span class="comment"># 如果你想要完全自訂額度或無限制，需在節點改成自行填入自己的 LLM API Key（如 OpenAI API Key）來直連，這樣限制就來自你購買的 API 配額，與 n8n 無關</span></span><br><span class="line"><span class="comment"># 額度提升方式</span></span><br><span class="line"><span class="comment"># 依照系統錯誤訊息，進入 n8n 的 credit 購買流程，加入 10 credits 可每天解鎖 1,000 次免費模型呼叫（不單次，而是每日）。一般會要求你綁信用卡或付費帳戶。</span></span><br><span class="line"><span class="comment"># 若你不加購，隔天會自動恢復基礎的免費額度（約 50 次左右，會依官方政策調整）。</span></span><br><span class="line">Source <span class="keyword">for</span> Prompt : Define below </span><br><span class="line">Prompt : &#123;&#123; <span class="variable">$json</span>.message.text &#125;&#125;, output not over 1200 letters, and not use markdown format</span><br></pre></td></tr></table></figure>

<h4 id="Gemini-response-ask-Google-Gemini-Chat-model-link-to-AIn-Agent-Chat-Model"><a href="#Gemini-response-ask-Google-Gemini-Chat-model-link-to-AIn-Agent-Chat-Model" class="headerlink" title="Gemini response ask : Google Gemini Chat model(link to AIn Agent Chat Model)"></a>Gemini response ask : Google Gemini Chat model(link to AIn Agent Chat Model)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">--&gt; <span class="built_in">set</span> API key</span><br><span class="line">Model : gemini-2,5-flash (也可選其他看看)</span><br></pre></td></tr></table></figure>

<h4 id="Sen-to-Telgram-Telegram-–-gt-send-a-text-message"><a href="#Sen-to-Telgram-Telegram-–-gt-send-a-text-message" class="headerlink" title="Sen to Telgram : Telegram –&gt; send a text message"></a>Sen to Telgram : Telegram –&gt; send a text message</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Telegram 文字訊息的長度限制是 最多 4,096 個字元（字符）。這個限制適用於單條文字訊息，不論是純文字還是帶格式的內容17。</span></span><br><span class="line"><span class="comment"># 此外，附件描述文字的長度上限是 1,024 到 2,048 字元，檔案大小限制普通用戶是 2 GB，Telegram Premium 用戶可達 4 GB1。</span></span><br><span class="line">Chat ID :&#123;&#123; $(<span class="string">&#x27;Telegram Trigger&#x27;</span>).item.json.message.chat.id &#125;&#125;</span><br><span class="line">Text: &#123;&#123; <span class="variable">$json</span>.output &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Google-Driver-–-gt-On-change-involving-a-specific-Folder"><a href="#Google-Driver-–-gt-On-change-involving-a-specific-Folder" class="headerlink" title="Google Driver –&gt; On change involving a specific Folder"></a>Google Driver –&gt; On change involving a specific Folder</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Folder : Demo</span><br><span class="line">Watch For : File Created</span><br></pre></td></tr></table></figure>

<h4 id="Google-Driver–-gt-Share-File"><a href="#Google-Driver–-gt-Share-File" class="headerlink" title="Google Driver–&gt; Share File"></a>Google Driver–&gt; Share File</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 若對方非 gmail email, access 時會回送 mail 要求設定權限</span></span><br><span class="line"></span><br><span class="line">File : By Id-&#123;&#123; <span class="variable">$json</span>.id &#125;&#125; </span><br><span class="line">--&gt; add permission </span><br><span class="line">--&gt; Role: Writer, Type:User, Email address: ...</span><br></pre></td></tr></table></figure>

<h4 id="Airtable-–-gt-Create-a-record"><a href="#Airtable-–-gt-Create-a-record" class="headerlink" title="Airtable –&gt;Create a record"></a><a target="_blank" rel="noopener" href="https://www.airtable.com/">Airtable</a> –&gt;Create a record</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Base:Untitled Base, </span><br><span class="line">Table:Table 1</span><br><span class="line">File ID:&#123;&#123; $(<span class="string">&#x27;Google Drive Trigger&#x27;</span>).item.json.id &#125;&#125;</span><br><span class="line">Creation Time:&#123;&#123; $(<span class="string">&#x27;Google Drive Trigger&#x27;</span>).item.json.createdTime &#125;&#125;</span><br><span class="line">Recipient Email:..</span><br></pre></td></tr></table></figure>

<h4 id="download-file-from-google-drive-google-drive–-gt-download-file"><a href="#download-file-from-google-drive-google-drive–-gt-download-file" class="headerlink" title="download file from google drive : google drive–&gt; download file"></a>download file from google drive : google drive–&gt; download file</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">File : &#123;&#123; <span class="variable">$json</span>.id &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Gemini-Transcribe-Gogle-Gemini-–-gt-Transcribe-a-recoding"><a href="#Gemini-Transcribe-Gogle-Gemini-–-gt-Transcribe-a-recoding" class="headerlink" title="Gemini Transcribe : Gogle Gemini –&gt; Transcribe a recoding"></a>Gemini Transcribe : Gogle Gemini –&gt; Transcribe a recoding</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Model: gemini-2.5.flash or Flash Live</span><br><span class="line">Input Type: Binary File</span><br></pre></td></tr></table></figure>

<h4 id="Gemini-Summarize-Gogle-Gemini-–-gt-Message-a-model"><a href="#Gemini-Summarize-Gogle-Gemini-–-gt-Message-a-model" class="headerlink" title="Gemini Summarize : Gogle Gemini –&gt; Message a model"></a>Gemini Summarize : Gogle Gemini –&gt; Message a model</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">Model: gemini-2.5.flash or Pro</span><br><span class="line">Prompt: Transcript:  &#123;&#123; <span class="variable">$json</span>.content.parts[0].text &#125;&#125;</span><br><span class="line"></span><br><span class="line">--&gt; Add Message</span><br><span class="line">Prompt: </span><br><span class="line">Instruction: </span><br><span class="line">Summarize the audio content into plain text, following the structure below.</span><br><span class="line">Rules:</span><br><span class="line">The entire summary must not exceed 1500 characters.</span><br><span class="line">Include and label all the following sections: title, summary, main_ points, action_items, follow_up, stories, references, arguments, related_topics.</span><br><span class="line">Keep the style clear, concise, and organized.</span><br><span class="line">Use short, natural-sounding bullet points <span class="keyword">for</span> lists.</span><br><span class="line">Example formtating:</span><br><span class="line">title: Notion Button</span><br><span class="line">Summary: A collection of buttons <span class="keyword">for</span> Notion that streamline workflow and save time.</span><br><span class="line">main_points:</span><br><span class="line">- Overview of Notion buttons</span><br><span class="line">- Example of button use cases</span><br><span class="line">- Best practices <span class="keyword">for</span> setup </span><br><span class="line">action_items:</span><br><span class="line">- Test different button templates\n</span><br><span class="line">- Implement buttons <span class="keyword">in</span> daily workflows</span><br><span class="line">- Share templates with team</span><br><span class="line">follow_up:</span><br><span class="line">- Explore advanced button integrations</span><br><span class="line">- Gather team feedback on usage</span><br><span class="line">stories:</span><br><span class="line">- A team improved productivity by 30% using custom buttons</span><br><span class="line">references:</span><br><span class="line">- Official Notion documentation</span><br><span class="line">- Community tutorials on Notion workflows</span><br><span class="line">arguments:</span><br><span class="line">- Buttons reduce repetitive tasks</span><br><span class="line">- Custom buttons enhance flexibility</span><br><span class="line">related_topics:</span><br><span class="line">- Notion automations</span><br><span class="line">- Workflow optimization</span><br><span class="line">-Team collaboration tools</span><br></pre></td></tr></table></figure>

<h4 id="save-to-Notion-Notion-–-gt-Append-a-block"><a href="#save-to-Notion-Notion-–-gt-Append-a-block" class="headerlink" title="save to Notion : Notion –&gt; Append a block"></a>save to Notion : Notion –&gt; Append a block</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Credential : Internal Integration Secret: </span><br><span class="line">parent Page : Notion<span class="string">&#x27;s create page...</span></span><br><span class="line"><span class="string">Title:&#123;&#123; $(&#x27;</span>Google Drive Trigger<span class="string">&#x27;).item.json.originalFilename &#125;&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">--&gt; add Block</span></span><br><span class="line"><span class="string">Type name: Heading1</span></span><br><span class="line"><span class="string">Text:Summary</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">--&gt; add Block</span></span><br><span class="line"><span class="string">Type name: Paragraph</span></span><br><span class="line"><span class="string">Rich Text: off</span></span><br><span class="line"><span class="string">Text:&#123;&#123; $json.content.parts[0].text &#125;&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># error -&gt; when data generate from Ai change --&gt; The entire summary must not exceed 1200 characters.</span></span><br><span class="line"><span class="string">Bad request - please check your parameters</span></span><br><span class="line"><span class="string">body failed validation: body.children[1].paragraph.rich_text[0].text.content.length should be ≤ 2000, instead was 2406.</span></span><br></pre></td></tr></table></figure>

<h4 id="update-to-Notion-database-Notion-–-gt-Create-a-database-page"><a href="#update-to-Notion-database-Notion-–-gt-Create-a-database-page" class="headerlink" title="update to Notion database : Notion –&gt; Create a database page"></a>update to Notion database : Notion –&gt; Create a database page</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from node : Google Driver –&gt; On change involving a specific Folder(Demo)</span></span><br><span class="line">DataBase:From List: File Uploaded - Google Drive</span><br><span class="line">--&gt; Add Property</span><br><span class="line">	key name or ID : Name </span><br><span class="line">	Title : &#123;&#123; <span class="variable">$json</span>.originalFilename &#125;&#125;</span><br><span class="line">--&gt; Add Property</span><br><span class="line">	key name or ID : File URL</span><br><span class="line">	URL: &#123;&#123; <span class="variable">$json</span>.webViewLink &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="get-a-google-doc-Google-Docs-–-gt-Get-document"><a href="#get-a-google-doc-Google-Docs-–-gt-Get-document" class="headerlink" title="get a google doc : Google Docs –&gt; Get document"></a>get a google doc : Google Docs –&gt; Get document</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># from node : Google Driver –&gt; On change involving a specific Folder(n8n testing)</span></span><br><span class="line">Doc ID or URL : &#123;&#123; <span class="variable">$json</span>.id &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="precess-by-Gemini-Gemini-–-gt-Meessage-a-modem"><a href="#precess-by-Gemini-Gemini-–-gt-Meessage-a-modem" class="headerlink" title="precess by Gemini : Gemini –&gt; Meessage a modem"></a>precess by Gemini : Gemini –&gt; Meessage a modem</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Model : gemini-2.5-flash </span><br><span class="line">Prompt: Summarise this content into 3-5 sentences: &#123;&#123; <span class="variable">$json</span>.content &#125;&#125;</span><br><span class="line"></span><br><span class="line">Tools : add Wikipedia</span><br></pre></td></tr></table></figure>

<h4 id="http-request-freeimage-host"><a href="#http-request-freeimage-host" class="headerlink" title="http request(freeimage host)"></a>http request(freeimage host)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Method: POST</span><br><span class="line">URL: https://freeimage.host/api/1/upload</span><br><span class="line">Send Body: <span class="built_in">enable</span></span><br><span class="line">Body Content Type: Form-Data</span><br><span class="line">key(From data): &lt;your key&gt;</span><br><span class="line">action(From data): upload</span><br><span class="line"><span class="built_in">source</span>(n8n Binnary File): data</span><br><span class="line">format(From data): json</span><br></pre></td></tr></table></figure>

<div style="max-width:800px">
    <img src="/2025/07/28/n8n-2/pic1.png" class="" title="pic1">
</div>

<h4 id="http-request-imgbb"><a href="#http-request-imgbb" class="headerlink" title="http request(imgbb)"></a>http request(imgbb)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Method: POST</span><br><span class="line">URL: https://api.imgbb.com/1/upload</span><br><span class="line">Send Body: <span class="built_in">enable</span></span><br><span class="line">Body Content Type: Form-Data</span><br><span class="line">key(From data): &lt;your key&gt;</span><br><span class="line">image(n8n Binnary File): data</span><br></pre></td></tr></table></figure>

<div style="max-width:800px">
    <img src="/2025/07/28/n8n-2/pic2.png" class="" title="pic2">
</div>


<h4 id="http-request-API-Market-free-image-amp-video-upload"><a href="#http-request-API-Market-free-image-amp-video-upload" class="headerlink" title="http request(API Market free image &amp; video upload)"></a>http request(API Market free image &amp; video upload)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Method: POST</span><br><span class="line">URL: https://prod.api.market/api/v1/magicapi/image-upload/upload</span><br><span class="line">Send Body: <span class="built_in">enable</span></span><br><span class="line">Body Content Type: Form-Data</span><br><span class="line">filename(n8n Binnary File): data</span><br></pre></td></tr></table></figure>

<div style="max-width:300px">
    <img src="/2025/07/28/n8n-2/pic3.png" class="" title="pic3">
</div>

<h4 id="basc-LLM-Chain-Model-Use-for-simple-prompt-and-response-tasks-with-no-advanced-logic"><a href="#basc-LLM-Chain-Model-Use-for-simple-prompt-and-response-tasks-with-no-advanced-logic" class="headerlink" title="basc LLM Chain + Model : Use for simple prompt-and-response tasks with no advanced logic"></a>basc LLM Chain + Model : Use for simple prompt-and-response tasks with no advanced logic</h4><h4 id="Information-Extractor-Model-extractor-data"><a href="#Information-Extractor-Model-extractor-data" class="headerlink" title="Information Extractor + Model : extractor data"></a>Information Extractor + Model : extractor data</h4><h4 id="Sentimat-Anaysys-Model-Use-to-detect-tone-positive-negative-neutral-in-text"><a href="#Sentimat-Anaysys-Model-Use-to-detect-tone-positive-negative-neutral-in-text" class="headerlink" title="Sentimat Anaysys + Model :　Use to detect tone (positive, negative, neutral) in text."></a>Sentimat Anaysys + Model :　Use to detect tone (positive, negative, neutral) in text.</h4><h4 id="Text-Classifier-Model-Use-to-sort-text-into-categories"><a href="#Text-Classifier-Model-Use-to-sort-text-into-categories" class="headerlink" title="Text Classifier + Model : Use to sort text into categories"></a>Text Classifier + Model : Use to sort text into categories</h4><h4 id="Summarization-chain-Use-to-condense-long-content-into-a-short-summary"><a href="#Summarization-chain-Use-to-condense-long-content-into-a-short-summary" class="headerlink" title="Summarization chain : Use to condense long content into a short summary"></a>Summarization chain : Use to condense long content into a short summary</h4><h4 id="Split-Turn-a-list-item-s-into-separate-items"><a href="#Split-Turn-a-list-item-s-into-separate-items" class="headerlink" title="Split : Turn a list item(s) into separate items"></a>Split : Turn a list item(s) into separate items</h4><h4 id="Splitter"><a href="#Splitter" class="headerlink" title="Splitter"></a>Splitter</h4><ul>
<li>Character Text Splitter <ul>
<li>依「字元數」分段，可指定分隔符（如換行、句號或自訂符號），再按固定長度切塊。​</li>
<li>優點是邏輯簡單、效能高，但容易在句子或段落中間硬切，語義連貫性較差，適合只需要粗略切片的情境。​</li>
</ul>
</li>
<li>Recursive Character Text Splitter<ul>
<li>同樣以「字元」為限制，但會「遞歸」按層級嘗試：先用段落、再句子、再單字等分割，盡量讓每個 chunk 在不超過長度限制下保持自然語段。​</li>
<li>一般 RAG &#x2F; 向量搜尋工作流比較推薦用這個，因為能在控制長度的同時保留較完整的上下文結構。​</li>
</ul>
</li>
<li>Token Splitter<ul>
<li>不是看字元，而是先把文字轉成模型用的 BPE「token」，再按 token 數量（例如 500 tokens 一塊）切分，最後再轉回文字。​</li>
<li>最大優點是能精準對齊 LLM 的上下文長度限制，輸入長度控制更準確，適合直接拿去給 OpenAI 等模型做 embedding 或對話。​</li>
</ul>
</li>
</ul>
<p>如果只想選一個「通用、安全的」做法，平常在 n8n 裡處理長文、做向量資料庫檢索，通常優先選 Recursive Character Text Splitter；需要精確控制 token 上限（例如怕超過 4k &#x2F; 8k token）時再改用 Token Splitter。</p>
<ul>
<li>Recursive Character Text Splitter 裡，Chunk Size 決定「每塊文字的最大字元數」，Chunk Overlap 則是「相鄰兩塊之間重疊的字元數」<ul>
<li>參數概念說明<br>1.Chunk Size：每個 chunk 最長可以包含多少個字元，超過時就會依分隔符（段落、句子、空白等）往下切。​<br>2.Chunk Overlap：相鄰 chunk 之間要重複多少字元，用來保留上下文，避免一句話剛好被切斷時語意斷裂。​</li>
<li>實務上的建議數值<ol>
<li>一般 RAG 文本（技術文件、網頁、PDF 段落等），常見設定為</li>
</ol>
<ul>
<li>Chunk Size 約 400–1,000 字元</li>
<li>Chunk Overlap 約 10–25% 的 Chunk Size（例如 400 &#x2F; 100、800 &#x2F; 160）。​</li>
</ul>
<ol start="2">
<li>有人示範在 n8n 中用 Recursive Character Text Splitter 時，採用 Chunk Size 400、Overlap 100 作為範例設定，兼顧語意與長度控制。​​</li>
</ol>
</li>
<li>依你的情境調整<ol>
<li>長、結構較完整的文章（技術白皮書、部落格）：可選擇 Chunk Size 600–1,000，Overlap 100–200，讓每塊有更多上下文，適合「摘要、解釋」類問題。​</li>
<li>短內容、問答精準檢索（FAQ、聊天記錄切段）：可用 Chunk Size 300–600，Overlap 50–120，讓召回更細粒度，避免一次抓到太大段文。</li>
</ol>
</li>
</ul>
</li>
</ul>
<h3 id="workflow"><a href="#workflow" class="headerlink" title="workflow"></a>workflow</h3><h4 id="Perplexity"><a href="#Perplexity" class="headerlink" title="Perplexity"></a>Perplexity</h4><h5 id="Smart-Perlexity-AI-Agent"><a href="#Smart-Perlexity-AI-Agent" class="headerlink" title="Smart Perlexity AI Agent"></a>Smart Perlexity AI Agent</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">On chat message :</span><br><span class="line"></span><br><span class="line">Ai Agent </span><br><span class="line">  chat model: Google Gemini Chat model(gemini-2.5.flash)</span><br><span class="line">  Tools: Perplexity Tool</span><br><span class="line">    Credential to connect with: Perplexity account</span><br><span class="line">      API Key: &lt;api_key&gt;</span><br><span class="line">    text : Defined automatically by the model</span><br><span class="line">      Model: Sonar or Sonar Pro more good</span><br><span class="line">      System Message: Tool  <span class="string">&quot;Message a model in Perplexity&quot;</span>　supports searching internal information</span><br><span class="line"></span><br><span class="line"><span class="comment"># input</span></span><br><span class="line">chat input : <span class="string">&quot;What are the 5 best AI tools for video editing until now (2025/08/08) </span></span><br></pre></td></tr></table></figure>

<h5 id="Perlexity-Node"><a href="#Perlexity-Node" class="headerlink" title="Perlexity Node"></a>Perlexity Node</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">On chat message : </span><br><span class="line"></span><br><span class="line">Perplexity --&gt; Message a model</span><br><span class="line">	Model : Sonar or Sonar Pro more good</span><br><span class="line">	text : &#123;&#123; <span class="variable">$json</span>.action &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># input</span></span><br><span class="line">chat input : give me 5 marketing ai tools <span class="keyword">in</span> 2025 </span><br></pre></td></tr></table></figure>

<h5 id="Perplexity-Node-HTTP-Request"><a href="#Perplexity-Node-HTTP-Request" class="headerlink" title="Perplexity Node(HTTP Request)"></a>Perplexity Node(HTTP Request)</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">On chat message : </span><br><span class="line"></span><br><span class="line">HTTP request</span><br><span class="line">	URL: https://api.perplexity.ai/chat/completions</span><br><span class="line">	Send Headers: Enabled</span><br><span class="line">	Name: Authorization</span><br><span class="line">	Value: Bearer YOUR_API_KEY</span><br><span class="line">	Send Body: Enabled</span><br><span class="line">	Body Content Type: JSON</span><br><span class="line">	Specify Body: Using JSON</span><br><span class="line">	JSON:</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="string">&quot;model&quot;</span>: <span class="string">&quot;sonar&quot;</span>,</span><br><span class="line">		<span class="string">&quot;messages&quot;</span>: [</span><br><span class="line">			&#123;</span><br><span class="line">			<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>,</span><br><span class="line">			<span class="string">&quot;content&quot;</span>: <span class="string">&quot;Be precise and concise.&quot;</span></span><br><span class="line">			&#125;,</span><br><span class="line">			&#123;</span><br><span class="line">			<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">			<span class="string">&quot;content&quot;</span>: <span class="string">&quot;&quot;</span>&#123;&#123; <span class="variable">$json</span>.chatInput &#125;&#125;<span class="string">&quot;</span></span><br><span class="line"><span class="string">			&#125;</span></span><br><span class="line"><span class="string">		]</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># input</span></span><br><span class="line"><span class="string">chat input : give me 5 marketing ai tools in 2005 </span></span><br></pre></td></tr></table></figure>

<h4 id="example-AI-automation-from-Templeate"><a href="#example-AI-automation-from-Templeate" class="headerlink" title="example AI automation from Templeate"></a>example AI automation from Templeate</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">n8n home </span><br><span class="line">--&gt; template (see workflow template) </span><br><span class="line">--&gt; serch <span class="string">&quot;email summary agent&quot;</span></span><br><span class="line">--&gt; select templeat</span><br><span class="line">--&gt; Use <span class="keyword">for</span> free</span><br><span class="line">--&gt; Import template to ... or Copy template to clipboard (JSON)</span><br></pre></td></tr></table></figure>

<h4 id="AI-Automation-Feedback-Collect-form"><a href="#AI-Automation-Feedback-Collect-form" class="headerlink" title="AI Automation Feedback Collect form"></a>AI Automation Feedback Collect form</h4><h5 id="on-form-submission"><a href="#on-form-submission" class="headerlink" title="on form submission"></a>on form submission</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Form Title :Feedback Form</span><br><span class="line">--&gt; Add form Element</span><br><span class="line">  Field name :Wtat you name?</span><br><span class="line">  Field name :What<span class="string">&#x27;s your email?</span></span><br><span class="line"><span class="string">  Field name :Please give us your feedback, Element type:Dropdown List --&gt; Great,Good,Neutral,Bad</span></span><br><span class="line"><span class="string">	Field name :Please lease a comment</span></span><br></pre></td></tr></table></figure>

<h5 id="google-sheets-–-gt-append-row-in-sheet"><a href="#google-sheets-–-gt-append-row-in-sheet" class="headerlink" title="google sheets –&gt; append row in sheet"></a>google sheets –&gt; append row in sheet</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docuemnt : Feedback Collection</span><br><span class="line">value : <span class="built_in">set</span> from form </span><br></pre></td></tr></table></figure>

<h4 id="AI-Agent-from-scratch"><a href="#AI-Agent-from-scratch" class="headerlink" title="AI Agent from scratch"></a>AI Agent from scratch</h4><h5 id="chat-Trigger"><a href="#chat-Trigger" class="headerlink" title="chat Trigger"></a>chat Trigger</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">send :  Can you please send an email to Boss that I need to reschedule our upcoming meeting?</span><br></pre></td></tr></table></figure>

<h5 id="AI-Agent"><a href="#AI-Agent" class="headerlink" title="AI Agent"></a>AI Agent</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># add option --&gt; system message</span></span><br><span class="line"><span class="comment">#Role</span></span><br><span class="line">You are a personal assistant AI Agent. Your primary role is to send emails. You have access to two tools: Contacts and Gmail_Tool.</span><br><span class="line"></span><br><span class="line"><span class="comment">##Tools</span></span><br><span class="line">1.Contacts</span><br><span class="line">Use this tool when you need to look up contact information like an email address or phone number. You need to use this tool BEFORE sending an email or BEFORE getting emails.</span><br><span class="line"></span><br><span class="line">2. Gmail_Tool:</span><br><span class="line">Use this <span class="keyword">for</span> handling all email</span><br><span class="line">-related actions, like sending emails, reading emails, or forwarding emails.</span><br><span class="line">- Keep emails professional.</span><br><span class="line">- Format nicely the Body of the email with line breaks and clear structure.</span><br><span class="line">- Always sing off as </span><br><span class="line">Best regards,</span><br><span class="line">Robert</span><br><span class="line">Here is the current time/date: &#123;&#123; <span class="variable">$now</span>.format(<span class="string">&#x27;DD&#x27;</span>)&#125;&#125;</span><br></pre></td></tr></table></figure>
<h5 id="AI-Agent-Chat-Model-Gemini-chat-model"><a href="#AI-Agent-Chat-Model-Gemini-chat-model" class="headerlink" title="AI Agent - Chat Model :　Gemini chat model"></a>AI Agent - Chat Model :　Gemini chat model</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model : gemini-2.5-flash </span><br></pre></td></tr></table></figure>
<h5 id="AI-Agent-Memory-simple-memory"><a href="#AI-Agent-Memory-simple-memory" class="headerlink" title="AI Agent - Memory :　simple memory"></a>AI Agent - Memory :　simple memory</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 保留 message</span></span><br><span class="line">Context Window Length : 10</span><br></pre></td></tr></table></figure>
<h5 id="AI-Agent-Tool-Google-Sheets-Tool"><a href="#AI-Agent-Tool-Google-Sheets-Tool" class="headerlink" title="AI Agent - Tool :  Google Sheets Tool"></a>AI Agent - Tool :  Google Sheets Tool</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> name : Contacts</span><br><span class="line">To/Subject/Message : Dedined automatically by the model</span><br><span class="line">--&gt; add option : Append n8n Attribution - <span class="built_in">disable</span> </span><br></pre></td></tr></table></figure>
<h5 id="AI-Agent-Tool-Gmail-Tool"><a href="#AI-Agent-Tool-Gmail-Tool" class="headerlink" title="AI Agent - Tool : Gmail Tool"></a>AI Agent - Tool : Gmail Tool</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> name : Gmail_Tool</span><br></pre></td></tr></table></figure>

<h4 id="Get-Daily-News"><a href="#Get-Daily-News" class="headerlink" title="Get Daily News"></a>Get Daily News</h4><h5 id="Schedule-Trigger"><a href="#Schedule-Trigger" class="headerlink" title="Schedule Trigger"></a>Schedule Trigger</h5><h5 id="Edit-Field-set-topic-value-“World-News”-“AI”-…"><a href="#Edit-Field-set-topic-value-“World-News”-“AI”-…" class="headerlink" title="Edit Field : set topic value : “World News” , “AI” …"></a>Edit Field : set topic value : “World News” , “AI” …</h5><h5 id="HTTP-request-1-GNews-HTTP-request-2-news-API-for-2-new-source"><a href="#HTTP-request-1-GNews-HTTP-request-2-news-API-for-2-new-source" class="headerlink" title="HTTP request#1-GNews, HTTP request#2-news API : for 2 new source"></a>HTTP request#1-<a target="_blank" rel="noopener" href="https://gnews.io/">GNews</a>, HTTP request#2-<a target="_blank" rel="noopener" href="https://newsapi.org/">news API</a> : for 2 new source</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Get GNews Articles</span></span><br><span class="line">Method: GET</span><br><span class="line">URL: https://gnews.io/api/v4/search</span><br><span class="line">Send Query Parameters: Enabled</span><br><span class="line">Parameter 1</span><br><span class="line">Name: q</span><br><span class="line">Value: AI</span><br><span class="line"></span><br><span class="line">Parameter 2</span><br><span class="line">Name: lang</span><br><span class="line">Value: en</span><br><span class="line">Parameter 3</span><br><span class="line">Name: apikey</span><br><span class="line">Value: Your_API_Key</span><br><span class="line"></span><br><span class="line"><span class="comment"># Get NewsAPI Articles</span></span><br><span class="line">Method: GET</span><br><span class="line">URL: https://newsapi.org/v2/everything</span><br><span class="line">Send Query Parameters: Enabled</span><br><span class="line">Parameter 1</span><br><span class="line">Name: q</span><br><span class="line">Value: AI</span><br><span class="line">Parameter 2</span><br><span class="line">Name: language</span><br><span class="line">Value: en</span><br><span class="line">Parameter 3</span><br><span class="line">Name: sortBy</span><br><span class="line">Value: publishedAt</span><br><span class="line">Parameter 4</span><br><span class="line">Name: pageSize</span><br><span class="line">Value: 20</span><br><span class="line">Send Headers: Enabled</span><br><span class="line">Name: X-Api-Key</span><br><span class="line">Value: Your_API_Key</span><br></pre></td></tr></table></figure>

<h5 id="Merge"><a href="#Merge" class="headerlink" title="Merge"></a>Merge</h5><h5 id="AI-AGent-1"><a href="#AI-AGent-1" class="headerlink" title="AI AGent(1)"></a>AI AGent(1)</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Prompt:</span></span><br><span class="line">** Select Top Articles **</span><br><span class="line">From &#123;&#123;<span class="variable">$json</span>.articles&#125;&#125;, choose the 15 most relevant articles related to AI technology advancements,</span><br><span class="line">tools, research, and applications.</span><br><span class="line">** Summarize Clearly **</span><br><span class="line">Write <span class="keyword">in</span> clear, professional, and readable language,</span><br><span class="line">summarizing the main point of each article <span class="keyword">in</span> 1-2 short sentences.</span><br><span class="line">** Include Links **</span><br><span class="line">After each summary, add the article<span class="string">&#x27;s URL for readers to explore more.</span></span><br><span class="line"><span class="string">** Add the Date **</span></span><br><span class="line"><span class="string">Begin the summary with today’s date:</span></span><br><span class="line"><span class="string">&#123;&#123; $now.format(&#x27;</span>yyyy/MM/dd<span class="string">&#x27;) &#125;&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># System Message:</span></span><br><span class="line"><span class="string">** Output Format **</span></span><br><span class="line"><span class="string">Only return the summary in plain text – no explanations</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># chat model : google gemini Model</span></span><br><span class="line"><span class="string">model : gemini-2.5-flash</span></span><br></pre></td></tr></table></figure>

<h5 id="gooogle-Gemini-–-gt-message-a-model-2-use-prompt-as-AI-AGent"><a href="#gooogle-Gemini-–-gt-message-a-model-2-use-prompt-as-AI-AGent" class="headerlink" title="gooogle Gemini –&gt; message a model(2):use prompt as AI AGent"></a>gooogle Gemini –&gt; message a model(2):use prompt as AI AGent</h5><h5 id="Telegram-–-gt-send-a-text-message"><a href="#Telegram-–-gt-send-a-text-message" class="headerlink" title="Telegram –&gt; send a text message"></a>Telegram –&gt; send a text message</h5><h4 id="Generate-Video-prompt"><a href="#Generate-Video-prompt" class="headerlink" title="Generate Video prompt"></a>Generate Video prompt</h4><h5 id="Schedule-Trigger-1"><a href="#Schedule-Trigger-1" class="headerlink" title="Schedule Trigger"></a>Schedule Trigger</h5><h5 id="AI-Agent-Create-a-Idea"><a href="#AI-Agent-Create-a-Idea" class="headerlink" title="AI Agent - Create a Idea"></a>AI Agent - Create a Idea</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Prompt:</span></span><br><span class="line">Give me an idea to create the content about biblical characters speaking to the camera and making a vlog</span><br><span class="line">System Message:</span><br><span class="line">** Purpose **</span><br><span class="line">You generate viral short-form video ideas inspired by biblical characters or scenes, styled like modern TikTok vlogs.</span><br><span class="line">These should feel personal, emotional, and often humorous.</span><br><span class="line">** Think Tool Prompt (used before generation) **</span><br><span class="line">“How can I take a biblical moment or character and turn it into a relatable, viral,</span><br><span class="line">or funny TikTok-style video idea that feels natural, emotional, or modern?”</span><br><span class="line">** Output Requirements **</span><br><span class="line">Your response must include:</span><br><span class="line">- caption – Short, poetic or funny, TikTok-style. Include emojis and 3–5 hashtags</span><br><span class="line">(e.g., <span class="comment">#biblevlog #foryou #holycomedy #ancientvibes).</span></span><br><span class="line">- idea – 1–2 sentence summary of the action, story, or twist <span class="keyword">in</span> the video.</span><br><span class="line">- environment – Describe what the <span class="built_in">set</span> looks like: light, textures, mood, setting. Think “GoPro meets ancient Jerusalem.”</span><br><span class="line">- status – Must be <span class="string">&quot;to create&quot;</span>, without quotation marks</span><br><span class="line">** JSON Output Parser **</span><br><span class="line">Every output must strictly follow this format:</span><br><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;caption&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line"><span class="string">&quot;idea&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line"><span class="string">&quot;environment&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line"><span class="string">&quot;status&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">** Sample Outputs **</span><br><span class="line">Example 1</span><br><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;caption&quot;</span>: <span class="string">&quot;When Jesus gives you the silent treatment ️😶 #jesusvlog #holycomedy&quot;</span>,</span><br><span class="line"><span class="string">&quot;idea&quot;</span>: <span class="string">&quot;Jesus calmly stares at the camera while the disciple keeps asking, &#x27;Are we lost?&#x27; – awkward silence builds up.&quot;</span>,</span><br><span class="line"><span class="string">&quot;environment&quot;</span>: <span class="string">&quot;Desert trail, golden hour light, dry bushes around, warm rocky textures and wind softly blowing.&quot;</span>,</span><br><span class="line"><span class="string">&quot;status&quot;</span>: <span class="string">&quot;ready for production&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">Example 2</span><br><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;caption&quot;</span>: <span class="string">&quot;POV: You just met Mary Magdalene and she’s not what you expected 😳✨ #biblevlog #foryou&quot;</span>,</span><br><span class="line"><span class="string">&quot;idea&quot;</span>: <span class="string">&quot;A modern-style introduction of Mary Magdalene where she breaks the fourth wall with sarcasm and confidence.&quot;</span>,</span><br><span class="line"><span class="string">&quot;environment&quot;</span>: <span class="string">&quot;Dusty stone home with narrow light beams, clay walls, fabric drapes blowing slightly in the breeze.&quot;</span>,</span><br><span class="line"><span class="string">&quot;status&quot;</span>: <span class="string">&quot;ready for production&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">Example 3</span><br><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;caption&quot;</span>: <span class="string">&quot;Me trying to explain the flood before it happened ️🐘 #noahvibes #bibletok&quot;</span>,</span><br><span class="line"><span class="string">&quot;idea&quot;</span>: <span class="string">&quot;Noah explains why he’s building the ark, while others laugh in the background — like a vlog rant.&quot;</span>,</span><br><span class="line"><span class="string">&quot;environment&quot;</span>: <span class="string">&quot;Half-built wooden structure, cloudy sky, goats wandering around, mud everywhere, distant laughter.&quot;</span>,</span><br><span class="line"><span class="string">&quot;status&quot;</span>: <span class="string">&quot;concept only&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># chat model : google gemini Model</span></span><br><span class="line">model : gemini-2.5-flash</span><br><span class="line"></span><br><span class="line"><span class="comment"># Require Specific Output Format : enable</span></span><br><span class="line"><span class="comment"># Output Parser :  Structure Output Parser</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;caption&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line"><span class="string">&quot;idea&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line"><span class="string">&quot;environment&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line"><span class="string">&quot;status&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Tool : Think</span></span><br></pre></td></tr></table></figure>

<h5 id="AI-Agent-Create-a-Video-prompt"><a href="#AI-Agent-Create-a-Video-prompt" class="headerlink" title="AI Agent - Create a Video prompt"></a>AI Agent - Create a Video prompt</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Prompt:</span></span><br><span class="line">Create a prompt <span class="keyword">for</span> the Veo3 video based on the following information:</span><br><span class="line">Idea: &#123;&#123; <span class="variable">$json</span>.output.idea &#125;&#125;</span><br><span class="line">Environment: &#123;&#123; <span class="variable">$json</span>.output.environment &#125;&#125;</span><br><span class="line"><span class="comment"># System Message:</span></span><br><span class="line">** System Message **</span><br><span class="line">You are a professional cinematic prompt generator <span class="keyword">for</span> AI video tools.</span><br><span class="line">Your task is to convert a short-form video idea and its environment description</span><br><span class="line">(inspired by biblical or ancient-world themes)</span><br><span class="line">into a highly detailed, camera-aware,</span><br><span class="line">emotionally rich prompt suitable <span class="keyword">for</span> generating a cinematic AI video using Veo3.</span><br><span class="line">You must understand the emotional tone, visual aesthetics,</span><br><span class="line">and storytelling style of short-form TikTok videos that imitate biblical scenes with modern pacing and framing.</span><br><span class="line">** Veo3 Prompt Structure Guidelines **</span><br><span class="line">Each prompt should be natural, cinematic, and visually immersive, including:</span><br><span class="line">- Scene description – Describe the overall environment clearly (terrain, buildings, light, movement).</span><br><span class="line">- Character focus – If the idea involves a person,</span><br><span class="line">include their position, outfit style (biblical era), mood/expression, and framing (e.g., close-up, wide shot).</span><br><span class="line">- Camera movement – Always include one cinematic camera motion</span><br><span class="line">(e.g., slow push-in, handheld tracking, drone pan, orbit, dolly backward).</span><br><span class="line">- Time of day &amp; lighting – Set the mood with light (e.g., golden hour, harsh daylight, candlelit interior).</span><br><span class="line">- Atmosphere &amp; texture – Mention dust, wind, fabric movement, shadows,</span><br><span class="line">reflections, or imperfections <span class="keyword">in</span> the scene to increase realism.</span><br><span class="line">- Style &amp; quality – Include cinematic tone, analog warmth,</span><br><span class="line">slightly soft vintage film look, GoPro-like closeness <span class="keyword">if</span> appropriate.</span><br><span class="line">** Input **</span><br><span class="line">- You will receive two fields: idea, environment</span><br><span class="line">- Return only the complete and detailed Veo3 prompt, no additional text.</span><br><span class="line">** Example Output **</span><br><span class="line">A biblical man stands <span class="keyword">in</span> front of a half-built wooden ark,</span><br><span class="line">gesturing passionately as he explains something to the camera.</span><br><span class="line">The camera follows him handheld-style, moving slightly as he paces.</span><br><span class="line">In the background, groups of villagers are laughing and pointing.</span><br><span class="line">The sky is overcast with low clouds, and goats wander through muddy terrain.</span><br><span class="line">The man wears worn, ancient robes,</span><br><span class="line">his feet muddy, his tone frustrated but hopeful.</span><br><span class="line">The scene has a documentary-style realism, with soft golden highlights breaking through cloud gaps.</span><br><span class="line">Light wind moves fabric and rustles dry straw around the ark.</span><br><span class="line">Shot <span class="keyword">in</span> cinematic 24fps with natural tones and slight vintage softness.</span><br><span class="line"></span><br><span class="line"><span class="comment"># chat model : google gemini Model</span></span><br><span class="line">model : gemini-2.5-flash</span><br><span class="line"></span><br><span class="line"><span class="comment"># Tool : Think</span></span><br></pre></td></tr></table></figure>

<h5 id="google-sheets-–-gt-append-row-in-sheet-1"><a href="#google-sheets-–-gt-append-row-in-sheet-1" class="headerlink" title="google sheets –&gt; append row in sheet"></a>google sheets –&gt; append row in sheet</h5><h4 id="Gemini-Create-a-Video-prompt"><a href="#Gemini-Create-a-Video-prompt" class="headerlink" title="Gemini - Create a Video prompt"></a>Gemini - Create a Video prompt</h4><h5 id="Schedule-Trigger-2"><a href="#Schedule-Trigger-2" class="headerlink" title="Schedule Trigger"></a>Schedule Trigger</h5><h5 id="Edit-field-Schedule-Trigger-cannot-trigger-Gemini-Gemini-x3D-“run”"><a href="#Edit-field-Schedule-Trigger-cannot-trigger-Gemini-Gemini-x3D-“run”" class="headerlink" title="Edit field (Schedule Trigger cannot trigger Gemini) : Gemini &#x3D; “run”"></a>Edit field (Schedule Trigger cannot trigger Gemini) : Gemini &#x3D; “run”</h5><h5 id="Gemini-–-gt-message-a-model-Create-a-Idea-set-follow-AI-Agent"><a href="#Gemini-–-gt-message-a-model-Create-a-Idea-set-follow-AI-Agent" class="headerlink" title="Gemini –&gt; message a model - Create a Idea : set follow AI Agent"></a>Gemini –&gt; message a model - Create a Idea : set follow AI Agent</h5><h5 id="Code-string-to-json"><a href="#Code-string-to-json" class="headerlink" title="Code (string to json)"></a>Code (string to json)</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> responseText = $input.first().json.content.parts[<span class="number">0</span>].text</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> jsonString = responseText;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 移除 ```</span></span><br><span class="line">jsonString = jsonString.replace(<span class="regexp">/```json\n?/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 移除 ```</span></span><br><span class="line">jsonString = jsonString.replace(<span class="regexp">/```\s*$/g</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 移除前後空白</span></span><br><span class="line">jsonString = jsonString.trim();</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  <span class="comment">// 解析 JSON 字符串</span></span><br><span class="line">  <span class="keyword">const</span> output = <span class="built_in">JSON</span>.parse(jsonString);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// 回傳解析後的結構化資料</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    output</span><br><span class="line">  &#125;;</span><br><span class="line">  </span><br><span class="line">&#125; <span class="keyword">catch</span> (error) &#123;</span><br><span class="line">  <span class="comment">// 解析失敗時的錯誤處理</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    error: <span class="string">&#x27;JSON format error&#x27;</span>,</span><br><span class="line">    originalResponse: responseText,</span><br><span class="line">    parseSuccess: <span class="literal">false</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="Gemini-–-gt-message-a-model-Create-a-Video-prompt-set-follow-AI-Agent"><a href="#Gemini-–-gt-message-a-model-Create-a-Video-prompt-set-follow-AI-Agent" class="headerlink" title="Gemini –&gt; message a model - Create a Video prompt : set follow AI Agent"></a>Gemini –&gt; message a model - Create a Video prompt : set follow AI Agent</h5><h5 id="google-sheets-–-gt-append-row-in-sheet-2"><a href="#google-sheets-–-gt-append-row-in-sheet-2" class="headerlink" title="google sheets –&gt; append row in sheet"></a>google sheets –&gt; append row in sheet</h5><h4 id="LinkedinPost-Generator"><a href="#LinkedinPost-Generator" class="headerlink" title="LinkedinPost Generator"></a>LinkedinPost Generator</h4><h5 id="n8n-form-on-form-submission-1"><a href="#n8n-form-on-form-submission-1" class="headerlink" title="n8n form : on form submission"></a>n8n form : on form submission</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># set </span></span><br><span class="line">Title : LinkedIn Post Generator</span><br><span class="line">Description : Provide the details to create a captivating LinkedIn post</span><br><span class="line"></span><br><span class="line"><span class="comment"># input </span></span><br><span class="line">Email: ...</span><br><span class="line">Post Topic : 3 amazing facts about artificial intelligence</span><br><span class="line">Target Audience: people who are beginners <span class="keyword">in</span> AI</span><br></pre></td></tr></table></figure>

<h5 id="LinkedIn-Post-Destcription-AI-Agent"><a href="#LinkedIn-Post-Destcription-AI-Agent" class="headerlink" title="LinkedIn Post Destcription  AI Agent"></a>LinkedIn Post Destcription  AI Agent</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">tool : HTTP Request(name -Search Web)</span><br><span class="line">		Method: POST</span><br><span class="line">		URL: https://api.tavily.com/search</span><br><span class="line">		Authentication: Generic Credential Type</span><br><span class="line">		Generic Credential Type: Header Auth</span><br><span class="line">		Send Body: Enabled</span><br><span class="line">		Body Content Type : JSON</span><br><span class="line">		Specify Body: Using JSON </span><br><span class="line">		JSON:</span><br><span class="line">		&#123;</span><br><span class="line">		<span class="string">&quot;query&quot;</span>: <span class="string">&quot;&#123;searchTerm&#125;&quot;</span>,</span><br><span class="line">		<span class="string">&quot;topic&quot;</span>: <span class="string">&quot;general&quot;</span>,</span><br><span class="line">		<span class="string">&quot;search_depth&quot;</span>: <span class="string">&quot;advanced&quot;</span>,</span><br><span class="line">		<span class="string">&quot;chunks_per_source&quot;</span>: 3,</span><br><span class="line">		<span class="string">&quot;max_results&quot;</span>: 1,</span><br><span class="line">		<span class="string">&quot;time_range&quot;</span>: null,</span><br><span class="line">		<span class="string">&quot;days&quot;</span>: 7,</span><br><span class="line">		<span class="string">&quot;include_answer&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">		<span class="string">&quot;include_raw_content&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">		<span class="string">&quot;include_images&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">		<span class="string">&quot;include_image_descriptions&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">		<span class="string">&quot;include_domains&quot;</span>: [],</span><br><span class="line">		<span class="string">&quot;exclude_domains&quot;</span>: []</span><br><span class="line">		&#125;</span><br><span class="line">Chat model : Google Gemini Chat model</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2nd (prompt put to this)</span></span><br><span class="line">Gemini --&gt; message a model</span><br><span class="line">	tool : HTTP Request(name -Search Web)</span><br></pre></td></tr></table></figure>

<h5 id="Create-Image-Prompt"><a href="#Create-Image-Prompt" class="headerlink" title="Create Image Prompt"></a>Create Image Prompt</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Chat model : Google Gemini Chat model</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2nd (prompt put to this)</span></span><br><span class="line">Gemini --&gt; message a model</span><br></pre></td></tr></table></figure>

<h5 id="Generate-Title"><a href="#Generate-Title" class="headerlink" title="Generate Title"></a>Generate Title</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Chat model : Google Gemini Chat model</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2nd (prompt put to this)</span></span><br><span class="line">Gemini --&gt; message a model</span><br></pre></td></tr></table></figure>

<h5 id="OpenAI-–-gt-Generate-an-image"><a href="#OpenAI-–-gt-Generate-an-image" class="headerlink" title="OpenAI –&gt; Generate an image"></a>OpenAI –&gt; Generate an image</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Model : DALL-E3 (more cheap)</span><br><span class="line">Quality : Standard</span><br><span class="line">Resolution : 1024*1024</span><br></pre></td></tr></table></figure>

<h5 id="goopgle-Drive-–-gt-upload-file"><a href="#goopgle-Drive-–-gt-upload-file" class="headerlink" title="goopgle Drive –&gt; upload file"></a>goopgle Drive –&gt; upload file</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add File name, Folder </span><br></pre></td></tr></table></figure>

<h5 id="Gmail-–-gt-send-a-message"><a href="#Gmail-–-gt-send-a-message" class="headerlink" title="Gmail –&gt; send a message"></a>Gmail –&gt; send a message</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">subtitle : Your LinkedIn Post is published</span><br><span class="line">message : </span><br><span class="line">Hello!</span><br><span class="line"></span><br><span class="line">Here are details <span class="keyword">for</span> your linked post:</span><br><span class="line"></span><br><span class="line">Title :&#123;&#123; $(<span class="string">&#x27;Generate Title&#x27;</span>).item.json.output &#125;&#125;</span><br><span class="line"></span><br><span class="line">Description:&#123;&#123; $(<span class="string">&#x27;LinkedIn Post Destcription  AI Agent&#x27;</span>).item.json.output &#125;&#125;</span><br><span class="line"></span><br><span class="line">Image URL: &#123;&#123; <span class="variable">$json</span>.webViewLink &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Automation-to-Manage-and-Classify-Gmail"><a href="#Automation-to-Manage-and-Classify-Gmail" class="headerlink" title="Automation to Manage and Classify Gmail"></a>Automation to Manage and Classify Gmail</h4><h5 id="Gmail-Trigger"><a href="#Gmail-Trigger" class="headerlink" title="Gmail Trigger"></a>Gmail Trigger</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Mode :every minite</span><br><span class="line">Simplify :  <span class="built_in">disable</span>(because we want to access all email data) </span><br></pre></td></tr></table></figure>

<h5 id="Information-Extractor"><a href="#Information-Extractor" class="headerlink" title="Information Extractor"></a>Information Extractor</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tool: gemini chat model</span><br><span class="line"></span><br><span class="line">Attributes: senderName</span><br><span class="line">Extract the sender<span class="string">&#x27;s name from this email, if no name, return an empty string.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">add option --&gt; System Prompt Template(use default) </span></span><br><span class="line"><span class="string">You are an advanced extraction tool. Only pull out the relevant details from the text. If you&#x27;</span>re unsure about the value of any requested attribute, leave it as an empty string.</span><br></pre></td></tr></table></figure>

<h5 id="if"><a href="#if" class="headerlink" title="if"></a>if</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Condition : &#123;&#123; <span class="variable">$json</span>.output.senderName &#125;&#125; (string) is not empty </span><br><span class="line">- Merge output <span class="built_in">type</span>::Keep Non-Matches - 輸出的就是那一些「只出現在某一個來源，但在另一個來源沒有對應資料」的項目</span><br></pre></td></tr></table></figure>

<h5 id="Edit-Field-Merge"><a href="#Edit-Field-Merge" class="headerlink" title="Edit Field + Merge"></a>Edit Field + Merge</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1st </span></span><br><span class="line">intro (string) Dear &#123;&#123; <span class="variable">$json</span>.output.senderName &#125;&#125;,</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2nd</span></span><br><span class="line">intro (string) Hi<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>
<h5 id="Edit-Field-Clean-Data"><a href="#Edit-Field-Clean-Data" class="headerlink" title="Edit Field(Clean Data)"></a>Edit Field(Clean Data)</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">message_id:&#123;&#123; $(<span class="string">&#x27;Gmail Trigger&#x27;</span>).item.json.id &#125;&#125;</span><br><span class="line">threadId:&#123;&#123; $(<span class="string">&#x27;Gmail Trigger&#x27;</span>).item.json.threadId &#125;&#125;</span><br><span class="line">text:&#123;&#123; $(<span class="string">&#x27;Gmail Trigger&#x27;</span>).item.json.text &#125;&#125; - maill 內容</span><br><span class="line">intro:&#123;&#123; <span class="variable">$json</span>.intro &#125;&#125;</span><br></pre></td></tr></table></figure>

<h5 id="Text-classifier"><a href="#Text-classifier" class="headerlink" title="Text  classifier"></a>Text  classifier</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">tool: gemini chat model</span><br><span class="line"></span><br><span class="line">Text to Classify:&#123;&#123; <span class="variable">$json</span>.text &#125;&#125;</span><br><span class="line"></span><br><span class="line">Categories:</span><br><span class="line">Services requests : Questions about consulting services offered, rates, or availability.</span><br><span class="line">Consultation requests : Scheduling initial consultations or follow-up meetings.</span><br><span class="line">Payments : Questions about invoices, payments, or refunds</span><br><span class="line">Others : Emails that don’t clearly fit into the other categories.</span><br><span class="line"></span><br><span class="line">System Prompt Template : </span><br><span class="line">Please classify the text provided by the user into one of the following categories: &#123;categories&#125;, and use the provided formatting instructions below. Don<span class="string">&#x27;t explain, and only output the json.</span></span><br></pre></td></tr></table></figure>

<h5 id="Gmail-–-gt-add-labbel-to-message"><a href="#Gmail-–-gt-add-labbel-to-message" class="headerlink" title="Gmail –&gt; add labbel to message"></a>Gmail –&gt; add labbel to message</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Ｇmail add Label 1st</span></span><br><span class="line">Message ID : &#123;&#123; $(<span class="string">&#x27;Clean Data&#x27;</span>).item.json.message_id &#125;&#125;</span><br><span class="line">Label Names or IDs : &lt;select label&gt;</span><br></pre></td></tr></table></figure>

<h5 id="Gmail-–-gt-Replay-to-a-message"><a href="#Gmail-–-gt-Replay-to-a-message" class="headerlink" title="Gmail –&gt; Replay to a message"></a>Gmail –&gt; Replay to a message</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Message ID : &#123;&#123; $(<span class="string">&#x27;Clean Data&#x27;</span>).item.json.message_id &#125;&#125;</span><br><span class="line">Email Type:text</span><br><span class="line">Message: &#123;&#123; $(<span class="string">&#x27;Text Classifier&#x27;</span>).item.json.intro &#125;&#125;: ...</span><br></pre></td></tr></table></figure>

<h4 id="Make-Better-Think"><a href="#Make-Better-Think" class="headerlink" title="Make Better Think"></a>Make Better Think</h4><h5 id="chat-trigger"><a href="#chat-trigger" class="headerlink" title="chat trigger"></a>chat trigger</h5><h5 id="Gemini-–-gt-Message-a-model"><a href="#Gemini-–-gt-Message-a-model" class="headerlink" title="Gemini –&gt; Message a model"></a>Gemini –&gt; Message a model</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#tool:Think</span></span><br><span class="line">Think tool Description: <span class="comment">### Overview This tool should...</span></span><br><span class="line"></span><br><span class="line">Model: gemini-2.5-flash</span><br><span class="line">Prompt: </span><br><span class="line"><span class="comment"># Overview</span></span><br><span class="line">You are a helpful assistant</span><br><span class="line"><span class="comment"># Instructions</span></span><br><span class="line">When you create any piece of written content you use a <span class="string">&quot;think node&quot;</span> to make it human-like &#123;&#123; <span class="variable">$json</span>.chatInput &#125;&#125;</span><br><span class="line"></span><br><span class="line">Simplity <span class="built_in">enable</span></span><br></pre></td></tr></table></figure>

<h5 id="sheet-–-gt-append-row-in-sheet"><a href="#sheet-–-gt-append-row-in-sheet" class="headerlink" title="sheet –&gt; append row in sheet"></a>sheet –&gt; append row in sheet</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Docuemnt: Think tools Test</span><br><span class="line">time: &#123;&#123; <span class="variable">$now</span>.format(<span class="string">&#x27;yyyy-MM-dd hh:mm&#x27;</span>) &#125;&#125;</span><br><span class="line">workflow: No Agent</span><br><span class="line">Input: &#123;&#123; $(<span class="string">&#x27;When chat message received&#x27;</span>).item.json.chatInput &#125;&#125;</span><br><span class="line">output:&#123;&#123; <span class="variable">$json</span>.content.parts[0].text &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="AI-story"><a href="#AI-story" class="headerlink" title="AI story"></a>AI story</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chat trigger(input example)</span></span><br><span class="line">crowded city <span class="keyword">in</span> the middle of the day, a lot of people, cozy atmosphere</span><br><span class="line"></span><br><span class="line"><span class="comment"># gemini --&gt; Message a model</span></span><br><span class="line">Prompt : ...</span><br><span class="line">simpllify Output: enebale</span><br><span class="line">Output Content as JSON</span><br><span class="line"></span><br><span class="line"><span class="comment"># OpenAI --&gt; Generate an image</span></span><br><span class="line">Model: GPT Image 1</span><br><span class="line">Prompt: ..</span><br><span class="line">Quality: Medium</span><br><span class="line">Resolution: 1536*1024(寬畫面)</span><br><span class="line"></span><br><span class="line"><span class="comment"># google drive --&gt; upload(image)</span></span><br><span class="line">Filename: image_&#123;&#123; $(<span class="string">&#x27;When chat message received&#x27;</span>).item.json.sessionId &#125;&#125;</span><br><span class="line">input Data Field Name: data</span><br><span class="line"></span><br><span class="line"><span class="comment"># google drive --&gt; download (因要存起來upload then download)</span></span><br><span class="line">File by URL : &#123;&#123; <span class="variable">$json</span>.webViewLink &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># save image to freeimage host</span></span><br><span class="line">Method : POST</span><br><span class="line">URL: https://freeimage.host/api/1/upload</span><br><span class="line">Body :</span><br><span class="line">key: &lt;your key&gt;</span><br><span class="line">action : upload</span><br><span class="line"><span class="built_in">source</span>(n8n Binary File): data</span><br><span class="line">format : json</span><br><span class="line"></span><br><span class="line"><span class="comment"># Pollo generate video by runway gen 4</span></span><br><span class="line">Method:POST</span><br><span class="line">URL: https://pollo.ai/api/platform/generation/runway/runway-gen-4-turbo</span><br><span class="line">Body using JSON:</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;input&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;image&quot;</span>: <span class="string">&quot;&#123;&#123; <span class="variable">$json</span>.image.url &#125;&#125;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;prompt&quot;</span>: &#123;&#123; $(<span class="string">&#x27;Generate Prompt&#x27;</span>).item.json.content.parts[0].text &#125;&#125;,</span><br><span class="line">    <span class="string">&quot;length&quot;</span>: 5,</span><br><span class="line">    <span class="string">&quot;aspectRatio&quot;</span>: <span class="string">&quot;16:9&quot;</span>,</span><br><span class="line">    <span class="string">&quot;seed&quot;</span>: 123</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Merge</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Wait 5s</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># get video status </span></span><br><span class="line">Method: GET</span><br><span class="line">URL: https://pollo.ai/api/platform/generation/&#123;&#123; <span class="variable">$json</span>.data.taskId &#125;&#125;/status</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#if </span></span><br><span class="line">&#123;&#123; <span class="variable">$json</span>.data.generations[0].status &#125;&#125; <span class="string">&quot;is equal to&quot;</span> Success</span><br><span class="line"><span class="literal">false</span> link to Merge</span><br><span class="line"></span><br><span class="line"><span class="comment"># get Video</span></span><br><span class="line">Method: GET</span><br><span class="line">URL: &#123;&#123; <span class="variable">$json</span>.data.generations[0].url &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># google drive --&gt; upload(video)</span></span><br><span class="line">Filename: video_&#123;&#123; $(<span class="string">&#x27;When chat message received&#x27;</span>).item.json.sessionId &#125;&#125;</span><br><span class="line">input Data Field Name: data</span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate Audio by Speechify </span></span><br><span class="line">Method: POST</span><br><span class="line">URL: https://api.sws.speechify.com/v1/audio/speech</span><br><span class="line">Body :</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;input&quot;</span>: &#123;&#123; $(<span class="string">&#x27;Generate Prompt&#x27;</span>).item.json.content.parts[0].text &#125;&#125;,</span><br><span class="line">  <span class="string">&quot;voice_id&quot;</span>: <span class="string">&quot;george&quot;</span>,</span><br><span class="line">  <span class="string">&quot;audio_format&quot;</span>: <span class="string">&quot;mp3&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#Code(Convert to File)</span></span><br><span class="line"><span class="built_in">return</span> [</span><br><span class="line">  &#123;</span><br><span class="line">    json: &#123;&#125;,</span><br><span class="line">    binary: &#123;</span><br><span class="line">      data: &#123;</span><br><span class="line">        data: Buffer.from(<span class="variable">$json</span>[<span class="string">&quot;audio_data&quot;</span>], <span class="string">&quot;base64&quot;</span>),</span><br><span class="line">        mimeType: <span class="string">&quot;audio/mpeg&quot;</span>,</span><br><span class="line">        fileName: <span class="string">&quot;output.mp3&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment"># google drive --&gt; upload(audio)</span></span><br><span class="line">Filename: audio_&#123;&#123; $(<span class="string">&#x27;When chat message received&#x27;</span>).item.json.sessionId &#125;&#125;</span><br><span class="line">input Data Field Name: data</span><br><span class="line"></span><br><span class="line"><span class="comment"># save to sheet(append row in sheet)</span></span><br><span class="line">chat: &#123;&#123; $(<span class="string">&#x27;When chat message received&#x27;</span>).item.json.chatInput &#125;&#125;</span><br><span class="line">prompt: &#123;&#123; $(<span class="string">&#x27;Generate Prompt&#x27;</span>).item.json.content.parts[0].text &#125;&#125;</span><br><span class="line">image: &#123;&#123; $(<span class="string">&#x27;Save Image&#x27;</span>).item.json.webViewLink &#125;&#125;</span><br><span class="line">video: &#123;&#123; $(<span class="string">&#x27;Upload file&#x27;</span>).item.json.webViewLink &#125;&#125;</span><br><span class="line">audio: &#123;&#123; <span class="variable">$json</span>.webViewLink &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Viral-Youtube-Posting"><a href="#Viral-Youtube-Posting" class="headerlink" title="Viral Youtube Posting"></a>Viral Youtube Posting</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Schedule trigger </span></span><br><span class="line">Trigger Interval: Custom(Crop) - 自訂</span><br><span class="line">Exppreesio : 0 15 * * 2,5 - Tue,Fri 13:00 </span><br><span class="line"></span><br><span class="line"><span class="comment"># http Request - Get The Latest Youtube Video</span></span><br><span class="line">Methold : GET</span><br><span class="line">URL: https://www.googleapis.com/youtube/v3/search</span><br><span class="line">Send Query Parameters : <span class="built_in">enable</span></span><br><span class="line">Specify Query Parameters : Using Fields Below </span><br><span class="line">part:snippet</span><br><span class="line">channelId: &lt;your youtube channel id&gt;</span><br><span class="line">maxResults: 1</span><br><span class="line">order: date</span><br><span class="line"><span class="built_in">type</span>: video</span><br><span class="line">key : &lt;your googleAPI key&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># http Request - Get Transcript(use Apify)</span></span><br><span class="line">Methold : GET</span><br><span class="line">URL: https://api.apify.com/v2/acts/pintostudio~youtube-transcript-scraper/run-sync-get-dataset-items</span><br><span class="line">Send Query Parameters : <span class="built_in">enable</span></span><br><span class="line">Specify Query Parameters : Using Fields Below </span><br><span class="line">token: &lt;your Apify token&gt;</span><br><span class="line">Send Body: <span class="built_in">enable</span> </span><br><span class="line">JSON --&gt; Using JSON</span><br><span class="line">&#123;</span><br><span class="line"><span class="string">&quot;videoUrl&quot;</span>: <span class="string">&quot;https://www.youtube.com/watch?v=&#123;&#123; <span class="variable">$json</span>.items[0].id.videoId &#125;&#125;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent - Facebook Post</span></span><br><span class="line">Prompt (User Message) : ..</span><br><span class="line">System Message: ...</span><br><span class="line">tool : gemini chat model(gemini-2.5-flash)</span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent - Email Campaign</span></span><br><span class="line">Prompt (User Message) : ..</span><br><span class="line">System Message: ...</span><br><span class="line">tool : gemini chat model(gemini-2.5-flash)</span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent - Skool Annoncement</span></span><br><span class="line">Prompt (User Message) : ..</span><br><span class="line">System Message: ...</span><br><span class="line">tool : gemini chat model(gemini-2.5-flash)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Notion --&gt; Create a database page</span></span><br><span class="line">Database: sellect <span class="keyword">for</span> you(eg. Youtube post <span class="comment">#1)</span></span><br><span class="line">Title: empty</span><br><span class="line">Add property:</span><br><span class="line">Video Name : &#123;&#123; $(<span class="string">&#x27;Get The Latest Youtube Video&#x27;</span>).item.json.items[0].snippet.title &#125;&#125;</span><br><span class="line">Facebook Post: &#123;&#123; $(<span class="string">&#x27;Facebook Post&#x27;</span>).item.json.output &#125;&#125;</span><br><span class="line">Email Campaign: &#123;&#123; $(<span class="string">&#x27;Email Campaign&#x27;</span>).item.json.output &#125;&#125;</span><br><span class="line">Skool Announcement: &#123;&#123; <span class="variable">$json</span>.output &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Crecte-Socia-Media-in-Seconds"><a href="#Crecte-Socia-Media-in-Seconds" class="headerlink" title="Crecte Socia Media in Seconds"></a>Crecte Socia Media in Seconds</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># google sheet --&gt; on row added</span></span><br><span class="line">Document sheet --&gt; on row added</span><br><span class="line"></span><br><span class="line"><span class="comment">#if </span></span><br><span class="line">Conditions : &#123;&#123; <span class="variable">$json</span>.Done &#125;&#125; is empty</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set Field</span></span><br><span class="line">query : &#123;&#123; <span class="variable">$json</span>[<span class="string">&#x27;Content Subject&#x27;</span>] &#125;&#125;</span><br><span class="line">tragetAudience : &#123;&#123; <span class="variable">$json</span>[<span class="string">&#x27;Target Audience&#x27;</span>] &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># http request</span></span><br><span class="line"><span class="comment"># replace(/&quot;/g, &#x27;\\&quot;&#x27;) :把所有雙引號 &quot; 取代為已轉義的 &quot;，確保字串在 JSON、JS 字面量或序列化時不會因未轉義引號而破壞語法</span></span><br><span class="line">Method : POST</span><br><span class="line">URL: https://api.tavily.com/search</span><br><span class="line">Body <span class="built_in">enable</span></span><br><span class="line"><span class="comment"># &#123;</span></span><br><span class="line"><span class="comment">#   &quot;query&quot;: &quot;&#123;&#123; $json.query.replace(/&quot;/g, &#x27;\\&quot;&#x27;) &#125;&#125;&quot;,</span></span><br><span class="line"><span class="comment">#   &quot;search_depth&quot;: &quot;basic&quot;,</span></span><br><span class="line"><span class="comment">#   &quot;include_answer&quot;: true,</span></span><br><span class="line"><span class="comment">#   &quot;topic&quot;: &quot;news&quot;,</span></span><br><span class="line"><span class="comment">#   &quot;include_raw_content&quot;: true,</span></span><br><span class="line"><span class="comment">#   &quot;max_results&quot;: 3</span></span><br><span class="line"><span class="comment"># &#125;</span></span><br><span class="line"></span><br><span class="line">＃ Split Out</span><br><span class="line">Fields To Split Out:results</span><br><span class="line"></span><br><span class="line"><span class="comment"># Aggregate </span></span><br><span class="line">include: Specified </span><br><span class="line">Field:title, raw_content</span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent(LikedIn)</span></span><br><span class="line">Prompt:..</span><br><span class="line">System Message:..</span><br><span class="line">tool: gemini chat model</span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent(Facebook)</span></span><br><span class="line">Prompt:..</span><br><span class="line">System Message:..</span><br><span class="line">tool: gemini chat model</span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent(Blog Post)</span></span><br><span class="line">Prompt:..</span><br><span class="line">System Message:..</span><br><span class="line">tool: gemini chat model</span><br><span class="line"></span><br><span class="line"><span class="comment"># Google sheet --&gt; update row in sheet</span></span><br><span class="line">Column to match on : Campaign</span><br><span class="line">Campaign (using to match) : &#123;&#123; $(<span class="string">&#x27;If&#x27;</span>).item.json.Campaign &#125;&#125;</span><br><span class="line">Done : complete</span><br><span class="line">Linkdein:&#123;&#123; $(<span class="string">&#x27;LinkedIn&#x27;</span>).item.json.output &#125;&#125;</span><br><span class="line">Facebook:&#123;&#123; $(<span class="string">&#x27;Facebook&#x27;</span>).item.json.output &#125;&#125;</span><br><span class="line">Blog:&#123;&#123; <span class="variable">$json</span>.output &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Building-an-AI-Agent-Instruction-From-Scratch"><a href="#Building-an-AI-Agent-Instruction-From-Scratch" class="headerlink" title="Building an AI Agent Instruction From Scratch"></a>Building an AI Agent Instruction From Scratch</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Chat Trigger</span></span><br><span class="line">Meaages prompt: &#123;&#123; <span class="variable">$json</span>.chatInput &#125;&#125;</span><br><span class="line">System message :</span><br><span class="line">	<span class="comment">## Purpose</span></span><br><span class="line">	You are a professional executive assistant. Your job is to complete the task you are requested to <span class="keyword">do</span> from the user.</span><br><span class="line"></span><br><span class="line">	<span class="comment">## Capibilities</span></span><br><span class="line">	- always when it<span class="string">&#x27;s requested to perform some task that requested dates to use, you can use this time as the reference, what time is it &#123;&#123; $now &#125;&#125; </span></span><br><span class="line"><span class="string">	- always usee tool/tools to perform a task, if it&#x27;</span>s need</span><br><span class="line"></span><br><span class="line">	<span class="comment">## Tools</span></span><br><span class="line">	- Send a message <span class="keyword">in</span> Gmail - use this tool to send emails</span><br><span class="line">	- Create an event <span class="keyword">in</span> Google Calendar - use this tool to schedule the meetings that user requests.</span><br><span class="line">	- Get Lables from Gmail - get all labels from my gmail account. Make sure to record all the labels names properly so later you can use it <span class="keyword">for</span> other steps</span><br><span class="line">	- Add label to message <span class="keyword">in</span> Gmail - use this tool to add label to a proper message <span class="keyword">in</span> gmail. Make sure you are using a proper label name. Every time use the id of a label to match it, instead of the label name.</span><br><span class="line">	- Append row <span class="keyword">in</span> sheet <span class="keyword">in</span> Google Sheets - use it to save email information to google sheets. whenever you use this took first, get emails and <span class="keyword">then</span> <span class="keyword">then</span> use this tools to save information </span><br><span class="line"></span><br><span class="line">	<span class="comment">## Interation Style</span></span><br><span class="line">	- when you send emails, keep professional and funny tone, <span class="keyword">in</span> the responses</span><br><span class="line"></span><br><span class="line">	<span class="comment">## Notes</span></span><br><span class="line">	- every time make sure you use the tool to complete the task</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gemini --&gt; Message a model</span></span><br><span class="line"><span class="comment"># Tools - Google Calendar Tool(just login)</span></span><br><span class="line">select Calendar</span><br><span class="line"><span class="comment">#				- Gmail tool(send a message in Gmail)</span></span><br><span class="line">Resource : message + Send</span><br><span class="line"><span class="comment">#				- Gmail tool(Get many labels in Gmail)</span></span><br><span class="line">Resource : label + Get many</span><br><span class="line"><span class="comment">#				- Gmail tool(Get many messages in Gmail)</span></span><br><span class="line">Resource : message + Get many</span><br><span class="line"><span class="comment">#				- Gmail tool(Add label to message in Gmail)</span></span><br><span class="line">Resource : message + Add Label</span><br><span class="line"><span class="comment">#				- Google Sheets Tooll(Append row in sheet in Google Sheets)</span></span><br><span class="line">Operation: Append Row</span><br><span class="line">Document:Email information</span><br><span class="line"></span><br><span class="line"><span class="comment"># chat</span></span><br><span class="line">Please schedule an event <span class="keyword">for</span> me at 8 pm, it should last 1 hour</span><br><span class="line">please get all my gmail<span class="string">&#x27;s label</span></span><br><span class="line"><span class="string">Take the latest receive email and save the information inside the Google Sheet</span></span><br></pre></td></tr></table></figure>

<h4 id="Create-an-AI-Agent-Instructions"><a href="#Create-an-AI-Agent-Instructions" class="headerlink" title="Create an AI Agent Instructions"></a>Create an AI Agent Instructions</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chat trigger</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># gemini model</span></span><br><span class="line">prompt: &#123;&#123; <span class="variable">$json</span>.chatInput &#125;&#125;</span><br><span class="line">system message :</span><br><span class="line">	<span class="comment">## Purpose</span></span><br><span class="line">	You are a professional virtual assistant. Your job is to accomplish the task <span class="keyword">for</span> the user.</span><br><span class="line"></span><br><span class="line">	<span class="comment">## Capabilities</span></span><br><span class="line">	- If you need <span class="keyword">in</span> some way to know what the current date is, you can use this date as a reference: &#123;&#123; <span class="variable">$now</span> &#125;&#125;</span><br><span class="line">	- You use AI to structure the content <span class="keyword">in</span> a nice format and provide comprehensive information about the query.</span><br><span class="line"></span><br><span class="line">	<span class="comment">## Tools</span></span><br><span class="line">	- Get News - use this tool to fetch the latest news from the internet</span><br><span class="line">	- Create a Document <span class="keyword">in</span> Google Docs - use this to create a black document docs, that contains only the title</span><br><span class="line">	- Update a Document <span class="keyword">in</span> Google Docs - use this tool to update a blank document. Insert inside the content you create with AI</span><br><span class="line">	- Send an email <span class="keyword">in</span> Gmail - use this tool to send an email to a user</span><br><span class="line"></span><br><span class="line">	<span class="comment">## Interaction style</span></span><br><span class="line">	- keep the tone processional, and the format really format</span><br><span class="line"></span><br><span class="line">	<span class="comment">## Notes</span></span><br><span class="line">	- When you create a blank document, always <span class="keyword">in</span> the title include the followiing form: The News <span class="keyword">for</span> [query] - [current date]</span><br><span class="line">	- When you get your news from <span class="string">&quot;get news&quot;</span>, use AI to format it this way, it can be nicely inserted inside Google Docs. so bascicaly choose the proper format, so we have heads, bolded parts and the necessary format.</span><br><span class="line">	- Every time before sending an email action, use AI to format an email <span class="keyword">in</span> HTML format. Include headings, bolded parts, italicized, and generally the best HTML formatting</span><br><span class="line"></span><br><span class="line"><span class="comment"># Tools - Gmail Tool(Send a message in Gmail)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Tools - Google Docs Tool(Create a document in Google Docs)</span></span><br><span class="line">Folder Name: Demo</span><br><span class="line"></span><br><span class="line"><span class="comment"># Tools - Google Docs Tool(Update a document in Google Docs)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Tools - HTTP Request Tool(Get News(Tavily))</span></span><br><span class="line">Method: POST</span><br><span class="line">URL:  https://api.tavily.com/search</span><br><span class="line">Send Mody Enable</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;query&quot;</span>: <span class="string">&quot;&#123;&#123; <span class="variable">$fromAI</span>(&#x27;parameters0_Value&#x27;) &#125;&#125;&quot;</span>,</span><br><span class="line">  <span class="string">&quot;search_depth&quot;</span>: <span class="string">&quot;basic&quot;</span>,</span><br><span class="line">  <span class="string">&quot;include_answer&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="string">&quot;topic&quot;</span>: <span class="string">&quot;news&quot;</span>,</span><br><span class="line">  <span class="string">&quot;include_raw_content&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="string">&quot;max_results&quot;</span>: 3</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Tools - option HTTP Request Tool(Get News(Serper))</span></span><br><span class="line">Method: POST</span><br><span class="line">URL:  https://google.serper.dev/search</span><br><span class="line">Send Mody Enable</span><br><span class="line">Specify Body: Using Fields Below</span><br><span class="line">q: &lt;<span class="built_in">set</span> auto&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># chat </span></span><br><span class="line">Please get me the news about the <span class="string">&quot;top 5 world news&quot;</span>. Use AI to format the information <span class="keyword">in</span> a nice way, <span class="keyword">then</span> create a blank document, and after update it with information from AI(and translate to Traditional Chinese). And at the end, send the email with information to me: kyp001@yahoo.com.tw</span><br><span class="line"></span><br><span class="line"><span class="comment"># another - prompt </span></span><br><span class="line">	Role &amp; Purpose  </span><br><span class="line">	You are a customizable news-gathering and reporting AI agent. Your purpose is to fetch world news based on a given topic or category, format them beautifully <span class="keyword">in</span> Google Docs, translate the summary into Traditional Chinese, and send the final report directly <span class="keyword">in</span> an HTML email to a user-specified address.  </span><br><span class="line"></span><br><span class="line">	Capabilities  </span><br><span class="line">	- Accept user input <span class="keyword">for</span> news topic (e.g., <span class="string">&quot;top 5 world news&quot;</span> or any keyword).  </span><br><span class="line">	- Fetch related news using Tavily News API.  </span><br><span class="line">	- Summarize and format the news <span class="keyword">in</span> a clear, professional style.  </span><br><span class="line">	- Translate all summaries into Traditional Chinese.  </span><br><span class="line">	- Create a blank Google Document with a clean layout (titles, sections, spacing, and styled text).  </span><br><span class="line">	- Update the document with first the full English version, followed by the full Traditional Chinese version.  </span><br><span class="line">	- Send the completed report via Gmail <span class="keyword">in</span> HTML format (email body content, not just a link).  </span><br><span class="line">	- current time is &#123;&#123; <span class="variable">$now</span> &#125;&#125;</span><br><span class="line"></span><br><span class="line">	** Tools **  </span><br><span class="line">	- Tavily News – Get the latest news by topic or category.  </span><br><span class="line">	- Google Docs (Create) – Start a new blank document.  </span><br><span class="line">	- Google Docs (Update) – Insert formatted content with styled sections.  </span><br><span class="line">	- Gmail – Send the final news report as HTML email directly to recipient.  </span><br><span class="line"></span><br><span class="line">	Interaction Style  </span><br><span class="line">	- Write concise, professional summaries with structured sections.  </span><br><span class="line">	- Use headings, bold text, spacing, and lists to ensure readability.  </span><br><span class="line">	- Present all English summaries first, <span class="keyword">then</span> all Traditional Chinese translations.  </span><br><span class="line">	- Maintain a consistent, formal, and polished style across both outputs.  </span><br><span class="line"></span><br><span class="line">	Notes  </span><br><span class="line">	- Default to top 5 items unless user specifies otherwise.  </span><br><span class="line">	- Ensure Google Docs formatting uses native styling (no markdown).  </span><br><span class="line">	- Email body must be HTML with proper headings, lists, and spacing.  </span><br><span class="line">	- Always send to the user-specified email; confirm <span class="keyword">if</span> not provided.  </span><br><span class="line"></span><br><span class="line"><span class="comment"># chat </span></span><br><span class="line">give me the <span class="string">&quot;Ukraine war&quot;</span> news and send to kyp001@yahoo.com.tw</span><br></pre></td></tr></table></figure>

<h3 id="wait-workflow"><a href="#wait-workflow" class="headerlink" title="wait workflow"></a>wait workflow</h3><ul>
<li>if length limite add flow for it : Telegrame, Notion</li>
<li>Line Bot</li>
<li>Audio Transcribe : NotebookLM </li>
<li>scan youtube some channge upgrade, down mp3 file</li>
<li>google API how to set project, cost or limit ?</li>
<li>gemini limite?</li>
</ul>
<h3 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h3><ul>
<li>reference<ul>
<li><a target="_blank" rel="noopener" href="https://www.reddit.com/r/n8n/comments/1jy1wdc/i_made_an_n8n_cheat_sheet/">n8n Cheat Sheet uploaded by Superb_Net_7426 on Reddit</a></li>
<li><a target="_blank" rel="noopener" href="https://www.hostinger.com/vps/n8n-hosting">Hostinger n8n VPS hosting</a>: easiest to work</li>
<li><a target="_blank" rel="noopener" href="https://blog.n8n.io/community-nodes-available-on-n8n-cloud/"> Official n8n Update on Community Nodes</a></li>
<li><a target="_blank" rel="noopener" href="https://www.anthropic.com/engineering/claude-think-tool">The “think” tool</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.n8n.io/">n8n Docs</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.n8n.io/integrations/creating-nodes/build/reference/http-helpers/">HTTP request helper for node builders</a></li>
<li><a target="_blank" rel="noopener" href="https://leadion.ai/blog/n8n-gemini-api-tutorial/">n8n 串接 Gemini API 教學</a></li>
</ul>
</li>
<li>API document<ul>
<li><a target="_blank" rel="noopener" href="https://docs.perplexity.ai/getting-started/models/models/sonar">Prplexity API documentation - Sonar</a></li>
</ul>
</li>
<li>channel<ul>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/@krystianwojtarowicz-ai">YouTube - Krystian Wojtarowicz AI</a></li>
</ul>
</li>
<li>workflow example <ul>
<li><a target="_blank" rel="noopener" href="https://github.com/n8n-io/n8n">n8n github</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/qwedsazxc78/ai-automation-n8n/blob/main/README.md">❇️ AI Braind ai-automation-n8n</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/restyler/awesome-n8n">Awesome N8N: Top 100 Community Nodes</a></li>
<li><a target="_blank" rel="noopener" href="https://n8n.io/workflows/">Workflow Automation Templates</a></li>
<li><a target="_blank" rel="noopener" href="https://chatgpt.com/g/g-68a5e18130a88191b3d09861dd777fdb-instruction-maker-ai-agent">Instruction-Maker AI Agent</a></li>
</ul>
</li>
<li>practice and using<ul>
<li><a target="_blank" rel="noopener" href="https://chatgpt.com/g/g-68a5e18130a88191b3d09861dd777fdb-instruction-maker-ai-agent">Instruction-Maker AI Agent</a></li>
<li><a target="_blank" rel="noopener" href="https://console.apify.com/billing/current-period">Apify using </a></li>
<li><a target="_blank" rel="noopener" href="https://pollo.ai/api-platform/billing">Pollo AI using</a></li>
<li><a target="_blank" rel="noopener" href="https://pollo.ai/api-platform/pricing">Pollo AI Price</a></li>
<li><a target="_blank" rel="noopener" href="https://platform.openai.com/settings/organization/billing/overview">❇️ OpenAI using</a></li>
<li><a target="_blank" rel="noopener" href="https://platform.openai.com/docs/pricing">OpenAI price</a></li>
<li><a target="_blank" rel="noopener" href="https://console.sws.speechify.com/billing">Speechify using</a></li>
</ul>
</li>
<li>case study<ul>
<li><a target="_blank" rel="noopener" href="https://www.xda-developers.com/build-self-healing-home-lab-with-n8n/">I built a self-healing home lab with n8n</a></li>
<li><a target="_blank" rel="noopener" href="https://www.xda-developers.com/saving-every-month-n8n-automations/">I’m saving $40+ every month thanks to these 5 n8n automations</a></li>
<li><a target="_blank" rel="noopener" href="https://www.ozbargain.com.au/node/932882">Self-Hosted n8n Hosting from US$59.40 for 2 Years (50% off, US$2.58&#x2F;Month)</a></li>
<li><a target="_blank" rel="noopener" href="https://www.geeky-gadgets.com/custom-workflows-with-n8n/">Build Anything With the n8n Code Node : The Secret to Advanced Automations</a></li>
<li><a target="_blank" rel="noopener" href="https://cloud.google.com/blog/topics/developers-practitioners/deploy-n8n-on-cloud-run">Easy AI workflow automation: Deploy n8n on Cloud Run</a></li>
<li><a target="_blank" rel="noopener" href="https://decrypt.co/347823/5-hottest-ai-powered-side-hustles-actually-seem-plausible">The 5 Hottest AI-Powered Side Hustles That Actually Seem Plausible</a></li>
</ul>
</li>
<li>Tools<ul>
<li><a target="_blank" rel="noopener" href="https://vert.sh/">❇️ VERT</a> - 檔案轉換</li>
<li><a target="_blank" rel="noopener" href="https://www.onlinedoctranslator.com/zh-CN/">❇️ Online doc Translator </a> - 文字檔翻譯 or 轉換格式</li>
</ul>
</li>
<li>Source<ul>
<li><a target="_blank" rel="noopener" href="https://www.pexels.com/zh-tw/">❇️ pexels</a> - 免費圖庫,影片</li>
</ul>
</li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/n8n/" rel="tag"># n8n</a>
              <a href="/tags/udemy/" rel="tag"># udemy</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/06/19/n8n-1/" rel="prev" title="n8n - local setup">
                  <i class="fa fa-chevron-left"></i> n8n - local setup
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/08/02/ai-15/" rel="next" title="GenAI">
                  GenAI <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    
  <div class="comments" id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Robert Kao</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="總字數">2.7m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="所需總閱讀時間">41:16</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 強力驅動
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="/js/local-search.js"></script>






  




  


<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://hot5656-blog.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://hot5656.github.io/2025/07/28/n8n-2/";
    this.page.identifier = "2025/07/28/n8n-2/";
    this.page.title = "n8n - AI Agents, AI Automations & AI Voice Agents (1)";
    };
  NexT.utils.loadComments('#disqus_thread', () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://hot5656-blog.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
