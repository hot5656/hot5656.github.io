<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hot5656.github.io","root":"/","images":"/images","scheme":"Gemini","version":"8.2.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜尋...","empty":"我們無法找到任何有關 ${query} 的搜索結果","hits_time":"${hits} 找到 ${time} 個結果","hits":"找到 ${hits} 個結果"},"path":"/search.json","localsearch":{"enable":"enable","trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false}};
  </script>
<meta name="description" content="workflow">
<meta property="og:type" content="article">
<meta property="og:title" content="n8n - AI Agents, AI Automations &amp; AI Voice Agents (2)&lt;br&gt; Business &amp; Support AI Agents">
<meta property="og:url" content="https://hot5656.github.io/2025/09/28/n8n-3/index.html">
<meta property="og:site_name" content="Robert 雜記">
<meta property="og:description" content="workflow">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_107.png">
<meta property="og:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_108.png">
<meta property="og:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_109.png">
<meta property="og:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_110_11.png">
<meta property="og:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_110_21.png">
<meta property="og:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_110_12.png">
<meta property="og:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_110_22.png">
<meta property="og:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_111.png">
<meta property="og:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_112_1.png">
<meta property="og:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_112_2.png">
<meta property="og:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_113.png">
<meta property="og:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_114.png">
<meta property="og:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_115.png">
<meta property="og:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_116.png">
<meta property="og:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_117_1.png">
<meta property="og:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_117_2.png">
<meta property="og:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_118_1.png">
<meta property="og:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_118_2.png">
<meta property="og:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_119.png">
<meta property="og:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_120.png">
<meta property="article:published_time" content="2025-09-28T07:10:15.000Z">
<meta property="article:modified_time" content="2025-11-28T07:28:37.509Z">
<meta property="article:author" content="Robert Kao">
<meta property="article:tag" content="n8n">
<meta property="article:tag" content="udemy">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hot5656.github.io/2025/09/28/n8n-3/pic_11_107.png">


<link rel="canonical" href="https://hot5656.github.io/2025/09/28/n8n-3/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-TW'
  };
</script>
<title>n8n - AI Agents, AI Automations & AI Voice Agents (2)<br> Business & Support AI Agents | Robert 雜記</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Robert 雜記</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首頁</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>標籤</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分類</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>歸檔列表</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜尋
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜尋..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#workflow"><span class="nav-number">1.</span> <span class="nav-text">workflow</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#11-107-Onboarding-System-Automation"><span class="nav-number">1.1.</span> <span class="nav-text">11_107 Onboarding System Automation</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-108-Customer-Feedback-Sentiment-Analysis"><span class="nav-number">1.2.</span> <span class="nav-text">11_108 Customer+Feedback+Sentiment+Analysis</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-109-Finance-Tracker"><span class="nav-number">1.3.</span> <span class="nav-text">11_109 Finance_Tracker</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%9D%87%EF%B8%8F-11-110-Update-Bella-Vista-KB-save-docuemnt"><span class="nav-number">1.4.</span> <span class="nav-text">❇️ 11_110 Update Bella Vista KB(save docuemnt)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%9D%87%EF%B8%8F-11-110-Bella-Vista-Customer-Bookings-amp-Support"><span class="nav-number">1.5.</span> <span class="nav-text">❇️ 11_110 Bella Vista Customer Bookings &amp; Support</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-111-Build-WhatsApp-Ai-Agent-that-Rembers-You-amp-Your-Conversations"><span class="nav-number">1.6.</span> <span class="nav-text">11_111 Build WhatsApp Ai Agent that Rembers You &amp; Your Conversations</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-112-inbox-manager-sort-incoming-Emails"><span class="nav-number">1.7.</span> <span class="nav-text">11_112 inbox manager - sort incoming Emails</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-112-inbox-manager-sort-old-Emails"><span class="nav-number">1.8.</span> <span class="nav-text">11_112 inbox manager - sort old Emails</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-113-Analyze-Resumes"><span class="nav-number">1.9.</span> <span class="nav-text">11_113 Analyze Resumes</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-114-Build-AI-Invoice-Processing-System"><span class="nav-number">1.10.</span> <span class="nav-text">11_114 Build AI Invoice Processing System</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-115-System-Summarize-your-Invoices-Monthly"><span class="nav-number">1.11.</span> <span class="nav-text">11_115 System Summarize your Invoices Monthly</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%9D%87%EF%B8%8F-11-116-Build-a-Powerful-Real-Estate-AI-Agent"><span class="nav-number">1.12.</span> <span class="nav-text">❇️ 11_116 Build a Powerful Real Estate AI Agent</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%9D%87%EF%B8%8F-11-117-Generate-Unlimited-Business-Ideas-with-AI-Agent-Multiple-Niches"><span class="nav-number">1.13.</span> <span class="nav-text">❇️ 11_117 Generate Unlimited Business Ideas with AI Agent(Multiple Niches)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%9D%87%EF%B8%8F-11-117-Generate-Unlimited-Business-Ideas-with-AI-Agent-One-Niches"><span class="nav-number">1.14.</span> <span class="nav-text">❇️ 11_117 Generate Unlimited Business Ideas with AI Agent(One Niches)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%9D%87%EF%B8%8F-11-118-Build-an-AI-That-Sends-Alerts-to-New-Youtube-Videos"><span class="nav-number">1.15.</span> <span class="nav-text">❇️ 11_118 Build an AI That Sends Alerts to New Youtube Videos</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#11-118-Slack-Testing"><span class="nav-number">1.16.</span> <span class="nav-text">11_118 Slack Testing</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%9D%87%EF%B8%8F-11-119-Get-Unlimited-Business-Leads-with-AI-Agent"><span class="nav-number">1.17.</span> <span class="nav-text">❇️ 11_119 Get Unlimited Business Leads with AI Agent</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%9D%87%EF%B8%8F-11-120-Nutritionist-AI-Agent-Your-24-x2F-7-Diet-Coach-Chiense"><span class="nav-number">1.18.</span> <span class="nav-text">❇️ 11_120 Nutritionist AI Agent - Your 24&#x2F;7 Diet Coach(Chiense)</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Robert Kao"
      src="/images/head.png">
  <p class="site-author-name" itemprop="name">Robert Kao</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">170</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">66</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
        <div class="back-to-top animated" role="button">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://hot5656.github.io/2025/09/28/n8n-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="Robert Kao">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Robert 雜記">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          n8n - AI Agents, AI Automations & AI Voice Agents (2)<br> Business & Support AI Agents
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2025-09-28 15:10:15" itemprop="dateCreated datePublished" datetime="2025-09-28T15:10:15+08:00">2025-09-28</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2025-11-28 15:28:37" itemprop="dateModified" datetime="2025-11-28T15:28:37+08:00">2025-11-28</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/AI/" itemprop="url" rel="index"><span itemprop="name">AI</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2025/09/28/n8n-3/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2025/09/28/n8n-3/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>65k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>59 分鐘</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h3 id="workflow"><a href="#workflow" class="headerlink" title="workflow"></a>workflow</h3><span id="more"></span>

<h4 id="11-107-Onboarding-System-Automation"><a href="#11-107-Onboarding-System-Automation" class="headerlink" title="11_107 Onboarding System Automation"></a>11_107 Onboarding System Automation</h4><div style="max-width:700px">
    <img src="/2025/09/28/n8n-3/pic_11_107.png" class="" title="pic_11_107">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># n8n form</span></span><br><span class="line">name</span><br><span class="line">Email</span><br><span class="line">Company Industry : Real Esltates</span><br><span class="line">What <span class="keyword">do</span> you want to achieve with us <span class="keyword">in</span> 5 months : I would liked to increase my revenue by 300%</span><br><span class="line"></span><br><span class="line"><span class="comment"># path 1 ============</span></span><br><span class="line"><span class="comment"># Gemini --&gt; Message a model </span></span><br><span class="line">Can you generate a warm and professional welcome email <span class="keyword">for</span> a new client based on the information provided?</span><br><span class="line">The message should be friendly, brief, and personalized—<span class="keyword">while</span> still sounding professional.</span><br><span class="line">It should reflect the client’s industry and their goals <span class="keyword">for</span> our collaboration. Below is the client’s information:</span><br><span class="line">Name: &#123;&#123; <span class="variable">$json</span>.name &#125;&#125;</span><br><span class="line">Email: &#123;&#123; <span class="variable">$json</span>.Email &#125;&#125;</span><br><span class="line">Company Industry: &#123;&#123; <span class="variable">$json</span>[<span class="string">&#x27;Company Industry&#x27;</span>] &#125;&#125;</span><br><span class="line">Goals <span class="keyword">for</span> the Partnership: &#123;&#123; <span class="variable">$json</span>[<span class="string">&#x27;What do you want to achieve with us in 5 months&#x27;</span>] &#125;&#125;</span><br><span class="line">Make sure to always end the email with the following sign-off:</span><br><span class="line">Best regards,</span><br><span class="line">Bob Bob</span><br><span class="line">VP of Internal Relations</span><br><span class="line">ABC Corp</span><br><span class="line">Do not use placeholders like [Your Name] or</span><br><span class="line">[Your Contact Information] under any circumstances, even <span class="keyword">if</span> some information is missing.</span><br><span class="line">Return the result <span class="keyword">in</span> 3 separate fields:</span><br><span class="line">Subject: The email’s subject line</span><br><span class="line">Body: The main email content</span><br><span class="line">Email: &#123;&#123; <span class="variable">$json</span>.Email &#125;&#125;</span><br><span class="line"></span><br><span class="line">The output just include 3 fields <span class="keyword">for</span> jason object: Subject,Body,Email</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set Field</span></span><br><span class="line">mail(object):&#123;&#123; JSON.parse( <span class="variable">$json</span>.content.parts[0].text.replaceAll(<span class="string">&#x27;`&#x27;</span>,<span class="string">&#x27;&#x27;</span>).replaceAll(<span class="string">&#x27;json&#x27;</span>, <span class="string">&#x27;&#x27;</span>)) &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gmail --&gt; send a message</span></span><br><span class="line">To: &#123;&#123; <span class="variable">$json</span>.mail.Email &#125;&#125;</span><br><span class="line">Subject: &#123;&#123; <span class="variable">$json</span>.mail.Subject &#125;&#125;</span><br><span class="line">Message : &#123;&#123; <span class="variable">$json</span>.mail.Body &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># path 2 ============</span></span><br><span class="line"><span class="comment"># Gemini --&gt; Message a model </span></span><br><span class="line">Use the client details below to generate a clear summary of their profile. Here is the information provided:</span><br><span class="line">Name:&#123;&#123; <span class="variable">$json</span>.name &#125;&#125;</span><br><span class="line">Company Industry:&#123;&#123; <span class="variable">$json</span>[<span class="string">&quot;Company Industry&quot;</span>] &#125;&#125;</span><br><span class="line">Goals with Us: &#123;&#123; <span class="variable">$json</span>[<span class="string">&quot;What do you want to achieve with us in 5 months&quot;</span>] &#125;&#125;</span><br><span class="line">Return the following fields separately:</span><br><span class="line">Name:&#123;&#123; <span class="variable">$json</span>.name &#125;&#125;</span><br><span class="line">Email:&#123;&#123; <span class="variable">$json</span>.Email &#125;&#125;</span><br><span class="line">Summary: A concise overview of the client based on the information provided above</span><br><span class="line">The output just include 3 fields <span class="keyword">for</span> jason object: Name,Emai,Summary</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set Field</span></span><br><span class="line">profile: &#123;&#123; JSON.parse( <span class="variable">$json</span>.content.parts[0].text.replaceAll(<span class="string">&#x27;`&#x27;</span>,<span class="string">&#x27;&#x27;</span>).replaceAll(<span class="string">&#x27;json&#x27;</span>, <span class="string">&#x27;&#x27;</span>)) &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># shett --&gt; Append row in sheet</span></span><br><span class="line">Document : Client<span class="string">&#x27;s Onboarding</span></span><br><span class="line"><span class="string">Name:&#123;&#123; $json.profile.Name &#125;&#125;</span></span><br><span class="line"><span class="string">Email: &#123;&#123; $json.profile.Email &#125;&#125;</span></span><br><span class="line"><span class="string">Summary: &#123;&#123; $json.profile.Summary &#125;&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="11-108-Customer-Feedback-Sentiment-Analysis"><a href="#11-108-Customer-Feedback-Sentiment-Analysis" class="headerlink" title="11_108 Customer+Feedback+Sentiment+Analysis"></a>11_108 Customer+Feedback+Sentiment+Analysis</h4><div style="max-width:700px">
    <img src="/2025/09/28/n8n-3/pic_11_108.png" class="" title="pic_11_108">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># n8n form</span></span><br><span class="line">name</span><br><span class="line">Email</span><br><span class="line">Feedback: </span><br><span class="line">  The service was excellent and the staff were very helpful</span><br><span class="line">  The project delivery was delayed, and the communication was poor throughout</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sendtiment Analysis </span></span><br><span class="line">Text to Analyze : &#123;&#123; <span class="variable">$json</span>.Feedback &#125;&#125;</span><br><span class="line">Sentiment Categories: Positive, Negative</span><br><span class="line"></span><br><span class="line"><span class="comment"># Positive path ============</span></span><br><span class="line"><span class="comment"># sheet --&gt; append or update row</span></span><br><span class="line">Document: Custom Feedback Form</span><br><span class="line">Sheet: Positive</span><br><span class="line">Column to match on: Email</span><br><span class="line">Email (using to match): &#123;&#123; $(<span class="string">&#x27;On form submission&#x27;</span>).item.json.Email &#125;&#125;</span><br><span class="line">Name: &#123;&#123; $(<span class="string">&#x27;On form submission&#x27;</span>).item.json.Name &#125;&#125;</span><br><span class="line">Feedback: &#123;&#123; $(<span class="string">&#x27;On form submission&#x27;</span>).item.json.Feedback &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Basic LLM chain(Write Positive response)</span></span><br><span class="line">Prompt (User Message):</span><br><span class="line">You are a customer support representative <span class="keyword">for</span> an AI automation Agency known as AdaptifyAI, specializing <span class="keyword">in</span> helping small and medium enterprises implement AI Agents and AI Automation solutions. </span><br><span class="line"></span><br><span class="line">Write a friendly response to the customer feedback below. </span><br><span class="line">format as HTML email ans sign from Marc AdsptifyAI. </span><br><span class="line">Return by json format inciude 2 fields: title and email content. email content format as HTML and sign from Marc AdsptifyAI.</span><br><span class="line">The jason not include ``` and json string</span><br><span class="line"></span><br><span class="line">Customer Name:</span><br><span class="line">&#123;&#123; <span class="variable">$json</span>.Name &#125;&#125;</span><br><span class="line">Feedback:</span><br><span class="line">&#123;&#123; <span class="variable">$json</span>.Feedback &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set Field</span></span><br><span class="line">email(Object): &#123;&#123; JSON.parse(<span class="variable">$json</span>.text) &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gmail --&gt; Send a merssage</span></span><br><span class="line">To:&#123;&#123; $(<span class="string">&#x27;Sentiment Analysis&#x27;</span>).item.json.Email &#125;&#125;</span><br><span class="line">Subject: &#123;&#123; <span class="variable">$json</span>.email.title &#125;&#125;</span><br><span class="line">Email Type: HTML</span><br><span class="line">Message: &#123;&#123; <span class="variable">$json</span>.email.email_content &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Nagetive Path ============</span></span><br><span class="line"><span class="comment"># Basic LLM chain(Suggests improvement)</span></span><br><span class="line">Prompt (User Message):</span><br><span class="line">You are a customer support representative <span class="keyword">for</span> an AI automation Agency known as AdaptifyAI, specializing <span class="keyword">in</span> helping small and medium enterprises implement AI Agents and AI Automation solutions. </span><br><span class="line"></span><br><span class="line">A client just submited feedback about our services <span class="built_in">which</span> you can see below.</span><br><span class="line">Please provide a concise suggestion on waht AdaptifyAI can <span class="keyword">do</span> to address their concerns and improve client satisfaction <span class="keyword">in</span> the future.</span><br><span class="line"></span><br><span class="line">Customer Name:</span><br><span class="line">&#123;&#123; <span class="variable">$json</span>.Name &#125;&#125;</span><br><span class="line">Feedback:</span><br><span class="line">&#123;&#123; <span class="variable">$json</span>.Feedback &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># sheet --&gt; append or update row</span></span><br><span class="line">Document: Custom Feedback Form</span><br><span class="line">Sheet: Negative</span><br><span class="line">Column to match on: Email</span><br><span class="line">Email (using to match): &#123;&#123; $(<span class="string">&#x27;On form submission&#x27;</span>).item.json.Email &#125;&#125;</span><br><span class="line">Name: &#123;&#123; $(<span class="string">&#x27;On form submission&#x27;</span>).item.json.Name &#125;&#125;</span><br><span class="line">Feedback: &#123;&#123; $(<span class="string">&#x27;On form submission&#x27;</span>).item.json.Feedback &#125;&#125;</span><br><span class="line">AI Suggestion: &#123;&#123; <span class="variable">$json</span>.text &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Basic LLM chain(Write Apology Response)</span></span><br><span class="line">Prompt (User Message):</span><br><span class="line">You are a customer support representative <span class="keyword">for</span> an AI automation Agency known as AdaptifyAI, specializing <span class="keyword">in</span> helping small and medium enterprises implement AI Agents and AI Automation solutions. </span><br><span class="line"></span><br><span class="line">Write a friendly and concise response to the customer feedback.</span><br><span class="line">The email should thanks the client <span class="keyword">for</span> their feedback about service and acknowledge their concerns, and inform that this has been escated to our management. Offer to extend their automation package with additional AI Agent integration at no extra charge. </span><br><span class="line"></span><br><span class="line">format as HTML email ans sign from Marc AdsptifyAI. </span><br><span class="line">Return by json format inciude 2 fields: title and email content. email content format as HTML and sign from Marc AdsptifyAI.</span><br><span class="line"></span><br><span class="line">Customer Name:</span><br><span class="line">&#123;&#123; <span class="variable">$json</span>.Name &#125;&#125;</span><br><span class="line">Feedback:</span><br><span class="line">&#123;&#123; <span class="variable">$json</span>.Feedback &#125;&#125;</span><br><span class="line">+ Require Specific Output Format:  Enable</span><br><span class="line">+ Structured Output Parser</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;title&quot;</span>:<span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;email_content&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gmail --&gt; Send a merssage</span></span><br><span class="line">To: &#123;&#123; $(<span class="string">&#x27;Add Negative feedback&#x27;</span>).item.json.Email &#125;&#125;</span><br><span class="line">Subject: &#123;&#123; <span class="variable">$json</span>.output.title &#125;&#125;</span><br><span class="line">Email Type: HTML</span><br><span class="line">Message: &#123;&#123; <span class="variable">$json</span>.output.email_content &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="11-109-Finance-Tracker"><a href="#11-109-Finance-Tracker" class="headerlink" title="11_109 Finance_Tracker"></a>11_109 Finance_Tracker</h4><div style="max-width:500px">
    <img src="/2025/09/28/n8n-3/pic_11_109.png" class="" title="pic_11_109">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># on chat message</span></span><br><span class="line">  I bought a bike <span class="keyword">for</span> 1500$ on June 16th</span><br><span class="line">  I earned 2000$ on June 1st</span><br><span class="line">  I receive 500$ from my side hustle on june 12th</span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent</span></span><br><span class="line">Prompt (User Message): &#123;&#123; <span class="variable">$json</span>.chatInput &#125;&#125;</span><br><span class="line">System Message: You are a helpful assistant. We are used to saving expenses or income. Always refer to the year 2025.</span><br><span class="line">+ Memory: simple Memoty </span><br><span class="line">+ Tools: Call n8n Workflow Tool</span><br><span class="line">  Description: Call this tool to save expenses or the income <span class="keyword">in</span> the database</span><br><span class="line">  Source:Database</span><br><span class="line">  Workflow:By ID: 取本身 workflow Id</span><br><span class="line">  如 workflow:https://hot5656.app.n8n.cloud/workflow/qgzznD8Jh8XcXNda 取 qgzznD8Jh8XcXNda</span><br><span class="line"></span><br><span class="line"><span class="comment"># set field</span></span><br><span class="line">response : response &#123;&#123; $(<span class="string">&#x27;When chat message received&#x27;</span>).item.json.chatInput &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Execute sub_workflow --&gt; when executed by another workflow ==== </span></span><br><span class="line">1. input data mode:Define using field below</span><br><span class="line">first <span class="built_in">set</span> mock data --&gt; save</span><br><span class="line">  [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;query&quot;</span>: <span class="string">&quot;I bought a bike for 1500$ on June 16th&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">2. 測試 ok 後, <span class="built_in">set</span> Input data mode:Accept all data</span><br><span class="line">3. 再由chat輸入即可</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Informtion Extractor</span></span><br><span class="line">Text : convert expense to JSON &#123;&#123; <span class="variable">$json</span>.query &#125;&#125;</span><br><span class="line">Attributes</span><br><span class="line">  Name: cost</span><br><span class="line">  Description: expense or income cost</span><br><span class="line">  Required: <span class="built_in">enable</span></span><br><span class="line"></span><br><span class="line">  Name: description</span><br><span class="line">  Description: expense or income description</span><br><span class="line">  Required: <span class="built_in">enable</span></span><br><span class="line"></span><br><span class="line">  Name:Date</span><br><span class="line">  Type:Date</span><br><span class="line">  Description:date of the operation</span><br><span class="line">  Required: <span class="built_in">enable</span></span><br><span class="line"></span><br><span class="line">  Name:<span class="built_in">type</span> </span><br><span class="line">  Description: either expense or income</span><br><span class="line">  Required: <span class="built_in">enable</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sheet --&gt; append a row</span></span><br><span class="line">Document: My Expenses [Template]</span><br><span class="line">Description: &#123;&#123; <span class="variable">$json</span>.output.description &#125;&#125;</span><br><span class="line">Cost:&#123;&#123; <span class="variable">$json</span>.output.cost &#125;&#125;</span><br><span class="line">Date: &#123;&#123; <span class="variable">$json</span>.output.Date.toDateTime().format(<span class="string">&#x27;yyyy-MM-dd&#x27;</span>) &#125;&#125;</span><br><span class="line">Type: &#123;&#123; <span class="variable">$json</span>.output[<span class="string">&quot;type &quot;</span>] &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="❇️-11-110-Update-Bella-Vista-KB-save-docuemnt"><a href="#❇️-11-110-Update-Bella-Vista-KB-save-docuemnt" class="headerlink" title="❇️ 11_110 Update Bella Vista KB(save docuemnt)"></a>❇️ 11_110 Update Bella Vista KB(save docuemnt)</h4><div style="max-width:500px">
    <img src="/2025/09/28/n8n-3/pic_11_110_11.png" class="" title="pic_11_110_11">
</div>
<div style="max-width:500px">
    <img src="/2025/09/28/n8n-3/pic_11_110_21.png" class="" title="pic_11_110_21">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># on from submission</span></span><br><span class="line">Form Title: Upload the document to the knowledge base.</span><br><span class="line">Form Elements:</span><br><span class="line">	Filed Name: File</span><br><span class="line">	Element <span class="built_in">type</span>: File</span><br><span class="line">	Required: Enable</span><br><span class="line"></span><br><span class="line"><span class="comment"># Simple Vector Store --&gt; Add  documents to vector store</span></span><br><span class="line">Operation Mode: Insert Documents</span><br><span class="line">Memory Key: vector_store_key (也可填其他值)</span><br><span class="line">+ Embedding: Embeddings google Gemini/Embedding OpenAI(用來生成文本的向量嵌入)</span><br><span class="line">+ Document: default Data lload</span><br><span class="line">	Type of Data: Binary</span><br><span class="line">	Mode: Load All Input Data</span><br><span class="line">	Data Format: Automatically Detect by Mime Type</span><br><span class="line">	Text Splitting :Simple</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># simple Vector Store --&gt; supabase</span></span><br><span class="line"><span class="comment"># Postgres PGVector Store --&gt; add document to vector store</span></span><br><span class="line">Table Name: n8n_vectors</span><br></pre></td></tr></table></figure>

<h4 id="❇️-11-110-Bella-Vista-Customer-Bookings-amp-Support"><a href="#❇️-11-110-Bella-Vista-Customer-Bookings-amp-Support" class="headerlink" title="❇️ 11_110 Bella Vista Customer Bookings &amp; Support"></a>❇️ 11_110 Bella Vista Customer Bookings &amp; Support</h4><div style="max-width:500px">
    <img src="/2025/09/28/n8n-3/pic_11_110_12.png" class="" title="pic_11_110_12">
</div>
<div style="max-width:500px">
    <img src="/2025/09/28/n8n-3/pic_11_110_22.png" class="" title="pic_11_110_22">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># on chat message</span></span><br><span class="line">	<span class="keyword">do</span> you support kid meal?</span><br><span class="line">	I want to book a table</span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent(Rachel)</span></span><br><span class="line">System Message:</span><br><span class="line">	<span class="comment">## Role</span></span><br><span class="line">	Your name is Rachel, a customer support agent <span class="keyword">for</span> an Italian restaurant called Bella Vista.</span><br><span class="line"></span><br><span class="line">	You are responsible <span class="keyword">for</span> providing information about the restaurant using the knowledge base	system</span><br><span class="line"></span><br><span class="line">	Please ensure your communication style is friendly and to the point</span><br><span class="line"></span><br><span class="line">	<span class="comment">## Tools</span></span><br><span class="line">	When a customer wants to make a booking, follow these steps.</span><br><span class="line"></span><br><span class="line">	Collect essentials details: customer name, email address, party size, preferred date and time, 	and special requests they may have.</span><br><span class="line"></span><br><span class="line">	Please <span class="built_in">let</span> the customer know that their booking request has been submitted to the restaurant, 	and they will receive a confirmation shortly.(the email must HTM format)</span><br><span class="line"></span><br><span class="line">	When a customer wants to speak with a real person</span><br><span class="line">	Get their name, email and phone number</span><br><span class="line">	Use the Human Support tool to send their details and send a email tell their request was 	submitted, and staff will contact them soon.</span><br><span class="line">+ Chat model: Google Gemini Chat model</span><br><span class="line">+ Memory: </span><br><span class="line">+ Tools:</span><br><span class="line">	Gmail Tool(Human support):</span><br><span class="line">		To: kyp001@...</span><br><span class="line">		Subject: auto</span><br><span class="line">		Message: auto</span><br><span class="line">	Gmail Tool(Making booking email):</span><br><span class="line">		To: auto</span><br><span class="line">		Subject: auto</span><br><span class="line">		Message: auto</span><br><span class="line">	Simple Vector Store(Bella Vista KB):</span><br><span class="line">	Operation Mode: Retrieve Documents (As Tool <span class="keyword">for</span> AI Agent)</span><br><span class="line">		Description: Use this tool to retrieve documents related to the Bella Vista restaurant</span><br><span class="line">		Memory Key: vector_store_key (或填對應值)</span><br><span class="line">		+ Embedding: Embeddings google Gemini/Embedding OpenAI(用來生成文本的向量嵌入)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># simple Vector Store --&gt; supabase</span></span><br><span class="line"><span class="comment"># Postgres PGVector Store&quot; 節點是用來與 PostgreSQL 資料庫中的 PGVector 擴展結合，管理和操作向量資料</span></span><br><span class="line"><span class="comment"># Postgres PGVector Store --&gt; retrieve documents for AI Agent as Tool </span></span><br><span class="line">Description: Use this tool to fetch the document related to the restaurant knowledge base</span><br><span class="line">Table Name: n8n_vectors</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># on chat message</span></span><br><span class="line">	manual triger --&gt; Make Chat Publicly Availabl : <span class="built_in">enable</span>(create a public URL)</span><br><span class="line">	Mode: Hosted Chat</span><br><span class="line">	Initial Message(s):</span><br><span class="line">		Hi there! 👋</span><br><span class="line">		My name is Nathan. How can I assist you today?</span><br><span class="line">		===================</span><br><span class="line">		&lt;link href=<span class="string">&quot;https://cdn.jsdelivr.net/npm/@n8n/chat/dist/style.css&quot;</span> rel=<span class="string">&quot;stylesheet&quot;</span> /&gt;</span><br><span class="line">		&lt;script <span class="built_in">type</span>=<span class="string">&quot;module&quot;</span>&gt;</span><br><span class="line">			import &#123; createChat &#125; from <span class="string">&#x27;https://cdn.jsdelivr.net/npm/@n8n/chat/dist/chat.bundle.es.js&#x27;</span>;</span><br><span class="line">			createChat(&#123; webhookUrl: <span class="string">&#x27;YOUR_PRODUCTION_WEBHOOK_URL&#x27;</span> &#125;);</span><br><span class="line">		&lt;/script&gt;</span><br><span class="line">		===================</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># put in web site</span></span><br><span class="line">	Mode: Embedded Chat</span><br><span class="line">	Reference Docuemnt:　https://www.npmjs.com/package/@n8n/chat</span><br><span class="line"><span class="comment"># ask LLM the example </span></span><br><span class="line">	I use wordpress <span class="keyword">for</span> my website, please integrate my n8n rag bot into my website, here is the official  documentation <span class="keyword">for</span> doing this.</span><br><span class="line">	https://www.npmjs.com/package/@n8n/chat</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># set workflow active --&gt; the the url can accept chat</span></span><br></pre></td></tr></table></figure>

<h4 id="11-111-Build-WhatsApp-Ai-Agent-that-Rembers-You-amp-Your-Conversations"><a href="#11-111-Build-WhatsApp-Ai-Agent-that-Rembers-You-amp-Your-Conversations" class="headerlink" title="11_111 Build WhatsApp Ai Agent that Rembers You &amp; Your Conversations"></a>11_111 Build WhatsApp Ai Agent that Rembers You &amp; Your Conversations</h4><div style="max-width:700px">
    <img src="/2025/09/28/n8n-3/pic_11_111.png" class="" title="pic_11_111">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># WahtsApp Business cloud --&gt; On message(receive WhatsApp)</span></span><br><span class="line">	Credential:</span><br><span class="line">		Client ID: from 應用程式設定 --&gt; 基本資料<span class="string">&#x27;s 應用程式編號</span></span><br><span class="line"><span class="string">		Client Secret: from 應用程式設定 --&gt; 基本資料&#x27;</span>s 應用程式密鑰</span><br><span class="line"></span><br><span class="line"><span class="comment"># Supabase --&gt; get many rows(get memory)</span></span><br><span class="line">Table Name or ID: ChatMemory</span><br><span class="line">Return All: Enable</span><br><span class="line">Field Name or ID: sender - (string) (select database, 取回同一人資料)</span><br><span class="line">Condition: Equals Field Value</span><br><span class="line"></span><br><span class="line"><span class="comment"># Aggregate (合併多筆資料為一筆)</span></span><br><span class="line">Aggregate: All Item Data (Into a Single List)</span><br><span class="line">Put Output <span class="keyword">in</span> Field: ChatMemory (<span class="built_in">set</span> output field name)</span><br><span class="line">Include: Specified Fields (只合併需要的資料)</span><br><span class="line">Fields To Include: message, created_at</span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent</span></span><br><span class="line">	Source <span class="keyword">for</span> Prompt (User Message): 	Define below</span><br><span class="line">	Prompt (User Message): &#123;&#123; $(<span class="string">&#x27;WhatsApp Trigger&#x27;</span>).item.json.messages[0].text.body &#125;&#125;</span><br><span class="line">	System Message:</span><br><span class="line">		<span class="comment"># ROLE</span></span><br><span class="line">		You are a friendly AI assistant.</span><br><span class="line">		You are currently chatting with a user on WhatsApp.</span><br><span class="line"></span><br><span class="line">		<span class="comment"># RULES</span></span><br><span class="line">		When the user sends a new message, check <span class="keyword">if</span> they shared any </span><br><span class="line">		**important information** that should be **saved <span class="keyword">in</span> memory** <span class="keyword">for</span> later.</span><br><span class="line"></span><br><span class="line">		If yes, use the Save Memory tool to save it.</span><br><span class="line">		Do NOT tell the user that you are saving anything.</span><br><span class="line"></span><br><span class="line">		Just keep the conversation going as usual.</span><br><span class="line"></span><br><span class="line">		<span class="comment"># Tools</span></span><br><span class="line">		Use this tool to **store any important facts** shared by the user.</span><br><span class="line">		Summarize the information clearly and pass it to this tool. </span><br><span class="line"></span><br><span class="line">		<span class="comment"># Memories</span></span><br><span class="line">		These are the **last saved facts** from the user (with date and time):</span><br><span class="line">		&#123;&#123; <span class="variable">$json</span>.ChatMemory.toJsonString() &#125;&#125;</span><br><span class="line"></span><br><span class="line">		!! IMPORTANT !!</span><br><span class="line">		Use this stored info when replying.</span><br><span class="line">		If something is already saved, don’t ask <span class="keyword">for</span> it again.</span><br><span class="line">		Keep your responses natural and friendly.</span><br><span class="line">	+ Chat Model: Google Gemini Chat Model</span><br><span class="line">	+ Tool: Supabase Tool</span><br><span class="line">		Table Name or ID: ChatMemory (選擇 DB)</span><br><span class="line">		Data to Send: Define Below <span class="keyword">for</span> Each Column</span><br><span class="line">			Field Name or ID: message - (string)</span><br><span class="line">			Field Value: auto</span><br><span class="line">			</span><br><span class="line">			Field Name or ID: sender - (string)</span><br><span class="line">			Field Value: &#123;&#123; $(<span class="string">&#x27;WhatsApp Trigger&#x27;</span>).item.json.messages[0].from &#125;&#125;</span><br><span class="line"></span><br><span class="line">			Field Name or ID: recipient - (string)</span><br><span class="line">			Field Value: &#123;&#123; $(<span class="string">&#x27;WhatsApp Trigger&#x27;</span>).item.json.contacts[0].wa_id &#125;&#125;</span><br><span class="line">		Credential:</span><br><span class="line">			URL Data: Supabase --&gt; Project Settings --&gt; API<span class="string">&#x27;s URL</span></span><br><span class="line"><span class="string">			Service Role Secret: Supabase --&gt; Project Settings --&gt; Data API&#x27;</span>s service_rolesecret</span><br><span class="line"></span><br><span class="line"><span class="comment"># WahtsApp Business cloud --&gt;send message(receive WhatsApp)</span></span><br><span class="line">	Sender Phone Number (or ID): 	15556391873 - Test Number (測試中選擇 Test Number)</span><br><span class="line">	Recipient<span class="string">&#x27;s Phone Number:	&#123;&#123; $(&#x27;</span>WhatsApp Trigger<span class="string">&#x27;).item.json.messages[0].from &#125;&#125;</span></span><br><span class="line"><span class="string">	MessageType: 	Text</span></span><br><span class="line"><span class="string">	Text Body: &#123;&#123; $json.output &#125;&#125;</span></span><br><span class="line"><span class="string">	Credential:</span></span><br><span class="line"><span class="string">		Access Token: from API 設定 - 存取權杖</span></span><br><span class="line"><span class="string">		Business Account ID: from API 設定 - WhatsApp Business 帳號編號：4189925184599952</span></span><br></pre></td></tr></table></figure>

<h4 id="11-112-inbox-manager-sort-incoming-Emails"><a href="#11-112-inbox-manager-sort-incoming-Emails" class="headerlink" title="11_112 inbox manager - sort incoming Emails"></a>11_112 inbox manager - sort incoming Emails</h4><ul>
<li><a target="_blank" rel="noopener" href="https://docs.n8n.io/integrations/builtin/core-nodes/n8n-nodes-base.scheduletrigger/#days-trigger-interval">Cron Expression - Schedule Trigger node</a></li>
</ul>
<div style="max-width:700px">
    <img src="/2025/09/28/n8n-3/pic_11_112_1.png" class="" title="pic_11_112_1">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Gmail --&gt; on message received</span></span><br><span class="line">Poll Times</span><br><span class="line">	Mode: Custom (自訂 trigger time)</span><br><span class="line">	Cron Expression: */15 * * * * (15 minutes)</span><br><span class="line">	Simplify: Disable</span><br><span class="line"></span><br><span class="line"><span class="comment"># Filter(Label Checker) - 檢查是否含 Label string</span></span><br><span class="line">&#123;&#123; <span class="variable">$json</span>.labelIds.join(<span class="string">&#x27;,&#x27;</span>).includes(<span class="string">&#x27;Label&#x27;</span>) &#125;&#125; <span class="string">&quot;is false&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent(Give a Label)</span></span><br><span class="line">Prompt (User Message):</span><br><span class="line">	Topic: &#123;&#123; <span class="variable">$json</span>.subject &#125;&#125;</span><br><span class="line">	Description: &#123;&#123; <span class="variable">$json</span>.text &#125;&#125;</span><br><span class="line">	Sender: &#123;&#123; <span class="variable">$json</span>.from.text &#125;&#125;</span><br><span class="line">Require Specific Output Format : Enable</span><br><span class="line">System Message:</span><br><span class="line">	** Your Role **</span><br><span class="line">	You are an intelligent email assistant responsible <span class="keyword">for</span> sorting incoming messages.</span><br><span class="line">	Your task is to analyze the content, subject, and sender of each email and assign it to the appropriate categor</span><br><span class="line">	y.</span><br><span class="line"></span><br><span class="line">	** Categories **</span><br><span class="line">	Categories <span class="keyword">for</span> sorting:</span><br><span class="line">	- priority: messages requiring immediate attention (from supervisors, clients)</span><br><span class="line">	- business: correspondence related to current projects, contracts, meetings</span><br><span class="line">	- newsletters: newsletter issues</span><br><span class="line">	- administrative: invoices, contracts, formal documents</span><br><span class="line">	- personal: private messages not related to work</span><br><span class="line">	- notifications: messages from social media, Substack, Coinbase, YouTube</span><br><span class="line">	- spam: unwanted messages, suspicious offers</span><br><span class="line"></span><br><span class="line">	** Instructions **</span><br><span class="line">	For each email:</span><br><span class="line">	- Analyze the content, subject, and sender</span><br><span class="line">	- Assign it to the appropriate category</span><br><span class="line">	- Add a label with the category</span><br><span class="line">	- If you are unsure, <span class="keyword">do</span> not label the message</span><br><span class="line"></span><br><span class="line">	** Response Format **</span><br><span class="line">	Always <span class="built_in">return</span> the result <span class="keyword">in</span> JSON format:</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="string">&quot;email_label&quot;</span>: <span class="string">&quot;business&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	IMPORTANT – the response must always be <span class="keyword">in</span> lowercase.</span><br><span class="line">+ Chat Mode: Google Gemini Chat Model</span><br><span class="line">+ Output Parser: Structure Output Parser</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="string">&quot;email_label&quot;</span>: <span class="string">&quot;business&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># switch</span></span><br><span class="line">	&#123;&#123; <span class="variable">$json</span>.output.email_label &#125;&#125; <span class="string">&quot;is equal to&quot;</span> priority</span><br><span class="line">	Rename Output(Enable), Output Name: Priority</span><br><span class="line"></span><br><span class="line">	&#123;&#123; <span class="variable">$json</span>.output.email_label &#125;&#125; <span class="string">&quot;is equal to&quot;</span> personal</span><br><span class="line">	Rename Output(Enable), Output Name: Personal</span><br><span class="line"></span><br><span class="line">	&#123;&#123; <span class="variable">$json</span>.output.email_label &#125;&#125; <span class="string">&quot;is equal to&quot;</span> notifications</span><br><span class="line">	Rename Output(Enable), Output Name: Notifications</span><br><span class="line"></span><br><span class="line">	&#123;&#123; <span class="variable">$json</span>.output.email_label &#125;&#125; <span class="string">&quot;is equal to&quot;</span> administrative</span><br><span class="line">	Rename Output(Enable), Output Name: Administrative</span><br><span class="line"></span><br><span class="line">	&#123;&#123; <span class="variable">$json</span>.output.email_label &#125;&#125; <span class="string">&quot;is equal to&quot;</span> business</span><br><span class="line">	Rename Output(Enable), Output Name: Business</span><br><span class="line"></span><br><span class="line">	&#123;&#123; <span class="variable">$json</span>.output.email_label &#125;&#125; <span class="string">&quot;is equal to&quot;</span> newsletters</span><br><span class="line">	Rename Output(Enable), Output Name: Newsletters</span><br><span class="line"></span><br><span class="line">	&#123;&#123; <span class="variable">$json</span>.output.email_label &#125;&#125; <span class="string">&quot;is equal to&quot;</span> spam</span><br><span class="line">	Rename Output(Enable), Output Name: Spam</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gmai --&gt; add label to message(Priority) - 建7個 Priority,Personal ..</span></span><br><span class="line">Message ID: &#123;&#123; $(<span class="string">&#x27;Gmail Trigger&#x27;</span>).item.json.id &#125;&#125;</span><br><span class="line">Label Names or IDs: Priority (select, Gmail 需先建 label)</span><br></pre></td></tr></table></figure>

<h4 id="11-112-inbox-manager-sort-old-Emails"><a href="#11-112-inbox-manager-sort-old-Emails" class="headerlink" title="11_112 inbox manager - sort old Emails"></a>11_112 inbox manager - sort old Emails</h4><div style="max-width:700px">
    <img src="/2025/09/28/n8n-3/pic_11_112_2.png" class="" title="pic_11_112_2">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># manual trigger</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Gmail --&gt; get many messages</span></span><br><span class="line"><span class="comment"># 抓權不太費時間, get many message 不 support loop()-可用 HTTP Request 需要再研究,先做測試</span></span><br><span class="line">Return All: Disable</span><br><span class="line">Limit: 10</span><br><span class="line">Simplify: Disable</span><br><span class="line">Filters: </span><br><span class="line">	Label Names or IDs: INBOX</span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent(Give a Label)</span></span><br><span class="line">System Message:(change below)</span><br><span class="line">	** Instructions **</span><br><span class="line">	For each email:</span><br><span class="line">	- Analyze the content, subject, and sender</span><br><span class="line">	- Assign it to the appropriate category</span><br><span class="line">	- Add a label with the category</span><br><span class="line">	- If you are unsure, <span class="keyword">do</span> not label the message</span><br><span class="line">	- output laso include email id from &#123;&#123; <span class="variable">$json</span>.id &#125;&#125;</span><br><span class="line"></span><br><span class="line">	** Response Format **</span><br><span class="line">	Always <span class="built_in">return</span> the result <span class="keyword">in</span> JSON format:</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="string">&quot;email_label&quot;</span>: <span class="string">&quot;business&quot;</span>,</span><br><span class="line">	<span class="string">&quot;id&quot;</span>:&#123;&#123; <span class="variable">$json</span>.id &#125;&#125;</span><br><span class="line">	&#125;</span><br><span class="line">+ Output Parser: Structure Output Parser</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="string">&quot;email_label&quot;</span>: <span class="string">&quot;business&quot;</span>,</span><br><span class="line">	<span class="string">&quot;id&quot;</span>:<span class="string">&quot;&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gmai --&gt; add label to message(Priority) - 建7個 Priority,Personal ..</span></span><br><span class="line">Message ID: &#123;&#123; <span class="variable">$json</span>.output.id &#125;&#125;</span><br><span class="line">Label Names or IDs: Priority (select, Gmail 需先建 label)</span><br></pre></td></tr></table></figure>

<h4 id="11-113-Analyze-Resumes"><a href="#11-113-Analyze-Resumes" class="headerlink" title="11_113 Analyze Resumes"></a>11_113 Analyze Resumes</h4><div style="max-width:1000px">
    <img src="/2025/09/28/n8n-3/pic_11_113.png" class="" title="pic_11_113">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Gmail --&gt; on message receive</span></span><br><span class="line">Poll Times:</span><br><span class="line">	Mode: Every Hour</span><br><span class="line">Simpllify: Disable</span><br><span class="line">Filters --&gt; Search: has:attachment filename:pdf</span><br><span class="line">Options:</span><br><span class="line">	Attachment Prefix: cv</span><br><span class="line">	Download Attachments: Enable</span><br><span class="line"></span><br><span class="line"><span class="comment"># Text Classifier</span></span><br><span class="line">Text to Classify:</span><br><span class="line">	Email Classify:</span><br><span class="line">		Email Title: &#123;&#123; <span class="variable">$json</span>.subject &#125;&#125;</span><br><span class="line">		Email Content: &#123;&#123; <span class="variable">$json</span>.text &#125;&#125;</span><br><span class="line">	Categories:</span><br><span class="line">	Job application : <span class="keyword">if</span> this email is a *Job Application* (<span class="keyword">for</span> example, it includes a resume, CV, or a message applying <span class="keyword">for</span> a job).</span><br><span class="line">	Other : Emails that don’t clearly fit into the other categories.</span><br><span class="line">Categories:</span><br><span class="line">	Category: Job application</span><br><span class="line">	Description: Job application</span><br><span class="line">	</span><br><span class="line">	Category: Other</span><br><span class="line">	Description: Other</span><br><span class="line">Options</span><br><span class="line">	System Prompt Template:(default is ok)</span><br><span class="line">		<span class="string">&quot;Please classify the text provided by the user into one of the following categories: &#123;categories&#125;, and use the provided formatting instructions below. Don&#x27;t explain, and only output the json.&quot;</span></span><br><span class="line">+ Model: Google Gemini Chat Model</span><br><span class="line"></span><br><span class="line"><span class="comment"># Google Drive --&gt; upload file</span></span><br><span class="line">Input Data Field Name: cv0 (傳來 file name)</span><br><span class="line">File Name: &#123;&#123; <span class="variable">$json</span>.from.value[0].name &#125;&#125;_&#123;&#123; <span class="variable">$node</span>[<span class="string">&#x27;Text Classifier&#x27;</span>].binary[<span class="string">&quot;cv0&quot;</span>].fileName &#125;&#125;</span><br><span class="line">Parent Drive: My Drive</span><br><span class="line">Parent Folder: Job_resume (已建目錄)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Google Drive --&gt; download file</span></span><br><span class="line">File(By ID): &#123;&#123; <span class="variable">$json</span>.id &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Extract from File --&gt; Extract from PDF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Information  Extractor</span></span><br><span class="line">Text: &#123;&#123; <span class="variable">$json</span>.text &#125;&#125;</span><br><span class="line">Schema Type: Define using JSON Schema</span><br><span class="line">Input Schema:</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="string">&quot;type&quot;</span>: <span class="string">&quot;object&quot;</span>,</span><br><span class="line">		<span class="string">&quot;properties&quot;</span>: &#123;</span><br><span class="line">			<span class="string">&quot;name&quot;</span>: &#123;</span><br><span class="line">				<span class="string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span></span><br><span class="line">			&#125;,</span><br><span class="line">			<span class="string">&quot;email&quot;</span>: &#123;</span><br><span class="line">				<span class="string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">				<span class="string">&quot;format&quot;</span>: <span class="string">&quot;email&quot;</span></span><br><span class="line">			&#125;,</span><br><span class="line">			<span class="string">&quot;phone_number&quot;</span>: &#123;</span><br><span class="line">				<span class="string">&quot;type&quot;</span>: <span class="string">&quot;string&quot;</span>,</span><br><span class="line">				<span class="string">&quot;pattern&quot;</span>: <span class="string">&quot;^(\\+\\d&#123;1,3&#125;[- ]?)?\\d&#123;10&#125;$&quot;</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="string">&quot;required&quot;</span>: [<span class="string">&quot;name&quot;</span>, <span class="string">&quot;email&quot;</span>, <span class="string">&quot;phone_number&quot;</span>]</span><br><span class="line">	&#125;</span><br><span class="line">+ Model: Google Gemini Chat Model</span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent</span></span><br><span class="line">Source <span class="keyword">for</span> Prompt (User Message): Define below</span><br><span class="line">Prompt (User Message) :</span><br><span class="line">	Email title : &#123;&#123; $(<span class="string">&#x27;Gmail Trigger&#x27;</span>).item.json.subject &#125;&#125;</span><br><span class="line">	Email content : &#123;&#123; $(<span class="string">&#x27;Gmail Trigger&#x27;</span>).item.json.text &#125;&#125;</span><br><span class="line">	Resume: &#123;&#123;  $(<span class="string">&#x27;Extract from File&#x27;</span>).item.json.text &#125;&#125; </span><br><span class="line">Require Specific Output Format: Enable</span><br><span class="line">System Message:</span><br><span class="line">	** Purpose **</span><br><span class="line">	You are a CV Evaluation and Summarization Agent. Your task is to extract key information from a CV and output it <span class="keyword">in</span> a clean, structured format.</span><br><span class="line">	You must also evaluate how well the candidate fits a specified job role and assign a relevance score (1–10), followed by a short justification.</span><br><span class="line"></span><br><span class="line">	** How It Works **</span><br><span class="line">	When provided with a CV and job description, follow this process:</span><br><span class="line"></span><br><span class="line">	1. Extract &amp; Summarize Information from the CV</span><br><span class="line"></span><br><span class="line">	- Educational Qualifications</span><br><span class="line">	Include degrees, institutions, and graduation years. only output by 1 string field</span><br><span class="line"></span><br><span class="line">	- Job History</span><br><span class="line">	List job titles, company names, employment dates, and 1 short sentence summarizing key responsibilities or achievements.</span><br><span class="line">	each Job histroy output by 1 string field and add job index, <span class="keyword">for</span> example 1. , between job add \n </span><br><span class="line"></span><br><span class="line">	- Skill Set</span><br><span class="line">	List technical, soft, or role-specific skills — separated by commas.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	2. Evaluate the Candidate <span class="keyword">for</span> the Job Role</span><br><span class="line"></span><br><span class="line">	- Compare the candidate’s qualifications and experience with the job requirements.</span><br><span class="line">	- Assign a score from 1–10 based on relevance:</span><br><span class="line">	1–3: Weak match</span><br><span class="line">	4–6: Moderate match</span><br><span class="line">	7–8: Strong match</span><br><span class="line">	9–10: Excellent match</span><br><span class="line"></span><br><span class="line">	- Provide a brief justification <span class="keyword">for</span> the score. Mention strengths and gaps directly related to the role — no assumptions or interpretations.</span><br><span class="line"></span><br><span class="line">	- output as json format</span><br><span class="line">+ Chat model:  Google Gemini Chat Model</span><br><span class="line">+ Output Parse: Structured Output Parser</span><br><span class="line">	&#123;</span><br><span class="line">			<span class="string">&quot;applied_for&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">		<span class="string">&quot;educational_qualifications&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">		<span class="string">&quot;job_history&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;skill_set&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">			<span class="string">&quot;score&quot;</span>:2,</span><br><span class="line">			<span class="string">&quot;justification&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># sheet --&gt; append row in sheet</span></span><br><span class="line">Document : List of candidates</span><br><span class="line">Values to Send</span><br><span class="line">	Name: &#123;&#123; $(<span class="string">&#x27;Information Extractor&#x27;</span>).item.json.output.name &#125;&#125;</span><br><span class="line">	Email: &#123;&#123; $(<span class="string">&#x27;Information Extractor&#x27;</span>).item.json.output.email &#125;&#125;</span><br><span class="line">	Number: &#123;&#123; $(<span class="string">&#x27;Information Extractor&#x27;</span>).item.json.output.phone_number &#125;&#125;</span><br><span class="line">	Skill Set: &#123;&#123; <span class="variable">$json</span>.output.skill_set &#125;&#125;</span><br><span class="line">	Qualifications: &#123;&#123; <span class="variable">$json</span>.output.educational_qualifications &#125;&#125;</span><br><span class="line">	Job History: &#123;&#123; <span class="variable">$json</span>.output.job_history &#125;&#125;</span><br><span class="line">	Score : &#123;&#123; <span class="variable">$json</span>.output.score &#125;&#125;</span><br><span class="line">	Justification: &#123;&#123; <span class="variable">$json</span>.output.justification &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="11-114-Build-AI-Invoice-Processing-System"><a href="#11-114-Build-AI-Invoice-Processing-System" class="headerlink" title="11_114 Build AI Invoice Processing System"></a>11_114 Build AI Invoice Processing System</h4><div style="max-width:1000px">
    <img src="/2025/09/28/n8n-3/pic_11_114.png" class="" title="pic_11_114">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Gmail --&gt; On message received(Gmail Trigger)</span></span><br><span class="line">Poll Times:</span><br><span class="line">	Mode: Every Hour</span><br><span class="line">Simpllify: Disable</span><br><span class="line">Filters --&gt; Search: has:attachment filename:pdf</span><br><span class="line">Options:</span><br><span class="line">	Download Attachments: Enable</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set Fieled</span></span><br><span class="line">attachments(Array): &#123;&#123;$(<span class="string">&#x27;Gmail Trigger&#x27;</span>).first().binary.keys()&#125;&#125;</span><br><span class="line">message_id(String): &#123;&#123; <span class="variable">$json</span>.id &#125;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Split Out</span></span><br><span class="line">Fields To Split Out: attachments</span><br><span class="line">Include: All Other Fields</span><br><span class="line"></span><br><span class="line"><span class="comment"># Merge (兩者合併成一筆資料)</span></span><br><span class="line">Mode: Combine</span><br><span class="line">Combine By: Matching Fields</span><br><span class="line">Fields To Match Have Different Names: Enable</span><br><span class="line">Fields to Match:</span><br><span class="line">	Input 1 Field: message_id</span><br><span class="line">	Input 2 Field: id</span><br><span class="line"></span><br><span class="line"><span class="comment"># Google Drive --&gt; upload file</span></span><br><span class="line">Input Data Field Name: &#123;&#123; <span class="variable">$json</span>.attachments &#125;&#125;</span><br><span class="line">File Name: &#123;&#123; <span class="variable">$json</span>.subject &#125;&#125;_&#123;&#123; <span class="variable">$json</span>.attachments &#125;&#125;</span><br><span class="line">Parent Drive: My Drive</span><br><span class="line">Parent Folder: Invoices From Gmail(已建目錄)</span><br><span class="line">---------- 更改如下較清楚</span><br><span class="line">File Name: &#123;&#123; <span class="variable">$json</span>.subject &#125;&#125;_&#123;&#123;<span class="variable">$binary</span>[<span class="variable">$json</span>.attachments].fileName &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Google Drive --&gt; download file</span></span><br><span class="line">File(By ID): &#123;&#123; <span class="variable">$json</span>.id &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Extra from File -&gt; Extract from PDF</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Basic LLM Chain</span></span><br><span class="line">Source <span class="keyword">for</span> Prompt (User Message): Define below</span><br><span class="line">Prompt (User Message): </span><br><span class="line">	<span class="string">&quot;Based on the text decide if the text is about an invoice or not: &#123;&#123; <span class="variable">$json</span>.text &#125;&#125;</span></span><br><span class="line"><span class="string">	Make sure not have string &quot;</span>invoice<span class="string">&quot; is invoice file, maybe just show some information about invoice </span></span><br><span class="line"><span class="string">	---------- receipt 誤判為 invoice 加以下</span></span><br><span class="line"><span class="string">	Please also check the title, it very import decide invoice or not</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	If yes return &quot;</span>yes<span class="string">&quot;, if no return &quot;</span>no<span class="string">&quot;. Don&#x27;t provide any additional information. Use only small letters&quot;</span></span><br><span class="line">Require Specific Output Format: Enable</span><br><span class="line">+ Model: Google Gemini Model</span><br><span class="line">+ Output Parser: Structured Output Parser</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="string">&quot;status&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># if </span></span><br><span class="line">+ <span class="literal">true</span>: next</span><br><span class="line">+ <span class="literal">false</span>: <span class="comment"># Google Drive --&gt; delete a file</span></span><br><span class="line">	File(By ID): &#123;&#123; $(<span class="string">&#x27;Upload file&#x27;</span>).item.json.id &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Basic LLM Chain</span></span><br><span class="line">Source <span class="keyword">for</span> Prompt (User Message): Define below</span><br><span class="line">Prompt (User Message): </span><br><span class="line">	<span class="comment">## Task Overview</span></span><br><span class="line">	You’ll receive raw text extracted from PDF invoices. Your job is to identify the key details listed below and <span class="built_in">return</span> them <span class="keyword">in</span> a structured JSON object.</span><br><span class="line"></span><br><span class="line">	<span class="comment">## Information to Capture</span></span><br><span class="line">	+ invoice_name – the identifier or title of the invoice</span><br><span class="line">	+ company_name – the name of the business that issued the invoice</span><br><span class="line">	+ total_invoice_amount – the grand total shown on the invoice</span><br><span class="line">	+ line_items – an array <span class="built_in">where</span> each entry includes:</span><br><span class="line">		+ description – the item or service label</span><br><span class="line">		+ amount – the cost <span class="keyword">for</span> that item</span><br><span class="line"></span><br><span class="line">	Output Format (example)</span><br><span class="line">	json</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="string">&quot;invoice_name&quot;</span>: <span class="string">&quot;Invoice ABC-123&quot;</span>,</span><br><span class="line">		<span class="string">&quot;company_name&quot;</span>: <span class="string">&quot;Acme Corp&quot;</span>,</span><br><span class="line">		<span class="string">&quot;total_invoice_amount&quot;</span>: 1000,</span><br><span class="line">		<span class="string">&quot;line_items&quot;</span>: [</span><br><span class="line">			&#123; </span><br><span class="line">				<span class="string">&quot;description&quot;</span>: <span class="string">&quot;Consulting services&quot;</span>, <span class="string">&quot;amount&quot;</span>: 100 </span><br><span class="line">			&#125;,</span><br><span class="line">			&#123; </span><br><span class="line">				<span class="string">&quot;description&quot;</span>: <span class="string">&quot;Software license&quot;</span>, <span class="string">&quot;amount&quot;</span>: 800 </span><br><span class="line">			&#125;,</span><br><span class="line">			&#123; </span><br><span class="line">				<span class="string">&quot;description&quot;</span>: <span class="string">&quot;Sales tax&quot;</span>, <span class="string">&quot;amount&quot;</span>: 100 </span><br><span class="line">			&#125;</span><br><span class="line">		]</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">## Guidelines</span></span><br><span class="line">	If any detail is missing or unclear, make your best estimate or use null.</span><br><span class="line">	Provide the most specific line-item labels available; use generic placeholders only when no description exists.</span><br><span class="line">	Verify that the line-item amounts add up to the total invoice amount (minor rounding differences are acceptable).</span><br><span class="line"></span><br><span class="line">	Input Placeholder</span><br><span class="line">	Text: &#123;&#123; $(<span class="string">&#x27;Extract from File&#x27;</span>).item.json.text &#125;&#125;&#123;&#123; $(<span class="string">&#x27;Extract from File&#x27;</span>).item.json.text &#125;&#125;</span><br><span class="line">Require Specific Output Format: Enable</span><br><span class="line">+ Model: Google Gemini Model</span><br><span class="line">+ Output Parser: Structured Output Parser</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;invoice_name&quot;</span>: <span class="string">&quot;Invoice ABC-123&quot;</span>,</span><br><span class="line">  <span class="string">&quot;company_name&quot;</span>: <span class="string">&quot;Acme Corp&quot;</span>,</span><br><span class="line">  <span class="string">&quot;total_invoice_amount&quot;</span>: 1000,</span><br><span class="line">  <span class="string">&quot;line_items&quot;</span>: [</span><br><span class="line">    &#123; </span><br><span class="line">      <span class="string">&quot;description&quot;</span>: <span class="string">&quot;Consulting services&quot;</span>, <span class="string">&quot;amount&quot;</span>: 100 </span><br><span class="line">    &#125;,</span><br><span class="line">    &#123; </span><br><span class="line">      <span class="string">&quot;description&quot;</span>: <span class="string">&quot;Software license&quot;</span>, <span class="string">&quot;amount&quot;</span>: 800 </span><br><span class="line">    &#125;,</span><br><span class="line">    &#123; </span><br><span class="line">      <span class="string">&quot;description&quot;</span>: <span class="string">&quot;Sales tax&quot;</span>, <span class="string">&quot;amount&quot;</span>: 100 </span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Notion --&gt; Create a database</span></span><br><span class="line">Database: Invoice Tracking Database</span><br><span class="line">Properties</span><br><span class="line">	Key Name or ID: Subject</span><br><span class="line">	Title: &#123;&#123; $(<span class="string">&#x27;Gmail Trigger&#x27;</span>).item.json.subject &#125;&#125;</span><br><span class="line">	</span><br><span class="line">	Key Name or ID: Email</span><br><span class="line">	Text: &#123;&#123; $(<span class="string">&#x27;Gmail Trigger&#x27;</span>).item.json.from.value[0].address &#125;&#125;</span><br><span class="line">	</span><br><span class="line">	Key Name or ID: Invoice URL</span><br><span class="line">	URL: &#123;&#123; $(<span class="string">&#x27;Upload file&#x27;</span>).item.json.webViewLink &#125;&#125;</span><br><span class="line">	</span><br><span class="line">	Key Name or ID: Amount</span><br><span class="line">	Number: &#123;&#123; <span class="variable">$json</span>.output.total_invoice_amount &#125;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Set Field</span></span><br><span class="line">line_items(Array): &#123;&#123; $(<span class="string">&#x27;Basic LLM Chain1&#x27;</span>).item.json.output.line_items &#125;&#125;</span><br><span class="line">subject_id(String): &#123;&#123; <span class="variable">$json</span>.id &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Split out</span></span><br><span class="line">Fields To Split Out: line_items</span><br><span class="line">Include: No Other Fields</span><br><span class="line"></span><br><span class="line"><span class="comment"># Notion --&gt; Create a database</span></span><br><span class="line">Properties</span><br><span class="line">	Key Name or ID: Invoice Subject</span><br><span class="line">	Title: &#123;&#123; $(<span class="string">&#x27;Gmail Trigger&#x27;</span>).item.json.subject &#125;&#125;</span><br><span class="line">	</span><br><span class="line">	Key Name or ID: Invoice Item</span><br><span class="line">	Text: &#123;&#123; <span class="variable">$json</span>.description &#125;&#125;</span><br><span class="line">	</span><br><span class="line">	Key Name or ID: Amount</span><br><span class="line">	Number: &#123;&#123; <span class="variable">$json</span>.amount &#125;&#125;</span><br></pre></td></tr></table></figure>


<h4 id="11-115-System-Summarize-your-Invoices-Monthly"><a href="#11-115-System-Summarize-your-Invoices-Monthly" class="headerlink" title="11_115 System Summarize your Invoices Monthly"></a>11_115 System Summarize your Invoices Monthly</h4><div style="max-width:1000px">
    <img src="/2025/09/28/n8n-3/pic_11_115.png" class="" title="pic_11_115">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Drive --&gt; On changes involving a psecific folder</span></span><br><span class="line">Folder ID:　16ccM8Afqv_TAdWldzw9k2Qf2XB0wIbmz　（Monthly Invoices)</span><br><span class="line">Watch For: Folder Created</span><br><span class="line"></span><br><span class="line"><span class="comment"># Wait</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Drive --&gt; Search files and folders</span></span><br><span class="line">Search Query: &#123;&#123; <span class="variable">$json</span>.name &#125;&#125; (目錄名稱,如 October)</span><br><span class="line">Limit: 50</span><br><span class="line">Filter: Folder(ID): 16ccM8Afqv_TAdWldzw9k2Qf2XB0wIbmz（Monthly Invoices)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Drive --&gt; Search files and folders</span></span><br><span class="line">Search Method: Advanced Search</span><br><span class="line"><span class="comment"># 查詢會列出指定父資料夾底下尚未被刪除的所有檔案與子資料夾</span></span><br><span class="line">Query String: <span class="string">&#x27;&#123;&#123; $json.id &#125;&#125;&#x27;</span> <span class="keyword">in</span> parents and trashed = <span class="literal">false</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># Drive --&gt; Download files</span></span><br><span class="line">File(ID):　&#123;&#123; <span class="variable">$json</span>.id &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Extract from File --&gt; Extract from pdf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Basic LLM Chain</span></span><br><span class="line">Prompt (User Message):</span><br><span class="line">	<span class="string">&quot;Based on the text decide if the text is about an invoice or not: &#123;&#123; <span class="variable">$json</span>.text &#125;&#125;</span></span><br><span class="line"><span class="string">	If yes return &quot;</span>yes<span class="string">&quot;, if no return &quot;</span>no<span class="string">&quot;. Don&#x27;t provide any additional information. Use only small letters&quot;</span></span><br><span class="line">Require Specific Output Format: Enable</span><br><span class="line"><span class="comment"># Output Parse: Structured Output Parser</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="string">&quot;status&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># if </span></span><br><span class="line">&#123;&#123; <span class="variable">$json</span>.output.status &#125;&#125; <span class="string">&quot;is equal to&quot;</span> yes</span><br><span class="line"><span class="literal">false</span>: No Operation, <span class="keyword">do</span> nothing(不加亦可)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Basic LLM Chain</span></span><br><span class="line">Prompt (User Message):</span><br><span class="line">	** Task Overview **</span><br><span class="line">	You’ll receive raw text extracted from PDF invoices.</span><br><span class="line">	Your job is to identify the key details listed below and <span class="built_in">return</span> them <span class="keyword">in</span> a structured JSON object.</span><br><span class="line"></span><br><span class="line">	** Information to Capture **</span><br><span class="line"></span><br><span class="line">	invoice_name – the identifier or title of the invoice</span><br><span class="line">	company_name – the name of the business that issued the invoice</span><br><span class="line">	total_invoice_amount – the grand total shown on the invoice</span><br><span class="line">	category - choose the most proper category <span class="keyword">for</span> invoice. ONLY take on out of the following categories:</span><br><span class="line">	Software &amp; Tools, Business Operations, Marketing &amp; Sales, Education &amp; Learning, Subscription,</span><br><span class="line">	Content Creation, Web &amp; Hosting, Team &amp; Collaboration, Other</span><br><span class="line"></span><br><span class="line">	Output Format (example)</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="string">&quot;invoice_name&quot;</span>: <span class="string">&quot;Invoice ABC-123&quot;</span>,</span><br><span class="line">	<span class="string">&quot;company_name&quot;</span>: <span class="string">&quot;Acme Corp&quot;</span>,</span><br><span class="line">	<span class="string">&quot;total_invoice_amount&quot;</span>: 1000,</span><br><span class="line">	<span class="string">&quot;month&quot;</span>: <span class="string">&quot;April&quot;</span>,</span><br><span class="line">	<span class="string">&quot;category&quot;</span>: <span class="string">&quot;Other&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	** Guidelines **</span><br><span class="line"></span><br><span class="line">	If any detail is missing or unclear, make your best estimate or use null.</span><br><span class="line">	Provide the most specific line-item labels available; use generic placeholders only when no description exists.</span><br><span class="line">	Verify that the line-item amounts add up to the total invoice amount (minor rounding differences are acceptable).</span><br><span class="line"></span><br><span class="line">	Input Placeholder</span><br><span class="line">	Text: &#123;&#123; $(<span class="string">&#x27;Extract from File&#x27;</span>).item.json.text &#125;&#125;</span><br><span class="line">Require Specific Output Format: Enable</span><br><span class="line"><span class="comment"># Output Parse: Structured Output Parser</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="string">&quot;invoice_name&quot;</span>: <span class="string">&quot;Invoice ABC-123&quot;</span>,</span><br><span class="line">		<span class="string">&quot;company_name&quot;</span>: <span class="string">&quot;Acme Corp&quot;</span>,</span><br><span class="line">		<span class="string">&quot;total_invoice_amount&quot;</span>: 1000,</span><br><span class="line">		<span class="string">&quot;month&quot;</span>: <span class="string">&quot;April&quot;</span>,</span><br><span class="line">		<span class="string">&quot;category&quot;</span>: <span class="string">&quot;Web &amp; Hosting&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment"># 當你設定預期格式，但 AI 模型輸出的格式不正確或一開始解析失敗時，這個功能會讓系統自動請 AI 重新調整輸出格式，使其符合預期格式要求，以此提升格式解析的成功率和穩定性</span></span><br><span class="line">	Auto-Fix Format: Enable</span><br><span class="line">	<span class="comment"># add model</span></span><br><span class="line">	Model: Google Gemini Chat Model</span><br><span class="line"></span><br><span class="line"><span class="comment"># Notion --&gt; Create a database page</span></span><br><span class="line">Database(From list): All Invoices</span><br><span class="line">Month: &#123;&#123; <span class="variable">$json</span>.output.month &#125;&#125;</span><br><span class="line">Invoice_From: &#123;&#123; <span class="variable">$json</span>.output.company_name &#125;&#125;</span><br><span class="line">Category: &#123;&#123; <span class="variable">$json</span>.output.category &#125;&#125;</span><br><span class="line">Amount: &#123;&#123; <span class="variable">$json</span>.output.total_invoice_amount &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Aggregate</span></span><br><span class="line">Aggregate: Individual Fields</span><br><span class="line">Fields To Aggregate:</span><br><span class="line">Input Field Name:	property_amount</span><br><span class="line">Input Field Name: property_invoice_from</span><br><span class="line"></span><br><span class="line"><span class="comment"># Edit field</span></span><br><span class="line">Amounts: &#123;&#123; <span class="variable">$json</span>.property_amount &#125;&#125;</span><br><span class="line">companies: &#123;&#123; <span class="variable">$json</span>.property_invoice_from &#125;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment"># AI Agent</span></span><br><span class="line">Prompt (User Message):</span><br><span class="line">	<span class="string">&quot;Amounts in $, please sum it up: &#123;&#123; <span class="variable">$json</span>.Amounts &#125;&#125;.</span></span><br><span class="line"><span class="string">	Only return plain number with currency. Also return number of invoices based on number of numbers&quot;</span></span><br><span class="line">Require Specific Output Format:<span class="built_in">enable</span></span><br><span class="line"><span class="comment"># Output Parse: Structured Output Parser</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="string">&quot;amount&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">		<span class="string">&quot;invoices_amount&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line"><span class="comment"># Tool: Calculator</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Notion --&gt; Create a database page</span></span><br><span class="line">Database(From list): Monthly Summary</span><br><span class="line">Month: &#123;&#123; $(<span class="string">&#x27;Google Drive Trigger&#x27;</span>).item.json.name &#125;&#125; (October)</span><br><span class="line">Total Amount: &#123;&#123; <span class="variable">$json</span>.output.amount &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gmail -&gt; send a message</span></span><br><span class="line">To: kyp001@yahoo.com.tw</span><br><span class="line">Subject: Invoice Summary <span class="keyword">for</span> &#123;&#123; $(<span class="string">&#x27;Google Drive Trigger&#x27;</span>).item.json.name &#125;&#125; is Ready!</span><br><span class="line">Email Type: Text</span><br><span class="line">Message:</span><br><span class="line">	Hi,</span><br><span class="line"></span><br><span class="line">	Here’s your invoice summary <span class="keyword">for</span> &#123;&#123; $(<span class="string">&#x27;Google Drive Trigger&#x27;</span>).item.json.name &#125;&#125;:</span><br><span class="line"></span><br><span class="line">	🧾 Total Amount: &#123;&#123; $(<span class="string">&#x27;AI Agent&#x27;</span>).item.json.output.amount &#125;&#125;</span><br><span class="line"></span><br><span class="line">	🥇 Number of invoices: &#123;&#123; $(<span class="string">&#x27;AI Agent&#x27;</span>).item.json.output.invoices_amount &#125;&#125;</span><br><span class="line"></span><br><span class="line">	✉️ Invoices From: &#123;&#123; $(<span class="string">&#x27;Edit Fields&#x27;</span>).item.json.companies &#125;&#125;</span><br><span class="line"></span><br><span class="line">	The full report has been saved to Notion.</span><br><span class="line"></span><br><span class="line">	Best,</span><br><span class="line">	Robert</span><br></pre></td></tr></table></figure>


<h4 id="❇️-11-116-Build-a-Powerful-Real-Estate-AI-Agent"><a href="#❇️-11-116-Build-a-Powerful-Real-Estate-AI-Agent" class="headerlink" title="❇️ 11_116 Build a Powerful Real Estate AI Agent"></a>❇️ 11_116 Build a Powerful Real Estate AI Agent</h4><div style="max-width:1000px">
    <img src="/2025/09/28/n8n-3/pic_11_116.png" class="" title="pic_11_116">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># n8n Form -&gt; on new n8n form event</span></span><br><span class="line">Form Title: Real Estate - Form</span><br><span class="line">Form Description: Please provide all your metrics to get the best real estate details</span><br><span class="line">Location(text): </span><br><span class="line">Status(Dropdown): forSale</span><br><span class="line">Minimum Price</span><br><span class="line">Maximum Price</span><br><span class="line">Minimum Number of Beds</span><br><span class="line">Minimum Number of Bathrooms</span><br><span class="line">sortselection(Dropdown):pricea</span><br><span class="line">Multi Family?(Dropdown):<span class="literal">true</span>,<span class="literal">false</span></span><br><span class="line">	<span class="string">&quot;Location&quot;</span>: 	<span class="string">&quot;Miami&quot;</span>,</span><br><span class="line">	<span class="string">&quot;Status&quot;</span>: 	<span class="string">&quot;forSale&quot;</span>,</span><br><span class="line">	<span class="string">&quot;Minimum Price&quot;</span>: 	<span class="string">&quot;400000&quot;</span>,</span><br><span class="line">	<span class="string">&quot;Maximum Price&quot;</span>: 	<span class="string">&quot;550000&quot;</span>,</span><br><span class="line">	<span class="string">&quot;Minimum Number of Beds&quot;</span>: 	3,</span><br><span class="line">	<span class="string">&quot;Minimum Number of Bathrooms&quot;</span>: 	2,</span><br><span class="line">	<span class="string">&quot;sortselection&quot;</span>: 	<span class="string">&quot;pricea&quot;</span>,</span><br><span class="line">	<span class="string">&quot;Multi Family?&quot;</span>: 	<span class="string">&quot;true&quot;</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment">#HTTP request</span></span><br><span class="line">URL:　x-rapidapi-host<span class="string">&#x27;s value</span></span><br><span class="line"><span class="string">Authentication:GenericnCredential Type</span></span><br><span class="line"><span class="string">Generic Auth Type: Header Auth</span></span><br><span class="line"><span class="string">Header AUth:</span></span><br><span class="line"><span class="string">	Name: x-rapidapi-key</span></span><br><span class="line"><span class="string">	Value: x-rapidapi-key&#x27;</span>s value</span><br><span class="line">Send Query Parameters:ｅｎａｂｌｅ</span><br><span class="line">	Name: location</span><br><span class="line">	Value: &#123;&#123; <span class="variable">$json</span>.Location &#125;&#125;</span><br><span class="line">	</span><br><span class="line">	Name: status</span><br><span class="line">	Value: &#123;&#123; <span class="variable">$json</span>.Status &#125;&#125;</span><br><span class="line">	</span><br><span class="line">	Name: price_min</span><br><span class="line">	Value: &#123;&#123; <span class="variable">$json</span>[<span class="string">&#x27;Minimum Price&#x27;</span>] &#125;&#125;</span><br><span class="line"></span><br><span class="line">	Name: price_max</span><br><span class="line">	Value: &#123;&#123; <span class="variable">$json</span>[<span class="string">&#x27;Maximum Price&#x27;</span>] &#125;&#125;</span><br><span class="line">	</span><br><span class="line">	Name:beds_min</span><br><span class="line">	Value: &#123;&#123; <span class="variable">$json</span>[<span class="string">&#x27;Minimum Number of Beds&#x27;</span>] &#125;&#125;</span><br><span class="line"></span><br><span class="line">	Name: baths_min</span><br><span class="line">	Value: &#123;&#123; <span class="variable">$json</span>[<span class="string">&#x27;Minimum Number of Bathrooms&#x27;</span>] &#125;&#125;</span><br><span class="line">	</span><br><span class="line">	Name: sortSelection</span><br><span class="line">	Value: &#123;&#123; <span class="variable">$json</span>.sortselection &#125;&#125;</span><br><span class="line">	</span><br><span class="line">	Name: isMultiFamily</span><br><span class="line">	Value: &#123;&#123; <span class="variable">$json</span>[<span class="string">&#x27;Multi Family?&#x27;</span>] &#125;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Split Out</span></span><br><span class="line">Fields To Split Out: results</span><br><span class="line">Include: No Other Fields</span><br><span class="line"></span><br><span class="line"><span class="comment"># Edit Field</span></span><br><span class="line">Mode: Manual Mapping</span><br><span class="line">Fields to Set:</span><br><span class="line">	address:String=&#123;&#123; <span class="variable">$json</span>.streetAddress &#125;&#125; &#123;&#123; <span class="variable">$json</span>.city &#125;&#125; &#123;&#123; <span class="variable">$json</span>.state &#125;&#125; &#123;&#123; <span class="variable">$json</span>.zipcode &#125;&#125; &#123;&#123; <span class="variable">$json</span>.country &#125;&#125;</span><br><span class="line">	homeStatus:String=&#123;&#123; <span class="variable">$json</span>.homeStatus &#125;&#125;</span><br><span class="line">	homeType:String=&#123;&#123; <span class="variable">$json</span>.homeType &#125;&#125;</span><br><span class="line">	totalSize:String=&#123;&#123; <span class="variable">$json</span>.lotAreaValue||<span class="string">&quot;&quot;</span> &#125;&#125; &#123;&#123; <span class="variable">$json</span>.lotAreaUnit||<span class="string">&quot;&quot;</span> &#125;&#125;</span><br><span class="line">	livingArea:String=&#123;&#123; <span class="variable">$json</span>.livingArea &#125;&#125; sqft</span><br><span class="line">	price:Number=&#123;&#123; <span class="variable">$json</span>.price &#125;&#125;</span><br><span class="line">	taxAssessedValue:String=&#123;&#123; <span class="variable">$json</span>.taxAssessedValue &#125;&#125;</span><br><span class="line">	zestimate:String=&#123;&#123; <span class="variable">$json</span>.zestimate &#125;&#125;</span><br><span class="line">	rentZestimate:String=&#123;&#123; <span class="variable">$json</span>.rentZestimate &#125;&#125;</span><br><span class="line">	priceReduction:String=&#123;&#123; <span class="variable">$json</span>.priceReduction &#125;&#125;</span><br><span class="line">	bathrooms:Number=&#123;&#123; <span class="variable">$json</span>.bathrooms &#125;&#125;</span><br><span class="line">	bedrooms:Number=&#123;&#123; <span class="variable">$json</span>.bedrooms &#125;&#125;</span><br><span class="line">	isNonOwnerOccupied:Boolean=&#123;&#123; <span class="variable">$json</span>.isNonOwnerOccupied &#125;&#125;</span><br><span class="line">	isPreforeclosureAuction:Boolean=&#123;&#123; <span class="variable">$json</span>.isPreforeclosureAuction &#125;&#125;</span><br><span class="line">	isPremierBuilder:Boolean=&#123;&#123; <span class="variable">$json</span>.isPremierBuilder &#125;&#125;</span><br><span class="line">	isShowcaseListing:Boolean=&#123;&#123; <span class="variable">$json</span>.isShowcaseListing &#125;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Code</span></span><br><span class="line">	// ── CONFIGURABLE ASSUMPTIONS ─────────────────────────────────────────</span><br><span class="line">	const downPaymentPct     = 0.20;   // 20 % down</span><br><span class="line">	const closingCostPct     = 0.03;   // 3 % closing costs</span><br><span class="line">	const annualInterestRate = 0.05;   // 5 % APR</span><br><span class="line">	const loanTermYears      = 30;     // 30‑yr mortgage</span><br><span class="line">	const propertyTaxRate    = 0.012;  // 1.2 % of assessed value per year</span><br><span class="line">	const insuranceRate      = 0.003;  // 0.3 % of price per year</span><br><span class="line">	const maintenanceRate    = 0.01;   // 1 % of price per year</span><br><span class="line">	// ─────────────────────────────────────────────────────────────────────</span><br><span class="line"></span><br><span class="line">	// IMPORTANT <span class="keyword">for</span> n8n: <span class="built_in">return</span> array of &#123; json: … &#125;</span><br><span class="line">	<span class="built_in">return</span> items.map(item =&gt; &#123;</span><br><span class="line"></span><br><span class="line">		// —— raw inputs (fall back to 0 <span class="keyword">if</span> missing) ————————————————</span><br><span class="line">		const j              = item.json;</span><br><span class="line">		const price          = parseFloat(j.price)           || 0;</span><br><span class="line">		const rent           = parseFloat(j.rentZestimate)   || 0;</span><br><span class="line">		const livingArea     = parseFloat(j.LivingArea)      || 0;  // sqft</span><br><span class="line">		const zEstimate      = parseFloat(j.zestimate)       || 0;</span><br><span class="line">		const taxAssessedVal = parseFloat(j.taxAssessedValue)|| price;</span><br><span class="line">		// ————————————————————————————————————————————————————————</span><br><span class="line"></span><br><span class="line">		// —— Financing ——————————————————————————</span><br><span class="line">		const downPayment    = price * downPaymentPct;</span><br><span class="line">		const closingCosts   = price * closingCostPct;</span><br><span class="line">		const loanAmount     = price - downPayment;</span><br><span class="line">		const monthlyRate    = annualInterestRate / 12;</span><br><span class="line">		const numPayments    = loanTermYears * 12;</span><br><span class="line">		const mortgagePayment= loanAmount * monthlyRate /</span><br><span class="line">													(1 - Math.pow(1 + monthlyRate, -numPayments));</span><br><span class="line"></span><br><span class="line">		// —— Operating expenses ———————————————</span><br><span class="line">		const annualTax      = taxAssessedVal * propertyTaxRate;</span><br><span class="line">		const annualIns      = price * insuranceRate;</span><br><span class="line">		const annualMaint    = price * maintenanceRate;</span><br><span class="line"></span><br><span class="line">		const monthlyTax     = annualTax   / 12;</span><br><span class="line">		const monthlyIns     = annualIns   / 12;</span><br><span class="line">		const monthlyMaint   = annualMaint / 12;</span><br><span class="line"></span><br><span class="line">		// —— Cash‑flow &amp; returns ——————————————</span><br><span class="line">		const totalMonthlyExp = mortgagePayment + monthlyTax + monthlyIns + monthlyMaint;</span><br><span class="line">		const monthlyCashFlow = rent - totalMonthlyExp;</span><br><span class="line">		const annualCashFlow  = monthlyCashFlow * 12;</span><br><span class="line"></span><br><span class="line">		const capRate         = annualCashFlow / price;                 // NOI ÷ price</span><br><span class="line">		const cashOnCashROI   = annualCashFlow / (downPayment + closingCosts);</span><br><span class="line"></span><br><span class="line">		// —— Extra metrics ————————————————</span><br><span class="line">		const pricePerSqft    = livingArea ? price / livingArea : 0;</span><br><span class="line">		const rentPerSqft     = livingArea ? rent  / livingArea : 0;</span><br><span class="line">		const rentToPricePct  = price ? (rent * 12) / price : 0;        // GRM inverse</span><br><span class="line">		const priceVsZestPct  = zEstimate ? (price - zEstimate) / zEstimate : 0;</span><br><span class="line">		// ————————————————————————————————————————————————————————</span><br><span class="line"></span><br><span class="line">		// —— Attach everything to output JSON ——</span><br><span class="line">		Object.assign(j, &#123;</span><br><span class="line">			downPayment:          +downPayment.toFixed(2),</span><br><span class="line">			closingCosts:         +closingCosts.toFixed(2),</span><br><span class="line">			loanAmount:           +loanAmount.toFixed(2),</span><br><span class="line">			mortgagePayment:      +mortgagePayment.toFixed(2),</span><br><span class="line"></span><br><span class="line">			monthlyPropertyTax:   +monthlyTax.toFixed(2),</span><br><span class="line">			monthlyInsurance:     +monthlyIns.toFixed(2),</span><br><span class="line">			monthlyMaintenance:   +monthlyMaint.toFixed(2),</span><br><span class="line">			totalMonthlyExpenses: +totalMonthlyExp.toFixed(2),</span><br><span class="line"></span><br><span class="line">			monthlyCashFlow:      +monthlyCashFlow.toFixed(2),</span><br><span class="line">			annualCashFlow:       +annualCashFlow.toFixed(2),</span><br><span class="line"></span><br><span class="line">			capRate:              +capRate.toFixed(4),         // 0.0523 ➜ 5.23 %</span><br><span class="line">			cashOnCashROI:        +cashOnCashROI.toFixed(4),   // 0.1234 ➜ 12.34 %</span><br><span class="line"></span><br><span class="line">			pricePerSqft:         +pricePerSqft.toFixed(2),</span><br><span class="line">			rentPerSqft:          +rentPerSqft.toFixed(2),</span><br><span class="line">			rentToPricePct:       +(rentToPricePct*100).toFixed(2), // % of price per yr</span><br><span class="line">			priceVsZestimatePct:  +(priceVsZestPct*100).toFixed(2) // over/under %</span><br><span class="line">		&#125;);</span><br><span class="line"></span><br><span class="line">		// Return a proper n8n item</span><br><span class="line">		<span class="built_in">return</span> &#123; json: j &#125;;</span><br><span class="line">	&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment"># (2)sheet --&gt; append or update row in sheet</span></span><br><span class="line">Document</span><br><span class="line">	From list:Real Estate Deals </span><br><span class="line">Mapping Column Mode: Map Each Column Manually</span><br><span class="line">Column to match on: Address</span><br><span class="line">Values to Send</span><br><span class="line">	Address (using to match): &#123;&#123; <span class="variable">$json</span>.address &#125;&#125;</span><br><span class="line">	homeStatus: &#123;&#123; <span class="variable">$json</span>.homeStatus &#125;&#125;</span><br><span class="line">	homeType: &#123;&#123; <span class="variable">$json</span>.homeType &#125;&#125;</span><br><span class="line">	totalSize: &#123;&#123; <span class="variable">$json</span>.totalSize &#125;&#125;</span><br><span class="line">	LivingArea: &#123;&#123; <span class="variable">$json</span>.livingArea &#125;&#125;</span><br><span class="line">	price: &#123;&#123; <span class="variable">$json</span>.price &#125;&#125;</span><br><span class="line">	taxAssessedValue: &#123;&#123; <span class="variable">$json</span>.taxAssessedValue &#125;&#125;</span><br><span class="line">	zestimate: &#123;&#123; <span class="variable">$json</span>.zestimate &#125;&#125;</span><br><span class="line">	rentZestimate: &#123;&#123; <span class="variable">$json</span>.rentZestimate &#125;&#125;</span><br><span class="line">	priceReduction: &#123;&#123; <span class="variable">$json</span>.priceReduction &#125;&#125;</span><br><span class="line">	bathrooms: &#123;&#123; <span class="variable">$json</span>.bathrooms &#125;&#125;</span><br><span class="line">	bedrooms: &#123;&#123; <span class="variable">$json</span>.bedrooms &#125;&#125;</span><br><span class="line">	isNonOwnerOccupied: &#123;&#123; <span class="variable">$json</span>.isNonOwnerOccupied &#125;&#125;</span><br><span class="line">	isPreforeclosureAuction: &#123;&#123; <span class="variable">$json</span>.isPreforeclosureAuction &#125;&#125;</span><br><span class="line">	isPremierBuilder: &#123;&#123; <span class="variable">$json</span>.isPremierBuilder &#125;&#125;</span><br><span class="line">	isShowcaseListing: &#123;&#123; <span class="variable">$json</span>.isShowcaseListing &#125;&#125;</span><br><span class="line">	downPayment: &#123;&#123; <span class="variable">$json</span>.downPayment &#125;&#125;</span><br><span class="line">	closingCosts &#123;&#123; <span class="variable">$json</span>.closingCosts &#125;&#125;</span><br><span class="line">	loanAmount: &#123;&#123; <span class="variable">$json</span>.loanAmount &#125;&#125;</span><br><span class="line">	mortgagePayment: &#123;&#123; <span class="variable">$json</span>.mortgagePayment &#125;&#125;</span><br><span class="line">	monthlyPropertyTax: &#123;&#123; <span class="variable">$json</span>.monthlyPropertyTax &#125;&#125;</span><br><span class="line">	monthlyInsurance: &#123;&#123; <span class="variable">$json</span>.monthlyInsurance &#125;&#125;</span><br><span class="line">	monthlyMaintenance: &#123;&#123; <span class="variable">$json</span>.monthlyMaintenance &#125;&#125;</span><br><span class="line">	totalMonthlyExpenses: &#123;&#123; <span class="variable">$json</span>.totalMonthlyExpenses &#125;&#125;</span><br><span class="line">	monthlyCashFlow: &#123;&#123; <span class="variable">$json</span>.monthlyCashFlow &#125;&#125;</span><br><span class="line">	annualCashFlow: &#123;&#123; <span class="variable">$json</span>.annualCashFlow &#125;&#125;</span><br><span class="line">	capRate: &#123;&#123; <span class="variable">$json</span>.capRate &#125;&#125;</span><br><span class="line">	cashOnCashROI: &#123;&#123; <span class="variable">$json</span>.cashOnCashROI &#125;&#125;</span><br><span class="line">	pricePerSqft: &#123;&#123; <span class="variable">$json</span>.pricePerSqft &#125;&#125;</span><br><span class="line">	rentPerSqft: &#123;&#123; <span class="variable">$json</span>.rentPerSqft &#125;&#125;</span><br><span class="line">	rentToPricePct: &#123;&#123; <span class="variable">$json</span>.rentToPricePct &#125;&#125;</span><br><span class="line">	priceVsZestimatePct: &#123;&#123; <span class="variable">$json</span>.priceVsZestimatePct &#125;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment"># (1) Aggregate</span></span><br><span class="line">Aggregate:All Item Data (Into a Single List)</span><br><span class="line">Put Output <span class="keyword">in</span> Field: data</span><br><span class="line">Include: All Fields</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gemini --&gt; Message a model</span></span><br><span class="line">Prompt:</span><br><span class="line">	<span class="string">&quot;You are a seasoned real estate investment analyst. You&#x27;ll receive a JSON array of property records with fields such as:</span></span><br><span class="line"><span class="string">	Address</span></span><br><span class="line"><span class="string">	homeStatus, homeType, size</span></span><br><span class="line"><span class="string">	price, taxAssessedValue, zestimate, rentZestimate</span></span><br><span class="line"><span class="string">	downPayment, closingCosts, loanAmount, mortgagePayment</span></span><br><span class="line"><span class="string">	monthlyPropertyTax, monthlyInsurance, monthlyMaintenance</span></span><br><span class="line"><span class="string">	totalMonthlyExpenses, monthlyCashFlow, annualCashFlow</span></span><br><span class="line"><span class="string">	capRate, cashOnCashROI</span></span><br><span class="line"><span class="string">	The input is available as:</span></span><br><span class="line"><span class="string">	&#123;&#123; JSON.stringify(<span class="variable">$json</span>.data) &#125;&#125;</span></span><br><span class="line"><span class="string">	Your tasks:</span></span><br><span class="line"><span class="string">	Write a short one-sentence summary of the overall real estate market sentiment.</span></span><br><span class="line"><span class="string">	List the Top 3 properties ranked by cash-on-cash ROI, and for each show:</span></span><br><span class="line"><span class="string">	Address</span></span><br><span class="line"><span class="string">	ROI (%)</span></span><br><span class="line"><span class="string">	Monthly cash flow</span></span><br><span class="line"><span class="string">	List the Top 3 properties ranked by cap rate, and for each show:</span></span><br><span class="line"><span class="string">	Address</span></span><br><span class="line"><span class="string">	Cap rate (%)</span></span><br><span class="line"><span class="string">	Annual cash flow</span></span><br><span class="line"><span class="string">	Highlight any properties with negative monthly cash flow.</span></span><br><span class="line"><span class="string">	Calculate and display portfolio-wide averages for:</span></span><br><span class="line"><span class="string">	Cap rate (%)</span></span><br><span class="line"><span class="string">	Cash-on-cash ROI (%)</span></span><br><span class="line"><span class="string">	Monthly cash flow (USD)</span></span><br><span class="line"><span class="string">	Suggest up to two next actions, for example:</span></span><br><span class="line"><span class="string">	“Schedule showings for properties X, Y”</span></span><br><span class="line"><span class="string">	“Consider raising your max price filter to find better cap rates”</span></span><br><span class="line"><span class="string">	Format your output as a clean daily report with headings and bullet points.</span></span><br><span class="line"><span class="string">	it include 2 field:</span></span><br><span class="line"><span class="string">	title: Daily Real Estate KPI Report for &#123;&#123; <span class="variable">$now</span> &#125;&#125; - &#123;&#123; <span class="subst">$(&#x27;On form submission&#x27;)</span>.item.json.Location &#125;&#125; (Ensure the date is in YYYY-MM-DD format.)</span></span><br><span class="line"><span class="string">	body:  it is HTML formatted and easy to read.</span></span><br><span class="line"><span class="string">	output example as bwelow : </span></span><br><span class="line"><span class="string">	&#123;</span></span><br><span class="line"><span class="string">		&quot;</span>title<span class="string">&quot;: &quot;</span>Daily Real Estate KPI Report <span class="keyword">for</span>..<span class="string">&quot;,</span></span><br><span class="line"><span class="string">		&quot;</span>body<span class="string">&quot;: &quot;</span>summary...<span class="string">&quot;</span></span><br><span class="line"><span class="string">	&#125;</span></span><br><span class="line"><span class="string">Output Content as JSON: Enable&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Edit field</span></span><br><span class="line">output(Object) &#123;&#123;  <span class="variable">$json</span>.content.parts[0].text.parseJson() &#125;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Gmail --&gt; send a message</span></span><br><span class="line">To: kyp001@gmail.com</span><br><span class="line">Subject: &#123;&#123; <span class="variable">$json</span>.output.title &#125;&#125;</span><br><span class="line">Email Type: HTML</span><br><span class="line">Message: &#123;&#123; <span class="variable">$json</span>.output.body &#125;&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h4 id="❇️-11-117-Generate-Unlimited-Business-Ideas-with-AI-Agent-Multiple-Niches"><a href="#❇️-11-117-Generate-Unlimited-Business-Ideas-with-AI-Agent-Multiple-Niches" class="headerlink" title="❇️ 11_117 Generate Unlimited Business Ideas with AI Agent(Multiple Niches)"></a>❇️ 11_117 Generate Unlimited Business Ideas with AI Agent(Multiple Niches)</h4><div style="max-width:1000px">
    <img src="/2025/09/28/n8n-3/pic_11_117_1.png" class="" title="pic_11_117_1">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># on a schedule</span></span><br><span class="line">Trigger Interval: Days</span><br><span class="line">Days Between Triggers: 1</span><br><span class="line">Trigger at Hour: Midnight</span><br><span class="line"></span><br><span class="line"><span class="comment"># sheet --&gt; append row in sheet</span></span><br><span class="line">Document(From list): Startup Ideas</span><br><span class="line">Date: -----------</span><br><span class="line">No: ------------------------</span><br><span class="line"></span><br><span class="line"><span class="comment"># sheet --&gt; append row in sheet</span></span><br><span class="line">Document(From list): Startup Ideas - Chinese</span><br><span class="line">Date: -----------</span><br><span class="line">No: ------------------------</span><br><span class="line"></span><br><span class="line"><span class="comment"># Edit field </span></span><br><span class="line">item_per_topic(Number): 20</span><br><span class="line"></span><br><span class="line"><span class="comment"># (1) Reddit --&gt; get many post</span></span><br><span class="line">Credential :</span><br><span class="line">	OAuth Redirect URL</span><br><span class="line">	Client ID *: Reddit App<span class="string">&#x27;s web app(id)</span></span><br><span class="line"><span class="string">	Client Secret: Reddit App&#x27;</span>s secret</span><br><span class="line">Subreddit:　startup</span><br><span class="line">Limit:　&#123;&#123; <span class="variable">$json</span>.item_per_topic &#125;&#125;</span><br><span class="line">Filters</span><br><span class="line">	Category: Hot Posts</span><br><span class="line"><span class="comment"># Edit field</span></span><br><span class="line">selftext : &#123;&#123; <span class="variable">$json</span>.selftext &#125;&#125;</span><br><span class="line">title : &#123;&#123; <span class="variable">$json</span>.title &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># (２) Reddit --&gt; get many post</span></span><br><span class="line">Subreddit:　artificial</span><br><span class="line">Limit:　&#123;&#123; <span class="variable">$json</span>.item_per_topic &#125;&#125;</span><br><span class="line">Filters</span><br><span class="line">	Category: Hot Posts</span><br><span class="line"><span class="comment"># Edit field</span></span><br><span class="line">selftext : &#123;&#123; <span class="variable">$json</span>.selftext &#125;&#125;</span><br><span class="line">title : &#123;&#123; <span class="variable">$json</span>.title &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># (３) Reddit --&gt; get many post</span></span><br><span class="line">Subreddit:　sideproject</span><br><span class="line">Limit:　&#123;&#123; <span class="variable">$json</span>.item_per_topic &#125;&#125;</span><br><span class="line">Filters</span><br><span class="line">	Category: Hot Posts</span><br><span class="line"><span class="comment"># Edit field</span></span><br><span class="line">selftext : &#123;&#123; <span class="variable">$json</span>.selftext &#125;&#125;</span><br><span class="line">title : &#123;&#123; <span class="variable">$json</span>.title &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># (４) Reddit --&gt; get many post</span></span><br><span class="line">Subreddit:　SaaS</span><br><span class="line">Limit:　&#123;&#123; <span class="variable">$json</span>.item_per_topic &#125;&#125;</span><br><span class="line">Filters</span><br><span class="line">	Category: Hot Posts</span><br><span class="line"><span class="comment"># Edit field</span></span><br><span class="line">selftext : &#123;&#123; <span class="variable">$json</span>.selftext &#125;&#125;</span><br><span class="line">title : &#123;&#123; <span class="variable">$json</span>.title &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Merge</span></span><br><span class="line">Number of Inputs: 4 </span><br><span class="line"></span><br><span class="line"><span class="comment"># Basic LLM Chain</span></span><br><span class="line">Prompt (User Message):</span><br><span class="line">	** Purpose **</span><br><span class="line">	You are a Startup Idea Extractor.</span><br><span class="line"></span><br><span class="line">	** You will receive an array of Reddit posts, each with these fields:</span><br><span class="line">	- title</span><br><span class="line">	- selftext (the body)</span><br><span class="line"></span><br><span class="line">	Your task is to process each post <span class="keyword">in</span> <span class="variable">$json</span>.data individually and <span class="built_in">read</span> the field titel and selftext to extract a concrete startup or business idea from each one. <span class="keyword">if</span> it is a idea <span class="built_in">set</span> the field success to <span class="literal">true</span>, <span class="keyword">else</span> <span class="built_in">set</span> it to <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">	Your job is to identify all concrete business or startup ideas mentioned.</span><br><span class="line"></span><br><span class="line">	** For each post with at least one idea, output an object with:</span><br><span class="line"></span><br><span class="line">	- title: &#123;&#123; <span class="variable">$json</span>.title &#125;&#125;</span><br><span class="line">	- url: &#123;&#123; <span class="variable">$json</span>.url &#125;&#125;</span><br><span class="line">	- startupIdea: one-sentence summary of the idea <span class="keyword">if</span> success=<span class="literal">true</span>, <span class="keyword">else</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	- success: boolean</span><br><span class="line">	- successDetails: explanation the ideal more detail <span class="keyword">if</span> success=<span class="literal">true</span>, <span class="keyword">else</span> <span class="string">&quot;&quot;</span></span><br><span class="line">	- goodIdea: same as field success </span><br><span class="line">	- pros: show the ideal<span class="string">&#x27;s benefit if success=true, else &quot;&quot;</span></span><br><span class="line"><span class="string">	- cons: show the ideal&#x27;</span>s drawback <span class="keyword">if</span> success=<span class="literal">true</span>, <span class="keyword">else</span> <span class="string">&quot;&quot;</span>  </span><br><span class="line">Require Specific Output Format: Enable</span><br><span class="line">Model: OpenAI Chat Model</span><br><span class="line">	Model:	gpt-4.1-mini</span><br><span class="line">Output parser: StructuredOutput Parser</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="string">&quot;title&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">		<span class="string">&quot;url&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">		<span class="string">&quot;startupIdea&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">		<span class="string">&quot;success&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">		<span class="string">&quot;successDetails&quot;</span>:  <span class="string">&quot;&quot;</span>,</span><br><span class="line">		<span class="string">&quot;goodIdea&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">		<span class="string">&quot;pros&quot;</span>:  <span class="string">&quot;&quot;</span>,</span><br><span class="line">		<span class="string">&quot;cons&quot;</span>:  <span class="string">&quot;&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># sheet --&gt; append row in sheet</span></span><br><span class="line">Document(From list): Startup Ideas</span><br><span class="line">Date: &#123;&#123;<span class="variable">$now</span>.toFormat(<span class="string">&#x27;yyyy-MM-dd&#x27;</span>)&#125;&#125;</span><br><span class="line">Title: &#123;&#123; <span class="variable">$json</span>.output.title &#125;&#125;</span><br><span class="line">Startup Idea: &#123;&#123; <span class="variable">$json</span>.output.startupIdea &#125;&#125;</span><br><span class="line">Success or not?: &#123;&#123; <span class="variable">$json</span>.output.success &#125;&#125;</span><br><span class="line">Details: &#123;&#123; <span class="variable">$json</span>.output.successDetails &#125;&#125;</span><br><span class="line">Is it a Good Idea?: &#123;&#123; <span class="variable">$json</span>.output.goodIdea &#125;&#125;</span><br><span class="line">Pros: &#123;&#123; <span class="variable">$json</span>.output.pros &#125;&#125;</span><br><span class="line">Cons: &#123;&#123; <span class="variable">$json</span>.output.cons &#125;&#125;</span><br><span class="line">Url: &#123;&#123; <span class="variable">$json</span>.output.url &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># if </span></span><br><span class="line">&#123;&#123; <span class="variable">$json</span>[<span class="string">&quot;Success or not?&quot;</span>] &#125;&#125;: is <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Basic LLM Chain</span></span><br><span class="line">Prompt (User Message):</span><br><span class="line">	Purpose</span><br><span class="line">	You are a professional translator.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	The input data contains fields such as <span class="string">&quot;Startup Idea&quot;</span>, <span class="string">&quot;Success or not?&quot;</span>, Details, <span class="string">&quot;Is it a Good Idea?&quot;</span>, Pros, Cons, Date and Title</span><br><span class="line">	Your task is to translate certain fields into Traditional Chinese, <span class="keyword">while</span> keeping the other fields <span class="keyword">in</span> their original form.</span><br><span class="line"></span><br><span class="line">	output fields:</span><br><span class="line"></span><br><span class="line">	- title: translate  &#123;&#123; <span class="variable">$json</span>.Title &#125;&#125; into Traditional Chinese; </span><br><span class="line">	- startupIdea: translate &#123;&#123; <span class="variable">$json</span>[<span class="string">&#x27;Startup Idea&#x27;</span>] &#125;&#125; into Traditional Chinese; </span><br><span class="line">	- successDetails: translate &#123;&#123; <span class="variable">$json</span>[<span class="string">&#x27; Details&#x27;</span>] &#125;&#125; into Traditional Chinese; </span><br><span class="line">	- pros: translate &#123;&#123; <span class="variable">$json</span>.Pros &#125;&#125;  into Traditional Chinese; </span><br><span class="line">	- cons: translate  &#123;&#123; <span class="variable">$json</span>.Cons &#125;&#125; into Traditional Chinese; </span><br><span class="line">	- listNo: &#123;&#123; <span class="variable">$json</span>.Date &#125;&#125;</span><br><span class="line">	- url: &#123;&#123; <span class="variable">$json</span>.Url &#125;&#125;</span><br><span class="line">	- success: &#123;&#123; <span class="variable">$json</span>[<span class="string">&#x27;Success or not?&#x27;</span>] &#125;&#125;</span><br><span class="line">	- good: &#123;&#123; <span class="variable">$json</span>[<span class="string">&#x27;Is it a Good Idea?&#x27;</span>] &#125;&#125;</span><br><span class="line">Require Specific Output Format: Enable</span><br><span class="line">Model: OpenAI Chat Model</span><br><span class="line">	Model:	gpt-4.1-mini</span><br><span class="line">Output parser: StructuredOutput Parser</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="string">&quot;title&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">		<span class="string">&quot;startupIdea&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">		<span class="string">&quot;successDetails&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">		<span class="string">&quot;pros&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">		<span class="string">&quot;cons&quot;</span>:<span class="string">&quot;&quot;</span>,</span><br><span class="line">		<span class="string">&quot;listNo&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">		<span class="string">&quot;url&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">		<span class="string">&quot;success&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">		<span class="string">&quot;good&quot;</span>: <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># sheet --&gt; append row in sheet</span></span><br><span class="line">Document(From list): Startup Ideas - Chinese</span><br><span class="line">	Date: &#123;&#123; <span class="variable">$json</span>.output.listNo &#125;&#125;</span><br><span class="line">	Title: &#123;&#123; <span class="variable">$json</span>.output.title &#125;&#125;</span><br><span class="line">	Startup Idea: &#123;&#123; <span class="variable">$json</span>.output.startupIdea &#125;&#125;</span><br><span class="line">	Success or not?: &#123;&#123; <span class="variable">$json</span>.output.success &#125;&#125;</span><br><span class="line">	Details: &#123;&#123; <span class="variable">$json</span>.output.successDetails &#125;&#125;</span><br><span class="line">	Is it a Good Idea?: &#123;&#123; <span class="variable">$json</span>.output.good &#125;&#125;</span><br><span class="line">	Pros: &#123;&#123; <span class="variable">$json</span>.output.pros &#125;&#125;</span><br><span class="line">	Cons: &#123;&#123; <span class="variable">$json</span>.output.cons &#125;&#125;</span><br><span class="line">	Url: &#123;&#123; <span class="variable">$json</span>.output.url &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="❇️-11-117-Generate-Unlimited-Business-Ideas-with-AI-Agent-One-Niches"><a href="#❇️-11-117-Generate-Unlimited-Business-Ideas-with-AI-Agent-One-Niches" class="headerlink" title="❇️ 11_117 Generate Unlimited Business Ideas with AI Agent(One Niches)"></a>❇️ 11_117 Generate Unlimited Business Ideas with AI Agent(One Niches)</h4><div style="max-width:1000px">
    <img src="/2025/09/28/n8n-3/pic_11_117_2.png" class="" title="pic_11_117_2">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># n8n form -&gt; on new n8n form event</span></span><br><span class="line">Form Title: Business Ideas</span><br><span class="line">Form Description: Provide your information inside</span><br><span class="line">Form Elements</span><br><span class="line">	Field Name: subreddit</span><br><span class="line">	Placeholder: artificial</span><br><span class="line"></span><br><span class="line">	Field Name: keywords</span><br><span class="line">	Placeholder: issues</span><br><span class="line">example :</span><br><span class="line">	<span class="string">&quot;subreddit&quot;</span>: <span class="string">&quot;RealEstate&quot;</span>,</span><br><span class="line">	<span class="string">&quot;keywords&quot;</span>: <span class="string">&quot;issues, problems, struggles&quot;</span>,</span><br><span class="line"></span><br><span class="line"><span class="comment"># Reddit --&gt; search for a post</span></span><br><span class="line">Subreddit:　&#123;&#123; <span class="variable">$json</span>.subreddit &#125;&#125;</span><br><span class="line">Keyword: &#123;&#123; <span class="variable">$json</span>.keywords &#125;&#125;</span><br><span class="line">Limit:　50</span><br><span class="line"></span><br><span class="line"><span class="comment"># Edit field</span></span><br><span class="line">title: &#123;&#123; <span class="variable">$json</span>.title &#125;&#125;</span><br><span class="line">selftext: &#123;&#123; <span class="variable">$json</span>.selftext &#125;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Aggregate</span></span><br><span class="line">Aggregate: All Item Data (Into a Single List)</span><br><span class="line">Put Output <span class="keyword">in</span> Field: data</span><br><span class="line">Include: All Fields</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gemini --&gt; Message a model</span></span><br><span class="line">Prompt :</span><br><span class="line">	You are an expert at generating innovative business ideas. You will receive a batch of Reddit posts pulled from:</span><br><span class="line">	r/&#123;&#123; $(<span class="string">&#x27;On form submission&#x27;</span>).item.json.subreddit &#125;&#125;</span><br><span class="line">	These posts match the search: “&#123;&#123; $(<span class="string">&#x27;On form submission&#x27;</span>).item.json.keywords &#125;&#125;”.</span><br><span class="line">	Each post includes a title and a selftext.</span><br><span class="line"></span><br><span class="line">	** Your job is as follows:</span><br><span class="line">	1. Analyze the content of these posts and identify up to 5 clear and distinct pain points shared by users.</span><br><span class="line">	2. For every pain point, generate 1 to 2 strong business ideas that directly address the issue.</span><br><span class="line">	3. Write an email summarizing the problems and proposed solutions.</span><br><span class="line"></span><br><span class="line">	Only <span class="built_in">return</span> a properly formatted JSON object with the structure below:</span><br><span class="line">	- emailSubject: A subject line like “Business ideas <span class="keyword">for</span> r/&#123;&#123; $(<span class="string">&#x27;On form submission&#x27;</span>).item.json.subreddit &#125;&#125;”</span><br><span class="line">	- emailBody: A clear, friendly email that:</span><br><span class="line">	- Summarizes each identified pain point</span><br><span class="line">	- Presents matching business ideas beneath each point</span><br><span class="line">	- Ends with a prompt <span class="keyword">for</span> next steps or feedback</span><br><span class="line"></span><br><span class="line">	The email body must be <span class="keyword">in</span> HTML format with appropriate line breaks, bolding, and bullet points <span class="built_in">where</span> needed.</span><br><span class="line"></span><br><span class="line">	Do not output anything other than the valid JSON object.</span><br><span class="line"></span><br><span class="line">	Always introduce yourself as an AI Researcher.</span><br><span class="line">Output Content as JSON: <span class="built_in">enable</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Edit fiels(English Content)</span></span><br><span class="line">output(object) : &#123;&#123; <span class="variable">$json</span>.content.parts[0].text.parseJson() &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Basic LLM Chain</span></span><br><span class="line">Prompt (User Message):</span><br><span class="line">	out to a jason format:</span><br><span class="line">	subtitle_c: translate &#123;&#123; <span class="variable">$json</span>.output.emailSubject &#125;&#125; to Traditional Chinese.</span><br><span class="line">	body_c: translate &#123;&#123; <span class="variable">$json</span>.output.emailBody &#125;&#125; to Traditional Chinese, but no effect <span class="keyword">for</span> HTML tag content.</span><br><span class="line">Require Specific Output Format: Enable</span><br><span class="line">Model: OpenAI Chat Model</span><br><span class="line">	Model:	gemini-2.5-flash</span><br><span class="line">Output parser: StructuredOutput Parser</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="string">&quot;subtitle_c&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">	<span class="string">&quot;body_c&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gmail --&gt; send a message</span></span><br><span class="line">To: kyp001@gmail.com</span><br><span class="line">Subject: &#123;&#123; <span class="variable">$json</span>.output.emailSubject &#125;&#125;</span><br><span class="line">Message: &#123;&#123; <span class="variable">$json</span>.output.emailBody &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="❇️-11-118-Build-an-AI-That-Sends-Alerts-to-New-Youtube-Videos"><a href="#❇️-11-118-Build-an-AI-That-Sends-Alerts-to-New-Youtube-Videos" class="headerlink" title="❇️ 11_118 Build an AI That Sends Alerts to New Youtube Videos"></a>❇️ 11_118 Build an AI That Sends Alerts to New Youtube Videos</h4><div style="max-width:1000px">
    <img src="/2025/09/28/n8n-3/pic_11_118_1.png" class="" title="pic_11_118_1">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># schedule Trigger</span></span><br><span class="line">Trigger Interval: Minutes</span><br><span class="line">Minutes Between Triggers: 30</span><br><span class="line"></span><br><span class="line"><span class="comment"># HTTP Request(Get Videos Channel)</span></span><br><span class="line">Method: GET</span><br><span class="line">URL: https://www.googleapis.com/youtube/v3/channels</span><br><span class="line">Authentication: Predefined Credential Type</span><br><span class="line">Credential Type: Google OAuth2 API</span><br><span class="line">Google OAuth2 API: </span><br><span class="line">	OAuth Redirect URL: copy to google cloud 用戶端 已授權的重新導向 URI</span><br><span class="line">	Client ID *: copy from google cloud 用戶端 用戶端 ID</span><br><span class="line">	Client Secret *: copy from google cloud 用戶端 用戶端密碼</span><br><span class="line">	Scope: https://www.googleapis.com/auth/youtube.readonly</span><br><span class="line">Send Query Parameters: Enable</span><br><span class="line">Query Parameters</span><br><span class="line">	part: contentDetails</span><br><span class="line">	mine: <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># HTTP Request(Get Videos Playlist)</span></span><br><span class="line">Method: GET</span><br><span class="line">URL: https://www.googleapis.com/youtube/v3/playlistItems</span><br><span class="line">Authentication: Predefined Credential Type</span><br><span class="line">Credential Type: Google OAuth2 API</span><br><span class="line">Google OAuth2 API: </span><br><span class="line">	same previous</span><br><span class="line">Send Query Parameters: Enable</span><br><span class="line">	Query Parameters</span><br><span class="line">	part: snippet,status</span><br><span class="line">	playlistId: &#123;&#123; <span class="variable">$json</span>.items[0].contentDetails.relatedPlaylists.uploads &#125;&#125;</span><br><span class="line">	maxResults: 20</span><br><span class="line">	order: date</span><br><span class="line"></span><br><span class="line"><span class="comment"># Split Out</span></span><br><span class="line">Fields To Split Out: items</span><br><span class="line">Include: No Other Fields</span><br><span class="line"></span><br><span class="line"><span class="comment"># if - just check condition</span></span><br><span class="line">&#123;&#123; <span class="variable">$json</span>.snippet.publishedAt &#125;&#125; <span class="string">&quot;is before&quot;</span> &#123;&#123; <span class="variable">$now</span>.minus(10,<span class="string">&#x27;days&#x27;</span>).format(<span class="string">&#x27;yyyy-MM-d HH:mm&#x27;</span> ) &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># switch (true)</span></span><br><span class="line">	&#123;&#123; <span class="variable">$json</span>.status.privacyStatus &#125;&#125; <span class="string">&quot;is equal to&quot;</span> private</span><br><span class="line">	Rename Output: Enable</span><br><span class="line">	Output name: Private</span><br><span class="line"></span><br><span class="line">	&#123;&#123; <span class="variable">$json</span>.status.privacyStatus &#125;&#125; <span class="string">&quot;is equal to&quot;</span> public</span><br><span class="line">	Rename Output: Enable</span><br><span class="line">	Output name: Public</span><br><span class="line"></span><br><span class="line"><span class="comment"># (Private)sheet -&gt; append or update row in sheet</span></span><br><span class="line">Document: Youtube Videos Tracking</span><br><span class="line">Column to match on: Video ID</span><br><span class="line">	Video ID (using to match): &#123;&#123; <span class="variable">$json</span>.snippet.resourceId.videoId &#125;&#125;</span><br><span class="line">	Status: &#123;&#123; <span class="variable">$json</span>.status.privacyStatus &#125;&#125;</span><br><span class="line">	Title: &#123;&#123; <span class="variable">$json</span>.snippet.title &#125;&#125;</span><br><span class="line">	Url: https://studio.youtube.com/video/&#123;&#123; <span class="variable">$json</span>.snippet.resourceId.videoId &#125;&#125;/edit</span><br><span class="line"> </span><br><span class="line"><span class="comment"># (Private)Slack -&gt; sned a message</span></span><br><span class="line">Send Message To: Channel</span><br><span class="line">Channel: n8n_discuss</span><br><span class="line">Message Type: Simple Text Message</span><br><span class="line">Message Text: </span><br><span class="line">	✅ New Youtube Video is ready to <span class="built_in">set</span> up: &#123;&#123; <span class="variable">$json</span>.Title &#125;&#125;</span><br><span class="line">	URL: &#123;&#123; <span class="variable">$json</span>.Url &#125;&#125;</span><br><span class="line">Include Link to Workflow: Disable</span><br><span class="line"><span class="comment"># 以下二者可mask 額外資訊</span></span><br><span class="line">Unfurl Links: Disable</span><br><span class="line">Unfurl Media: Disable</span><br><span class="line"></span><br><span class="line"><span class="comment"># (Public)sheet -&gt; append or update row in sheet</span></span><br><span class="line">Document: Youtube Videos Tracking</span><br><span class="line">Column to match on: Video ID</span><br><span class="line">	Video ID (using to match): &#123;&#123; <span class="variable">$json</span>.snippet.resourceId.videoId &#125;&#125;</span><br><span class="line">	Status: &#123;&#123; <span class="variable">$json</span>.status.privacyStatus &#125;&#125;</span><br><span class="line">	Title: &#123;&#123; <span class="variable">$json</span>.snippet.title &#125;&#125;</span><br><span class="line">	Url: https://studio.youtube.com/video/&#123;&#123; <span class="variable">$json</span>.snippet.resourceId.videoId &#125;&#125;/edit</span><br><span class="line"> </span><br><span class="line"><span class="comment"># (Public)Slack -&gt; sned a message</span></span><br><span class="line">Send Message To: Channel</span><br><span class="line">Channel: n8n_discuss</span><br><span class="line">Message Type: Simple Text Message</span><br><span class="line">Message Text: </span><br><span class="line">	☑️ New Youtube Video is published and ready to promote: &#123;&#123; $(<span class="string">&#x27;Split Out&#x27;</span>).item.json.snippet.title &#125;&#125;  </span><br><span class="line">	URL: https://studio.youtube.com/video/&#123;&#123; $(<span class="string">&#x27;Split Out&#x27;</span>).item.json.snippet.resourceId.videoId &#125;&#125;/edit</span><br><span class="line">Include Link to Workflow: Disable</span><br><span class="line"><span class="comment"># 以下二者可mask 額外資訊</span></span><br><span class="line">Unfurl Links: Disable</span><br><span class="line">Unfurl Media: Disable</span><br><span class="line"></span><br><span class="line"><span class="comment"># if false, (Private)Slack -&gt; sned a message</span></span><br><span class="line">Send Message To: Channel</span><br><span class="line">Channel: n8n_discuss</span><br><span class="line">Message Type: Simple Text Message</span><br><span class="line">Message Text: </span><br><span class="line">	✅ (previous) New Youtube Video is ready to <span class="built_in">set</span> up: &#123;&#123; <span class="variable">$json</span>.Title &#125;&#125;</span><br><span class="line">	URL: &#123;&#123; <span class="variable">$json</span>.Url &#125;&#125;</span><br><span class="line">Include Link to Workflow: Disable</span><br><span class="line"><span class="comment"># 以下二者可mask 額外資訊</span></span><br><span class="line">Unfurl Links: Disable</span><br><span class="line"></span><br><span class="line"><span class="comment"># if false, (Public)Slack -&gt; sned a message</span></span><br><span class="line">Send Message To: Channel</span><br><span class="line">Channel: n8n_discuss</span><br><span class="line">Message Type: Simple Text Message</span><br><span class="line">Message Text: </span><br><span class="line">	☑️ (previous) New Youtube Video is published and ready to promote: &#123;&#123; $(<span class="string">&#x27;Split Out&#x27;</span>).item.json.snippet.title &#125;&#125;  </span><br><span class="line">	URL: https://studio.youtube.com/video/&#123;&#123; $(<span class="string">&#x27;Split Out&#x27;</span>).item.json.snippet.resourceId.videoId &#125;&#125;/edit</span><br><span class="line">Include Link to Workflow: Disable</span><br><span class="line"><span class="comment"># 以下二者可mask 額外資訊</span></span><br><span class="line">Unfurl Links: Disable</span><br><span class="line">Unfurl Media: Disable</span><br></pre></td></tr></table></figure>

<h4 id="11-118-Slack-Testing"><a href="#11-118-Slack-Testing" class="headerlink" title="11_118 Slack Testing"></a>11_118 Slack Testing</h4><div style="max-width:500px">
    <img src="/2025/09/28/n8n-3/pic_11_118_2.png" class="" title="pic_11_118_2">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Slack --&gt; On any event</span></span><br><span class="line">Channel to Watch: n8n_discuss2</span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent</span></span><br><span class="line">Source <span class="keyword">for</span> Prompt (User Message):Define below</span><br><span class="line">Prompt (User Message): &#123;&#123; <span class="variable">$json</span>.blocks[0].elements[0].elements[1].text &#125;&#125;</span><br><span class="line">Model:  Google Femini Chat model</span><br><span class="line"></span><br><span class="line"><span class="comment"># Slack --&gt; Send a message</span></span><br><span class="line">Channel: n8n_discuss2</span><br><span class="line">Message Text: &#123;&#123; <span class="variable">$json</span>.output &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="❇️-11-119-Get-Unlimited-Business-Leads-with-AI-Agent"><a href="#❇️-11-119-Get-Unlimited-Business-Leads-with-AI-Agent" class="headerlink" title="❇️ 11_119 Get Unlimited Business Leads with AI Agent"></a>❇️ 11_119 Get Unlimited Business Leads with AI Agent</h4><div style="max-width:1000px">
    <img src="/2025/09/28/n8n-3/pic_11_119.png" class="" title="pic_11_119">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Chat Trigger</span></span><br><span class="line">Give me real estate agencies <span class="keyword">in</span> Boston</span><br><span class="line">Give me contact details <span class="keyword">for</span> the best tattoo studios <span class="keyword">in</span> New York</span><br><span class="line">給我台灣成功的AI Agent 相關公司的資料 </span><br><span class="line">給我台灣成功的 SaaS 公司的資料 </span><br><span class="line">給我台灣成功的 n8n 相關 自動化 公司的資料</span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent</span></span><br><span class="line">Source <span class="keyword">for</span> Prompt (User Message): Define below</span><br><span class="line">Prompt (User Message):&#123;&#123; <span class="variable">$json</span>.chatInput &#125;&#125;</span><br><span class="line">System Message:</span><br><span class="line">	You are a research assistant helping the user collect contact details from the “Map Checker” tool or a website.</span><br><span class="line"></span><br><span class="line">	Your job is to extract and <span class="built_in">return</span> all contact information <span class="keyword">in</span> a clearly structured JSON format, following the example below:</span><br><span class="line"></span><br><span class="line">	[</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="string">&quot;Name&quot;</span>: <span class="string">&quot;Dexters.co&quot;</span>,</span><br><span class="line">			<span class="string">&quot;Address&quot;</span>: <span class="string">&quot;54 Borough High St, London Bridge, London SE1 1XL, United Kingdom&quot;</span>,</span><br><span class="line">			<span class="string">&quot;Phone&quot;</span>: <span class="string">&quot;+44 20 7650 5100&quot;</span>,</span><br><span class="line">			<span class="string">&quot;Website&quot;</span>: <span class="string">&quot;https://www.dexters.co.uk/contact-us/our-offices/london-bridge&quot;</span>,</span><br><span class="line">			<span class="string">&quot;Rating&quot;</span>: <span class="string">&quot;4.9&quot;</span>,</span><br><span class="line">			<span class="string">&quot;Opening Hours&quot;</span>: <span class="string">&quot;8 AM–8 PM daily&quot;</span></span><br><span class="line">		&#125;,</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="string">&quot;Address&quot;</span>: <span class="string">&quot;realestateagentslondon&quot;</span>,</span><br><span class="line">			<span class="string">&quot;Address&quot;</span>: <span class="string">&quot;75A Barking Rd, London E16 4HB, United Kingdom&quot;</span>,</span><br><span class="line">			<span class="string">&quot;Phone&quot;</span>: <span class="string">&quot;+44 20 7055 0441&quot;</span>,</span><br><span class="line">			<span class="string">&quot;Website&quot;</span>: <span class="string">&quot;https://realestateagentslondon.co.uk/&quot;</span>,</span><br><span class="line">			<span class="string">&quot;Rating&quot;</span>: <span class="string">&quot;4.8&quot;</span>,</span><br><span class="line">			<span class="string">&quot;Opening Hours&quot;</span>: <span class="string">&quot;9:30 AM–5:30 PM, Saturday 11 AM–4 PM, Closed Sunday&quot;</span></span><br><span class="line">		&#125;</span><br><span class="line">		// more entries...</span><br><span class="line">	]</span><br><span class="line"></span><br><span class="line">	Return ONLY this JSON array <span class="keyword">in</span> the response.</span><br><span class="line">	Do not wrap it inside another object or string — just output the raw array.</span><br><span class="line"></span><br><span class="line">	Make sure:</span><br><span class="line">	- All values are properly filled <span class="keyword">in</span> and escaped</span><br><span class="line">	- No nested or malformed JSON</span><br><span class="line">	- If a value is missing (e.g., website), use an empty string: <span class="string">&quot;Website&quot;</span>: <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">	This format will be used by a code node to extract values before sending them to Google Sheets.</span><br><span class="line">	Only <span class="built_in">return</span> the response <span class="keyword">in</span> valid JSON format, without any other elements.</span><br><span class="line">Chat model: Gemini Chat Model</span><br><span class="line">Memory: Simple Memory </span><br><span class="line">Tool: HTTP request Tool</span><br><span class="line">	Description:</span><br><span class="line">		This bot helps you scrape all contact information <span class="keyword">for</span> lead generation from Google Maps.</span><br><span class="line">		Use the query parameter <span class="string">&quot;q&quot;</span> <span class="keyword">for</span> the search term, <span class="string">&quot;ll&quot;</span> <span class="keyword">for</span> latitude and longitude, and <span class="string">&quot;page&quot;</span> <span class="keyword">for</span> the current pagination index.</span><br><span class="line">	URL: https://google.serper.dev/maps</span><br><span class="line">	Authentication: Generic Credential Type</span><br><span class="line">	Generic Auth Type: Custom Auth</span><br><span class="line">	Custom Auth: Custom Auth (Serper)</span><br><span class="line">	Send Query Parameters: Enable</span><br><span class="line">		q: auto</span><br><span class="line">		ll: auto</span><br><span class="line">		page: auto</span><br><span class="line"></span><br><span class="line"><span class="comment"># sheet --&gt; Append row in sheet(add date and message)</span></span><br><span class="line">Document: Map Searcher</span><br><span class="line">Name: *** &#123;&#123;<span class="variable">$now</span>.format(<span class="string">&#x27;yyyy-MM-dd HH:mm&#x27;</span>)&#125;&#125;</span><br><span class="line">Address: &#123;&#123; $(<span class="string">&#x27;When chat message received&#x27;</span>).item.json.chatInput &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Code</span></span><br><span class="line">	// Get the full response string from the previous step (usually <span class="string">&quot;AI Agent&quot;</span> or similar)</span><br><span class="line">	// 第0筆, json output 欄位</span><br><span class="line">	// const output = items[0].json.output;</span><br><span class="line">	const output = $(<span class="string">&#x27;AI Agent&#x27;</span>).first().json.output;</span><br><span class="line"></span><br><span class="line">	// show <span class="built_in">type</span> </span><br><span class="line">	// ? 是「可選鏈結運算子」（optional chaining）；它會在左邊為 null 或 undefined 時直接回傳 undefined，而不是丟錯</span><br><span class="line">	// check array and array</span><br><span class="line">	console.log(<span class="string">&#x27;typeof output:&#x27;</span>, typeof items?.[0]?.json?.output);</span><br><span class="line">	console.log(<span class="string">&#x27;isArray:&#x27;</span>, Array.isArray(items?.[0]?.json?.output));</span><br><span class="line"></span><br><span class="line">	// Try to extract the JSON array from the output string</span><br><span class="line">	// 過濾前後 ```json\n , \n``` 字串</span><br><span class="line">	const jsonStart = output.indexOf(<span class="string">&#x27;[&#x27;</span>);</span><br><span class="line">	const jsonEnd = output.lastIndexOf(<span class="string">&#x27;]&#x27;</span>) + 1;</span><br><span class="line">	const jsonString = output.slice(jsonStart, jsonEnd);</span><br><span class="line">	// Parse the JSON array</span><br><span class="line">	const contacts = JSON.parse(jsonString);</span><br><span class="line"></span><br><span class="line">	// compare contacts vs contacts.map(contact =&gt; (&#123; json: contact &#125;))</span><br><span class="line">	// console.log(contacts);</span><br><span class="line">	// console.log(contacts.map(contact =&gt; (&#123; json: contact &#125;)));</span><br><span class="line"></span><br><span class="line">	// console.log(<span class="string">&#x27;contacts:&#x27;</span>, typeof contacts?.[0]?.json?.Name);</span><br><span class="line">	// 奇怪在 AI Agent 後, 程式中執行 contacts.map(contact =&gt; (&#123; json: contact &#125;)) 就會出問題</span><br><span class="line">	//console.log(<span class="string">&#x27;contacts map:&#x27;</span>, typeof contacts.map(contact =&gt; (&#123; json: contact &#125;)).[0]?.json?.Name);</span><br><span class="line"></span><br><span class="line">	// Optionally, <span class="built_in">return</span> each contact as a separate item <span class="keyword">for</span> downstream nodes (like Sheets)</span><br><span class="line">	// 因 n8n 是透過 json 溝通, 其實沒有差別</span><br><span class="line">	//<span class="built_in">return</span> contacts.map(contact =&gt; (&#123; json: contact &#125;));</span><br><span class="line">	<span class="built_in">return</span> contacts;</span><br><span class="line"></span><br><span class="line"><span class="comment"># sheet --&gt; Append row in sheet(add date and message)</span></span><br><span class="line">Document: Map Searcher</span><br><span class="line">Name: &#123;&#123; <span class="variable">$json</span>.Name &#125;&#125;</span><br><span class="line">Address: &#123;&#123; <span class="variable">$json</span>.Address &#125;&#125;</span><br><span class="line">Phone:  &#123;&#123; <span class="variable">$json</span>.Phone &#125;&#125; - 在最前面要加 space</span><br><span class="line">Website: &#123;&#123; <span class="variable">$json</span>.Website &#125;&#125;</span><br><span class="line">Rating: &#123;&#123; <span class="variable">$json</span>.Rating &#125;&#125;</span><br><span class="line">Opening Hours: &#123;&#123; <span class="variable">$json</span>[<span class="string">&quot;Opening Hours&quot;</span>] &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="❇️-11-120-Nutritionist-AI-Agent-Your-24-x2F-7-Diet-Coach-Chiense"><a href="#❇️-11-120-Nutritionist-AI-Agent-Your-24-x2F-7-Diet-Coach-Chiense" class="headerlink" title="❇️ 11_120 Nutritionist AI Agent - Your 24&#x2F;7 Diet Coach(Chiense)"></a>❇️ 11_120 Nutritionist AI Agent - Your 24&#x2F;7 Diet Coach(Chiense)</h4> <div style="max-width:1000px">
    <img src="/2025/09/28/n8n-3/pic_11_120.png" class="" title="pic_11_120">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Telegram --&gt; On message</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># switch</span></span><br><span class="line">	&#123;&#123; <span class="variable">$json</span>.message.text &#125;&#125;: exists</span><br><span class="line">	Rename Output: Enable</span><br><span class="line">	Output Name: Text</span><br><span class="line"></span><br><span class="line">	&#123;&#123; <span class="variable">$json</span>.message.voice.file_id &#125;&#125;: exists</span><br><span class="line">	Rename Output: Enable</span><br><span class="line">	Output Name: Voice</span><br><span class="line"></span><br><span class="line">	&#123;&#123; <span class="variable">$json</span>.message.photo[1].file_id &#125;&#125;:exists</span><br><span class="line">	Rename Output: Enable</span><br><span class="line">	Output Name: Image</span><br><span class="line"></span><br><span class="line"><span class="comment"># switch - Image ===============</span></span><br><span class="line"><span class="comment"># Telegram --&gt; get a file</span></span><br><span class="line">File ID: &#123;&#123; <span class="variable">$json</span>.message.photo[1].file_id &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># (1) Gemini -&gt; Analyze Image</span></span><br><span class="line">	你是一位專業的營養分析師。</span><br><span class="line">	你的目標是針對每一個在此食物照片中可見的項目進行分析，並輸出一份結構清晰、包含熱量及三大營養素（碳水化合物、蛋白質、脂肪）估算值的 JSON 檔案。</span><br><span class="line"></span><br><span class="line">	<span class="comment">## 核心功能</span></span><br><span class="line">	Text input:</span><br><span class="line">	- 當顯示一張食物照片時，識別每一項食物及其主要成分（蛋白質、碳水、脂肪等）。</span><br><span class="line">	- 假設比例參照標準（例如：26 公分的晚餐盤、250 毫升的杯子、標準餐叉大小）。</span><br><span class="line">	- 若看起來是餐廳料理，需假設額外的烹調用油：每份增加約 1 大匙（14 公克）的炒或醬用油脂。</span><br><span class="line">	- 以公克為單位估算份量。根據照片裡的參考物件（杯子、標準玻璃杯大小、麵包尺寸、常見餐具等）來推算比例。</span><br><span class="line">	- 使假設盡量貼近現實，優先選擇常見的份量大小。</span><br><span class="line">	- 列出你用來估計尺寸的各種假設（形狀、密度、覆蓋率等）。</span><br><span class="line">	- 依據可靠的資料庫（例如 USDA FoodData Central、歐洲對應資料庫）估算每項食物的熱量及三大營養素，並校正餐廳料理的額外油脂。</span><br><span class="line">	- 記錄可見的烹調方式或添加物（食用油、醬料、奶油等）。</span><br><span class="line">	- 為每項食物計算熱量並提供合理範圍。</span><br><span class="line">	- 加總總熱量範圍。</span><br><span class="line"></span><br><span class="line">	<span class="comment">## JSON 輸出格式</span></span><br><span class="line">	text</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="string">&quot;overview&quot;</span>: <span class="string">&quot;對整體餐盤或餐點的簡單說明&quot;</span>,</span><br><span class="line">	<span class="string">&quot;short_name&quot;</span>: <span class="string">&quot;漢堡配薯條&quot;</span>,</span><br><span class="line">	<span class="string">&quot;items&quot;</span>: [</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="string">&quot;name&quot;</span>: <span class="string">&quot;食物名稱&quot;</span>,</span><br><span class="line">			<span class="string">&quot;type&quot;</span>: <span class="string">&quot;protein | carb | fat | beverage | 等等&quot;</span>,</span><br><span class="line">			<span class="string">&quot;portion_size&quot;</span>: <span class="string">&quot;例如 1 杯、2 片&quot;</span>,</span><br><span class="line">			<span class="string">&quot;cooking_method&quot;</span>: <span class="string">&quot;明顯者需填&quot;</span>,</span><br><span class="line">			<span class="string">&quot;macros_g&quot;</span>: &#123;</span><br><span class="line">				<span class="string">&quot;protein&quot;</span>: 0,</span><br><span class="line">				<span class="string">&quot;carbs&quot;</span>: 0,</span><br><span class="line">				<span class="string">&quot;fat&quot;</span>: 0</span><br><span class="line">			&#125;,</span><br><span class="line">			<span class="string">&quot;calories_kcal&quot;</span>: &#123;</span><br><span class="line">				<span class="string">&quot;low&quot;</span>: 0,</span><br><span class="line">				<span class="string">&quot;high&quot;</span>: 0</span><br><span class="line">			&#125;,</span><br><span class="line">			<span class="string">&quot;assumptions&quot;</span>: <span class="string">&quot;所有你推估時的假設&quot;</span></span><br><span class="line">		&#125;</span><br><span class="line">	],</span><br><span class="line">	<span class="string">&quot;total_calories_kcal&quot;</span>: &#123;</span><br><span class="line">		<span class="string">&quot;low&quot;</span>: 0,</span><br><span class="line">		<span class="string">&quot;high&quot;</span>: 0</span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">&quot;total_macros&quot;</span>: &#123;</span><br><span class="line">		<span class="string">&quot;proteins&quot;</span>: &#123;</span><br><span class="line">			<span class="string">&quot;low&quot;</span>: 0,</span><br><span class="line">			<span class="string">&quot;high&quot;</span>: 0</span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="string">&quot;carbs&quot;</span>: &#123;</span><br><span class="line">			<span class="string">&quot;low&quot;</span>: 0,</span><br><span class="line">			<span class="string">&quot;high&quot;</span>: 0</span><br><span class="line">		&#125;,</span><br><span class="line">		<span class="string">&quot;fat&quot;</span>: &#123;</span><br><span class="line">			<span class="string">&quot;low&quot;</span>: 0,</span><br><span class="line">			<span class="string">&quot;high&quot;</span>: 0</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;,</span><br><span class="line">	<span class="string">&quot;notes&quot;</span>: <span class="string">&quot;所有限制、‘估算有誤差’等備註&quot;</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">## 食物分析指引</span></span><br><span class="line">	- 先對整份餐點寫一段「overview」簡介。</span><br><span class="line">	- 每一個項目都要填寫所有欄位。</span><br><span class="line">	- 熱量採「最低—最高」區間呈現。</span><br><span class="line">	- 在「assumptions」欄說明你的估算依據。</span><br><span class="line">	- 若照片不清楚或你無法確定，請在「notes」欄標註警語。</span><br><span class="line">	- 若用戶留下食物額外說明，也一併納入（這是自願性的）：</span><br><span class="line">	&#123;&#123; $(<span class="string">&#x27;Telegram Trigger&#x27;</span>).item.json.message.caption &#125;&#125;</span><br><span class="line">Input Type: Binary File(s)</span><br><span class="line">Input Data Field Name(s): data</span><br><span class="line"></span><br><span class="line"><span class="comment"># (1) Edit Field - Colories &amp; Macros</span></span><br><span class="line">text(object):</span><br><span class="line">&#123;&#123;    </span><br><span class="line">  JSON.stringify(</span><br><span class="line">    JSON.parse(       </span><br><span class="line">        <span class="variable">$json</span>.content.parts.first().text</span><br><span class="line">        .replace(/```(?:json)?\s*/g, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        .trim()      </span><br><span class="line">    ),</span><br><span class="line">    null,</span><br><span class="line">    2</span><br><span class="line">  )</span><br><span class="line">&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># (2) Drive --&gt; upload file</span></span><br><span class="line">	File Name: &#123;&#123;<span class="variable">$now</span>.format(<span class="string">&#x27;yyyy-MM-dd HH:mm&#x27;</span>)&#125;&#125;.png</span><br><span class="line">	Parent Drive: My Drive</span><br><span class="line">	Parent Folder: n8n_working</span><br><span class="line"></span><br><span class="line"><span class="comment"># (2) Edit Field - Image Link</span></span><br><span class="line">	image_url: &#123;&#123; <span class="variable">$json</span>.webViewLink &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Merge</span></span><br><span class="line">Mode: Combine</span><br><span class="line">Combine By: All Possible Combinations</span><br><span class="line"></span><br><span class="line"><span class="comment"># sheet --&gt; Append row in sheet</span></span><br><span class="line">Document: Food Data</span><br><span class="line">Sheet: Food Data</span><br><span class="line">Mapping Column Mode: Map Each Column Manually</span><br><span class="line">	Name: &#123;&#123; $(<span class="string">&#x27;Telegram Trigger&#x27;</span>).item.json.message.chat.first_name &#125;&#125;</span><br><span class="line">	Date: &#123;&#123; <span class="variable">$now</span>.format(<span class="string">&#x27;yyyy-MM-dd&#x27;</span>) &#125;&#125;</span><br><span class="line">	Time: &#123;&#123; <span class="variable">$now</span>.format(<span class="string">&#x27;HH:mm&#x27;</span>) &#125;&#125;</span><br><span class="line">	Food: &#123;&#123; <span class="variable">$json</span>.text.short_name &#125;&#125;</span><br><span class="line">	Calories: &#123;&#123; (<span class="variable">$json</span>.text.total_calories_kcal.low +  <span class="variable">$json</span>.text.total_calories_kcal.high)/2&#125;&#125; kcal</span><br><span class="line">	Proteins: &#123;&#123; (<span class="variable">$json</span>.text.total_macros.proteins.low + <span class="variable">$json</span>.text.total_macros.proteins.high)/2 &#125;&#125;</span><br><span class="line">	Carbs: &#123;&#123; (<span class="variable">$json</span>.text.total_macros.carbs.low + <span class="variable">$json</span>.text.total_macros.carbs.high)/2&#125;&#125;</span><br><span class="line">	Fat: &#123;&#123; (<span class="variable">$json</span>.text.total_macros.fat.low +  <span class="variable">$json</span>.text.total_macros.fat.high)/2 &#125;&#125;</span><br><span class="line">	Picture: &#123;&#123; <span class="variable">$json</span>.image_url &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># sheet --&gt; get row in sheet</span></span><br><span class="line">Document: Food Data</span><br><span class="line">Sheet: Goals</span><br><span class="line">Filters: Column:Name, Value: &#123;&#123; <span class="variable">$json</span>.Name &#125;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment"># AI Agent (Motivation Cocah AI Agent)</span></span><br><span class="line">Prompt (User Message)</span><br><span class="line">	你是一個營養助手，幫助用戶追蹤並了解他們的飲食。</span><br><span class="line"></span><br><span class="line">	你會收到食物資訊，請用以下格式呈現：</span><br><span class="line"></span><br><span class="line">	熱量：XXX kcal</span><br><span class="line">	蛋白質：XXg</span><br><span class="line">	碳水：XXg</span><br><span class="line">	脂肪：XXg</span><br><span class="line"></span><br><span class="line">	<span class="comment">## 餐點名稱：[餐點名稱]</span></span><br><span class="line"></span><br><span class="line">	接著根據食物和用戶目標，給予最多2句（合計不超過120字的）教練建議。</span><br><span class="line"></span><br><span class="line">	以下是食物資訊（無需重複）：</span><br><span class="line">	&#123;&#123; JSON.stringify($(<span class="string">&#x27;Merge&#x27;</span>).item.json.text,null,2) &#125;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">## 用戶目標：&#123;&#123; $json.Goal &#125;&#125;</span></span><br><span class="line">	- 每日目標：&#123;&#123; <span class="variable">$json</span>[<span class="string">&#x27;Daily Goal&#x27;</span>] &#125;&#125; kcal</span><br><span class="line">	- 目標赤字：&#123;&#123; <span class="variable">$json</span>[<span class="string">&#x27;Target Deficit&#x27;</span>] &#125;&#125; kcal</span><br><span class="line">	- 維持熱量：&#123;&#123; <span class="variable">$json</span>.Mantain &#125;&#125; kcal</span><br><span class="line"></span><br><span class="line">	<span class="comment">## 教練建議規則（僅選擇一個符合的）：</span></span><br><span class="line">	- 達標餐點（營養素均衡且符合目標） → 鼓勵並提醒持續努力。</span><br><span class="line">	範例：選得很好！保持下去，持續達成你的目標。</span><br><span class="line">	- 餐廳/速食餐點 → 評論目標是否符合並提醒隱藏成分。</span><br><span class="line">	範例：符合你的目標，但注意油和醬料。下次可嘗試自己料理！</span><br><span class="line">	- 不健康或高熱量餐點 → 明確提醒不符合目標，敦促回歸正軌。</span><br><span class="line">	範例：這不符合你的目標，請調整心態並重新回到正軌。</span><br><span class="line"></span><br><span class="line">	<span class="comment">## 不健康食物警示條件（如適用）：</span></span><br><span class="line">	- 高反式/飽和脂肪 → 炸物、糕點、加工肉品</span><br><span class="line">	- 過量糖分 → 糖果、汽水、甜麥片</span><br><span class="line">	- 精緻碳水 → 白麵包、白米、糕點</span><br><span class="line">	- 高鈉 → 罐頭、加工或醃製食品</span><br><span class="line">	- 低營養密度 → 空熱量食物</span><br><span class="line">	運用以上參考決定食物是否不健康。</span><br><span class="line"></span><br><span class="line">	<span class="comment">## 請僅回覆：</span></span><br><span class="line">	- 格式化的營養成分與餐點名稱</span><br><span class="line">	- 最多2句簡短教練建議（合計限120字）</span><br><span class="line">	- 不加標籤、不用表情符號、不額外說明</span><br><span class="line">Chat Model: Google Gemini Chat Model</span><br><span class="line"></span><br><span class="line"><span class="comment"># Telegram --&gt; send a text message</span></span><br><span class="line">Chat ID: &#123;&#123; $(<span class="string">&#x27;Telegram Trigger&#x27;</span>).item.json.message.chat.id &#125;&#125;</span><br><span class="line">Text: &#123;&#123; <span class="variable">$json</span>.output &#125;&#125;</span><br><span class="line"><span class="comment"># switch - Image ===============</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># switch - voice ===============</span></span><br><span class="line"><span class="comment"># Telegram --&gt; get a file</span></span><br><span class="line">File ID: &#123;&#123; <span class="variable">$json</span>.message.voice.file_id &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gemini --&gt; Transcribe a recoording</span></span><br><span class="line">Input Type: Binary File(s)</span><br><span class="line">Input Data Field Name(s): data</span><br><span class="line"><span class="comment"># switch - voice ===============</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Code(Food)</span></span><br><span class="line">	<span class="built_in">let</span> text = null;</span><br><span class="line">	<span class="built_in">let</span> voice = null;</span><br><span class="line"></span><br><span class="line">	try &#123;</span><br><span class="line">		text = <span class="variable">$input</span>.all(0)[0].json.message.text;</span><br><span class="line">	&#125; catch(e) &#123;</span><br><span class="line">		console.log(<span class="string">&quot;01:&quot;</span>, e);</span><br><span class="line">		// ..</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	try &#123;</span><br><span class="line">		voice = <span class="variable">$input</span>.all(1)[0].json.content.parts[0].text;</span><br><span class="line">	&#125; catch(e) &#123;</span><br><span class="line">		// ..</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	const output = &#123;</span><br><span class="line">		text : text ? text : voice ? voice : <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">return</span> output ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># (1) sheet --&gt; get rows in sheet</span></span><br><span class="line">Document: Food Data</span><br><span class="line">Sheet: Food Data</span><br><span class="line">Filters:  Name: &#123;&#123; $(<span class="string">&#x27;Telegram Trigger&#x27;</span>).item.json.message.from.first_name &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># (1) Aggregate</span></span><br><span class="line">Aggregate: All Item Data (Into a Single List)</span><br><span class="line">Put Output <span class="keyword">in</span> Field: data</span><br><span class="line">Include: All Fields</span><br><span class="line"></span><br><span class="line"><span class="comment"># (2) sheet --&gt; get rows  in sheet</span></span><br><span class="line">Document: Food Data</span><br><span class="line">Sheet: Goals</span><br><span class="line">Filters:  Name: &#123;&#123; $(<span class="string">&#x27;Telegram Trigger&#x27;</span>).item.json.message.from.first_name &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Merge </span></span><br><span class="line">Mode: Combine</span><br><span class="line">Combine By: All Possible Combinations</span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent</span></span><br><span class="line">Prompt (User Message):</span><br><span class="line">	你是一位有資深的營養助理。</span><br><span class="line"></span><br><span class="line">	你的任務是分析用戶過去七天（如果數據不足則以可用天數為準）的飲食紀錄，</span><br><span class="line">	並判斷他們在維持目標熱量下是否能夠食用所要求的食物或飲品。</span><br><span class="line"></span><br><span class="line">	用戶姓名：&#123;&#123; $(<span class="string">&#x27;Telegram Trigger&#x27;</span>).item.json.message.from.first_name &#125;&#125;</span><br><span class="line">	請求項目：&#123;&#123; $(<span class="string">&#x27;Food&#x27;</span>).item.json.text &#125;&#125;</span><br><span class="line">	今天日期：&#123;&#123; <span class="variable">$now</span> &#125;&#125;</span><br><span class="line">	用戶目標：&#123;&#123; <span class="variable">$json</span>.Goal &#125;&#125;</span><br><span class="line">	每日熱量目標：&#123;&#123; <span class="variable">$json</span>[<span class="string">&#x27;Daily Goal&#x27;</span>] &#125;&#125; 大卡</span><br><span class="line"></span><br><span class="line">	以下是用戶的飲食紀錄：</span><br><span class="line">	&#123;&#123; JSON.stringify($(<span class="string">&#x27;Aggregate&#x27;</span>).item.json.data, null, 2) &#125;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">## 請依照以下步驟分析：</span></span><br><span class="line">	1. 計算過去七天（或可用天數）總攝取熱量。</span><br><span class="line">	2. 用每日目標乘以天數，算出可攝取總熱量。</span><br><span class="line">	3. 用總允許熱量減去已攝取熱量，得出剩餘可攝取熱量。</span><br><span class="line">	4. 查詢所要求食物或飲品每一標準份量的熱量。</span><br><span class="line">	- 如果是飲品（例如雞尾酒、啤酒、葡萄酒），計算在剩下熱量下可喝幾份。</span><br><span class="line">	- 如果是單份食物（例如披薩、漢堡附薯條），假設只吃一份，檢查這份是否在允許範圍內。</span><br><span class="line"></span><br><span class="line">	<span class="comment">## 格式化規則：</span></span><br><span class="line">	- 所有熱量以百位數四捨五入。</span><br><span class="line">	- 回覆請用簡單、清楚的語言（適合小學六年級到國中二年級）。</span><br><span class="line">	- 只出現一句簡短語句。</span><br><span class="line">	- 不重複用戶問題內容。</span><br><span class="line"></span><br><span class="line">	<span class="comment">## 請用下列其中之一格式回答：</span></span><br><span class="line">	- 如果符合攝取標準：</span><br><span class="line">	「你還有[X]大卡可以攝取，所以你可以吃／喝 &#123;&#123; $(<span class="string">&#x27;Food&#x27;</span>).item.json.text &#125;&#125;，並維持最近y天的熱量赤字。」- (&#123;&#123; $(<span class="string">&#x27;Food&#x27;</span>).item.json.text &#125;&#125;  熱量為 [X]大卡)</span><br><span class="line">	- 如果不符合攝取標準：</span><br><span class="line">	「你還有[X]大卡可以攝取，所以你無法吃／喝 &#123;&#123; $(<span class="string">&#x27;Food&#x27;</span>).item.json.text &#125;&#125;，並維持最近y天的熱量赤字。」- ( &#123;&#123; $(<span class="string">&#x27;Food&#x27;</span>).item.json.text &#125;&#125; &#125;&#125; 熱量為 [X]大卡)</span><br><span class="line">	- 依食物自動選擇吃或喝字動截取食物名稱而不是整個輸入</span><br><span class="line">	- 不要多做說明，不要有表情符號，不要多加建議。</span><br><span class="line">Chat Model:Google Gemini Chat Model</span><br><span class="line">Memory: Simple Memory</span><br><span class="line">	Session ID: Define below</span><br><span class="line">	Key: &#123;&#123; $(<span class="string">&#x27;Telegram Trigger&#x27;</span>).item.json.message.chat.id &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Telegram --&gt; send a text message</span></span><br><span class="line">Chat ID: &#123;&#123; $(<span class="string">&#x27;Telegram Trigger&#x27;</span>).item.json.message.chat.id &#125;&#125;</span><br><span class="line">Text: &#123;&#123; <span class="variable">$json</span>.output &#125;&#125;</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/n8n/" rel="tag"># n8n</a>
              <a href="/tags/udemy/" rel="tag"># udemy</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/08/02/ai-15/" rel="prev" title="GenAI">
                  <i class="fa fa-chevron-left"></i> GenAI
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/10/30/youtube-3/" rel="next" title="Youtube - Priority List">
                  Youtube - Priority List <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    
  <div class="comments" id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Robert Kao</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="總字數">2.7m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="所需總閱讀時間">40:58</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 強力驅動
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="/js/local-search.js"></script>






  




  


<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://hot5656-blog.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://hot5656.github.io/2025/09/28/n8n-3/";
    this.page.identifier = "2025/09/28/n8n-3/";
    this.page.title = "n8n - AI Agents, AI Automations & AI Voice Agents (2)<br> Business & Support AI Agents";
    };
  NexT.utils.loadComments('#disqus_thread', () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://hot5656-blog.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
