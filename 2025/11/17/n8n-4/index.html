<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hot5656.github.io","root":"/","images":"/images","scheme":"Gemini","version":"8.2.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜尋...","empty":"我們無法找到任何有關 ${query} 的搜索結果","hits_time":"${hits} 找到 ${time} 個結果","hits":"找到 ${hits} 個結果"},"path":"/search.json","localsearch":{"enable":"enable","trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false}};
  </script>
<meta name="description" content="workflow">
<meta property="og:type" content="article">
<meta property="og:title" content="n8n - AI Agents, AI Automations &amp; AI Voice Agents (3)&lt;br&gt; RAG &amp; Research AI Agents">
<meta property="og:url" content="https://hot5656.github.io/2025/11/17/n8n-4/index.html">
<meta property="og:site_name" content="Robert 雜記">
<meta property="og:description" content="workflow">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://hot5656.github.io/2025/11/17/n8n-4/pic_12_122.png">
<meta property="og:image" content="https://hot5656.github.io/2025/11/17/n8n-4/pic_12_123.png">
<meta property="og:image" content="https://hot5656.github.io/2025/11/17/n8n-4/pic_12_124.png">
<meta property="og:image" content="https://hot5656.github.io/2025/11/17/n8n-4/pic_12_125.png">
<meta property="og:image" content="https://hot5656.github.io/2025/11/17/n8n-4/pic_12_126.png">
<meta property="og:image" content="https://hot5656.github.io/2025/11/17/n8n-4/pic_12_127.png">
<meta property="og:image" content="https://hot5656.github.io/2025/11/17/n8n-4/pic_12_128.png">
<meta property="article:published_time" content="2025-11-17T07:18:34.000Z">
<meta property="article:modified_time" content="2025-12-04T03:30:04.622Z">
<meta property="article:author" content="Robert Kao">
<meta property="article:tag" content="n8n">
<meta property="article:tag" content="udemy">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hot5656.github.io/2025/11/17/n8n-4/pic_12_122.png">


<link rel="canonical" href="https://hot5656.github.io/2025/11/17/n8n-4/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-TW'
  };
</script>
<title>n8n - AI Agents, AI Automations & AI Voice Agents (3)<br> RAG & Research AI Agents | Robert 雜記</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Robert 雜記</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首頁</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>標籤</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分類</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>歸檔列表</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜尋
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜尋..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#workflow"><span class="nav-number">1.</span> <span class="nav-text">workflow</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#12-122-Build-RAG-Agent-with-n8n-amp-Pinecorn-save-RAG"><span class="nav-number">1.1.</span> <span class="nav-text">12_122 Build RAG Agent with n8n &amp; Pinecorn(save RAG)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-122-Build-RAG-Agent-with-n8n-amp-Pinecorn-ask-for-RAG"><span class="nav-number">1.2.</span> <span class="nav-text">12_122 Build RAG Agent with n8n &amp; Pinecorn(ask for RAG)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-123-DeepSeek-R1-Planner-Gemini"><span class="nav-number">1.3.</span> <span class="nav-text">12_123 DeepSeek R1 Planner(Gemini)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-124-Build-AI-Agent-that-Remembers-Everything-Supabase-VB-PostgreSQL-save-communication-amp-get-RAG"><span class="nav-number">1.4.</span> <span class="nav-text">12_124 Build AI Agent that Remembers Everything(Supabase VB + PostgreSQL) - save communication &amp; get RAG</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-124-Build-AI-Agent-that-Remembers-Everything-Supabase-VB-PostgreSQL-load-document"><span class="nav-number">1.5.</span> <span class="nav-text">12_124 Build AI Agent that Remembers Everything(Supabase VB + PostgreSQL) - load document</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%9D%87%EF%B8%8F-12-125-Build-DeepSeek-R1-WhatApp-AI-Agent-to-Plan-and-Research-llama-Telegram"><span class="nav-number">1.6.</span> <span class="nav-text">❇️ 12_125 Build DeepSeek R1 WhatApp AI Agent to Plan and Research(llama + Telegram)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%9D%87%EF%B8%8F-12-126-WhatsApp-AI-Custom-Support-amp-low-ticket-Slaes-Agent-Telegram-put-document-to-Supabase"><span class="nav-number">1.7.</span> <span class="nav-text">❇️ 12_126 WhatsApp AI Custom Support &amp; low-ticket Slaes Agent(Telegram) - put document to Supabase</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-126-WhatsApp-AI-Custom-Support-amp-low-ticket-Slaes-Agent-Telegram-Servicew-Agent"><span class="nav-number">1.8.</span> <span class="nav-text">12_126 WhatsApp AI Custom Support &amp; low-ticket Slaes Agent(Telegram) - Servicew Agent</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%9D%87%EF%B8%8F-12-127-Day-Trading-Ai-Agent"><span class="nav-number">1.9.</span> <span class="nav-text">❇️ 12_127 Day Trading Ai Agent</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E2%9D%87%EF%B8%8F-12-128-X-Ai-Agent-Finds-the-Hottest-News-on-Any-topic"><span class="nav-number">1.10.</span> <span class="nav-text">❇️ 12_128 X Ai Agent Finds the Hottest News on  Any topic</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#12-129-Spotify-AI-Agent-Build-Smart-Palylist"><span class="nav-number">1.11.</span> <span class="nav-text">12_129 Spotify AI Agent Build Smart Palylist</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Robert Kao"
      src="/images/head.png">
  <p class="site-author-name" itemprop="name">Robert Kao</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">171</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">66</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
        <div class="back-to-top animated" role="button">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://hot5656.github.io/2025/11/17/n8n-4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="Robert Kao">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Robert 雜記">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          n8n - AI Agents, AI Automations & AI Voice Agents (3)<br> RAG & Research AI Agents
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2025-11-17 15:18:34" itemprop="dateCreated datePublished" datetime="2025-11-17T15:18:34+08:00">2025-11-17</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2025-12-04 11:30:04" itemprop="dateModified" datetime="2025-12-04T11:30:04+08:00">2025-12-04</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/AI/" itemprop="url" rel="index"><span itemprop="name">AI</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2025/11/17/n8n-4/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2025/11/17/n8n-4/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>24k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>22 分鐘</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h3 id="workflow"><a href="#workflow" class="headerlink" title="workflow"></a>workflow</h3><span id="more"></span>

<h4 id="12-122-Build-RAG-Agent-with-n8n-amp-Pinecorn-save-RAG"><a href="#12-122-Build-RAG-Agent-with-n8n-amp-Pinecorn-save-RAG" class="headerlink" title="12_122 Build RAG Agent with n8n &amp; Pinecorn(save RAG)"></a>12_122 Build RAG Agent with n8n &amp; Pinecorn(save RAG)</h4><div style="max-width:700px">
    <img src="/2025/11/17/n8n-4/pic_12_122.png" class="" title="pic_12_122">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Drive --&gt; On changes involving a specific folder</span></span><br><span class="line">Folder(By ID): ...(<span class="keyword">for</span> First RAG Agent)</span><br><span class="line">Watch For: File Created</span><br><span class="line"></span><br><span class="line"><span class="comment"># Drive --&gt; Download file</span></span><br><span class="line">File(By ID) : &#123;&#123; <span class="variable">$json</span>.id &#125;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment"># pinecorn  Vector Store --&gt; add docuemnts to vector store</span></span><br><span class="line">Pinecone Index(From list): n8nragagent</span><br><span class="line">Options:</span><br><span class="line">  Pinecone Namespace: ragagent or ragagent2(更改空間)</span><br><span class="line">Embedding Document: Embedding Google Gemini</span><br><span class="line">Data loader:　Default Data loader</span><br><span class="line">  Type of Data: Binary</span><br><span class="line">  Mode: Load All Input Data</span><br><span class="line">  Data Format: PDF</span><br><span class="line">  Text Splitting: Custom (外接 Text Splitter)</span><br><span class="line">  ext Splitter　--&gt; add <span class="string">&quot;Recursive Character Text Splitter&quot;</span>(以下設定有較好的效率)</span><br><span class="line">            Chunk Size: 900</span><br><span class="line">            Chunk Overlap: 50</span><br><span class="line">  Options</span><br><span class="line">    Metadata: (可使用於搜尋時加過濾條件)</span><br><span class="line">      Name: Apple</span><br><span class="line">      Value: &#123;&#123; <span class="variable">$json</span>.name &#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="12-122-Build-RAG-Agent-with-n8n-amp-Pinecorn-ask-for-RAG"><a href="#12-122-Build-RAG-Agent-with-n8n-amp-Pinecorn-ask-for-RAG" class="headerlink" title="12_122 Build RAG Agent with n8n &amp; Pinecorn(ask for RAG)"></a>12_122 Build RAG Agent with n8n &amp; Pinecorn(ask for RAG)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># chat trigger</span></span><br><span class="line">what about Image Playground</span><br><span class="line">what about Writing Tools</span><br><span class="line"><span class="string">&quot;I am robert, I like dog</span></span><br><span class="line"><span class="string">What&#x27;s my name and what animal do I like?</span></span><br><span class="line"><span class="string">what I aks previous ?&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent</span></span><br><span class="line">System Message: </span><br><span class="line">  <span class="string">&quot;</span></span><br><span class="line"><span class="string">  # Role  </span></span><br><span class="line"><span class="string">  You are an AI assistant designed to answer questions about iOS 18, based on the official feature documents stored in the TOOL&#x27;s &quot;</span>iOS RAG<span class="string">&quot; vector database.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # Objective  </span></span><br><span class="line"><span class="string">  Your goal is to help users understand the new features, settings, and changes introduced in iOS 18. All answers should come directly from the information found in the vector database.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  If a user asks about something not covered in the stored content, let them know that the information isn’t currently available.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  # Rules  </span></span><br><span class="line"><span class="string">  - if cannot link to &quot;</span>iOS RAG<span class="string">&quot; just response unknow</span></span><br><span class="line"><span class="string">  - Use bullet points or short paragraphs for lists or multiple features.  </span></span><br><span class="line"><span class="string">  - Do not guess or assume anything. Use only the verified data from the vector database.  </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  Your main goal: Provide helpful, accurate, and easy-to-understand answers using only the stored documents — no speculation or outside sources.  </span></span><br><span class="line"><span class="string">  &quot;</span></span><br><span class="line">Chat Mode: Google gemini Chat model</span><br><span class="line">meomey : simple memory : context window length:10</span><br><span class="line">Tool: Answer questions with a vector store (iOS RAG)</span><br><span class="line">  Description of Data: <span class="keyword">for</span> ask IOS</span><br><span class="line">  Model: gemin chat model</span><br><span class="line">  Vector store:Pinecone Vector Store </span><br><span class="line">    Operation Mode: Retrieve Documents (As Vector Store <span class="keyword">for</span> Chain/Tool)</span><br><span class="line">    Pinecone Index(From list): n8nragagent</span><br><span class="line">    Options: </span><br><span class="line">      Pinecone Namespace: ragagent or or ragagent2(更改空間)</span><br><span class="line">    Embedding: embedding google gemini</span><br></pre></td></tr></table></figure>

<h4 id="12-123-DeepSeek-R1-Planner-Gemini"><a href="#12-123-DeepSeek-R1-Planner-Gemini" class="headerlink" title="12_123 DeepSeek R1 Planner(Gemini)"></a>12_123 DeepSeek R1 Planner(Gemini)</h4><div style="max-width:700px">
    <img src="/2025/11/17/n8n-4/pic_12_123.png" class="" title="pic_12_123">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># On chat message</span></span><br><span class="line"><span class="string">&quot;</span></span><br><span class="line"><span class="string">Schedule a meeting for me with Jack. Her email is kyp001@gmail.com at 1 pm on November 21th, 2025, for 1 hour. Also, please send an email to her.</span></span><br><span class="line"><span class="string">&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent(Planner AI Agent)</span></span><br><span class="line">System Message:</span><br><span class="line">  ** Mission **</span><br><span class="line">  You are an AI tasked with drafting clear, practical prompts that <span class="built_in">help</span> a personal assistant complete any job at hand.</span><br><span class="line"></span><br><span class="line">  ** Operating Scope **</span><br><span class="line">  - No external tools or references.</span><br><span class="line">  - Keep every instruction brief, ordered, and unmistakable.</span><br><span class="line">  - Jobs can be simple or complex, but your wording must remain straightforward.</span><br><span class="line"></span><br><span class="line">  ** Workflow **</span><br><span class="line">  - Receive the user’s request.</span><br><span class="line">  - Decompose the request into a short series of logical actions.</span><br><span class="line">  - Write each action so it can be executed immediately—no guesswork.</span><br><span class="line">  - Note prerequisites or context the assistant needs to know.</span><br><span class="line">  - Proof-read the prompt <span class="keyword">for</span> clarity and fullness before sending it.</span><br><span class="line"></span><br><span class="line">  ** Illustrative Scenarios **</span><br><span class="line"></span><br><span class="line">  Example 1:</span><br><span class="line">  --------User Request</span><br><span class="line">  “Book a doctor’s appointment <span class="keyword">for</span> next week.”</span><br><span class="line"></span><br><span class="line">  --------Prompt You Produce</span><br><span class="line">  1. Find open slots with the doctor next week. 2. Pick a time that doesn’t clash with existing events.</span><br><span class="line">  3. Book the slot by phone or online. 4. Add the appointment to the calendar.</span><br><span class="line"></span><br><span class="line">  Example 2:</span><br><span class="line">  --------User Request</span><br><span class="line">  “Get ready <span class="keyword">for</span> John’s birthday party.”</span><br><span class="line"></span><br><span class="line">  --------Prompt You Produce</span><br><span class="line">  1. Select a date and time <span class="keyword">for</span> the party. 2. Draft a guest list. 3. Buy and <span class="built_in">set</span> up decorations beforehand.</span><br><span class="line">  4. Arrange food and drinks. 5. Send invitations.</span><br><span class="line"></span><br><span class="line">  ** Operating Checklist (SOP) **</span><br><span class="line">  - Hear the goal.</span><br><span class="line">  - Break it into clear, ordered, actionable steps.</span><br><span class="line">  - Supply any needed background details.</span><br><span class="line">  - Double-check that the plan is complete and plain.</span><br><span class="line">  - Deliver the polished prompt to the assistant.</span><br><span class="line"></span><br><span class="line">  ** Closing Reminders **</span><br><span class="line">  - Favor simplicity over flourish.</span><br><span class="line">  - Omit anything irrelevant or overly wordy.</span><br><span class="line">  - Hand over a ready-to-execute plan that needs no further clarification.</span><br><span class="line">  - Current date/time: &#123;&#123; <span class="variable">$now</span> &#125;&#125;</span><br><span class="line">Caht Model: Google Gemini chat Model</span><br><span class="line">Memory: Simple Memory</span><br><span class="line">  Context Window Length: 10</span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent(Execute AI AGent)</span></span><br><span class="line">Source <span class="keyword">for</span> Prompt (User Message): Define below</span><br><span class="line">Prompt (User Message): &#123;&#123; <span class="variable">$json</span>.output &#125;&#125;</span><br><span class="line">System Message:</span><br><span class="line">  <span class="comment"># Tool</span></span><br><span class="line">  - Send a message <span class="keyword">in</span> Gmail: support send email</span><br><span class="line">  - Create an event <span class="keyword">in</span> Google Calendar: support <span class="built_in">set</span> calendar event</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Note</span></span><br><span class="line">  - Don<span class="string">&#x27;t need to wait for an email response, directly set a calendar event and give a proper title</span></span><br><span class="line"><span class="string">  - my name is Robert</span></span><br><span class="line"><span class="string">  - The email use HTMl format</span></span><br><span class="line"><span class="string">  - Directly do what toy can do, show what you do in output message</span></span><br><span class="line"><span class="string">Caht Model: Google Gemini chat Model</span></span><br><span class="line"><span class="string">Tool: </span></span><br><span class="line"><span class="string">  Gmail Tool</span></span><br><span class="line"><span class="string">    To: &#123;&#123;$fromAI(&#x27;</span>emailAddress<span class="string">&#x27;)&#125;&#125;</span></span><br><span class="line"><span class="string">    Subject: &#123;&#123;$fromAI(&#x27;</span>subject<span class="string">&#x27;)&#125;&#125;</span></span><br><span class="line"><span class="string">    Email Type: HTML</span></span><br><span class="line"><span class="string">    Message: &#123;&#123;$fromAI(&#x27;</span>message<span class="string">&#x27;)&#125;&#125;</span></span><br><span class="line"><span class="string">    Options: Append n8n Attribution: Disable</span></span><br><span class="line"><span class="string">  Google Calendar Tool</span></span><br><span class="line"><span class="string">    Calendar: my_google_email</span></span><br><span class="line"><span class="string">    Start: &#123;&#123; $fromAI(&#x27;</span>startDate<span class="string">&#x27;)&#125;&#125;</span></span><br><span class="line"><span class="string">    End: &#123;&#123; $fromAI(&#x27;</span>endDate<span class="string">&#x27;)&#125;&#125;</span></span><br><span class="line"><span class="string">    Additional Fields</span></span><br><span class="line"><span class="string">      Summary: &#123;&#123; $fromAI(&#x27;</span>title<span class="string">&#x27;)&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="12-124-Build-AI-Agent-that-Remembers-Everything-Supabase-VB-PostgreSQL-save-communication-amp-get-RAG"><a href="#12-124-Build-AI-Agent-that-Remembers-Everything-Supabase-VB-PostgreSQL-save-communication-amp-get-RAG" class="headerlink" title="12_124 Build AI Agent that Remembers Everything(Supabase VB + PostgreSQL) - save communication &amp; get RAG"></a>12_124 Build AI Agent that Remembers Everything(Supabase VB + PostgreSQL) - save communication &amp; get RAG</h4><div style="max-width:700px">
    <img src="/2025/11/17/n8n-4/pic_12_124.png" class="" title="pic_12_124">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># On chat Message</span></span><br><span class="line">hello --&gt; Supabase table n8n_chat_histories can see send and response recorded message</span><br><span class="line">please tell me about <span class="string">&quot;Role&quot;</span></span><br><span class="line">please tell me about <span class="string">&quot;Next Steps&quot;</span></span><br><span class="line">what is the prompt about?</span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent - RAG Agent</span></span><br><span class="line">Chat mode: Google Gemini Chat Model</span><br><span class="line">Memory: Postgres Chat Memoey</span><br><span class="line">Tool: Supabase Vector Store</span><br><span class="line">  Description: Use this to get information about the AI voice Agent prompt</span><br><span class="line">  Table Name: documents</span><br><span class="line">  Embedding: Embeddings Google Gemini</span><br></pre></td></tr></table></figure>

<h4 id="12-124-Build-AI-Agent-that-Remembers-Everything-Supabase-VB-PostgreSQL-load-document"><a href="#12-124-Build-AI-Agent-that-Remembers-Everything-Supabase-VB-PostgreSQL-load-document" class="headerlink" title="12_124 Build AI Agent that Remembers Everything(Supabase VB + PostgreSQL) - load document"></a>12_124 Build AI Agent that Remembers Everything(Supabase VB + PostgreSQL) - load document</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Drive --&gt; download file</span></span><br><span class="line">File: AIVOIC_1.PDF</span><br><span class="line"></span><br><span class="line"><span class="comment"># Superbase Vector Store --&gt; add Documents to vector store</span></span><br><span class="line">Table Name: documents (select when table <span class="string">&quot;documents&quot;</span> create already)</span><br><span class="line">embedding : Embeddings Google Gemini</span><br><span class="line">ocuemnt loader : Default Data loader </span><br><span class="line">  Type of Data: Binary</span><br><span class="line"></span><br><span class="line"><span class="comment"># run load file </span></span><br></pre></td></tr></table></figure>

<h4 id="❇️-12-125-Build-DeepSeek-R1-WhatApp-AI-Agent-to-Plan-and-Research-llama-Telegram"><a href="#❇️-12-125-Build-DeepSeek-R1-WhatApp-AI-Agent-to-Plan-and-Research-llama-Telegram" class="headerlink" title="❇️ 12_125 Build DeepSeek R1 WhatApp AI Agent to Plan and Research(llama + Telegram)"></a>❇️ 12_125 Build DeepSeek R1 WhatApp AI Agent to Plan and Research(llama + Telegram)</h4><div style="max-width:700px">
    <img src="/2025/11/17/n8n-4/pic_12_125.png" class="" title="pic_12_125">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Telegram --&gt; on message</span></span><br><span class="line">Plan a budget-friendly one-month stay <span class="keyword">in</span> Thailand as a digital nomad. I need a cheap place to stay, good Wifi, coworking spaces, and some great traction to visit.</span><br><span class="line">規劃一個預算友好的台灣一個月數位遊牧生活，我需要便宜的住宿、良好的WiFi、共享辦公空間，以及一些很棒的旅遊景點。 </span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent(Planner Agent)</span></span><br><span class="line">Source <span class="keyword">for</span> Prompt (User Message): Define below</span><br><span class="line">Prompt (User Message):</span><br><span class="line">  &#123;&#123; <span class="variable">$json</span>.message.text &#125;&#125;</span><br><span class="line">System Message:</span><br><span class="line">  Role: You are an AI Planner Agent</span><br><span class="line">Chat model : Groq Chat Model</span><br><span class="line">  Model : llama-3.3-70b-versatile</span><br><span class="line">Memory : Simple Memory</span><br><span class="line">  Session ID: Define below</span><br><span class="line">  Key: &#123;&#123; $(<span class="string">&#x27;Telegram Trigger&#x27;</span>).item.json.message.text &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent(Research Agent)</span></span><br><span class="line">Source <span class="keyword">for</span> Prompt (User Message): Define below</span><br><span class="line">Prompt (User Message):</span><br><span class="line">  &#123;&#123;<span class="variable">$json</span>.output&#125;&#125;</span><br><span class="line">System Message:</span><br><span class="line">  <span class="comment"># Role</span></span><br><span class="line">  You are an AI Search Agent integrating SerpAPI to support an AI Travel Planner Agent. Your purpose is to locate and provide comprehensive, actionable information about ALL locations, services, and resources mentioned <span class="keyword">in</span> the Planner<span class="string">&#x27;s structured itinerary.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  ## Task</span></span><br><span class="line"><span class="string">  1. Receive the Planner&#x27;</span>s detailed itinerary input as `&#123;&#123; <span class="variable">$json</span>.output &#125;&#125;`.</span><br><span class="line">  2. the output language same as `&#123;&#123; <span class="variable">$json</span>.output &#125;&#125;`</span><br><span class="line">  3. Extract EVERY specific place, service, or resource mentioned (e.g., hostels like <span class="string">&quot;Stamps Backpackers&quot;</span>, coworking spaces like <span class="string">&quot;Hub53&quot;</span>, attractions like <span class="string">&quot;Doi Suthep&quot;</span>, websites like <span class="string">&quot;Airbnb&quot;</span>).</span><br><span class="line">  4. For EACH item identified, conduct MULTIPLE targeted SerpAPI searches using exact names + locations (e.g., <span class="string">&quot;Stamps Backpackers Chiang Mai official website&quot;</span>, <span class="string">&quot;Hub53 Chiang Mai address booking&quot;</span>).</span><br><span class="line">  5. Provide AT LEAST 3-5 high-quality options per category when possible, including alternatives <span class="keyword">if</span> exact matches are limited.</span><br><span class="line">  6. For every result, include COMPREHENSIVE details:</span><br><span class="line">    - **Name** (full official name)</span><br><span class="line">    - **Exact Location/Address** (street, city, postal code)</span><br><span class="line">    - **Official Website** (direct booking/official links ONLY)</span><br><span class="line">    - **Phone/Contact** (<span class="keyword">if</span> available)</span><br><span class="line">    - **Prices/Rates** (current monthly rates, day passes)</span><br><span class="line">    - **Booking Links** (direct reservation URLs)</span><br><span class="line">    - **Reviews/Ratings** (from Google/Trustpilot)</span><br><span class="line">    - **Key Features** (WiFi speed, amenities, nomad-friendly notes)</span><br><span class="line">    - **Multiple Options** (2-3 alternatives per location)</span><br><span class="line">  7. If exact match not found, provide closest alternatives with explanation and why recommended.</span><br><span class="line">  8. Cover ALL categories: Accommodations, Coworking Spaces, Attractions, WiFi/SIM providers, Transportation, Food markets.</span><br><span class="line">  9. Prioritize 2025 current data from official sites, Booking.com, Airbnb, Google Maps, TripAdvisor.</span><br><span class="line">  10. Structure output by Planner<span class="string">&#x27;s original sections (e.g., &quot;Accommodation Options&quot;, &quot;Coworking Spaces&quot;).</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  ## Output Format</span></span><br><span class="line"><span class="string">  Organize by Planner&#x27;</span>s sections. Use this EXACT plain text template <span class="keyword">for</span> each item:</span><br><span class="line"></span><br><span class="line">  Step/Category Name:</span><br><span class="line">  Name: [Full Name]</span><br><span class="line">  Location: [Complete Address]</span><br><span class="line">  Website: [Direct URL]</span><br><span class="line">  Phone: [Number]</span><br><span class="line">  Prices: [Current Rates]</span><br><span class="line">  Booking: [Direct Link]</span><br><span class="line">  Ratings: [Score/Source]</span><br><span class="line">  Features: [Key Amenities]</span><br><span class="line">  Alternatives:</span><br><span class="line">  - Option 1: [Name, Location, Website]</span><br><span class="line"></span><br><span class="line">  **NEVER use <span class="string">&quot;Note: could not find&quot;</span> - always provide alternatives.**</span><br><span class="line">  **Include 3+ options per category minimum.**</span><br><span class="line">  **Output ONLY structured data, no extra commentary.**</span><br><span class="line">Chat model : Google Gemini Chat Model</span><br><span class="line">Tool : SerpAPI</span><br><span class="line"></span><br><span class="line"><span class="comment"># code</span></span><br><span class="line">const inputData = <span class="variable">$input</span>.first();</span><br><span class="line">const longText = inputData.json.output;</span><br><span class="line"></span><br><span class="line">// 分割長訊息</span><br><span class="line"><span class="keyword">function</span> splitMessage(message, <span class="built_in">limit</span> = 4096) &#123;</span><br><span class="line">  <span class="built_in">let</span> messages = [];</span><br><span class="line">  <span class="built_in">let</span> currentChunk = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  const words = message.split(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">  <span class="keyword">for</span> (const word of words) &#123;</span><br><span class="line">    <span class="keyword">if</span> ((currentChunk + <span class="string">&#x27; &#x27;</span> + word).length &gt; <span class="built_in">limit</span>) &#123;</span><br><span class="line">      messages.push(currentChunk);</span><br><span class="line">      currentChunk = word;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      currentChunk += (currentChunk ? <span class="string">&#x27; &#x27;</span> : <span class="string">&#x27;&#x27;</span>) + word;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (currentChunk) messages.push(currentChunk);</span><br><span class="line">  <span class="built_in">return</span> messages;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 分段後，轉成 n8n 的 items 格式</span><br><span class="line">const chunks = splitMessage(longText, 3600);</span><br><span class="line">const items = chunks.map(chunk =&gt; (&#123;</span><br><span class="line">  json: &#123;</span><br><span class="line">    ...inputData.json,   // 保留原始 json 內容</span><br><span class="line">    output: chunk         // 把 output 改成當前這一段</span><br><span class="line">  &#125;</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="built_in">return</span> items;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Telegram -&gt; Send a text message</span></span><br><span class="line">Chat ID: &#123;&#123; $(<span class="string">&#x27;Telegram Trigger&#x27;</span>).item.json.message.chat.id &#125;&#125;</span><br><span class="line">Text: &#123;&#123; <span class="variable">$json</span>.output &#125;&#125;</span><br><span class="line">Append n8n Attribution: Disable</span><br></pre></td></tr></table></figure>

<h4 id="❇️-12-126-WhatsApp-AI-Custom-Support-amp-low-ticket-Slaes-Agent-Telegram-put-document-to-Supabase"><a href="#❇️-12-126-WhatsApp-AI-Custom-Support-amp-low-ticket-Slaes-Agent-Telegram-put-document-to-Supabase" class="headerlink" title="❇️ 12_126 WhatsApp AI Custom Support &amp; low-ticket Slaes Agent(Telegram) - put document to Supabase"></a>❇️ 12_126 WhatsApp AI Custom Support &amp; low-ticket Slaes Agent(Telegram) - put document to Supabase</h4><div style="max-width:700px">
    <img src="/2025/11/17/n8n-4/pic_12_126.png" class="" title="pic_12_126">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># manual Trigger</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># drive --&gt; Download file</span></span><br><span class="line">File : Defining_AI_companions_a_research_agenda-from_arti.pdf</span><br><span class="line"></span><br><span class="line"><span class="comment"># supabase Vector Store --&gt; Add docuemnts to vector store</span></span><br><span class="line"><span class="comment"># need generate documents 1st</span></span><br><span class="line">Credential to connect with: Supabase(rag_126)</span><br><span class="line">Table Name:　documents</span><br><span class="line">Embedding: Embeddings Google Gemini</span><br><span class="line">Document: Default Data loader</span><br><span class="line">  Type of Data: Binary</span><br><span class="line">  Mode: Load All Input Data</span><br><span class="line">  Data Format: Automatically Detect by Mime Type</span><br><span class="line">  Text Splitting: Custom</span><br><span class="line">  Text SPlitter: Recursive Character Splitter</span><br><span class="line">    Chunk Size: 2000</span><br><span class="line">    Chunk Overlap: 200</span><br></pre></td></tr></table></figure>

<h4 id="12-126-WhatsApp-AI-Custom-Support-amp-low-ticket-Slaes-Agent-Telegram-Servicew-Agent"><a href="#12-126-WhatsApp-AI-Custom-Support-amp-low-ticket-Slaes-Agent-Telegram-Servicew-Agent" class="headerlink" title="12_126 WhatsApp AI Custom Support &amp; low-ticket Slaes Agent(Telegram) - Servicew Agent"></a>12_126 WhatsApp AI Custom Support &amp; low-ticket Slaes Agent(Telegram) - Servicew Agent</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Telegram --&gt; on message</span></span><br><span class="line">Credential to connect with: Telegram account(Nutritionist_Agent)</span><br><span class="line">  what service <span class="keyword">do</span> you offer?</span><br><span class="line">  what about Writing-habitually</span><br><span class="line"></span><br><span class="line"><span class="comment"># Switch</span></span><br><span class="line">Routing Rules</span><br><span class="line">  &#123;&#123; <span class="variable">$json</span>.message.voice.file_id &#125;&#125; : exists</span><br><span class="line">    Rename Output: Enable</span><br><span class="line">    Output Name: Voice</span><br><span class="line">  &#123;&#123; <span class="variable">$json</span>.message.text &#125;&#125;: exists</span><br><span class="line">    Rename Output: Enable</span><br><span class="line">    Output Name: Text</span><br><span class="line"><span class="comment"># 1st : Telegram --&gt; get a file</span></span><br><span class="line">File ID: &#123;&#123; <span class="variable">$json</span>.message.voice.file_id &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1st : Google Gemini --&gt; Transcribe a recording</span></span><br><span class="line">Model: models/gemini-2.5-flash</span><br><span class="line">Input Type: Binary File(s)</span><br><span class="line">Input Data Field Name(s): data</span><br><span class="line"></span><br><span class="line"><span class="comment"># code </span></span><br><span class="line">-----------</span><br><span class="line"><span class="built_in">let</span> text = null;</span><br><span class="line"><span class="built_in">let</span> voice = null;</span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line">    text = <span class="variable">$json</span>.message.text;</span><br><span class="line">&#125; catch(e) &#123;</span><br><span class="line">  console.log(<span class="string">&quot;01:&quot;</span>, e);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">try &#123;</span><br><span class="line">  voice = <span class="variable">$json</span>.content.parts[0].text;</span><br><span class="line">&#125; catch(e) &#123;</span><br><span class="line">	// ..</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const output = &#123;</span><br><span class="line">	text : text ? text : voice ? voice : <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">return</span> output ;</span><br><span class="line">--------------</span><br><span class="line"></span><br><span class="line"><span class="comment">#AI Agent</span></span><br><span class="line">Source <span class="keyword">for</span> Prompt (User Message): Define below</span><br><span class="line">Prompt (User Message): &#123;&#123; <span class="variable">$json</span>.text &#125;&#125;</span><br><span class="line">System Message: You are a helpful assistant, output send text  format</span><br><span class="line">  Chat Model: Gemini Chat Tool</span><br><span class="line">  Memory: Postgres Chat Memory</span><br><span class="line">    Credential to connect with: Postgres (rag_126)</span><br><span class="line">    Session ID: Define below</span><br><span class="line">    Key: &#123;&#123; <span class="variable">$json</span>.text &#125;&#125;</span><br><span class="line">    Table Name: n8n_chat_histories</span><br><span class="line">  Tool: Supabase vector Store</span><br><span class="line">    Credential to connect with: Supabase(rag_126)</span><br><span class="line">    Operation Mode: Retrieve Documents (As Tool <span class="keyword">for</span> AI Agent)</span><br><span class="line">    Description: get document information</span><br><span class="line">    Table Name: documents</span><br><span class="line">      Embedding: Embedding Google </span><br><span class="line"></span><br><span class="line"><span class="comment"># Telegram --&gt; Sned a text message</span></span><br><span class="line">Chat ID: &#123;&#123; $(<span class="string">&#x27;Telegram Trigger&#x27;</span>).item.json.message.from.id &#125;&#125;</span><br><span class="line">Text: &#123;&#123; <span class="variable">$json</span>.output &#125;&#125;</span><br><span class="line">Append n8n Attribution: Disable</span><br></pre></td></tr></table></figure>

<h4 id="❇️-12-127-Day-Trading-Ai-Agent"><a href="#❇️-12-127-Day-Trading-Ai-Agent" class="headerlink" title="❇️ 12_127 Day Trading Ai Agent"></a>❇️ 12_127 Day Trading Ai Agent</h4><div style="max-width:700px">
    <img src="/2025/11/17/n8n-4/pic_12_127.png" class="" title="pic_12_127">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 01: Telegram ---&gt; On message</span></span><br><span class="line">AAPL</span><br><span class="line">  Technical Recommendation: BUY</span><br><span class="line"></span><br><span class="line">  Entry Price: 283.32</span><br><span class="line"></span><br><span class="line">  Stop-Loss: 282.15</span><br><span class="line"></span><br><span class="line">  Target/Exit Price: 284.80</span><br><span class="line"></span><br><span class="line">  Hold or Exit Decision: Hold</span><br><span class="line">NVDA</span><br><span class="line">  - Technical Recommendation: BUY</span><br><span class="line">  - Entry Price: 181.36</span><br><span class="line">  - Stop-Loss: 180.90</span><br><span class="line">  - Target/Exit Price: 181.85</span><br><span class="line">  - Hold or Exit Decision: Hold</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 01-1st: HTTP Request(1 Mintue Interval)</span></span><br><span class="line">Method: GET</span><br><span class="line">URL: https://api.twelvedata.com/time_series</span><br><span class="line">Authentication: Generic Credential Type</span><br><span class="line">Generic Auth Type: Query Auth</span><br><span class="line">Query Auth: Query Auth (twelvedata)</span><br><span class="line">  apikey: &lt;api-key&gt;</span><br><span class="line">Send Query Parameters: Enable</span><br><span class="line">  symbol: &#123;&#123; <span class="variable">$json</span>.message.text &#125;&#125;</span><br><span class="line">  interval: 1min</span><br><span class="line">  outputsize: 100</span><br><span class="line"></span><br><span class="line"><span class="comment"># 01-2nd: HTTP Request(15 Mintue Interval)</span></span><br><span class="line">Send Query Parameters: Enable</span><br><span class="line">Method: GET</span><br><span class="line">URL: https://api.twelvedata.com/time_series</span><br><span class="line">Send Query Parameters: Enable</span><br><span class="line">  symbol: &#123;&#123; <span class="variable">$json</span>.message.text &#125;&#125;</span><br><span class="line">  interval: 15min</span><br><span class="line">  outputsize: 100</span><br><span class="line"></span><br><span class="line"><span class="comment"># 01-3rd: HTTP Request(30 Mintue Interval)</span></span><br><span class="line">Send Query Parameters: Enable</span><br><span class="line">Method: GET</span><br><span class="line">URL: https://api.twelvedata.com/time_series</span><br><span class="line">Send Query Parameters: Enable</span><br><span class="line">  symbol: &#123;&#123; <span class="variable">$json</span>.message.text &#125;&#125;</span><br><span class="line">  interval: 30min</span><br><span class="line">  outputsize: 100</span><br><span class="line"></span><br><span class="line"><span class="comment"># 01-1st .. 01-3rd : Merge</span></span><br><span class="line">Mode: Append</span><br><span class="line">Number of Inputs:３</span><br><span class="line"></span><br><span class="line"><span class="comment"># Aggregate</span></span><br><span class="line">Aggregate: All Item Data (Into a Single List)</span><br><span class="line">Put Output <span class="keyword">in</span> Field: data</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2: Code </span></span><br><span class="line">const root = items[0].json;</span><br><span class="line">// extract datasets</span><br><span class="line">const data1m = root.data[0]; // 1min</span><br><span class="line">const data15m = root.data[1]; // 15min</span><br><span class="line">const data30m = root.data[2]; // 30min</span><br><span class="line"></span><br><span class="line">// standardize format</span><br><span class="line"><span class="keyword">function</span> normalize(values) &#123;</span><br><span class="line"><span class="built_in">return</span> values</span><br><span class="line">.map(v =&gt; (&#123;</span><br><span class="line">    time: new Date(v.datetime),</span><br><span class="line">    open: parseFloat(v.open),</span><br><span class="line">    high: parseFloat(v.high),</span><br><span class="line">    low: parseFloat(v.low),</span><br><span class="line">    close: parseFloat(v.close),</span><br><span class="line">  &#125;))</span><br><span class="line">  .sort((a, b) =&gt; a.time - b.time);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">return</span> [</span><br><span class="line">  &#123;</span><br><span class="line">    json: &#123;</span><br><span class="line">      ticker: data1m.meta.symbol,</span><br><span class="line">      candles1m: normalize(data1m.values),</span><br><span class="line">      candles15m: normalize(data15m.values),</span><br><span class="line">      candles30m: normalize(data30m.values),</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">];</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="comment"># 01-4th: HTTP request(Get News)</span></span><br><span class="line">Method: GET</span><br><span class="line">URL: https://newsapi.org/v2/everything</span><br><span class="line">Authentication: Generic Credential Type</span><br><span class="line">Generic Auth Type: Query Auth</span><br><span class="line">Query Auth: Query Auth(NewsAPI)</span><br><span class="line">Send Query Parameters</span><br><span class="line">  apikey: &lt;api-key&gt;</span><br><span class="line">Send Query Parameters: Enable</span><br><span class="line">  q:　&#123;&#123; <span class="variable">$json</span>.message.text &#125;&#125;</span><br><span class="line">  from: &#123;&#123; <span class="variable">$today</span>.minus(&#123; days: 2 &#125;).toFormat(<span class="string">&#x27;yyyy-MM-dd&#x27;</span>) &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Google Gemini: Message Model</span></span><br><span class="line">  Model: models/gemini-2.5.flash</span><br><span class="line">  Prompt:     (empty)</span><br><span class="line">  Output Content as JSON: Enable</span><br><span class="line">  System Message:</span><br><span class="line">    You are a highly intelligent and accurate sentiment analyzer specializing <span class="keyword">in</span> the financial markets.</span><br><span class="line">    Analyze the sentiment of the provided text.</span><br><span class="line">    - Evaluate immediate market reaction, news impact, and technical volatility.</span><br><span class="line">    - Provide a score between -1 (very negative) and 1 (very positive).</span><br><span class="line">    - Give a short rationale explaining the sentiment.</span><br><span class="line"></span><br><span class="line">    Your output must be a **JSON object** with:</span><br><span class="line">    - <span class="string">&quot;category&quot;</span></span><br><span class="line">    - <span class="string">&quot;score&quot;</span></span><br><span class="line">    - <span class="string">&quot;rationale&quot;</span></span><br><span class="line"></span><br><span class="line">    Only <span class="built_in">return</span> the JSON. Example:</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;shortTermSentiment&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;category&quot;</span>: <span class="string">&quot;Positive&quot;</span>,</span><br><span class="line">      <span class="string">&quot;score&quot;</span>: 0.7,</span><br><span class="line">      <span class="string">&quot;rationale&quot;</span>: <span class="string">&quot;...&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Now analyze the following text and <span class="built_in">return</span> only the JSON:</span><br><span class="line">    &#123;&#123; JSON.stringify(<span class="variable">$json</span>.articles) &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3: Edit Field</span></span><br><span class="line">output: &#123;&#123; <span class="variable">$json</span>.content.parts[0].text.parseJson() &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2+3: Merge</span></span><br><span class="line">Mode:　Append</span><br><span class="line"></span><br><span class="line"><span class="comment"># Aggegate </span></span><br><span class="line">Aggregate: All Item Data (Into a Single List)</span><br><span class="line">Put Output <span class="keyword">in</span> Field: data</span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent</span></span><br><span class="line">Prompt (User Message):</span><br><span class="line">  ** Purpose **</span><br><span class="line">  You are a professional day trader.</span><br><span class="line">  Based on the candle data and sentiment analysis provided below, give one clear trading recommendation: Buy, Sell, or Hold.</span><br><span class="line"></span><br><span class="line">  ** Your decision must consider **</span><br><span class="line">  - Price action from 1m, 15m, and 1h candles</span><br><span class="line">  - Overall sentiment over the last 24h</span><br><span class="line"></span><br><span class="line">  ** Then <span class="built_in">return</span> the following details **</span><br><span class="line">  - Trade Action (Buy / Sell / Hold — based on analysis)</span><br><span class="line">  - Entry Price</span><br><span class="line">  - Stop-Loss</span><br><span class="line">  - Target Price</span><br><span class="line">  - Data <span class="keyword">for</span> Review</span><br><span class="line"></span><br><span class="line">  Candle Data:</span><br><span class="line">  &#123;&#123; JSON.stringify(<span class="variable">$json</span>.data[1]) &#125;&#125;</span><br><span class="line">  Sentiment (Past 24h):</span><br><span class="line">  &#123;&#123; JSON.stringify(<span class="variable">$json</span>.data[0]) &#125;&#125;</span><br><span class="line"></span><br><span class="line">  ** Each candle includes:</span><br><span class="line">  - timeframe: “1m”, “15m”, or “1h”</span><br><span class="line">  - candles: [openTime, open, high, low, close, volume, ...]</span><br><span class="line"></span><br><span class="line">  Steps to Decide:</span><br><span class="line">  - Group candles by timeframe</span><br><span class="line">  - Use 1m &amp; 15m candles with RSI, MACD, and trendlines <span class="keyword">for</span> timing</span><br><span class="line">  - Confirm trend using 1h data</span><br><span class="line">  - Use sentiment to finalize the recommendation</span><br><span class="line">  - Your Output Format (No explanation text!):</span><br><span class="line"></span><br><span class="line">  Your Output Format (No explanation text!):</span><br><span class="line">  - Trade Action: BUY | SELL | HOLD</span><br><span class="line">  - Entry Price: &lt;number&gt;</span><br><span class="line">  - Stop-Loss: &lt;number&gt;</span><br><span class="line">  - Target Price: &lt;number&gt;</span><br><span class="line">System Message:</span><br><span class="line">  ** Response Format **</span><br><span class="line">  - Technical Recommendation:</span><br><span class="line">  &lt;BUY | SELL | HOLD&gt;</span><br><span class="line"></span><br><span class="line">  - Entry Price:</span><br><span class="line">  &lt;number or N/A&gt;</span><br><span class="line"></span><br><span class="line">  - Stop-Loss:</span><br><span class="line">  &lt;number or N/A&gt;</span><br><span class="line"></span><br><span class="line">  - Target/Exit Price:</span><br><span class="line">  &lt;number or N/A&gt;</span><br><span class="line"></span><br><span class="line">  - Hold or Exit Decision:</span><br><span class="line">  &lt;Hold | Exit&gt;</span><br><span class="line">Chat model: Gemini Chat Model</span><br><span class="line"></span><br><span class="line"><span class="comment"># Telegram --&gt; send a text message</span></span><br><span class="line">Chat ID: &#123;&#123; $(<span class="string">&#x27;Telegram Trigger&#x27;</span>).item.json.message.chat.id &#125;&#125;</span><br><span class="line">Text: &#123;&#123; <span class="variable">$json</span>.output &#125;&#125;</span><br><span class="line">Append n8n Attribution: Disable</span><br></pre></td></tr></table></figure>

<h4 id="❇️-12-128-X-Ai-Agent-Finds-the-Hottest-News-on-Any-topic"><a href="#❇️-12-128-X-Ai-Agent-Finds-the-Hottest-News-on-Any-topic" class="headerlink" title="❇️ 12_128 X Ai Agent Finds the Hottest News on  Any topic"></a>❇️ 12_128 X Ai Agent Finds the Hottest News on  Any topic</h4><div style="max-width:700px">
    <img src="/2025/11/17/n8n-4/pic_12_128.png" class="" title="pic_12_128">
</div>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># schedule trigger</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># HTTPS Request</span></span><br><span class="line">Method: GET</span><br><span class="line">URL: https://api.twitterapi.io/twitter/tweet/advanced_search</span><br><span class="line">Authentication: Generic Credential Type</span><br><span class="line">Generic Auth Type: Header Auth</span><br><span class="line">Header Auth: Header Auth (twitterapi)</span><br><span class="line">  Name: X-API-Key</span><br><span class="line">  Value: &lt;api_key&gt;</span><br><span class="line">Send Query Parameters: Enable</span><br><span class="line">Query Parameters</span><br><span class="line">  query: openai       -- search data</span><br><span class="line">  queryType: Top</span><br><span class="line">Pagination</span><br><span class="line">  Pagination Mode: Response Contains Next URL</span><br><span class="line">  Next URL: https://api.twitterapi.io/twitter/tweet/advanced_search?cursor=&#123;&#123; <span class="variable">$response</span>.body.next_cursor &#125;&#125;</span><br><span class="line">  Pagination Complete When: Other</span><br><span class="line">  Complete Expression: &#123;&#123; <span class="variable">$response</span>.body.has_next_page == <span class="literal">false</span> &#125;&#125;</span><br><span class="line">  Limit Pages Fetched: Enable</span><br><span class="line">  Max Pages: 5</span><br><span class="line">  Interval Between Requests (ms): 3000 -- 若有問題增加 6000</span><br><span class="line"></span><br><span class="line"><span class="comment"># Code</span></span><br><span class="line">// Initialize an empty array to collect all tweets</span><br><span class="line"><span class="built_in">let</span> allTweets = [];</span><br><span class="line">// Loop through each input item</span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">let</span> item of <span class="variable">$input</span>.all()) &#123;</span><br><span class="line">  <span class="keyword">if</span> (item.json.tweets &amp;&amp; Array.isArray(item.json.tweets)) &#123;</span><br><span class="line">    allTweets = allTweets.concat(item.json.tweets);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">// Function to format the date <span class="keyword">in</span> a more human-readable way</span><br><span class="line"><span class="keyword">function</span> formatDate(dateString) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!dateString) <span class="built_in">return</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  </span><br><span class="line">  try &#123;</span><br><span class="line">    const date = new Date(dateString);</span><br><span class="line">    <span class="built_in">return</span> date.toLocaleString(<span class="string">&#x27;en-US&#x27;</span>, &#123;</span><br><span class="line">      year: <span class="string">&#x27;numeric&#x27;</span>,</span><br><span class="line">      month: <span class="string">&#x27;long&#x27;</span>,</span><br><span class="line">      day: <span class="string">&#x27;numeric&#x27;</span>,</span><br><span class="line">      hour: <span class="string">&#x27;2-digit&#x27;</span>,</span><br><span class="line">      minute: <span class="string">&#x27;2-digit&#x27;</span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; catch (error) &#123;</span><br><span class="line">    console.log(<span class="string">&quot;Error formatting date:&quot;</span>, error);</span><br><span class="line">    <span class="built_in">return</span> dateString;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// Convert and structure the tweets properly</span><br><span class="line">const formattedTweets = allTweets.map(tweet =&gt; (&#123;</span><br><span class="line">  json: &#123;</span><br><span class="line">    tweetId: tweet.id || <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    url: tweet.url || <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    content: tweet.text || <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    likeCount: tweet.likeCount || 0,</span><br><span class="line">    retweetCount: tweet.retweetCount || 0,</span><br><span class="line">    replyCount: tweet.replyCount || 0,</span><br><span class="line">    quoteCount: tweet.quoteCount || 0,</span><br><span class="line">    viewCount: tweet.viewCount || 0,</span><br><span class="line">    createdAt: formatDate(tweet.createdAt)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">// Output all tweets as separate items</span><br><span class="line"><span class="built_in">return</span> formattedTweets;</span><br><span class="line">----</span><br><span class="line"></span><br><span class="line"><span class="comment"># Filter</span></span><br><span class="line">&#123;&#123; <span class="variable">$json</span>.likeCount &#125;&#125; <span class="string">&quot;is greater than&quot;</span> 800 - or other value</span><br><span class="line"></span><br><span class="line"><span class="comment"># sheet --&gt; Append row in sheet</span></span><br><span class="line">Document: Twitter_X Posts [TEMPLATE]</span><br><span class="line">  ID: &#123;&#123; <span class="variable">$json</span>.tweetId &#125;&#125;</span><br><span class="line">  URL: &#123;&#123; <span class="variable">$json</span>.url &#125;&#125;</span><br><span class="line">  Content: &#123;&#123; <span class="variable">$json</span>.content &#125;&#125;</span><br><span class="line">  Likes: &#123;&#123; <span class="variable">$json</span>.likeCount &#125;&#125;</span><br><span class="line">  Retweets: &#123;&#123; <span class="variable">$json</span>.retweetCount &#125;&#125;</span><br><span class="line">  Replies: &#123;&#123; <span class="variable">$json</span>.replyCount &#125;&#125;</span><br><span class="line">  Quotes: &#123;&#123; <span class="variable">$json</span>.quoteCount &#125;&#125;</span><br><span class="line">  Views: &#123;&#123; <span class="variable">$json</span>.viewCount &#125;&#125;</span><br><span class="line">  Date:　&#123;&#123; <span class="variable">$json</span>.createdAt &#125;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Code</span></span><br><span class="line">const allItems = <span class="variable">$input</span>.all();</span><br><span class="line">const combined = allItems.map(item =&gt; item.json.Content).join(<span class="string">&#x27;\n\n---\n\n&#x27;</span>);</span><br><span class="line"><span class="built_in">return</span> [&#123; json: &#123; combinedContent: combined &#125; &#125;];</span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent</span></span><br><span class="line">Prompt (User Message):</span><br><span class="line">  You are a skilled social media analyst specializing <span class="keyword">in</span> summarizing high-impact Twitter/X content.</span><br><span class="line"></span><br><span class="line">  You will receive a string that includes several high-performing tweets combined into one text block.</span><br><span class="line">  Each tweet is separated by a line of <span class="string">&quot;---&quot;</span>.</span><br><span class="line"></span><br><span class="line">  Tweets input is:</span><br><span class="line">  &#123;&#123; <span class="variable">$json</span>.combinedContent &#125;&#125;</span><br><span class="line"></span><br><span class="line">  Your tasks:</span><br><span class="line">  1. Write a concise one-sentence overview summarizing today’s main topic or pattern.</span><br><span class="line">  2. List the Top 3 Most Impactful Tweets. For each tweet, include:</span><br><span class="line">    - A brief summary</span><br><span class="line">    - Why it stands out</span><br><span class="line">    - A short snippet of the tweet (up to 280 characters)</span><br><span class="line">  3. Highlight one tweet that is surprising, controversial, or unique, <span class="keyword">if</span> any, and explain why.</span><br><span class="line">  4. Suggest two intelligent next actions based on today’s tweet content.</span><br><span class="line"></span><br><span class="line">  ---</span><br><span class="line"></span><br><span class="line">  <span class="comment">### Email Formatting Instructions:</span></span><br><span class="line">  - Format the final output as a clean **HTML email report**.</span><br><span class="line">  - Use the following styling:</span><br><span class="line">  - `&lt;h1 style=<span class="string">&quot;color:#D32F2F;&quot;</span>&gt;🚀 Daily Twitter/X Highlights – &#123;&#123; <span class="variable">$now</span>.plus(8,hours).format(<span class="string">&#x27;yyyy-MM-dd HH:mm&#x27;</span>) &#125;&#125;&lt;/h1&gt;` <span class="keyword">for</span> the</span><br><span class="line">  main title</span><br><span class="line">  - `&lt;h2 style=<span class="string">&quot;color:#1976D2;&quot;</span>&gt;...&lt;/h2&gt;` <span class="keyword">for</span> section headers</span><br><span class="line">  - `&lt;ul&gt;&lt;li&gt;` <span class="keyword">for</span> bullet points</span><br><span class="line">  - `&lt;p&gt;` <span class="keyword">for</span> paragraphs</span><br><span class="line">  - Use `&lt;b&gt;` to highlight any key names, metrics, or facts</span><br><span class="line">  - Use `&lt;hr&gt;` between major sections</span><br><span class="line"></span><br><span class="line">  ---</span><br><span class="line">  <span class="comment">### Email Sending Instructions:</span></span><br><span class="line"></span><br><span class="line">  Use the Gmail tool to send the final HTML report.</span><br><span class="line">  - **To**: [Your email address here or leave blank <span class="keyword">if</span> dynamically defined]</span><br><span class="line">  - **Subject**: `🚀 Daily Twitter/X Highlights – &#123;&#123; <span class="variable">$now</span>.plus(8,hours).format(<span class="string">&#x27;yyyy-MM-dd HH:mm&#x27;</span>) &#125;&#125;`</span><br><span class="line">  - **Body**: the HTML report you generated</span><br><span class="line"></span><br><span class="line">  Make sure the email is **HTML formatted**, easy to scan, and includes only the structured summary —</span><br><span class="line">  <span class="keyword">do</span> not include the original tweet input or any internal explanations. Just output the final result and send it via Gmail.</span><br><span class="line"></span><br><span class="line">  <span class="comment">### support 2 language</span></span><br><span class="line">  Please provide both the English and Traditional Chinese versions <span class="keyword">in</span> the email.  </span><br><span class="line">---</span><br><span class="line"></span><br><span class="line"><span class="comment"># AI Agent</span></span><br><span class="line">Chat Model: Gemini Chat Model</span><br><span class="line">Tool: Gmail Tool</span><br><span class="line">  To:kyp001@gmail.com</span><br><span class="line">  Subject: Defined automatically by the model</span><br><span class="line">  Email Type: HTML</span><br><span class="line">  Message: Defined automatically by the model</span><br></pre></td></tr></table></figure>

<h4 id="12-129-Spotify-AI-Agent-Build-Smart-Palylist"><a href="#12-129-Spotify-AI-Agent-Build-Smart-Palylist" class="headerlink" title="12_129 Spotify AI Agent Build Smart Palylist"></a>12_129 Spotify AI Agent Build Smart Palylist</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Telegram --&gt; on message</span></span><br><span class="line">input :</span><br><span class="line">  <span class="string">&quot;</span></span><br><span class="line"><span class="string">  give me party music</span></span><br><span class="line"><span class="string">  I feel sad</span></span><br><span class="line"><span class="string">  I&#x27;m going to the gym right now, give me the best motivational songs you found</span></span><br><span class="line"><span class="string">  &quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Spotify --&gt; Create a playlist (Credential - login is enough)</span></span><br><span class="line">Name: Playlist &#123;&#123;<span class="variable">$now</span>.format(<span class="string">&#x27;yyyy-MM-dd HH:00&#x27;</span>)&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Text Classifier</span></span><br><span class="line">Text to Classify: User Input:  &#123;&#123; $(<span class="string">&#x27;Telegram Trigger&#x27;</span>).item.json.message.text &#125;&#125;</span><br><span class="line">Categories:</span><br><span class="line">  Chill: Music with relaxing, mellow, or laid-back vibes. Perfect <span class="keyword">for</span> unwinding, background ambiance, or quiet time.</span><br><span class="line">  Energetic: High-tempo, upbeat music that boosts energy and motivation. Great <span class="keyword">for</span> movement, action, or high-focus tasks.</span><br><span class="line">  Focus: Calm and minimal music (often instrumental) to <span class="built_in">help</span> with studying, working, or deep concentration.</span><br><span class="line">  Happy: Bright, joyful, and uplifting tracks that create a positive and cheerful mood.</span><br><span class="line">  Sad: Emotional, slow, or melancholic music that fits introspective or sorrowful feelings.</span><br><span class="line">  Workout: Intense and powerful tracks with a driving rhythm, suitable <span class="keyword">for</span> exercising or staying physically active.</span><br><span class="line">  Party: Fun, lively, and danceable music made <span class="keyword">for</span> socializing, celebrations, or night outs.</span><br><span class="line">  Romantic: Gentle, warm, or heartfelt music that suits moments of love, connection, or intimacy.</span><br><span class="line">  Motivational: Inspiring, confident, and empowering music that pushes you to take action or overcome challenges.</span><br><span class="line">Model: Gemini Chat Model</span><br><span class="line"></span><br><span class="line"><span class="comment"># (0-8)Spotify --&gt; search reack by keyword</span></span><br><span class="line">Search Keyword: chill vibes, energetic vibes, focus vibes, happy vibes, sad vibes, workout vibes, party vibes, romatic vibes, motivational vibes</span><br><span class="line">Limit: 20</span><br><span class="line"></span><br><span class="line"><span class="comment"># Edit Field</span></span><br><span class="line">uri: &#123;&#123; <span class="variable">$json</span>.uri &#125;&#125;</span><br><span class="line">playlist_uri: &#123;&#123; $(<span class="string">&#x27;Create a playlist&#x27;</span>).item.json.uri &#125;&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment"># spotify --&gt; add an item to playlist</span></span><br><span class="line">Playlist ID: &#123;&#123; <span class="variable">$json</span>.playlist_uri &#125;&#125;</span><br><span class="line">Track ID: </span><br><span class="line"></span><br><span class="line"><span class="comment"># Aggregate (no anything, just trigge a output)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Telegram --&gt; send a text message</span></span><br><span class="line">Chat ID: &#123;&#123; $(<span class="string">&#x27;Telegram Trigger&#x27;</span>).item.json.message.chat.id &#125;&#125;</span><br><span class="line">Text: Hey! our new playlist is ready to use: &#123;&#123; $(<span class="string">&#x27;Create a playlist&#x27;</span>).item.json.external_urls.spotify &#125;&#125;</span><br><span class="line">Append n8n Attribution: Disable</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/n8n/" rel="tag"># n8n</a>
              <a href="/tags/udemy/" rel="tag"># udemy</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/10/30/youtube-3/" rel="prev" title="Youtube - Priority List">
                  <i class="fa fa-chevron-left"></i> Youtube - Priority List
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/12/04/n8n-5/" rel="next" title="n8n-5">
                  n8n-5 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    
  <div class="comments" id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Robert Kao</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="總字數">2.7m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="所需總閱讀時間">41:16</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 強力驅動
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="/js/local-search.js"></script>






  




  


<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://hot5656-blog.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://hot5656.github.io/2025/11/17/n8n-4/";
    this.page.identifier = "2025/11/17/n8n-4/";
    this.page.title = "n8n - AI Agents, AI Automations & AI Voice Agents (3)<br> RAG & Research AI Agents";
    };
  NexT.utils.loadComments('#disqus_thread', () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://hot5656-blog.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
