<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hot5656.github.io","root":"/","images":"/images","scheme":"Gemini","version":"8.2.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜尋...","empty":"我們無法找到任何有關 ${query} 的搜索結果","hits_time":"${hits} 找到 ${time} 個結果","hits":"找到 ${hits} 個結果"},"path":"/search.json","localsearch":{"enable":"enable","trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false}};
  </script>
<meta name="description" content="名詞雜湊(Hash) : 將目標文字轉換成具有相同長度的、不可逆的雜湊字串加密(Encrypt) :是將目標文字轉換成具有不同長度的、可逆的密文如 MD5, SHA256 跨網站指令碼(Cross-site scripting,簡稱XSS) : 是一種網站應用程式的安全漏洞攻擊，是代碼注入的一種123456789101112&lt;!-- 測試網站是否有正確處理特殊字元： --&gt;&gt;&amp;l">
<meta property="og:type" content="article">
<meta property="og:title" content="PHP 說明">
<meta property="og:url" content="https://hot5656.github.io/2021/05/31/php-1/index.html">
<meta property="og:site_name" content="Robert 雜記">
<meta property="og:description" content="名詞雜湊(Hash) : 將目標文字轉換成具有相同長度的、不可逆的雜湊字串加密(Encrypt) :是將目標文字轉換成具有不同長度的、可逆的密文如 MD5, SHA256 跨網站指令碼(Cross-site scripting,簡稱XSS) : 是一種網站應用程式的安全漏洞攻擊，是代碼注入的一種123456789101112&lt;!-- 測試網站是否有正確處理特殊字元： --&gt;&gt;&amp;l">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://hot5656.github.io/2021/05/31/php-1/pic1.png">
<meta property="og:image" content="https://hot5656.github.io/2021/05/31/php-1/pic2.png">
<meta property="og:image" content="https://hot5656.github.io/2021/05/31/php-1/pic3.png">
<meta property="og:image" content="https://hot5656.github.io/2021/05/31/php-1/pic4.png">
<meta property="og:image" content="https://hot5656.github.io/2021/05/31/php-1/pic5.png">
<meta property="og:image" content="https://hot5656.github.io/2021/05/31/php-1/pic6.png">
<meta property="og:image" content="https://hot5656.github.io/2021/05/31/php-1/pic7.png">
<meta property="og:image" content="https://hot5656.github.io/2021/05/31/php-1/pic8.png">
<meta property="og:image" content="https://hot5656.github.io/2021/05/31/php-1/pic9.png">
<meta property="og:image" content="https://hot5656.github.io/2021/05/31/php-1/pic10.png">
<meta property="og:image" content="https://hot5656.github.io/2021/05/31/php-1/pic11.png">
<meta property="article:published_time" content="2021-05-31T02:39:11.000Z">
<meta property="article:modified_time" content="2022-06-09T03:38:35.321Z">
<meta property="article:author" content="Robert Kao">
<meta property="article:tag" content="database">
<meta property="article:tag" content="mysql">
<meta property="article:tag" content="php">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hot5656.github.io/2021/05/31/php-1/pic1.png">


<link rel="canonical" href="https://hot5656.github.io/2021/05/31/php-1/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-TW'
  };
</script>
<title>PHP 說明 | Robert 雜記</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Robert 雜記</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首頁</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>標籤</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分類</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>歸檔列表</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜尋
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜尋..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8D%E8%A9%9E"><span class="nav-number">1.</span> <span class="nav-text">名詞</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9B%9C%E6%B9%8A-Hash-%E5%B0%87%E7%9B%AE%E6%A8%99%E6%96%87%E5%AD%97%E8%BD%89%E6%8F%9B%E6%88%90%E5%85%B7%E6%9C%89%E7%9B%B8%E5%90%8C%E9%95%B7%E5%BA%A6%E7%9A%84%E3%80%81%E4%B8%8D%E5%8F%AF%E9%80%86%E7%9A%84%E9%9B%9C%E6%B9%8A%E5%AD%97%E4%B8%B2"><span class="nav-number">1.1.</span> <span class="nav-text">雜湊(Hash) : 將目標文字轉換成具有相同長度的、不可逆的雜湊字串</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8A%A0%E5%AF%86-Encrypt-%E6%98%AF%E5%B0%87%E7%9B%AE%E6%A8%99%E6%96%87%E5%AD%97%E8%BD%89%E6%8F%9B%E6%88%90%E5%85%B7%E6%9C%89%E4%B8%8D%E5%90%8C%E9%95%B7%E5%BA%A6%E7%9A%84%E3%80%81%E5%8F%AF%E9%80%86%E7%9A%84%E5%AF%86%E6%96%87"><span class="nav-number">1.2.</span> <span class="nav-text">加密(Encrypt) :是將目標文字轉換成具有不同長度的、可逆的密文</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B7%A8%E7%B6%B2%E7%AB%99%E6%8C%87%E4%BB%A4%E7%A2%BC-Cross-site-scripting-%E7%B0%A1%E7%A8%B1XSS-%E6%98%AF%E4%B8%80%E7%A8%AE%E7%B6%B2%E7%AB%99%E6%87%89%E7%94%A8%E7%A8%8B%E5%BC%8F%E7%9A%84%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E%E6%94%BB%E6%93%8A%EF%BC%8C%E6%98%AF%E4%BB%A3%E7%A2%BC%E6%B3%A8%E5%85%A5%E7%9A%84%E4%B8%80%E7%A8%AE"><span class="nav-number">1.3.</span> <span class="nav-text">跨網站指令碼(Cross-site scripting,簡稱XSS) : 是一種網站應用程式的安全漏洞攻擊，是代碼注入的一種</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SQL-injection"><span class="nav-number">1.4.</span> <span class="nav-text">SQL injection</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B3%87%E6%96%99%E5%BA%AB%E6%AD%A3%E8%A6%8F%E5%8C%96"><span class="nav-number">1.5.</span> <span class="nav-text">資料庫正規化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CSRF-Cross-Site-Request-Forgery-%E8%B7%A8%E7%AB%99%E8%AB%8B%E6%B1%82%E5%81%BD%E9%80%A0"><span class="nav-number">1.6.</span> <span class="nav-text">CSRF(Cross Site Request Forgery) 跨站請求偽造</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CORS-%E5%85%A8%E5%90%8D%E7%82%BA-Cross-Origin-Resource-Sharing-%E8%B7%A8%E4%BE%86%E6%BA%90%E8%B3%87%E6%BA%90%E5%85%B1%E4%BA%AB"><span class="nav-number">1.7.</span> <span class="nav-text">CORS(全名為 Cross-Origin Resource Sharing) 跨來源資源共享</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Offset-x2F-limit-based-and-Cursored-based-Pagination"><span class="nav-number">1.8.</span> <span class="nav-text">Offset&#x2F;limit-based and Cursored-based Pagination</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A8%AD%E8%A8%88%E5%8F%83%E8%80%83"><span class="nav-number">2.</span> <span class="nav-text">設計參考</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#PHP-Security-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85"><span class="nav-number">2.1.</span> <span class="nav-text">PHP Security 注意事項</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#setup-XAMPP"><span class="nav-number">2.2.</span> <span class="nav-text">setup XAMPP</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#install-XAMPP"><span class="nav-number">2.2.1.</span> <span class="nav-text">install XAMPP</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#XAMPP-Config"><span class="nav-number">2.2.2.</span> <span class="nav-text">XAMPP Config</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#run-XAMPP"><span class="nav-number">2.2.2.1.</span> <span class="nav-text">run XAMPP</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Start-Apache-and-MySQL"><span class="nav-number">2.2.2.2.</span> <span class="nav-text">Start Apache and MySQL</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#check-Admin-and-PHP-PHPInfo"><span class="nav-number">2.2.2.3.</span> <span class="nav-text">check Admin and PHP PHPInfo</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Config-PHP"><span class="nav-number">2.2.2.4.</span> <span class="nav-text">Config PHP</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PHP-%E5%9F%BA%E6%9C%AC%E8%AA%9E%E6%B3%95"><span class="nav-number">2.3.</span> <span class="nav-text">PHP 基本語法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Disable-cache"><span class="nav-number">2.4.</span> <span class="nav-text">Disable cache</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#from-%E5%90%AB%E4%B8%8D%E9%A1%AF%E7%A4%BA%E8%B3%87%E6%96%99-input%E2%80%99s-type-x3D-%E2%80%9Dhidden%E2%80%9D"><span class="nav-number">2.5.</span> <span class="nav-text">from 含不顯示資料 input’s type&#x3D;”hidden”</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PHP-example"><span class="nav-number">3.</span> <span class="nav-text">PHP example</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Query-string"><span class="nav-number">3.1.</span> <span class="nav-text">Query string</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#show-time"><span class="nav-number">3.2.</span> <span class="nav-text">show time</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#form-by-GET"><span class="nav-number">3.3.</span> <span class="nav-text">form by GET</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#form-by-POST-%E8%A6%81%E6%94%B9%E7%94%A8-POST-%E6%8A%93%E5%8F%83%E6%95%B8"><span class="nav-number">3.4.</span> <span class="nav-text">form by POST - 要改用$_POST 抓參數</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Query-strig-%E6%A8%99%E7%A4%BA%E9%8C%AF%E8%AA%A4"><span class="nav-number">3.5.</span> <span class="nav-text">Query strig 標示錯誤</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%A2%E7%94%9F%E4%BA%82%E6%95%B8%E5%AD%97%E4%B8%B2"><span class="nav-number">3.6.</span> <span class="nav-text">產生亂數字串</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#global-%E5%85%A8%E5%9F%9F%E8%AE%8A%E6%95%B8"><span class="nav-number">3.7.</span> <span class="nav-text">global 全域變數</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#htmlspecialchars-for-XSS"><span class="nav-number">3.8.</span> <span class="nav-text">htmlspecialchars for XSS</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Snippet-for-mySQL"><span class="nav-number">4.</span> <span class="nav-text">Snippet for mySQL</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#special-parameter"><span class="nav-number">4.1.</span> <span class="nav-text">special parameter</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#connect-database"><span class="nav-number">4.2.</span> <span class="nav-text">connect database</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#query-time-from-database"><span class="nav-number">4.3.</span> <span class="nav-text">query time from database</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%80%E5%8F%96-mySQL"><span class="nav-number">4.4.</span> <span class="nav-text">讀取 mySQL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%80%E5%8F%96-mySQL-check-error"><span class="nav-number">4.5.</span> <span class="nav-text">讀取 mySQL(check error)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B0%E5%A2%9E-mySQL-%E8%B3%87%E6%96%99"><span class="nav-number">4.6.</span> <span class="nav-text">新增 mySQL 資料</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B0%E5%A2%9E-mySQL-%E8%B3%87%E6%96%99-%E4%BD%BF%E7%94%A8-form"><span class="nav-number">4.7.</span> <span class="nav-text">新增 mySQL 資料(使用 form)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B0%E5%A2%9E-mySQL-%E8%B3%87%E6%96%99-check-error"><span class="nav-number">4.8.</span> <span class="nav-text">新增 mySQL 資料(check error)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%AA%E9%99%A4-mySQL-%E8%B3%87%E6%96%99"><span class="nav-number">4.9.</span> <span class="nav-text">刪除 mySQL 資料</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%AA%E9%99%A4-mySQL-%E8%B3%87%E6%96%99-soft-delete"><span class="nav-number">4.10.</span> <span class="nav-text">刪除 mySQL 資料(soft delete)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9-mySQL-%E8%B3%87%E6%96%99"><span class="nav-number">4.11.</span> <span class="nav-text">修改 mySQL 資料</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MySQL-Prepared-Statements-%E9%A0%90%E9%98%B2-SQL-injection"><span class="nav-number">4.12.</span> <span class="nav-text">MySQL Prepared Statements (預防 SQL injection)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MySQL-join"><span class="nav-number">4.13.</span> <span class="nav-text">MySQL join</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MySQL-limit-and-offset"><span class="nav-number">4.14.</span> <span class="nav-text">MySQL limit and offset</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MySQL-%E6%AA%A2%E6%9F%A5%E6%AC%84%E4%BD%8D%E6%98%AF%E5%90%A6-NULL-%E6%88%96%E7%A9%BA%E7%99%BD"><span class="nav-number">4.15.</span> <span class="nav-text">MySQL 檢查欄位是否 NULL 或空白</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#login-%E6%AA%A2%E6%9F%A5"><span class="nav-number">4.16.</span> <span class="nav-text">login 檢查</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PHP-MySQL-Get-Last-Inserted-ID"><span class="nav-number">4.17.</span> <span class="nav-text">PHP MySQL Get Last Inserted ID</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PHP-%E8%AA%9E%E6%B3%95"><span class="nav-number">5.</span> <span class="nav-text">PHP 語法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%8A%E6%95%B8"><span class="nav-number">5.1.</span> <span class="nav-text">變數</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#array"><span class="nav-number">5.1.1.</span> <span class="nav-text">array</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#object"><span class="nav-number">5.1.2.</span> <span class="nav-text">object</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#SERVER-PHP%E9%A0%90%E5%AE%9A%E7%BE%A9%E7%9A%84%E8%B6%85%E5%85%A8%E5%B1%80%E8%AE%8A%E9%87%8F"><span class="nav-number">5.1.3.</span> <span class="nav-text">$_SERVER PHP預定義的超全局變量</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Snippet-for-PHP"><span class="nav-number">6.</span> <span class="nav-text">Snippet for PHP</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#error-code-%E8%99%95%E7%90%86"><span class="nav-number">6.1.</span> <span class="nav-text">error code 處理</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8B%E6%8B%89%E5%BC%8F%E9%81%B8%E5%96%AE-lt-select-gt-lt-option-gt"><span class="nav-number">6.2.</span> <span class="nav-text">下拉式選單 - &lt;select&gt;, &lt;option&gt;</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E9%A0%81"><span class="nav-number">6.3.</span> <span class="nav-text">分頁</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#utils"><span class="nav-number">6.4.</span> <span class="nav-text">utils</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#check-accountValid"><span class="nav-number">6.4.1.</span> <span class="nav-text">check accountValid</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A8%AD%E5%AE%9A-HTML-%E8%B7%B3%E8%84%AB%E5%AD%97%E5%85%83-check-echo-%E6%9C%89%E7%84%A1%E5%91%BC%E5%8F%AB"><span class="nav-number">6.4.2.</span> <span class="nav-text">設定 HTML 跳脫字元 - check echo 有無呼叫</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9B%9E%E5%82%B3-json"><span class="nav-number">6.5.</span> <span class="nav-text">回傳 json</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#html-php-%E5%9B%9E%E5%82%B3-json"><span class="nav-number">6.6.</span> <span class="nav-text">html + php 回傳 json</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PHP-function"><span class="nav-number">7.</span> <span class="nav-text">PHP function</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#simple-function"><span class="nav-number">7.1.</span> <span class="nav-text">simple function</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BD%89%E6%8F%9B"><span class="nav-number">7.2.</span> <span class="nav-text">轉換</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BD%89%E6%95%B8%E5%AD%97"><span class="nav-number">7.2.1.</span> <span class="nav-text">轉數字</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#floor-x2F-ceil-x2F-round"><span class="nav-number">7.2.2.</span> <span class="nav-text">floor()&#x2F;ceil()&#x2F;round()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ASCII-code-%E8%BD%89%E6%8F%9B-ord-x2F-chr"><span class="nav-number">7.2.3.</span> <span class="nav-text">ASCII code 轉換 ord()&#x2F;chr()</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#string"><span class="nav-number">7.3.</span> <span class="nav-text">string</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#strpos-check-%E6%98%AF%E5%90%A6%E5%8C%85%E5%90%AB%E5%AD%97%E4%B8%B2-%E4%B8%8D%E5%8C%85%E5%90%AB%E5%82%B3%E5%9B%9E-false"><span class="nav-number">7.3.1.</span> <span class="nav-text">strpos() - check 是否包含字串,不包含傳回 false</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#substr-x2F-mb-substr-%E6%93%B7%E5%8F%96%E5%AD%97%E4%B8%B2"><span class="nav-number">7.3.2.</span> <span class="nav-text">substr()&#x2F;mb_substr() - 擷取字串</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#date"><span class="nav-number">7.4.</span> <span class="nav-text">date()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#header-%E9%96%8B%E5%95%9F%E7%B6%B2%E9%A0%81"><span class="nav-number">7.5.</span> <span class="nav-text">header 開啟網頁</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#cookie"><span class="nav-number">7.6.</span> <span class="nav-text">cookie</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#session"><span class="nav-number">7.7.</span> <span class="nav-text">session</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#die-%E5%8D%B0%E5%87%BA%E5%BE%8C%E7%B5%90%E6%9D%9F%E7%A8%8B%E5%BC%8F"><span class="nav-number">7.8.</span> <span class="nav-text">die() - 印出後結束程式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#rand-%E7%94%A2%E7%94%9F%E4%BA%82%E6%95%B8"><span class="nav-number">7.9.</span> <span class="nav-text">rand() - 產生亂數</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#hash-%E9%9B%9C%E6%B9%8A%E7%94%A2%E7%94%9F"><span class="nav-number">7.10.</span> <span class="nav-text">hash() - 雜湊產生</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#password-hash-x2F-password-verify-%E9%9B%9C%E6%B9%8A%E5%AF%86%E7%A2%BC%E7%94%A2%E7%94%9F%E8%88%87%E9%A9%97%E8%AD%89"><span class="nav-number">7.11.</span> <span class="nav-text">password_hash()&#x2F;password_verify() - 雜湊密碼產生與驗證</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#htmlentities-%E5%92%8C-htmlspecialchars"><span class="nav-number">7.12.</span> <span class="nav-text">htmlentities 和 htmlspecialchars</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#require-x2F-require-once-and-include-x2F-include-once"><span class="nav-number">7.13.</span> <span class="nav-text">require()&#x2F;require_once() and include()&#x2F;include_once()</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#echo-print-r-and-var-var-dump"><span class="nav-number">8.</span> <span class="nav-text">echo , print_r() and var var_dump()</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Robert Kao"
      src="/images/head.png">
  <p class="site-author-name" itemprop="name">Robert Kao</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">171</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">66</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
        <div class="back-to-top animated" role="button">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://hot5656.github.io/2021/05/31/php-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="Robert Kao">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Robert 雜記">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          PHP 說明
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2021-05-31 10:39:11" itemprop="dateCreated datePublished" datetime="2021-05-31T10:39:11+08:00">2021-05-31</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2022-06-09 11:38:35" itemprop="dateModified" datetime="2022-06-09T11:38:35+08:00">2022-06-09</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Back-End/" itemprop="url" rel="index"><span itemprop="name">Back End</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2021/05/31/php-1/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2021/05/31/php-1/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>45k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>41 分鐘</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h3 id="名詞"><a href="#名詞" class="headerlink" title="名詞"></a>名詞</h3><h4 id="雜湊-Hash-將目標文字轉換成具有相同長度的、不可逆的雜湊字串"><a href="#雜湊-Hash-將目標文字轉換成具有相同長度的、不可逆的雜湊字串" class="headerlink" title="雜湊(Hash) : 將目標文字轉換成具有相同長度的、不可逆的雜湊字串"></a>雜湊(Hash) : 將目標文字轉換成具有相同長度的、不可逆的雜湊字串</h4><h4 id="加密-Encrypt-是將目標文字轉換成具有不同長度的、可逆的密文"><a href="#加密-Encrypt-是將目標文字轉換成具有不同長度的、可逆的密文" class="headerlink" title="加密(Encrypt) :是將目標文字轉換成具有不同長度的、可逆的密文"></a>加密(Encrypt) :是將目標文字轉換成具有不同長度的、可逆的密文</h4><p>如 MD5, SHA256</p>
<h4 id="跨網站指令碼-Cross-site-scripting-簡稱XSS-是一種網站應用程式的安全漏洞攻擊，是代碼注入的一種"><a href="#跨網站指令碼-Cross-site-scripting-簡稱XSS-是一種網站應用程式的安全漏洞攻擊，是代碼注入的一種" class="headerlink" title="跨網站指令碼(Cross-site scripting,簡稱XSS) : 是一種網站應用程式的安全漏洞攻擊，是代碼注入的一種"></a>跨網站指令碼(Cross-site scripting,簡稱XSS) : 是一種網站應用程式的安全漏洞攻擊，是代碼注入的一種</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 測試網站是否有正確處理特殊字元： --&gt;</span></span><br><span class="line">&gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="built_in">document</span>.cookie)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">=&#x27;&gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="built_in">document</span>.cookie)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">&quot;&gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="built_in">document</span>.cookie)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="built_in">document</span>.cookie)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="string">&#x27;vulnerable&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">%3Cscript%3Ealert(&#x27;XSS&#x27;)%3C/script%3E</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="string">&#x27;XSS&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;javascript:alert(&#x27;XSS&#x27;)&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 可導到釣魚網站或dump cookie --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">location.href=<span class="string">&quot;https://google.com&quot;</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">alert(<span class="built_in">document</span>.cookie)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<span id="more"></span>

<h4 id="SQL-injection"><a href="#SQL-injection" class="headerlink" title="SQL injection"></a>SQL injection</h4><p>也稱SQL隱碼或SQL注碼，是發生於應用程式與資料庫層的安全漏洞。簡而言之，是在輸入的字串之中夾帶SQL指令，在設計不良的程式當中忽略了字元檢查，那麼這些夾帶進去的惡意指令就會被資料庫伺服器誤認為是正常的SQL指令而執行，因此遭到破壞或是入侵。也稱為駭客的填字遊戲.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># 原指令</span><br><span class="line"># select * from users where username&#x3D; &#39;%s&#39; and password&#x3D;&#39;%s&#39; ;</span><br><span class="line"># usaename 填入以下,即可登入</span><br><span class="line">aa&#39;#</span><br><span class="line">&#39; or 1&#x3D;1#</span><br><span class="line"></span><br><span class="line"># 原指令</span><br><span class="line"># insert into comment(nickname, content) values(&#39;%s&#39;, &#39;%s&#39;);</span><br><span class="line"># content 填入以下,即可偽裝留言</span><br><span class="line">&#39;), (&#39;aa2&#39;, &#39;bb21</span><br><span class="line">&#39;), (&#39;admin&#39;, &#39;what&#39;)#</span><br><span class="line"></span><br><span class="line"># 原指令</span><br><span class="line"># nsert into comment(nickname, content) values(&#39;%s&#39;, &#39;%s&#39;);</span><br><span class="line"># sub query 模擬以下命令</span><br><span class="line"># insert into comment(nickname, content) values(&#39;aaa&#39;, (select password from users limit 1) ) </span><br><span class="line"># content 填入以下,即可列出密碼</span><br><span class="line">&#39;), (&#39;admin&#39;, (select password from users limit 1) )#</span><br><span class="line">&#39;), (&#39;dd&#39;, (select password from users where nickname&#x3D;&#39;dd&#39;) )#</span><br><span class="line">&#39;), ((select nickname from users where id&#x3D;69), (select password from users where id&#x3D;69) )#</span><br></pre></td></tr></table></figure>

<h4 id="資料庫正規化"><a href="#資料庫正規化" class="headerlink" title="資料庫正規化"></a>資料庫正規化</h4><p><a target="_blank" rel="noopener" href="https://drawsql.app/templates">Database schema templates</a><br>資料庫正規化，又稱正規化、標準化，是資料庫設計的一系列原理和技術</p>
<h4 id="CSRF-Cross-Site-Request-Forgery-跨站請求偽造"><a href="#CSRF-Cross-Site-Request-Forgery-跨站請求偽造" class="headerlink" title="CSRF(Cross Site Request Forgery) 跨站請求偽造"></a>CSRF(Cross Site Request Forgery) 跨站請求偽造</h4><ul>
<li>現在有些 Framework 都有內建防禦 CSRF 的功能，可以很簡單的開啟</li>
<li>使用者的防禦 : 每次使用完網站就登出，就可以避免掉 CSRF</li>
<li>Server 的防禦 : <ul>
<li>檢查 Referer</li>
<li>加上圖形驗證碼, 簡訊驗證碼等等</li>
<li>加上 CSRF token<br>  在 form 裡面加上一個 hidden 的欄位，叫做csrftoken，這裡面填的值由 server 隨機產生，並且存在 server 的 session 中。<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;https://small-min.blog.com/delete&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;3&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;csrftoken&quot;</span> <span class="attr">value</span>=<span class="string">&quot;fj1iro2jro12ijoi1&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;刪除文章&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>browser 本身的防禦 : Chrome 51 版的時候正式加入了這個功能：SameSite cookie<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 你原本設置 Cookie 的 header 長這樣：</span></span><br><span class="line">Set-Cookie: session_id=ewfewjf23o1;</span><br><span class="line"><span class="comment">// 你只要在後面多加一個 SameSite 就好：</span></span><br><span class="line">Set-Cookie: session_id=ewfewjf23o1; SameSite</span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">// 假設刪除文章命令如下</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;/delete?id=3&#x27;</span>&gt;</span>刪除<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">// 點下去,刪除自己的文章</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;https://small-min.blog.com/delete?id=3&#x27;</span>&gt;</span>開始測驗<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">// 打開網頁即刪除文章</span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#x27;https://small-min.blog.com/delete?id=3&#x27;</span> <span class="attr">width</span>=<span class="string">&#x27;0&#x27;</span> <span class="attr">height</span>=<span class="string">&#x27;0&#x27;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&#x27;/test&#x27;</span>&gt;</span>開始測驗<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">// 若刪除改為 POST</span><br><span class="line">// 點下去,刪除自己的文章</span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;https://small-min.blog.com/delete&quot;</span> <span class="attr">method</span>=<span class="string">&quot;POST&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;hidden&quot;</span> <span class="attr">name</span>=<span class="string">&quot;id&quot;</span> <span class="attr">value</span>=<span class="string">&quot;3&quot;</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;開始測驗&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">// 不知情刪除</span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">style</span>=<span class="string">&quot;display:none&quot;</span> <span class="attr">name</span>=<span class="string">&quot;csrf-frame&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&#x27;POST&#x27;</span> <span class="attr">action</span>=<span class="string">&#x27;https://small-min.blog.com/delete&#x27;</span> <span class="attr">target</span>=<span class="string">&quot;csrf-frame&quot;</span> <span class="attr">id</span>=<span class="string">&quot;csrf-form&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;hidden&#x27;</span> <span class="attr">name</span>=<span class="string">&#x27;id&#x27;</span> <span class="attr">value</span>=<span class="string">&#x27;3&#x27;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&#x27;submit&#x27;</span> <span class="attr">value</span>=<span class="string">&#x27;submit&#x27;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">document</span>.getElementById(<span class="string">&quot;csrf-form&quot;</span>).submit()</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">// 若刪除改為 json format</span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;https://small-min.blog.com/delete&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;text/plain&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&#x27;&#123;&quot;id&quot;:3, &quot;ignore_me&quot;:&quot;&#x27;</span> <span class="attr">value</span>=<span class="string">&#x27;test&quot;&#125;&#x27;</span> <span class="attr">type</span>=<span class="string">&#x27;hidden&#x27;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">value</span>=<span class="string">&quot;delete!&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="CORS-全名為-Cross-Origin-Resource-Sharing-跨來源資源共享"><a href="#CORS-全名為-Cross-Origin-Resource-Sharing-跨來源資源共享" class="headerlink" title="CORS(全名為 Cross-Origin Resource Sharing) 跨來源資源共享"></a>CORS(全名為 Cross-Origin Resource Sharing) 跨來源資源共享</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">header(<span class="string">&#x27;Access-Control-Allow-Origin: *&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="Offset-x2F-limit-based-and-Cursored-based-Pagination"><a href="#Offset-x2F-limit-based-and-Cursored-based-Pagination" class="headerlink" title="Offset&#x2F;limit-based and Cursored-based Pagination"></a>Offset&#x2F;limit-based and Cursored-based Pagination</h4><ul>
<li>offset 在運作的時候需要從頭開始尋訪 (Scan table) 才能知道要取哪一段資料，所以當分頁越後面的時候查詢時間就會越久，在小型資料庫並不會有特別的感覺，但是當資料量非常龐大 (到達幾千萬或是上億時) 時，就能感受到時間明顯的差距</li>
<li>對於大型資料庫做分頁的其中一個替代方案便是 Cursor-based pagination，其能夠有效使用資料庫的 index 進行尋訪，不會對於資料庫造成傷害</li>
</ul>
<h3 id="設計參考"><a href="#設計參考" class="headerlink" title="設計參考"></a>設計參考</h3><h4 id="PHP-Security-注意事項"><a href="#PHP-Security-注意事項" class="headerlink" title="PHP Security 注意事項"></a>PHP Security 注意事項</h4><ul>
<li>add session</li>
<li>password save by hash</li>
<li>XSS : print add htmlspecialchars(check echo 有無呼叫 escape function)</li>
<li>SQL injection : add prepared statement</li>
<li>權限管理 : 做以下動作前,要再 check user 是否符合<br>  modify, deleted, show private information</li>
</ul>
<h4 id="setup-XAMPP"><a href="#setup-XAMPP" class="headerlink" title="setup XAMPP"></a>setup XAMPP</h4><ul>
<li>XAMPP是最流行的PHP開發環境</li>
<li>MariaDB是MySQL關聯式資料庫管理系統的一個復刻，由社群開發，有商業支援</li>
</ul>
<h5 id="install-XAMPP"><a href="#install-XAMPP" class="headerlink" title="install XAMPP"></a>install <a target="_blank" rel="noopener" href="https://www.apachefriends.org/zh_tw/index.html">XAMPP</a></h5><h5 id="XAMPP-Config"><a href="#XAMPP-Config" class="headerlink" title="XAMPP Config"></a>XAMPP Config</h5><h6 id="run-XAMPP"><a href="#run-XAMPP" class="headerlink" title="run XAMPP"></a>run XAMPP</h6><div style="width:150px">
    <img src="/2021/05/31/php-1/pic1.png" class="" title="pic1">
</div>

<h6 id="Start-Apache-and-MySQL"><a href="#Start-Apache-and-MySQL" class="headerlink" title="Start Apache and MySQL"></a>Start Apache and MySQL</h6><div style="width:700px">
    <img src="/2021/05/31/php-1/pic2.png" class="" title="pic2">
    <img src="/2021/05/31/php-1/pic3.png" class="" title="pic3">
</div>

<h6 id="check-Admin-and-PHP-PHPInfo"><a href="#check-Admin-and-PHP-PHPInfo" class="headerlink" title="check Admin and PHP PHPInfo"></a>check Admin and PHP PHPInfo</h6><div style="width:700px">
    <img src="/2021/05/31/php-1/pic4.png" class="" title="pic4">
    <img src="/2021/05/31/php-1/pic5.png" class="" title="pic5">
    <img src="/2021/05/31/php-1/pic6.png" class="" title="pic6">
</div>

<h6 id="Config-PHP"><a href="#Config-PHP" class="headerlink" title="Config PHP"></a>Config PHP</h6><ul>
<li><p>點選 Config -&gt; &lt;browse&gt; [PHP]</p>
<div style="width:700px">
  <img src="/2021/05/31/php-1/pic7.png" class="" title="pic7">
</div>
</li>
<li><p>選 xampp &gt; htdocs 目錄</p>
<div style="width:700px">
  <img src="/2021/05/31/php-1/pic8.png" class="" title="pic8">
</div>
</li>
<li><p>新增工作目錄 和 檔案 a.php</p>
<div style="width:500px">
  <img src="/2021/05/31/php-1/pic9.png" class="" title="pic9">
</div>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>	</span><br><span class="line">	<span class="comment">// a.php</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;Hello!&quot;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>browser 執行 a.php</p>
<div style="width:500px">
  <img src="/2021/05/31/php-1/pic10.png" class="" title="pic10">
</div></li>
</ul>
<h4 id="PHP-基本語法"><a href="#PHP-基本語法" class="headerlink" title="PHP 基本語法"></a>PHP 基本語法</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>	</span><br><span class="line">	<span class="comment">// a.php</span></span><br><span class="line">	<span class="comment">// ; 結尾, echo 為輸出</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;Hello!&quot;</span> ;</span><br><span class="line">	<span class="comment">// 加入標簽(有作用)</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;&lt;h1&gt;Hello!&lt;h1&gt;&quot;</span> ;</span><br><span class="line">	<span class="comment">// 變數 $ 開頭</span></span><br><span class="line">	<span class="variable">$a</span> = <span class="number">1</span>; </span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line">	<span class="comment">// 字串不可相加, 要用 . </span></span><br><span class="line">	<span class="variable">$b</span> = <span class="string">&quot;bbbb&quot;</span>;</span><br><span class="line">	<span class="variable">$c</span> = <span class="string">&quot;cccc&quot;</span>;</span><br><span class="line">	<span class="comment">// echo $b + $d</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$b</span> . <span class="variable">$c</span>;</span><br><span class="line">	<span class="comment">// if 條件式</span></span><br><span class="line">	<span class="variable">$score</span> = <span class="number">70</span>;</span><br><span class="line">	<span class="keyword">if</span> (<span class="variable">$score</span> &gt;= <span class="number">60</span>) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;pass&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;fail&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// loop </span></span><br><span class="line">	<span class="comment">// \n 會解釋為空白(單引號與雙引號有差別)</span></span><br><span class="line">	<span class="comment">// 因用 browser 輸出, 故改為 &lt;br? 即可換行</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">1</span> ; <span class="variable">$i</span>&lt;=<span class="number">10</span> ; <span class="variable">$i</span>++) &#123;</span><br><span class="line">		<span class="comment">// echo $i . &quot;\n&quot;;</span></span><br><span class="line">		<span class="keyword">echo</span> <span class="variable">$i</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// array </span></span><br><span class="line">	<span class="variable">$arr</span> = <span class="keyword">array</span>(<span class="string">&quot;aa&quot;</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="string">&quot;zz&quot;</span>);</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span> . <span class="variable">$arr</span>[<span class="number">0</span>] . <span class="variable">$arr</span>[<span class="number">3</span>] . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">	<span class="comment">// array size</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;length=&quot;</span> . sizeof(<span class="variable">$arr</span>);</span><br><span class="line">	<span class="comment">// 直接 echo array 會有問題</span></span><br><span class="line">	<span class="comment">// echo $arr</span></span><br><span class="line">	<span class="comment">// dump array 可用 var_dump()</span></span><br><span class="line">	var_dump(<span class="variable">$arr</span>);</span><br><span class="line">	<span class="comment">// 另一個 dump function print_r()</span></span><br><span class="line">	print_r(<span class="variable">$arr</span>);</span><br><span class="line">	<span class="comment">// function</span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params"><span class="variable">$a</span> ,<span class="variable">$b</span></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="variable">$a</span> + <span class="variable">$b</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">echo</span> add(<span class="number">3</span>,<span class="number">6</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># output </span></span><br><span class="line">Hello!</span><br><span class="line">Hello!</span><br><span class="line">1bbbbccccpass1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line"></span><br><span class="line">aa4</span><br><span class="line">length=5array(5) &#123; [0]=&gt; string(2) <span class="string">&quot;aa&quot;</span> [1]=&gt; int(2) [2]=&gt; int(3) [3]=&gt; int(4) [4]=&gt; string(2) <span class="string">&quot;zz&quot;</span> &#125; </span><br><span class="line">Array ( [0] =&gt; aa [1] =&gt; 2 [2] =&gt; 3 [3] =&gt; 4 [4] =&gt; zz ) 9</span><br></pre></td></tr></table></figure>

<h4 id="Disable-cache"><a href="#Disable-cache" class="headerlink" title="Disable cache"></a>Disable cache</h4><p>使用XAMPP環境,有時程式改變但 browser 顯示卻不正確,可能是 cache 的影響,選擇 Disable cache 再從新整理即可</p>
<div style="width:700px">
    <img src="/2021/05/31/php-1/pic11.png" class="" title="pic11">
</div>

<h4 id="from-含不顯示資料-input’s-type-x3D-”hidden”"><a href="#from-含不顯示資料-input’s-type-x3D-”hidden”" class="headerlink" title="from 含不顯示資料 input’s type&#x3D;”hidden”"></a>from 含不顯示資料 input’s type&#x3D;”hidden”</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;form class=&quot;input-form&quot; method=&quot;POST&quot; action=&quot;update_content_handle.php&quot;&gt;</span><br><span class="line">	&lt;div class=&quot;hi&quot;&gt;</span><br><span class="line">		Hi, </span><br><span class="line">		<span class="meta">&lt;?php</span> </span><br><span class="line">			<span class="keyword">echo</span> <span class="variable">$_GET</span>[<span class="string">&#x27;nickname&#x27;</span>];	</span><br><span class="line">		<span class="meta">?&gt;</span> </span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">	&lt;textarea class=&quot;input-content&quot; name=&quot;content&quot; rows=&quot;5&quot;&gt;&lt;?php echo $content; ?&gt;&lt;/textarea&gt;</span><br><span class="line">	&lt;input type=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&#x27;id&#x27;</span> value=<span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>] <span class="meta">?&gt;</span> &gt;</span><br><span class="line">	&lt;input type=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&#x27;nickname&#x27;</span> value=<span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="variable">$_GET</span>[<span class="string">&#x27;nickname&#x27;</span>] <span class="meta">?&gt;</span> &gt;</span><br><span class="line">	&lt;input class=&quot;input-submit&quot; type=&quot;submit&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<h3 id="PHP-example"><a href="#PHP-example" class="headerlink" title="PHP example"></a>PHP example</h3><h4 id="Query-string"><a href="#Query-string" class="headerlink" title="Query string"></a>Query string</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;Hello! &lt;br&gt;&#x27;</span>;</span><br><span class="line">	<span class="comment">// 檢查 a 是否有傳進來</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>])) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;a:&quot;</span> . <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;b:&quot;</span> . <span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	print_r(<span class="variable">$_GET</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># web browser </span></span><br><span class="line">http://localhost/robert/data.php?a=1&amp;b=3</span><br><span class="line">	Hello!</span><br><span class="line">	a:1</span><br><span class="line">	b:3</span><br><span class="line">	Array ( [a] =&gt; 1 [b] =&gt; 3 )</span><br><span class="line"><span class="comment"># web browser </span></span><br><span class="line">http://localhost/robert/data.php?a=&amp;c=1</span><br><span class="line">	Hello!</span><br><span class="line">	a:</span><br><span class="line">	Array ( [a] =&gt; [c] =&gt; 1 )</span><br></pre></td></tr></table></figure>

<h4 id="show-time"><a href="#show-time" class="headerlink" title="show time"></a>show time</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;hello !&#x27;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;h1&gt;Now : <span class="meta">&lt;?php</span> <span class="keyword">echo</span> date(<span class="string">&#x27;Y-m-d H:i:s&#x27;</span>) <span class="meta">?&gt;</span>&lt;/h1&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># web browser </span></span><br><span class="line">http://localhost/robert/index.php</span><br><span class="line">	hello !</span><br><span class="line">	Now : 2021-06-07 08:13:39</span><br></pre></td></tr></table></figure>

<h4 id="form-by-GET"><a href="#form-by-GET" class="headerlink" title="form by GET"></a>form by GET</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- data.php --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="comment">// 檢查 是否有傳進來</span></span><br><span class="line">	<span class="comment">// if (!isset($_GET[&#x27;name&#x27;]) ||  !isset($_GET[&#x27;age&#x27;]) ) &#123;</span></span><br><span class="line">	<span class="comment">// 檢查空字串較合理</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>]) || <span class="keyword">empty</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;age&#x27;</span>]) ) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;請輸入資料!&quot;</span> ;</span><br><span class="line">		<span class="comment">// 程式跳開</span></span><br><span class="line">		<span class="keyword">exit</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;Hello! &#x27;</span> . <span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;Your age is &#x27;</span> . <span class="variable">$_GET</span>[<span class="string">&#x27;age&#x27;</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- index.php --&gt;</span><br><span class="line">&lt;form method=<span class="string">&quot;GET&quot;</span> action=<span class="string">&quot;data.php&quot;</span>&gt;</span><br><span class="line">	name: &lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&#x27;name&#x27;</span>&gt;</span><br><span class="line">	age: &lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&#x27;age&#x27;</span>&gt;</span><br><span class="line">	&lt;input type=<span class="string">&quot;submit&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<h4 id="form-by-POST-要改用-POST-抓參數"><a href="#form-by-POST-要改用-POST-抓參數" class="headerlink" title="form by POST - 要改用$_POST 抓參數"></a>form by POST - 要改用$_POST 抓參數</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- data.php --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="comment">// 檢查 是否有傳進來</span></span><br><span class="line">	<span class="comment">// if (!isset($_GET[&#x27;name&#x27;]) ||  !isset($_GET[&#x27;age&#x27;]) ) &#123;</span></span><br><span class="line">	<span class="comment">// 檢查空字串較合理</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;name&#x27;</span>]) || <span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;age&#x27;</span>]) ) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;請輸入資料!&quot;</span> ;</span><br><span class="line">		<span class="comment">// 程式跳開</span></span><br><span class="line">		<span class="keyword">exit</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;Hello! &#x27;</span> . <span class="variable">$_POST</span>[<span class="string">&#x27;name&#x27;</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;Your age is &#x27;</span> . <span class="variable">$_POST</span>[<span class="string">&#x27;age&#x27;</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">	print_r(<span class="variable">$_POST</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- index.php --&gt;</span><br><span class="line">&lt;form method=<span class="string">&quot;POST&quot;</span> action=<span class="string">&quot;data.php&quot;</span>&gt;</span><br><span class="line">	name: &lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&#x27;name&#x27;</span>&gt;</span><br><span class="line">	age: &lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&#x27;age&#x27;</span>&gt;</span><br><span class="line">	&lt;input type=<span class="string">&quot;submit&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<h4 id="Query-strig-標示錯誤"><a href="#Query-strig-標示錯誤" class="headerlink" title="Query strig 標示錯誤"></a>Query strig 標示錯誤</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">	<span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;errorCode&#x27;</span>])) &#123;</span><br><span class="line">		<span class="variable">$code</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;errorCode&#x27;</span>];</span><br><span class="line">		<span class="variable">$msg</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">		<span class="keyword">if</span> (<span class="variable">$code</span> === <span class="string">&#x27;1&#x27;</span>) &#123;</span><br><span class="line">			<span class="variable">$msg</span> = <span class="string">&#x27;輸入不齊全!&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;&lt;h2 class=&quot;error&quot;&gt; 錯誤 : &#x27;</span> . <span class="variable">$msg</span> . <span class="string">&#x27;&lt;/h2&gt;&#x27;</span> ;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// load 含 error code</span></span><br><span class="line">header(<span class="string">&#x27;Location: index.php?errorCode=1&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="產生亂數字串"><a href="#產生亂數字串" class="headerlink" title="產生亂數字串"></a>產生亂數字串</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">creatToken</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="variable">$str</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">20</span> ; <span class="variable">$i</span>++) &#123;</span><br><span class="line">		<span class="variable">$str</span> = <span class="variable">$str</span> . chr(rand(<span class="number">65</span>,<span class="number">90</span>));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="variable">$str</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="global-全域變數"><a href="#global-全域變數" class="headerlink" title="global 全域變數"></a>global 全域變數</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">   <span class="keyword">global</span> <span class="variable">$a</span>;</span><br><span class="line">   </span><br><span class="line">   <span class="variable">$a</span> = <span class="variable">$a</span>*<span class="number">100</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sum();</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="htmlspecialchars-for-XSS"><a href="#htmlspecialchars-for-XSS" class="headerlink" title="htmlspecialchars for XSS"></a>htmlspecialchars for XSS</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// default 第二個引數為ENT_COMPAT,只轉化雙引號,不對單引號做轉換,故加入 ENT_QUOTES</span></span><br><span class="line"><span class="variable">$content</span> = htmlspecialchars(<span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>],ENT_QUOTES);</span><br></pre></td></tr></table></figure>

<h3 id="Snippet-for-mySQL"><a href="#Snippet-for-mySQL" class="headerlink" title="Snippet for mySQL"></a>Snippet for mySQL</h3><h4 id="special-parameter"><a href="#special-parameter" class="headerlink" title="special parameter"></a>special parameter</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// check update/detelet success - $conn-&gt;affected_rows</span></span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;update comment set content=? where id = ? and username=?&quot;</span>;</span><br><span class="line"><span class="variable">$stmt</span>= <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$stmt</span>-&gt;bind_param(<span class="string">&#x27;sss&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>], <span class="variable">$_POST</span>[<span class="string">&#x27;id&#x27;</span>], <span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>]);</span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">	print_r(<span class="variable">$conn</span>-&gt;error);</span><br><span class="line">	header(<span class="string">&#x27;Location: update_content.php?errorCode=2&amp;nickname=$_POST[&quot;nickname&quot;]&amp;id=$_POST[&quot;id&quot;]&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$affect_rows</span> = (<span class="keyword">int</span>)<span class="variable">$conn</span>-&gt;affected_rows;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$affect_rows</span>&lt;<span class="number">1</span>) &#123;</span><br><span class="line">	header(<span class="string">&#x27;Location: index.php?errorCode=3&#x27;</span>);</span><br><span class="line">	<span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="connect-database"><a href="#connect-database" class="headerlink" title="connect database"></a>connect database</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- conn.php --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="variable">$server_name</span> = <span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line">	<span class="variable">$username</span> = <span class="string">&#x27;robert&#x27;</span>;</span><br><span class="line">	<span class="variable">$password</span> = <span class="string">&#x27;pass&#x27;</span>;</span><br><span class="line">	<span class="variable">$db_name</span> = <span class="string">&#x27;robert&#x27;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$conn</span> = <span class="keyword">new</span> mysqli(<span class="variable">$server_name</span>, <span class="variable">$username</span>, <span class="variable">$password</span>, <span class="variable">$db_name</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (<span class="variable">$conn</span>-&gt;connect_error) &#123;</span><br><span class="line">		<span class="comment">// echo &#x27;資料庫連接錯誤 : &#x27; . $conn-&gt;connect_error . &#x27;&lt;br&gt;&#x27;;</span></span><br><span class="line">		<span class="comment">// die 表程式結束,後面不再執行</span></span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&#x27;資料庫連接錯誤 : &#x27;</span> . <span class="variable">$conn</span>-&gt;connect_error);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 設定編碼,中文才不會有問題</span></span><br><span class="line">	<span class="variable">$conn</span>-&gt;query(<span class="string">&#x27;SET NAMES UTF8&#x27;</span>);</span><br><span class="line">	<span class="comment">// 設定我們的時區</span></span><br><span class="line">	<span class="variable">$conn</span>-&gt;query(<span class="string">&#x27;SET time_zone = &quot;+8:00&quot;&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- data.php --&gt;</span><br><span class="line">&lt;?php</span><br><span class="line">	&#x2F;&#x2F; include file</span><br><span class="line">	require_once(&#39;conn.php&#39;);</span><br><span class="line"></span><br><span class="line">	......</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h4 id="query-time-from-database"><a href="#query-time-from-database" class="headerlink" title="query time from database"></a>query time from database</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- data.php --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="comment">// include file</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;conn.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$conn</span>-&gt;query(<span class="string">&quot;select now();&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="variable">$conn</span>-&gt;error);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// print_r($result);</span></span><br><span class="line">	<span class="comment">// 拿到結果</span></span><br><span class="line">	<span class="variable">$row</span> = <span class="variable">$result</span>-&gt;fetch_assoc();</span><br><span class="line">	print_r(<span class="variable">$row</span>);		<span class="comment">// Array ( [now()] =&gt; 2021-06-07 16:43:20 )</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;now:&#x27;</span> . <span class="variable">$row</span>[<span class="string">&#x27;now()&#x27;</span>]; <span class="comment">// now:2021-06-07 16:43:20</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- data.php --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="comment">// include file</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;conn.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$conn</span>-&gt;query(<span class="string">&quot;select now() as n;&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="variable">$conn</span>-&gt;error);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// print_r($result);</span></span><br><span class="line">	<span class="comment">// 拿到結果</span></span><br><span class="line">	<span class="variable">$row</span> = <span class="variable">$result</span>-&gt;fetch_assoc();</span><br><span class="line">	<span class="comment">//print_r($row);		</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;br&gt;now:&#x27;</span> . <span class="variable">$row</span>[<span class="string">&#x27;n&#x27;</span>]; <span class="comment">// now:2021-06-07 16:43:20</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="讀取-mySQL"><a href="#讀取-mySQL" class="headerlink" title="讀取 mySQL"></a>讀取 mySQL</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- index.php --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="comment">// include file</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;conn.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&quot;select * from comment order by id DESC;&quot;</span>;</span><br><span class="line">	<span class="comment">//$result = $conn-&gt;query($sql);</span></span><br><span class="line">	<span class="comment">//if (!$result) &#123;</span></span><br><span class="line">	<span class="comment">//	die(&#x27;Error : &#x27; . $conn-&gt;error);</span></span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">	<span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">	<span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&#x27;Error : &#x27;</span> . <span class="variable">$conn</span>-&gt;error);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 真正取資料要執行 $stmt-&gt;get_result();</span></span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;get_result();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 印出所有資料</span></span><br><span class="line">	<span class="comment">// $row = $result-&gt;fetch_assoc() 每次讀出一筆資料,無資料時讀出空資料</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="variable">$row</span> = <span class="variable">$result</span>-&gt;fetch_assoc()) &#123;</span><br><span class="line">		<span class="comment">// print_r($row);	</span></span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;nickname : &#x27;</span> . <span class="variable">$row</span>[<span class="string">&#x27;nickname&#x27;</span>] . <span class="string">&#x27; content : &#x27;</span> . <span class="variable">$row</span>[<span class="string">&#x27;content&#x27;</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>; </span><br><span class="line">	&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="讀取-mySQL-check-error"><a href="#讀取-mySQL-check-error" class="headerlink" title="讀取 mySQL(check error)"></a>讀取 mySQL(check error)</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;conn.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ( <span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) || <span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]) ) &#123;</span><br><span class="line">		header(<span class="string">&#x27;Location: login.php?errorCode=1&#x27;</span>);</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;輸入錯誤!&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//$sql = sprintf(&quot;select * from users where username= &#x27;%s&#x27; and password = &#x27;%s&#x27;; &quot;,</span></span><br><span class="line">	<span class="comment">//		$_POST[&#x27;username&#x27;], $_POST[&#x27;password&#x27;]);</span></span><br><span class="line">	<span class="comment">//$result = $conn-&gt;query($sql);</span></span><br><span class="line">	<span class="comment">//if (!$result) &#123;</span></span><br><span class="line">	<span class="comment">//	die($conn-&gt;error);</span></span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&quot;select * from users where username= ? and password = ?&quot;</span>;</span><br><span class="line">	<span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line">	<span class="variable">$stmt</span>-&gt;bind_param(<span class="string">&#x27;ss&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>], <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">	<span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="variable">$conn</span>-&gt;error);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 真正取資料要執行 $stmt-&gt;get_result();</span></span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;get_result();</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// $result-&gt;num_rows,$conn-&gt;affected_rows 都可以</span></span><br><span class="line">	<span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows &lt; <span class="number">1</span> ) &#123;</span><br><span class="line">		header(<span class="string">&#x27;Location: login.php?errorCode=2&#x27;</span>);</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;登入失敗&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;登入成功&quot;</span>;</span><br><span class="line">	<span class="variable">$expire</span> = time()+<span class="number">3600</span>*<span class="number">24</span>*<span class="number">30</span>;</span><br><span class="line">	setcookie(<span class="string">&quot;username&quot;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>], <span class="variable">$expire</span>);</span><br><span class="line">	header(<span class="string">&#x27;Location: index.php&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="新增-mySQL-資料"><a href="#新增-mySQL-資料" class="headerlink" title="新增 mySQL 資料"></a>新增 mySQL 資料</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- add.php --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="comment">// include file</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;conn.php&#x27;</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// command 方法 #1</span></span><br><span class="line">	<span class="comment">// $result = $conn-&gt;query(&quot;insert into users(username) values(&#x27;apple&#x27;)&quot;);</span></span><br><span class="line">	<span class="variable">$username</span> = <span class="string">&#x27;orange&#x27;</span>;</span><br><span class="line">	<span class="comment">// command 方法 #2</span></span><br><span class="line">	<span class="comment">// $sql = &quot;insert into users(username) values(&#x27;&quot; . $username . &quot;&#x27;)&quot;;</span></span><br><span class="line">	<span class="comment">// command 方法 #3</span></span><br><span class="line">	<span class="comment">// $sql = sprintf(&quot;insert into users(id, username) values(%d, &#x27;%s&#x27;)&quot;, 13, $username);</span></span><br><span class="line">	<span class="comment">// ---</span></span><br><span class="line">	<span class="comment">// $sql = sprintf(&quot;insert into users(username) values(&#x27;%s&#x27;)&quot;, $username);</span></span><br><span class="line">	<span class="comment">// $result = $conn-&gt;query($sql);</span></span><br><span class="line"></span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&quot;insert into users(username) values(?)&quot;</span>;</span><br><span class="line">	<span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line">	<span class="variable">$stmt</span>-&gt;bind_param(<span class="string">&#x27;s&#x27;</span>, <span class="variable">$username</span>) ;</span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="variable">$conn</span>-&gt;error);</span><br><span class="line">	&#125;</span><br><span class="line">	print_r(<span class="variable">$result</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="新增-mySQL-資料-使用-form"><a href="#新增-mySQL-資料-使用-form" class="headerlink" title="新增 mySQL 資料(使用 form)"></a>新增 mySQL 資料(使用 form)</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- index.php --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="comment">// include file</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;conn.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 大到小排列</span></span><br><span class="line">	<span class="comment">// $result = $conn-&gt;query(&quot;SELECT * FROM users ORDER BY id DESC;&quot;);</span></span><br><span class="line">	<span class="comment">// 小到大排列</span></span><br><span class="line">	<span class="comment">//$result = $conn-&gt;query(&quot;SELECT * FROM users ORDER BY id ASC;&quot;);</span></span><br><span class="line">	<span class="comment">//if (!$result) &#123;</span></span><br><span class="line">	<span class="comment">//	die($conn-&gt;error);</span></span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users ORDER BY id ASC&quot;</span>;</span><br><span class="line">	<span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">	<span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&#x27;Error : &#x27;</span> . <span class="variable">$conn</span>-&gt;error);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 真正取資料要執行 $stmt-&gt;get_result();</span></span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;get_result();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 印出所有資料</span></span><br><span class="line">	<span class="comment">// $row = $result-&gt;fetch_assoc() 每次讀出一筆資料,無資料時讀出空資料</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="variable">$row</span> = <span class="variable">$result</span>-&gt;fetch_assoc()) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;id : &#x27;</span> . <span class="variable">$row</span>[<span class="string">&#x27;id&#x27;</span>] . <span class="string">&#x27; username : &#x27;</span> . <span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;  <span class="comment">// id : 1 username : Mary ...</span></span><br><span class="line">	&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;h2&gt;新增 user&lt;/h2&gt;</span><br><span class="line">&lt;form method=<span class="string">&quot;POST&quot;</span> action=<span class="string">&quot;add.php&quot;</span>&gt;</span><br><span class="line">	username: &lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&#x27;username&#x27;</span>&gt;</span><br><span class="line">	&lt;input type=<span class="string">&quot;submit&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- add.php --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="comment">// include file</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;conn.php&#x27;</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>])) &#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&#x27;請輸入 username&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">	<span class="comment">// command 方法 #1</span></span><br><span class="line">	<span class="comment">// $result = $conn-&gt;query(&quot;insert into users(username) values(&#x27;apple&#x27;)&quot;);</span></span><br><span class="line">	<span class="comment">// command 方法 #2</span></span><br><span class="line">	<span class="comment">// $sql = &quot;insert into users(username) values(&#x27;&quot; . $username . &quot;&#x27;)&quot;;</span></span><br><span class="line">	<span class="comment">// command 方法 #3</span></span><br><span class="line">	<span class="comment">// $sql = sprintf(&quot;insert into users(id, username) values(%d, &#x27;%s&#x27;)&quot;, 13, $username);</span></span><br><span class="line">	<span class="comment">// --</span></span><br><span class="line">	<span class="comment">// $sql = sprintf(&quot;insert into users(username) values(&#x27;%s&#x27;)&quot;, $username);</span></span><br><span class="line">	<span class="comment">// $result = $conn-&gt;query($sql);</span></span><br><span class="line"></span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&quot;insert into users(username) values(?)&quot;</span>;</span><br><span class="line">	<span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line">	<span class="variable">$stmt</span>-&gt;bind_param(<span class="string">&#x27;s&#x27;</span>, <span class="variable">$username</span>) ;</span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="variable">$conn</span>-&gt;error);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;新增成功!&#x27;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// run index.php</span></span><br><span class="line">	header(<span class="string">&quot;Location: index.php&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="新增-mySQL-資料-check-error"><a href="#新增-mySQL-資料-check-error" class="headerlink" title="新增 mySQL 資料(check error)"></a>新增 mySQL 資料(check error)</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;conn.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> ( <span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) || <span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>])</span><br><span class="line">		|| <span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>])) &#123;</span><br><span class="line">		header(<span class="string">&#x27;Location: register.php?errorCode=1&#x27;</span>);</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;輸入錯誤!&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//$sql = sprintf(&quot;insert into users(username, nickname, password) values(&#x27;%s&#x27;, &#x27;%s&#x27;, &#x27;%s&#x27;)&quot;,</span></span><br><span class="line">	<span class="comment">//		$_POST[&#x27;username&#x27;], $_POST[&#x27;nickname&#x27;], $_POST[&#x27;password&#x27;]);</span></span><br><span class="line">	<span class="comment">//$result = $conn-&gt;query($sql);</span></span><br><span class="line"></span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&quot;insert into users(username, nickname, password) values(?, ?, ?)&quot;</span>;</span><br><span class="line">	<span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line">	<span class="variable">$stmt</span>-&gt;bind_param(<span class="string">&#x27;sss&#x27;</span>,<span class="variable">$username</span>, <span class="variable">$nickname</span>, password_hash(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>], PASSWORD_DEFAULT) ) ;</span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">		<span class="comment">// check 是否包含字串,不包含傳回 false</span></span><br><span class="line">		<span class="comment">// if (strpos($conn-&gt;error, &#x27;Duplicate entry&#x27;) !== false) &#123;</span></span><br><span class="line">		<span class="comment">// check duplicate error code = 1062</span></span><br><span class="line">		<span class="keyword">if</span>  (<span class="variable">$conn</span>-&gt;errno === <span class="number">1062</span>) &#123;</span><br><span class="line">			 header(<span class="string">&#x27;Location: register.php?errorCode=2&#x27;</span>);</span><br><span class="line">			 <span class="keyword">echo</span> <span class="string">&#x27;帳號已被註冊!&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">		 	header(<span class="string">&#x27;Location: register.php?errorCode=3&#x27;</span>);</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&#x27;新增錯誤!&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">die</span>(<span class="variable">$conn</span>-&gt;error);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;新增完成&quot;</span>;</span><br><span class="line">	<span class="variable">$expire</span> = time()+<span class="number">3600</span>*<span class="number">24</span>*<span class="number">30</span>;</span><br><span class="line">	setcookie(<span class="string">&quot;username&quot;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>], <span class="variable">$expire</span>);</span><br><span class="line">	header(<span class="string">&#x27;Location: index.php&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>


<h4 id="刪除-mySQL-資料"><a href="#刪除-mySQL-資料" class="headerlink" title="刪除 mySQL 資料"></a>刪除 mySQL 資料</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- index.php --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="comment">// include file</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;conn.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 小到大排列</span></span><br><span class="line">	<span class="comment">//$result = $conn-&gt;query(&quot;SELECT * FROM users ORDER BY id ASC;&quot;);</span></span><br><span class="line">	<span class="comment">//if (!$result) &#123;</span></span><br><span class="line">	<span class="comment">//	die($conn-&gt;error);</span></span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users ORDER BY id ASC&quot;</span>;</span><br><span class="line">	<span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">	<span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&#x27;Error : &#x27;</span> . <span class="variable">$conn</span>-&gt;error);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 真正取資料要執行 $stmt-&gt;get_result();</span></span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;get_result();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 印出所有資料</span></span><br><span class="line">	<span class="comment">// $row = $result-&gt;fetch_assoc() 每次讀出一筆資料,無資料時讀出空資料</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="variable">$row</span> = <span class="variable">$result</span>-&gt;fetch_assoc()) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;id : &#x27;</span> . <span class="variable">$row</span>[<span class="string">&#x27;id&#x27;</span>] . <span class="string">&#x27; username : &#x27;</span> . <span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>] .  <span class="string">&#x27;&lt;a href=&quot;delete.php?id=&#x27;</span> . <span class="variable">$row</span>[<span class="string">&#x27;id&#x27;</span>] . <span class="string">&#x27;&quot;&gt;刪除&lt;/a&gt;&#x27;</span> . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;  <span class="comment">// id : 1 username : Mary ...</span></span><br><span class="line">	&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;h2&gt;新增 user&lt;/h2&gt;</span><br><span class="line">&lt;form method=<span class="string">&quot;POST&quot;</span> action=<span class="string">&quot;add.php&quot;</span>&gt;</span><br><span class="line">	username: &lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&#x27;username&#x27;</span>&gt;</span><br><span class="line">	&lt;input type=<span class="string">&quot;submit&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- delete.php --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="comment">// include file</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;conn.php&#x27;</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>])) &#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&#x27;請輸入 id&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">	<span class="comment">//$sql = sprintf(&quot;delete from users where id = %d&quot;, $id);</span></span><br><span class="line">	<span class="comment">//$result = $conn-&gt;query($sql);</span></span><br><span class="line">	<span class="comment">//if (!$result) &#123;</span></span><br><span class="line">	<span class="comment">//	die($conn-&gt;error);</span></span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&quot;delete from users where id = ?&quot;</span>;</span><br><span class="line">	<span class="variable">$stmt</span>= <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line">	<span class="variable">$stmt</span>-&gt;bind_param(<span class="string">&#x27;s&#x27;</span>, <span class="variable">$id</span>);</span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">	<span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">		print_r(<span class="variable">$conn</span>-&gt;error);</span><br><span class="line">		header(<span class="string">&#x27;Location: index.php?errorCode=3&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// check update or delete some item</span></span><br><span class="line">	<span class="variable">$affect_rows</span> = (<span class="keyword">int</span>)<span class="variable">$conn</span>-&gt;affected_rows;</span><br><span class="line">	<span class="keyword">if</span> (<span class="variable">$affect_rows</span>&lt;<span class="number">1</span>) &#123;</span><br><span class="line">		header(<span class="string">&#x27;Location: index.php?errorCode=3&#x27;</span>);</span><br><span class="line">		<span class="keyword">exit</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;刪除成功!&#x27;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// run index.php</span></span><br><span class="line">	header(<span class="string">&quot;Location: index.php&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="刪除-mySQL-資料-soft-delete"><a href="#刪除-mySQL-資料-soft-delete" class="headerlink" title="刪除 mySQL 資料(soft delete)"></a>刪除 mySQL 資料(soft delete)</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;conn.php&#x27;</span>);</span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;utils.php&#x27;</span>);</span><br><span class="line">	session_start();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// if account not valid auto re-direct to index(logout)</span></span><br><span class="line">	accountValid();</span><br><span class="line">	</span><br><span class="line">	<span class="variable">$id</span> = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>])) &#123;</span><br><span class="line">		<span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// $sql = &quot;update blog set is_deleted=? where id=?&quot;;</span></span><br><span class="line">	<span class="comment">// $stmt = $conn-&gt;prepare($sql);</span></span><br><span class="line">	<span class="comment">// // 使用 true, TRUE or 1 都可, 但不能設值要使用變數</span></span><br><span class="line">	<span class="comment">// $true = true;</span></span><br><span class="line">	<span class="comment">// $stmt-&gt;bind_param(&#x27;bs&#x27;, $true, $id);</span></span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&quot;update blog set is_deleted=TRUE where id=?&quot;</span>;</span><br><span class="line">	<span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line">	<span class="variable">$stmt</span>-&gt;bind_param(<span class="string">&#x27;s&#x27;</span>, <span class="variable">$id</span>);</span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">	<span class="keyword">if</span>(!<span class="variable">$result</span>) &#123;</span><br><span class="line">		header(<span class="string">&#x27;Location: admin.php?id=&#x27;</span> . <span class="variable">$id</span> . <span class="string">&#x27;&amp;errorCode=2&#x27;</span>);</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&#x27;刪除錯誤!&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$affect_rows</span> = (<span class="keyword">int</span>)<span class="variable">$conn</span>-&gt;affected_rows;</span><br><span class="line">	<span class="keyword">if</span> (<span class="variable">$affect_rows</span>&lt;<span class="number">1</span>) &#123;</span><br><span class="line">		header(<span class="string">&#x27;Location: admin.php?id=&#x27;</span> . <span class="variable">$id</span> . <span class="string">&#x27;&amp;errorCode=2&#x27;</span>);</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&#x27;刪除錯誤!&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;刪除完成!&#x27;</span>;</span><br><span class="line">	header(<span class="string">&#x27;Location: admin.php&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="修改-mySQL-資料"><a href="#修改-mySQL-資料" class="headerlink" title="修改 mySQL 資料"></a>修改 mySQL 資料</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- index.php --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="comment">// include file</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;conn.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 小到大排列</span></span><br><span class="line">	<span class="comment">//$result = $conn-&gt;query(&quot;SELECT * FROM users ORDER BY id ASC;&quot;);</span></span><br><span class="line">	<span class="comment">//if (!$result) &#123;</span></span><br><span class="line">	<span class="comment">//	die($conn-&gt;error);</span></span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM users ORDER BY id ASC&quot;</span>;</span><br><span class="line">	<span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">	<span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&#x27;Error : &#x27;</span> . <span class="variable">$conn</span>-&gt;error);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 真正取資料要執行 $stmt-&gt;get_result();</span></span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;get_result();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 印出所有資料</span></span><br><span class="line">	<span class="comment">// $row = $result-&gt;fetch_assoc() 每次讀出一筆資料,無資料時讀出空資料</span></span><br><span class="line">	<span class="keyword">while</span> (<span class="variable">$row</span> = <span class="variable">$result</span>-&gt;fetch_assoc()) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;id : &#x27;</span> . <span class="variable">$row</span>[<span class="string">&#x27;id&#x27;</span>] . <span class="string">&#x27; username : &#x27;</span> . <span class="variable">$row</span>[<span class="string">&#x27;username&#x27;</span>] .  <span class="string">&#x27;&lt;a href=&quot;delete.php?id=&#x27;</span> . <span class="variable">$row</span>[<span class="string">&#x27;id&#x27;</span>] . <span class="string">&#x27;&quot;&gt;刪除&lt;/a&gt;&#x27;</span> . <span class="string">&#x27;&lt;br&gt;&#x27;</span>;  <span class="comment">// id : 1 username : Mary ...</span></span><br><span class="line">	&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;h2&gt;新增 user&lt;/h2&gt;</span><br><span class="line">&lt;form method=<span class="string">&quot;POST&quot;</span> action=<span class="string">&quot;add.php&quot;</span>&gt;</span><br><span class="line">	username: &lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&#x27;username&#x27;</span>&gt;</span><br><span class="line">	&lt;input type=<span class="string">&quot;submit&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;h2&gt;編輯 user&lt;/h2&gt;</span><br><span class="line">&lt;form method=<span class="string">&quot;POST&quot;</span> action=<span class="string">&quot;update.php&quot;</span>&gt;</span><br><span class="line">	id: &lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&#x27;id&#x27;</span>&gt;</span><br><span class="line">	username: &lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&#x27;username&#x27;</span>&gt;</span><br><span class="line">	&lt;input type=<span class="string">&quot;submit&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- update.php --&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="comment">// include file</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;conn.php&#x27;</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;id&#x27;</span>]) || <span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>])) &#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&#x27;請輸入 id 和 username&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$id</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">	<span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">	<span class="comment">//$sql = sprintf(&quot;update users set username=&#x27;%s&#x27; where id=%d&quot;,</span></span><br><span class="line">	<span class="comment">//				$username, $id);</span></span><br><span class="line">	<span class="comment">//$result = $conn-&gt;query($sql);</span></span><br><span class="line">	<span class="comment">//if (!$result) &#123;</span></span><br><span class="line">	<span class="comment">//	die($conn-&gt;error);</span></span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	<span class="comment">//if ($conn-&gt;affected_rows &gt;=1) &#123;</span></span><br><span class="line">	<span class="comment">//	echo &#x27;編輯成功!&#x27;;</span></span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line">	<span class="comment">//else &#123;</span></span><br><span class="line">	<span class="comment">//	echo &#x27;查無資料!&#x27;;</span></span><br><span class="line">	<span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&quot;update users set username=? where id=?&quot;</span>;</span><br><span class="line">	<span class="variable">$stmt</span>= <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line">	<span class="variable">$stmt</span>-&gt;bind_param(<span class="string">&#x27;ss&#x27;</span>, <span class="variable">$username</span>, <span class="variable">$id</span>);</span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">	<span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">		header(<span class="string">&#x27;Location: index.php?errorCode=3&#x27;</span>);</span><br><span class="line">		print_r(<span class="variable">$conn</span>-&gt;error);</span><br><span class="line">		<span class="keyword">exit</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// check update or delete some item</span></span><br><span class="line">	<span class="variable">$affect_rows</span> = (<span class="keyword">int</span>)<span class="variable">$conn</span>-&gt;affected_rows;</span><br><span class="line">	<span class="keyword">if</span> (<span class="variable">$affect_rows</span>&lt;<span class="number">1</span>) &#123;</span><br><span class="line">		header(<span class="string">&#x27;Location: index.php?errorCode=3&#x27;</span>);</span><br><span class="line">		<span class="keyword">exit</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// run index.php</span></span><br><span class="line">	header(<span class="string">&quot;Location: index.php&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="MySQL-Prepared-Statements-預防-SQL-injection"><a href="#MySQL-Prepared-Statements-預防-SQL-injection" class="headerlink" title="MySQL Prepared Statements (預防 SQL injection)"></a><a target="_blank" rel="noopener" href="https://www.w3schools.com/php/php_mysql_prepared_statements.asp">MySQL Prepared Statements</a> (預防 SQL injection)</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select * from users where username= ?&quot;</span>;</span><br><span class="line"><span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$stmt</span>-&gt;bind_param(<span class="string">&#x27;s&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]);</span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="variable">$conn</span>-&gt;error);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 真正取資料要執行 $stmt-&gt;get_result();</span></span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;get_result();</span><br><span class="line"></span><br><span class="line"><span class="comment">// $result-&gt;num_rows,$conn-&gt;affected_rows 都可以</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows &lt; <span class="number">1</span> ) &#123;</span><br><span class="line">	header(<span class="string">&#x27;Location: login.php?errorCode=2&#x27;</span>);</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">&quot;登入失敗&quot;</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h4 id="MySQL-join"><a href="#MySQL-join" class="headerlink" title="MySQL join"></a><a target="_blank" rel="noopener" href="https://joins.spathon.com/">MySQL join</a></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># INNER JOIN</span></span><br><span class="line">SELECT users.name, likes.like FROM users JOIN likes ON users.id = likes.user_id;</span><br><span class="line"><span class="comment"># LEFT JOIN</span></span><br><span class="line">SELECT users.name, likes.like FROM users LEFT JOIN likes ON users.id = likes.user_id;</span><br><span class="line"><span class="comment"># RIGHT JOIN</span></span><br><span class="line">SELECT users.name, likes.like FROM users RIGHT JOIN likes ON users.id = likes.user_id;</span><br><span class="line"><span class="comment"># OUTER JOIN</span></span><br><span class="line">SELECT users.name, likes.like FROM users LEFT OUTER JOIN likes ON users.id = likes.user_id</span><br><span class="line">UNION</span><br><span class="line">SELECT users.name, likes.like FROM users RIGHT OUTER JOIN likes ON users.id = likes.user_id</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&#x27;select C.id, C.content, C.create_at, U.username, U.nickname &#x27;</span> . </span><br><span class="line">					<span class="string">&#x27;from comment as C left join users as U &#x27;</span> .</span><br><span class="line">					<span class="string">&#x27;on C.username = U.username &#x27;</span> . </span><br><span class="line">					<span class="string">&#x27;where C.deleted!=1 order by C.id DESC&#x27;</span>;</span><br><span class="line"><span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">&#x27;Error : &#x27;</span> . <span class="variable">$conn</span>-&gt;error);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 真正取資料要執行 $stmt-&gt;get_result();</span></span><br><span class="line"><span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;get_result();</span><br><span class="line"><span class="keyword">while</span> (<span class="variable">$row</span> = <span class="variable">$result</span>-&gt;fetch_assoc()) &#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;nickname : &#x27;</span> . <span class="variable">$row</span>[<span class="string">&#x27;nickname&#x27;</span>] . <span class="string">&#x27; content : &#x27;</span> . <span class="variable">$row</span>[<span class="string">&#x27;content&#x27;</span>] . <span class="string">&#x27;&lt;br&gt;&#x27;</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="MySQL-limit-and-offset"><a href="#MySQL-limit-and-offset" class="headerlink" title="MySQL limit and offset"></a>MySQL limit and offset</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span> = <span class="string">&#x27;select C.id, C.content, C.create_at, U.username, U.nickname &#x27;</span> . </span><br><span class="line">					<span class="string">&#x27;from comment as C left join users as U &#x27;</span> .</span><br><span class="line">					<span class="string">&#x27;on C.username = U.username &#x27;</span> . </span><br><span class="line">					<span class="string">&#x27;where C.deleted!=1 order by C.id DESC&#x27;</span>;</span><br><span class="line"><span class="variable">$sql</span> = <span class="variable">$sql</span> . <span class="string">&#x27; LIMIT &#x27;</span> . <span class="variable">$item_perpage</span> . <span class="string">&#x27; OFFSET &#x27;</span> . (<span class="variable">$page</span>-<span class="number">1</span>)*<span class="variable">$item_perpage</span>;</span><br></pre></td></tr></table></figure>

<h4 id="MySQL-檢查欄位是否-NULL-或空白"><a href="#MySQL-檢查欄位是否-NULL-或空白" class="headerlink" title="MySQL 檢查欄位是否 NULL 或空白"></a>MySQL 檢查欄位是否 NULL 或空白</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 欄位 col_name 是 NULL 的紀錄</span></span><br><span class="line">ELECT * FROM table_name WHERE col_name IS NULL</span><br><span class="line"><span class="comment"># 欄位 col_name 不是 NULL 的記錄</span></span><br><span class="line">SELECT * FROM table_name WHERE col_name IS NOT NULL</span><br><span class="line"><span class="comment">#欄位 col_name 是 NULL 或 空字串 的記錄</span></span><br><span class="line">SELECT * FROM table_name WHERE col_name IS NULL OR col_name = <span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="login-檢查"><a href="#login-檢查" class="headerlink" title="login 檢查"></a>login 檢查</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// login_handle.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;conn.php&#x27;</span>);</span><br><span class="line">	session_start();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> ( <span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) || <span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]) ) &#123;</span><br><span class="line">		header(<span class="string">&#x27;Location: login.php?errorCode=4&#x27;</span>);</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;輸入錯誤!&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">	<span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&quot;select * from users where username=?&quot;</span>;</span><br><span class="line">	<span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line">	<span class="variable">$stmt</span>-&gt;bind_param(<span class="string">&#x27;s&#x27;</span>, <span class="variable">$username</span>);</span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">	<span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">		header(<span class="string">&#x27;Location: login.php?errorCode=1&#x27;</span>);</span><br><span class="line">		print_r(<span class="variable">$conn</span>-&gt;error);</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;資料庫錯誤!&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 真正取資料要執行 $stmt-&gt;get_result();</span></span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;get_result();</span><br><span class="line">	<span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows &lt; <span class="number">1</span>) &#123;</span><br><span class="line">		header(<span class="string">&#x27;Location: login.php?errorCode=2&#x27;</span>);</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;查無帳號!&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$row</span> = <span class="variable">$result</span>-&gt;fetch_assoc();</span><br><span class="line">	<span class="keyword">if</span>(!password_verify(<span class="variable">$password</span>, <span class="variable">$row</span>[<span class="string">&#x27;password&#x27;</span>])) &#123;</span><br><span class="line">		header(<span class="string">&#x27;Location: login.php?errorCode=3&#x27;</span>);</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;密碼錯誤!&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&quot;登入成功!&quot;</span>;</span><br><span class="line">	<span class="comment">// set session</span></span><br><span class="line">	<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>] = <span class="variable">$username</span>;</span><br><span class="line">	header(<span class="string">&#x27;Location: index.php&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>check login state</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	session_start();</span><br><span class="line"></span><br><span class="line">	<span class="variable">$username</span> = <span class="literal">NULL</span>;</span><br><span class="line">	<span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>])) &#123;</span><br><span class="line">		<span class="variable">$username</span> = <span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">	&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;div class=&quot;nav-right&quot;&gt;</span><br><span class="line">	<span class="meta">&lt;?php</span> <span class="keyword">if</span>(<span class="variable">$username</span>) &#123; <span class="meta">?&gt;</span></span><br><span class="line">		&lt;div class=&quot;nav-item&quot;&gt;&lt;a href=&quot;admin.php&quot;&gt;管理後台&lt;/a&gt;&lt;/div&gt;</span><br><span class="line">		&lt;div class=&quot;nav-item&quot;&gt;&lt;a href=&quot;logout_handle.php&quot;&gt;登出&lt;/a&gt;&lt;/div&gt;</span><br><span class="line">	<span class="meta">&lt;?php</span> &#125; <span class="keyword">else</span> &#123; <span class="meta">?&gt;</span></span><br><span class="line">		&lt;div class=&quot;nav-item&quot;&gt;&lt;a href=&quot;login.php&quot;&gt;登入&lt;/a&gt;&lt;/div&gt;</span><br><span class="line">	<span class="meta">&lt;?php</span> &#125; <span class="meta">?&gt;</span></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<h4 id="PHP-MySQL-Get-Last-Inserted-ID"><a href="#PHP-MySQL-Get-Last-Inserted-ID" class="headerlink" title="PHP MySQL Get Last Inserted ID"></a>PHP MySQL Get Last Inserted ID</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$id</span> = <span class="variable">$conn</span>-&gt;insert_id;</span><br></pre></td></tr></table></figure>

<h3 id="PHP-語法"><a href="#PHP-語法" class="headerlink" title="PHP 語法"></a>PHP 語法</h3><h4 id="變數"><a href="#變數" class="headerlink" title="變數"></a>變數</h4><h5 id="array"><a href="#array" class="headerlink" title="array"></a>array</h5><ul>
<li>array 設定<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$array</span> = <span class="keyword">array</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>,  <span class="number">1</span>, <span class="number">8</span> =&gt; <span class="number">1</span>,  <span class="number">4</span> =&gt; <span class="number">1</span>, <span class="number">19</span>, <span class="number">3</span> =&gt; <span class="number">13</span>);</span><br><span class="line"><span class="variable">$firstquarter</span> = <span class="keyword">array</span>(<span class="number">1</span> =&gt; <span class="string">&#x27;January&#x27;</span>, <span class="string">&#x27;February&#x27;</span>, <span class="string">&#x27;March&#x27;</span>);</span><br><span class="line"><span class="variable">$foo</span> = <span class="keyword">array</span>(<span class="string">&#x27;bar&#x27;</span> =&gt; <span class="string">&#x27;baz&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Hello <span class="subst">&#123;$foo[&#x27;bar&#x27;]&#125;</span>!&quot;</span>; <span class="comment">// Hello baz!</span></span><br></pre></td></tr></table></figure></li>
<li>設空 array - $levelArr &#x3D; []  or levelArr &#x3D; array();</li>
<li>push array - array_push($levelArr, $row );<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getManageLevels</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">global</span> <span class="variable">$conn</span>;</span><br><span class="line">	<span class="variable">$levelArr</span> = [];</span><br><span class="line">	</span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&#x27;select * from user_levels order by user_level&#x27;</span>;</span><br><span class="line">	<span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">	<span class="keyword">if</span> (<span class="variable">$result</span>) &#123;</span><br><span class="line">		<span class="comment">// 真正取資料要執行 $stmt-&gt;get_result();</span></span><br><span class="line">		<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;get_result();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span>(<span class="variable">$row</span> = <span class="variable">$result</span>-&gt;fetch_assoc()) &#123;</span><br><span class="line">			array_push(<span class="variable">$levelArr</span>, <span class="variable">$row</span> );</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="variable">$levelArr</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// show array</span></span><br><span class="line"><span class="variable">$levelArr</span> = getManageLevels();</span><br><span class="line"><span class="variable">$length</span> = count(<span class="variable">$levelArr</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span> ; <span class="variable">$i</span> &lt; <span class="variable">$length</span> ; <span class="variable">$i</span>++) &#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$levelArr</span>[<span class="variable">$i</span>][<span class="string">&#x27;id&#x27;</span>] . <span class="string">&#x27; &#x27;</span> ;</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$levelArr</span>[<span class="variable">$i</span>][<span class="string">&#x27;user_level&#x27;</span>] . <span class="string">&#x27; &#x27;</span> ;</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$levelArr</span>[<span class="variable">$i</span>][<span class="string">&#x27;level_describe&#x27;</span>] . <span class="string">&#x27; &#x27;</span> ;</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$levelArr</span>[<span class="variable">$i</span>][<span class="string">&#x27;all_modify&#x27;</span>] . <span class="string">&#x27; &#x27;</span> ;</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$levelArr</span>[<span class="variable">$i</span>][<span class="string">&#x27;all_delete&#x27;</span>] . <span class="string">&#x27; &#x27;</span> ;</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$levelArr</span>[<span class="variable">$i</span>][<span class="string">&#x27;self_create&#x27;</span>] . <span class="string">&#x27; &#x27;</span> ;</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$levelArr</span>[<span class="variable">$i</span>][<span class="string">&#x27;self_modify&#x27;</span>] . <span class="string">&#x27; &#x27;</span> ;</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$levelArr</span>[<span class="variable">$i</span>][<span class="string">&#x27;self_delete&#x27;</span>] . <span class="string">&#x27; &#x27;</span> ;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27; &lt;br&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="object"><a href="#object" class="headerlink" title="object"></a>object</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; object 設定</span><br><span class="line">$manageState &#x3D; [</span><br><span class="line">	&#39;user_admin&#39; &#x3D;&gt; 0,</span><br><span class="line">	&#39;all_modify&#39; &#x3D;&gt; 0,</span><br><span class="line">	&#39;all_delete&#39; &#x3D;&gt; 0,</span><br><span class="line">	&#39;self_create&#39; &#x3D;&gt; 0,</span><br><span class="line">	&#39;self_modify&#39; &#x3D;&gt; 0,</span><br><span class="line">	&#39;self_delete&#39; &#x3D;&gt; 0,</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<h5 id="SERVER-PHP預定義的超全局變量"><a href="#SERVER-PHP預定義的超全局變量" class="headerlink" title="$_SERVER PHP預定義的超全局變量"></a><a target="_blank" rel="noopener" href="https://www.php.net/manual/zh/reserved.variables.server.php">$_SERVER</a> PHP預定義的超全局變量</h5><ul>
<li>$_SERVER[“SCRIPT_NAME”] 		- &#x2F;index.php		<br>  當前腳本路徑</li>
<li>$_SERVER[“REQUEST_URI”] 		- &#x2F;index.php?id&#x3D;1	<br>  訪問頁面URI，包含查詢字符串</li>
<li>$_SERVER[“QUERY_STRING”] 		- id&#x3D;1				<br>  查詢字符串，不存在為” “</li>
<li>$_SERVER[“REQUEST_METHOD”] 	- GET				<br>  請求方法，如”POST”、”PUT”等</li>
<li>$_SERVER[“SERVER_PROTOCOL”] - HTTP&#x2F;1.1			<br>  通信協議的名稱和版本</li>
<li>$_SERVER[“GATEWAY_INTERFACE”] - CGI&#x2F;1.1			<br>  服務器使用的CGI 規範的版本</li>
<li>$_SERVER[“REMOTE_PORT”] 		- 60599				<br>  用戶連接服務器使用的端口</li>
<li>$_SERVER[“SCRIPT_FILENAME”] - E:&#x2F;WWW&#x2F;example&#x2F;index.php	<br>  當前腳本的絕對路徑</li>
<li>$_SERVER[“DOCUMENT_ROOT”] 	- E:&#x2F;WWW&#x2F;example&#x2F;			<br>  當前腳本文檔根目錄的絕對路徑</li>
<li>$_SERVER[“REMOTE_ADDR”] 		- 127.0.0.1					<br>  用戶的IP地址</li>
<li>$_SERVER[“SERVER_PORT”] 		- 80						<br>  服務器使用的端口</li>
<li>$_SERVER[“SERVER_ADDR”] 		- 127.0.0.1					<br>  服務器的IP地址</li>
<li>$_SERVER[“SERVER_NAME”] 		- <a target="_blank" rel="noopener" href="http://www.example.com/">www.example.com</a>			<br>  服務器的主機名，注：如果腳本運行於虛擬主機中，該名稱是由那個虛擬主機所設置的值決定。在Apache 2裡，必須設置UseCanonicalName &#x3D; On和ServerName。否則該值會由客戶端提供，就有可能被偽造。上下文有安全性要求的環境裡，不應該依賴此值。</li>
<li>$_SERVER[“SERVER_SOFTWARE”] 	- Apache&#x2F;2.4.23 (Win32) OpenSSL&#x2F;1.0.2j mod_fcgid&#x2F;2.3.9	<br>  響應頭中Server的內容</li>
<li>$_SERVER[“SERVER_SIGNATURE”] 	- 							<br>  包含了服務器版本和虛擬主機名的字符串</li>
<li>$_SERVER[“HTTP_HOST”] 			- <a target="_blank" rel="noopener" href="http://www.example.com/">www.example.com</a>			<br>  請求頭中Host項的內容</li>
<li>$_SERVER[“HTTP_CONNECTION”] 	- keep-alive				<br>  請求頭中Connection項的內容</li>
<li>$_SERVER[“HTTP_PRAGMA”] 		- no-cache					<br>  請求頭中Pragma項的內容</li>
<li>$_SERVER[“HTTP_CACHE_CONTROL”] 	- no-cache					<br>  請求頭中Cache-Control項的內容</li>
<li>$_SERVER[“HTTP_UPGRADE_INSECURE_REQUESTS”] 	} |1			<br>  請求頭中Upgrade-Insecure-Requests項的內容</li>
<li>$_SERVER[“HTTP_USER_AGENT”] 	- Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;61.0.3163.100 Safari&#x2F;537.36	<br>  請求頭中User-Agent項的內容</li>
<li>$_SERVER[“HTTP_ACCEPT”] 		- text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,image&#x2F;apng, &#x2F; ;q&#x3D;0.		<br>  請求頭中Accept項的內容</li>
<li>$_SERVER[“HTTP_ACCEPT_ENCODING”] - gzip, deflate			<br>  請求頭中Accept-Encoding項的內容</li>
<li>$_SERVER[“HTTP_ACCEPT_LANGUAGE”] - zh-CN,zh;q&#x3D;0.8			<br>  請求頭中Accept-Language項的內容</li>
<li>$_SERVER[“PHP_SELF”] 				- &#x2F;index.php			<br>  當前執行腳本的文件名</li>
<li>$_SERVER[“REQUEST_TIME_FLOAT”]		- 1510112348.8084		<br>  請求開始的時間戳，微秒級別精準度</li>
<li>$_SERVER[“REQUEST_TIME”] 			- 1510112348			<br>  請求開始的時間戳</li>
<li>$_SERVER[‘HTTP_REFERER’] - localhost&#x2F;robert&#x2F;comment&#x2F;register.php<br>  前一頁面的URL 地址</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 前頁 uri</span></span><br><span class="line"><span class="variable">$uri</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_URI&#x27;</span>];</span><br><span class="line"><span class="comment">// 前一頁面的URL 地址</span></span><br><span class="line"><span class="variable">$page</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_REFERER&#x27;</span>];</span><br></pre></td></tr></table></figure>

<h3 id="Snippet-for-PHP"><a href="#Snippet-for-PHP" class="headerlink" title="Snippet for PHP"></a>Snippet for PHP</h3><h4 id="error-code-處理"><a href="#error-code-處理" class="headerlink" title="error code 處理"></a>error code 處理</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">	<span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;errorCode&#x27;</span>])) &#123;</span><br><span class="line">		<span class="variable">$msg</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">		<span class="keyword">switch</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;errorCode&#x27;</span>]) &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">1</span> :</span><br><span class="line">				<span class="variable">$msg</span> = <span class="string">&#x27;資料庫錯誤!&#x27;</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span> :</span><br><span class="line">				<span class="variable">$msg</span> = <span class="string">&#x27;查無帳號!&#x27;</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">3</span> :</span><br><span class="line">				<span class="variable">$msg</span> = <span class="string">&#x27;密碼錯誤!&#x27;</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">4</span> :</span><br><span class="line">				<span class="variable">$msg</span> = <span class="string">&#x27;輸入錯誤!&#x27;</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">default</span> :</span><br><span class="line">				<span class="variable">$msg</span> = <span class="string">&#x27;未知錯誤!&#x27;</span>;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;&lt;div class=&quot;warning&quot;&gt;&#x27;</span> . <span class="variable">$msg</span> . <span class="string">&#x27;&lt;/div&gt;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="下拉式選單-lt-select-gt-lt-option-gt"><a href="#下拉式選單-lt-select-gt-lt-option-gt" class="headerlink" title="下拉式選單 - &lt;select&gt;, &lt;option&gt;"></a>下拉式選單 - &lt;select&gt;, &lt;option&gt;</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;select name=<span class="string">&quot;level&quot;</span>&gt;</span><br><span class="line">	<span class="meta">&lt;?php</span> </span><br><span class="line">		<span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span> ; <span class="variable">$i</span> &lt; <span class="variable">$length</span> ; <span class="variable">$i</span>++) &#123; </span><br><span class="line">			<span class="variable">$describe</span> = <span class="variable">$levelArr</span>[<span class="variable">$i</span>][<span class="string">&#x27;level_describe&#x27;</span>] ;</span><br><span class="line">			<span class="variable">$level</span> =  <span class="variable">$levelArr</span>[<span class="variable">$i</span>][<span class="string">&#x27;user_level&#x27;</span>] ;</span><br><span class="line">			<span class="variable">$selectStr</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">			<span class="keyword">if</span> (<span class="variable">$row</span>[<span class="string">&#x27;user_level&#x27;</span>] == <span class="variable">$level</span>) &#123;</span><br><span class="line">				<span class="variable">$selectStr</span> = <span class="string">&#x27;selected&#x27;</span> ;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&#x27;&lt;option value=&quot;&#x27;</span>. <span class="variable">$level</span> . <span class="string">&#x27;&quot; &#x27;</span> . <span class="variable">$selectStr</span> .<span class="string">&#x27; &gt;&#x27;</span> . <span class="variable">$describe</span> . <span class="string">&#x27;&lt;/option&gt;&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	<span class="meta">?&gt;</span></span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>

<h4 id="分頁"><a href="#分頁" class="headerlink" title="分頁"></a>分頁</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">	<span class="comment">// init page</span></span><br><span class="line">	<span class="variable">$page</span> = <span class="number">1</span>;</span><br><span class="line">	<span class="variable">$total_page</span> = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&#x27;select * from blog where deleted=0 or deleted is NULL &#x27;</span></span><br><span class="line">	. <span class="string">&#x27;order by id asc&#x27;</span>;</span><br><span class="line">	<span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">	<span class="keyword">if</span> (<span class="variable">$result</span>) &#123;</span><br><span class="line">		<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;get_result();</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// page control </span></span><br><span class="line">		<span class="variable">$item_perpage</span> = <span class="number">5</span> ;</span><br><span class="line">		<span class="variable">$total</span> = <span class="variable">$result</span>-&gt;num_rows ;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>])) &#123;</span><br><span class="line">			<span class="variable">$page</span> = <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="variable">$page</span> = (<span class="keyword">int</span>) <span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="variable">$total_page</span> = ceil(<span class="variable">$total</span>/<span class="variable">$item_perpage</span>) ;</span><br><span class="line"></span><br><span class="line">		<span class="variable">$sql</span> = <span class="variable">$sql</span> . <span class="string">&#x27; LIMIT &#x27;</span> . <span class="variable">$item_perpage</span> . <span class="string">&#x27; OFFSET &#x27;</span> . (<span class="variable">$page</span>-<span class="number">1</span>)*<span class="variable">$item_perpage</span>;</span><br><span class="line">		<span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line">		<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">		<span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Error : &#x27;</span> . <span class="variable">$conn</span>-&gt;error);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// 真正取資料要執行 $stmt-&gt;get_result();</span></span><br><span class="line">		<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;get_result();</span><br><span class="line">	&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">	&lt;div class=&quot;page&quot;&gt;</span><br><span class="line">		<span class="meta">&lt;?php</span></span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&#x27;頁數 : &#x27;</span> . <span class="variable">$page</span> . <span class="string">&#x27; / &#x27;</span>  . <span class="variable">$total_page</span>;</span><br><span class="line">		<span class="meta">?&gt;</span></span><br><span class="line">	&lt;/div&gt;</span><br><span class="line">	&lt;div class=&quot;page-control&quot;&gt;</span><br><span class="line">		<span class="meta">&lt;?php</span> </span><br><span class="line">			<span class="keyword">if</span> (<span class="variable">$page</span> &gt; <span class="number">1</span>) &#123;</span><br><span class="line">				<span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;list.php?page=1&quot;&gt;首頁&lt;/a&gt;&#x27;</span> ;</span><br><span class="line">				<span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;list.php?page=&#x27;</span> . strval(<span class="variable">$page</span>-<span class="number">1</span>) . <span class="string">&#x27;&quot;&gt;上一頁&lt;/a&gt;&#x27;</span> ;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (<span class="variable">$page</span> &lt; <span class="variable">$total_page</span>) &#123;</span><br><span class="line">				<span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;list.php?page=&#x27;</span> . strval(<span class="variable">$page</span>+<span class="number">1</span>) . <span class="string">&#x27;&quot;&gt;下一頁&lt;/a&gt;&#x27;</span> ;</span><br><span class="line">				<span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;list.php?page=&#x27;</span> . <span class="variable">$total_page</span> . <span class="string">&#x27;&quot;&gt;最後一頁&lt;/a&gt;&#x27;</span> ;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="meta">?&gt;</span></span><br><span class="line">	&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.page</span> &#123;</span><br><span class="line">	<span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.page-control</span> &#123;</span><br><span class="line">	<span class="attribute">display</span>: flex;</span><br><span class="line">	<span class="attribute">justify-content</span>: center;</span><br><span class="line">	<span class="attribute">margin-top</span>: <span class="number">10px</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.page-control</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">	<span class="attribute">display</span>: inline-block;</span><br><span class="line">	<span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#D1DEEB</span>;</span><br><span class="line">	<span class="attribute">padding</span>: <span class="number">7px</span> <span class="number">20px</span> <span class="number">5px</span>;</span><br><span class="line">	<span class="attribute">border-radius</span>: <span class="number">6px</span>;</span><br><span class="line">	<span class="attribute">cursor</span>: pointer;</span><br><span class="line">	<span class="attribute">text-decoration</span>: none;</span><br><span class="line">	<span class="attribute">color</span>: <span class="number">#000</span>;</span><br><span class="line">	<span class="attribute">margin</span>: <span class="number">0</span> <span class="number">5px</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="utils"><a href="#utils" class="headerlink" title="utils"></a>utils</h4><h5 id="check-accountValid"><a href="#check-accountValid" class="headerlink" title="check accountValid"></a>check accountValid</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;conn.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="comment">// if account not valid auto re-direct to index(logout)</span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">accountValid</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">global</span> <span class="variable">$conn</span> ;</span><br><span class="line">		<span class="variable">$isValid</span> =  <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">		<span class="variable">$username</span> = <span class="literal">NULL</span>;</span><br><span class="line">		<span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>])) &#123;</span><br><span class="line">			<span class="variable">$username</span> = <span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="variable">$sql</span> = <span class="string">&quot;select * from users where username=?&quot;</span>;</span><br><span class="line">		<span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line">		<span class="variable">$stmt</span>-&gt;bind_param(<span class="string">&#x27;s&#x27;</span>, <span class="variable">$username</span>);</span><br><span class="line">		<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">		<span class="keyword">if</span> (<span class="variable">$result</span>) &#123;</span><br><span class="line">			<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;get_result();</span><br><span class="line">			<span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows &gt; <span class="number">0</span>) &#123;</span><br><span class="line">				<span class="variable">$isValid</span> =  <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span> (!<span class="variable">$isValid</span>) &#123;</span><br><span class="line">			Header(<span class="string">&quot;location: logout_handle.php&quot;</span>);</span><br><span class="line">			<span class="keyword">exit</span>();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="設定-HTML-跳脫字元-check-echo-有無呼叫"><a href="#設定-HTML-跳脫字元-check-echo-有無呼叫" class="headerlink" title="設定 HTML 跳脫字元 - check echo 有無呼叫"></a>設定 HTML 跳脫字元 - check echo 有無呼叫</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 設定 HTML 跳脫字元</span></span><br><span class="line"><span class="comment">// check echo 有無呼叫</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params"><span class="variable">$str</span></span>) </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> htmlspecialchars(<span class="variable">$str</span>, ENT_QUOTES);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="回傳-json"><a href="#回傳-json" class="headerlink" title="回傳 json"></a>回傳 json</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">header(<span class="string">&#x27;Content-Type: application/json; charset=utf-8&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$comments</span> = <span class="keyword">array</span>();</span><br><span class="line">......</span><br><span class="line"></span><br><span class="line"><span class="variable">$json</span> = <span class="keyword">array</span>(</span><br><span class="line">	<span class="string">&quot;comment&quot;</span> =&gt; <span class="variable">$comments</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="variable">$response</span> = json_encode(<span class="variable">$json</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$response</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// response error</span></span><br><span class="line"><span class="keyword">if</span>( (<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>])) ||</span><br><span class="line">		(<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]))</span><br><span class="line">	) &#123;</span><br><span class="line">		<span class="variable">$json</span> = <span class="keyword">array</span>(</span><br><span class="line">			<span class="string">&quot;ok&quot;</span> =&gt; <span class="literal">false</span>,</span><br><span class="line">			<span class="string">&quot;message&quot;</span> =&gt; <span class="string">&quot;Please input data!&quot;</span></span><br><span class="line">		);</span><br><span class="line"></span><br><span class="line">		<span class="variable">$response</span> = json_encode(<span class="variable">$json</span>);</span><br><span class="line">		<span class="keyword">echo</span> <span class="variable">$response</span>;</span><br><span class="line">		<span class="keyword">exit</span>();</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h4 id="html-php-回傳-json"><a href="#html-php-回傳-json" class="headerlink" title="html + php 回傳 json"></a>html + php 回傳 json</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- index_api.html --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">title</span>&gt;</span>留言板<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;reset.css&quot;</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;style.css&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;wrap &quot;</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">header</span> <span class="attr">class</span>=<span class="string">&quot;warning&quot;</span>&gt;</span></span><br><span class="line">			注意！本站為練習用網站，因教學用途刻意忽略資安的實作，註冊時請勿使用任何真實的帳號或密碼。</span><br><span class="line">		<span class="tag">&lt;/<span class="name">header</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">main</span> <span class="attr">class</span>=<span class="string">&quot;board&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;hi&quot;</span>&gt;</span></span><br><span class="line">				Hi, aa!</span><br><span class="line">			<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">&quot;input-form&quot;</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">textarea</span> <span class="attr">class</span>=<span class="string">&quot;input-content&quot;</span> <span class="attr">name</span>=<span class="string">&quot;content&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;5&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;input-submit&quot;</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;hr&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">section</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">main</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">		<span class="function"><span class="keyword">function</span> <span class="title">ajaxGetApi</span>(<span class="params">url, respProcess</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">			<span class="keyword">const</span> request = <span class="keyword">new</span> XMLHttpRequest()</span></span><br><span class="line"><span class="javascript">			<span class="comment">// loaded function</span></span></span><br><span class="line"><span class="javascript">			request.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line">				if (request.status &gt;= 200 &amp;&amp; request.status &lt; 400) &#123;</span><br><span class="line"><span class="javascript">					<span class="comment">// process by callback function</span></span></span><br><span class="line">					respProcess(request.responseText)</span><br><span class="line">				&#125;</span><br><span class="line"><span class="javascript">				<span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">					<span class="built_in">console</span>.log(<span class="string">&#x27;response :&#x27;</span>, request)</span></span><br><span class="line"><span class="javascript">					<span class="built_in">console</span>.log(<span class="string">&#x27;response error :&#x27;</span>, request.status)</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line"><span class="javascript">			<span class="comment">// error </span></span></span><br><span class="line"><span class="javascript">			request.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">				<span class="built_in">console</span>.log(<span class="string">&#x27;error&#x27;</span>)</span></span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line"><span class="javascript">			<span class="comment">// true 表非同步</span></span></span><br><span class="line"><span class="javascript">			request.open(<span class="string">&#x27;GET&#x27;</span>, url, <span class="literal">true</span>)</span></span><br><span class="line">			request.send()</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">		<span class="function"><span class="keyword">function</span> <span class="title">ajaxPOSTjsonApi</span>(<span class="params">url, postObj, respProcess</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">			<span class="keyword">const</span> request = <span class="keyword">new</span> XMLHttpRequest()</span></span><br><span class="line"><span class="javascript">			<span class="comment">// loaded function</span></span></span><br><span class="line"><span class="javascript">			request.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line">				if (request.status &gt;= 200 &amp;&amp; request.status &lt; 400) &#123;</span><br><span class="line"><span class="javascript">					<span class="comment">// process by callback function</span></span></span><br><span class="line">					respProcess(request.responseText)</span><br><span class="line">				&#125;</span><br><span class="line"><span class="javascript">				<span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">					<span class="built_in">console</span>.log(<span class="string">&#x27;response :&#x27;</span>, request)</span></span><br><span class="line"><span class="javascript">					<span class="built_in">console</span>.log(<span class="string">&#x27;response error :&#x27;</span>, request.status)</span></span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line"><span class="javascript">			<span class="comment">// error </span></span></span><br><span class="line"><span class="javascript">			request.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">				<span class="built_in">console</span>.log(<span class="string">&#x27;error&#x27;</span>)</span></span><br><span class="line">			&#125;</span><br><span class="line">			</span><br><span class="line"><span class="javascript">			<span class="comment">// true 表非同步</span></span></span><br><span class="line"><span class="javascript">			request.open(<span class="string">&#x27;POST&#x27;</span>, url, <span class="literal">true</span>)</span></span><br><span class="line"><span class="javascript">			<span class="comment">// POST 需要 header</span></span></span><br><span class="line"><span class="javascript">			request.setRequestHeader(<span class="string">&#x27;Content-Type&#x27;</span>,  <span class="string">&#x27;application/x-www-form-urlencoded;charset=UTF-8&#x27;</span>);</span></span><br><span class="line"><span class="javascript">			<span class="comment">// encodeURIComponent() 可讓 1&amp;2&amp;3 亦可輸入正常 </span></span></span><br><span class="line"><span class="javascript">			request.send(<span class="string">`username=<span class="subst">$&#123;postObj.username&#125;</span>&amp;content=<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(postObj.content)&#125;</span>`</span>)</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">		<span class="comment">// JavaScript escape HTML function()</span></span></span><br><span class="line"><span class="javascript">		<span class="function"><span class="keyword">function</span> <span class="title">escapeHTML</span>(<span class="params">s</span>) </span>&#123; </span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> s.replace(<span class="regexp">/&amp;/g</span>, <span class="string">&#x27;&amp;amp;&#x27;</span>)</span></span><br><span class="line"><span class="javascript">            .replace(<span class="regexp">/&quot;/g</span>, <span class="string">&#x27;&amp;quot;&#x27;</span>)</span></span><br><span class="line"><span class="javascript">            .replace(<span class="regexp">/&lt;/g</span>, <span class="string">&#x27;&amp;lt;&#x27;</span>)</span></span><br><span class="line"><span class="javascript">            .replace(<span class="regexp">/&gt;/g</span>, <span class="string">&#x27;&amp;gt;&#x27;</span>);</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line"><span class="javascript">		ajaxGetApi(<span class="string">&#x27;http://localhost/robert/comment/api_get_comment.php&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">response</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">			<span class="keyword">const</span> comments = <span class="built_in">JSON</span>.parse(response)</span></span><br><span class="line"><span class="javascript">			<span class="keyword">let</span> section = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;section&#x27;</span>)</span></span><br><span class="line"><span class="javascript">			<span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span> ; i &lt; comments.comment.length ; i++ ) &#123;</span></span><br><span class="line"><span class="javascript">				<span class="keyword">let</span> card = <span class="built_in">document</span>.createElement(<span class="string">&#x27;div&#x27;</span>)</span></span><br><span class="line"><span class="javascript">				card.classList.add(<span class="string">&#x27;card&#x27;</span>)</span></span><br><span class="line">				card.innerHTML = `</span><br><span class="line"><span class="handlebars"><span class="xml">					<span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;card-avatar&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="javascript">					&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;card-info&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">						&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;card-title&quot;</span>&gt; </span></span><br><span class="line"><span class="handlebars"><span class="xml">							<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;card-user&quot;</span>&gt;</span>$&#123;comments.comment[i].nickname&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">							<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;card-time&quot;</span>&gt;</span>$&#123;comments.comment[i].create_at&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span></span><br><span class="line"><span class="javascript">						&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;card-content&quot;</span>&gt;</span></span><br><span class="line">							$&#123;escapeHTML(comments.comment[i].content)&#125;</span><br><span class="line"><span class="handlebars"><span class="xml">						<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">					<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span></span><br><span class="line">				`</span><br><span class="line">				section.appendChild(card)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;)</span><br><span class="line"></span><br><span class="line"><span class="javascript">		<span class="comment">// submit </span></span></span><br><span class="line"><span class="javascript">		<span class="keyword">const</span> form = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;form&#x27;</span>)</span></span><br><span class="line"><span class="javascript">		form.addEventListener(<span class="string">&#x27;submit&#x27;</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">			<span class="keyword">let</span> comment = &#123;</span></span><br><span class="line"><span class="javascript">				username : <span class="string">&#x27;aa&#x27;</span>,</span></span><br><span class="line"><span class="javascript">				content : <span class="string">&#x27;&#x27;</span></span></span><br><span class="line">			&#125;</span><br><span class="line">			e.preventDefault()</span><br><span class="line"><span class="javascript">			comment.content = <span class="built_in">document</span>.querySelector(<span class="string">&#x27;.input-content&#x27;</span>).value</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">			ajaxPOSTjsonApi(<span class="string">&#x27;http://localhost/robert/comment/api_add_comment.php&#x27;</span>, comment, <span class="function"><span class="keyword">function</span>(<span class="params">response</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">				<span class="keyword">const</span> resp = <span class="built_in">JSON</span>.parse(response)</span></span><br><span class="line">				if (resp.ok) &#123;</span><br><span class="line"><span class="javascript">					<span class="comment">// JavaScript reload </span></span></span><br><span class="line">					location.reload();</span><br><span class="line">				&#125;</span><br><span class="line"><span class="javascript">				<span class="keyword">else</span> &#123;</span></span><br><span class="line">					alert(resp.message);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;)</span><br><span class="line">		&#125;)</span><br><span class="line">	<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">	<span class="comment">// api_get_comment.php</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;conn.php&#x27;</span>);</span><br><span class="line">	header(<span class="string">&#x27;Content-Type: application/json; charset=utf-8&#x27;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&#x27;select C.id, C.content, C.create_at, U.username, U.nickname &#x27;</span> .</span><br><span class="line">					<span class="string">&#x27;from comment as C left join users as U &#x27;</span> .</span><br><span class="line">					<span class="string">&#x27;on C.username = U.username &#x27;</span> . </span><br><span class="line">					<span class="string">&#x27;where C.deleted=0 or C.deleted is NULL order by C.id DESC&#x27;</span>;</span><br><span class="line">	<span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">	<span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&quot;查詢錯誤!&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;get_result();</span><br><span class="line">	<span class="variable">$comments</span> = <span class="keyword">array</span>();</span><br><span class="line">	<span class="keyword">while</span>(<span class="variable">$row</span> = <span class="variable">$result</span>-&gt;fetch_assoc()) &#123;</span><br><span class="line">		array_push(<span class="variable">$comments</span>, <span class="variable">$row</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$json</span> = <span class="keyword">array</span>(</span><br><span class="line">		<span class="string">&quot;comment&quot;</span> =&gt; <span class="variable">$comments</span></span><br><span class="line">	);</span><br><span class="line"></span><br><span class="line">	<span class="variable">$response</span> = json_encode(<span class="variable">$json</span>);</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$response</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="comment">// api_add_comment.php</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;conn.php&#x27;</span>);</span><br><span class="line">	header(<span class="string">&#x27;Content-Type: application/json; charset=utf-8&#x27;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>( (<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>])) ||</span><br><span class="line">			(<span class="keyword">empty</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]))</span><br><span class="line">		) &#123;</span><br><span class="line">			<span class="variable">$json</span> = <span class="keyword">array</span>(</span><br><span class="line">				<span class="string">&quot;ok&quot;</span> =&gt; <span class="literal">false</span>,</span><br><span class="line">				<span class="string">&quot;message&quot;</span> =&gt; <span class="string">&quot;Please input data!&quot;</span></span><br><span class="line">			);</span><br><span class="line">	</span><br><span class="line">			<span class="variable">$response</span> = json_encode(<span class="variable">$json</span>);</span><br><span class="line">			<span class="keyword">echo</span> <span class="variable">$response</span>;</span><br><span class="line">			<span class="keyword">exit</span>();</span><br><span class="line">		&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] ;</span><br><span class="line">	<span class="variable">$content</span> =  <span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>] ;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&quot;insert into comment(username, content) value(?, ?)&quot;</span>;</span><br><span class="line">	<span class="variable">$stmt</span> = <span class="variable">$conn</span>-&gt;prepare(<span class="variable">$sql</span>);</span><br><span class="line">	<span class="variable">$stmt</span>-&gt;bind_param(<span class="string">&#x27;ss&#x27;</span>, <span class="variable">$username</span>, <span class="variable">$content</span>);</span><br><span class="line">	<span class="variable">$result</span> = <span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line">	<span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">		<span class="variable">$json</span> = <span class="keyword">array</span>(</span><br><span class="line">			<span class="string">&quot;ok&quot;</span> =&gt; <span class="literal">false</span>,</span><br><span class="line">			<span class="string">&quot;message&quot;</span> =&gt; <span class="variable">$conn</span>-&gt;error</span><br><span class="line">		);	</span><br><span class="line">	</span><br><span class="line">		<span class="variable">$response</span> = json_encode(<span class="variable">$json</span>);</span><br><span class="line">		<span class="keyword">echo</span> <span class="variable">$response</span>;</span><br><span class="line">		<span class="keyword">exit</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$json</span> = <span class="keyword">array</span>(</span><br><span class="line">		<span class="string">&quot;ok&quot;</span> =&gt; <span class="literal">true</span>,</span><br><span class="line">		<span class="string">&quot;message&quot;</span> =&gt; <span class="string">&quot;Success&quot;</span></span><br><span class="line">	);	</span><br><span class="line">	<span class="variable">$response</span> = json_encode(<span class="variable">$json</span>);</span><br><span class="line">	<span class="keyword">echo</span> $</span><br></pre></td></tr></table></figure>

<h3 id="PHP-function"><a href="#PHP-function" class="headerlink" title="PHP function"></a>PHP function</h3><h4 id="simple-function"><a href="#simple-function" class="headerlink" title="simple function"></a>simple function</h4><ul>
<li>exit() - 結束程式</li>
</ul>
<h4 id="轉換"><a href="#轉換" class="headerlink" title="轉換"></a>轉換</h4><h5 id="轉數字"><a href="#轉數字" class="headerlink" title="轉數字"></a>轉數字</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$page</span> = (<span class="keyword">int</span>) <span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>];</span><br><span class="line"><span class="comment">// intval()而言，如果引數是字串，則返回字串中第一個不是數字的字元之前的數字串所代表的整數值</span></span><br><span class="line"><span class="variable">$int1</span>=intval(<span class="variable">$string</span>);</span><br></pre></td></tr></table></figure>

<h5 id="floor-x2F-ceil-x2F-round"><a href="#floor-x2F-ceil-x2F-round" class="headerlink" title="floor()&#x2F;ceil()&#x2F;round()"></a>floor()&#x2F;ceil()&#x2F;round()</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 取整數(無條件進位)</span></span><br><span class="line"><span class="variable">$total_page</span> = ceil(<span class="variable">$total</span>/<span class="variable">$item_perpage</span>) ;</span><br><span class="line"><span class="comment">// 捨去取整數</span></span><br><span class="line"><span class="keyword">echo</span> floor(<span class="number">1.6</span>); <span class="comment">// will output &quot;1&quot; </span></span><br><span class="line"><span class="keyword">echo</span> floor(-<span class="number">1.6</span>); <span class="comment">// will output &quot;-2&quot;</span></span><br><span class="line"><span class="comment">// 四捨五入</span></span><br><span class="line"><span class="keyword">echo</span> round(<span class="number">3.4</span>); <span class="comment">// 3</span></span><br><span class="line"><span class="keyword">echo</span> round(<span class="number">3.5</span>); <span class="comment">// 4</span></span><br></pre></td></tr></table></figure>

<h5 id="ASCII-code-轉換-ord-x2F-chr"><a href="#ASCII-code-轉換-ord-x2F-chr" class="headerlink" title="ASCII code 轉換 ord()&#x2F;chr()"></a>ASCII code 轉換 ord()&#x2F;chr()</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 字元轉換為 ASCII 碼</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;將字符 # 轉換為 ASCII 碼: &#x27;</span>.ord(<span class="string">&#x27;#&#x27;</span>).<span class="string">&#x27;&lt;br&gt;&#x27;</span>; <span class="comment">// 35</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;將字符 % 轉換為 ASCII 碼: &#x27;</span>.ord(<span class="string">&#x27;%&#x27;</span>).<span class="string">&#x27;&lt;br&gt;&#x27;</span>; <span class="comment">// 37</span></span><br><span class="line"><span class="comment">// ASCII 碼轉換為字元</span></span><br><span class="line"><span class="variable">$str1</span> = <span class="string">&#x27;66&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;由 ASCII 碼 66 轉換回英文字母 B 的結果: &#x27;</span>.chr(<span class="variable">$str1</span>).<span class="string">&#x27;&lt;br&gt;&#x27;</span>; <span class="comment">// 66</span></span><br></pre></td></tr></table></figure>

<h4 id="string"><a href="#string" class="headerlink" title="string"></a>string</h4><h5 id="strpos-check-是否包含字串-不包含傳回-false"><a href="#strpos-check-是否包含字串-不包含傳回-false" class="headerlink" title="strpos() - check 是否包含字串,不包含傳回 false"></a>strpos() - check 是否包含字串,不包含傳回 false</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// check 是否包含字串,不包含傳回 false</span></span><br><span class="line">	<span class="keyword">if</span> (strpos(<span class="variable">$conn</span>-&gt;error, <span class="string">&#x27;Duplicate entry&#x27;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">	 	header(<span class="string">&#x27;Location: register.php?errorCode=2&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="substr-x2F-mb-substr-擷取字串"><a href="#substr-x2F-mb-substr-擷取字串" class="headerlink" title="substr()&#x2F;mb_substr() - 擷取字串"></a>substr()&#x2F;mb_substr() - 擷取字串</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 擷取字串 </span></span><br><span class="line"><span class="keyword">echo</span> substr(<span class="variable">$row</span>[<span class="string">&#x27;content&#x27;</span>], <span class="number">0</span>, <span class="number">200</span>);</span><br><span class="line"><span class="comment">// 擷取字串-中文字不被切斷</span></span><br><span class="line"><span class="keyword">echo</span> mb_substr(<span class="variable">$row</span>[<span class="string">&#x27;content&#x27;</span>], <span class="number">0</span>, <span class="number">200</span>, <span class="string">&#x27;utf-8&#x27;</span>);</span><br></pre></td></tr></table></figure>


<h4 id="date"><a href="#date" class="headerlink" title="date()"></a><a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.date.php">date()</a></h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 設定時區</span></span><br><span class="line">date_default_timezone_set(<span class="string">&quot;Asia/Taipei&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$today</span> = date(<span class="string">&quot;F j, Y, g:i a&quot;</span>);                 <span class="comment">// March 10, 2001, 5:16 pm</span></span><br><span class="line"><span class="variable">$today</span> = date(<span class="string">&quot;m.d.y&quot;</span>);                         <span class="comment">// 03.10.01</span></span><br><span class="line"><span class="variable">$today</span> = date(<span class="string">&quot;j, n, Y&quot;</span>);                       <span class="comment">// 10, 3, 2001</span></span><br><span class="line"><span class="variable">$today</span> = date(<span class="string">&quot;Ymd&quot;</span>);                           <span class="comment">// 20010310</span></span><br><span class="line"><span class="variable">$today</span> = date(<span class="string">&#x27;h-i-s, j-m-y, it is w Day&#x27;</span>);     <span class="comment">// 05-16-18, 10-03-01, 1631 1618 6 Satpm01</span></span><br><span class="line"><span class="variable">$today</span> = date(<span class="string">&#x27;\i\t \i\s \t\h\e jS \d\a\y.&#x27;</span>);   <span class="comment">// it is the 10th day.</span></span><br><span class="line"><span class="variable">$today</span> = date(<span class="string">&quot;D M j G:i:s T Y&quot;</span>);               <span class="comment">// Sat Mar 10 17:16:18 MST 2001</span></span><br><span class="line"><span class="variable">$today</span> = date(<span class="string">&#x27;H:m:s \m \i\s\ \m\o\n\t\h&#x27;</span>);     <span class="comment">// 17:03:18 m is month</span></span><br><span class="line"><span class="variable">$today</span> = date(<span class="string">&quot;H:i:s&quot;</span>);                         <span class="comment">// 17:16:18</span></span><br><span class="line"><span class="variable">$today</span> = date(<span class="string">&quot;Y-m-d H:i:s&quot;</span>);                   <span class="comment">// 2001-03-10 17:16:18 (the MySQL DATETIME format)</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="header-開啟網頁"><a href="#header-開啟網頁" class="headerlink" title="header 開啟網頁"></a><a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.header.php">header</a> 開啟網頁</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">header(<span class="string">&quot;Location: http://<span class="subst">$host</span><span class="subst">$uri</span>/<span class="subst">$extra</span>&quot;</span>);</span><br><span class="line">header(<span class="string">&quot;Location: index.php&quot;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// set cookie - 1 hour --&gt; *24*30 = 30days</span></span><br><span class="line">setcookie(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;peter&quot;</span> , time()+<span class="number">3600</span>); </span><br><span class="line"><span class="comment">// get kookie</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_COOKIE</span>[<span class="string">&quot;user&quot;</span>];</span><br><span class="line"><span class="comment">// delete cookie </span></span><br><span class="line">setcookie(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;&quot;</span>, time()-<span class="number">3600</span>);</span><br></pre></td></tr></table></figure>

<h4 id="session"><a href="#session" class="headerlink" title="session"></a>session</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 啟用 session</span></span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 設定 session</span></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;UserName&#x27;</span>] = <span class="string">&#x27;Jordan&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 讀取 session</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$_SESSION</span>[<span class="string">&#x27;UserName&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 刪除 session</span></span><br><span class="line"><span class="keyword">unset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;變數名稱&#x27;</span>]);</span><br><span class="line">session_destroy();</span><br></pre></td></tr></table></figure>

<h4 id="die-印出後結束程式"><a href="#die-印出後結束程式" class="headerlink" title="die() - 印出後結束程式"></a>die() - 印出後結束程式</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">&#x27;Error : &#x27;</span> . <span class="variable">$conn</span>-&gt;error);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="rand-產生亂數"><a href="#rand-產生亂數" class="headerlink" title="rand() - 產生亂數"></a>rand() - 產生亂數</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// random(ish) 5 digit int</span></span><br><span class="line"><span class="variable">$random_number</span> = intval( <span class="string">&quot;0&quot;</span> . rand(<span class="number">1</span>,<span class="number">9</span>) . rand(<span class="number">0</span>,<span class="number">9</span>) . rand(<span class="number">0</span>,<span class="number">9</span>) . rand(<span class="number">0</span>,<span class="number">9</span>) . rand(<span class="number">0</span>,<span class="number">9</span>) ); </span><br><span class="line"><span class="comment">// random(ish) 5 character string</span></span><br><span class="line"><span class="variable">$random_string</span> = chr(rand(<span class="number">65</span>,<span class="number">90</span>)) . chr(rand(<span class="number">65</span>,<span class="number">90</span>)) . chr(rand(<span class="number">65</span>,<span class="number">90</span>)) . chr(rand(<span class="number">65</span>,<span class="number">90</span>)) . chr(rand(<span class="number">65</span>,<span class="number">90</span>)); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="hash-雜湊產生"><a href="#hash-雜湊產生" class="headerlink" title="hash() - 雜湊產生"></a>hash() - 雜湊產生</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">hash ( string $algo , string $data , bool $binary = false ) : string|false</span></span><br><span class="line"><span class="comment">	algo</span></span><br><span class="line"><span class="comment">		Name of selected hashing algorithm (i.e. &quot;md5&quot;, &quot;sha256&quot;, &quot;haval160,4&quot;, etc..). For a list of supported algorithms see hash_algos().</span></span><br><span class="line"><span class="comment">	data</span></span><br><span class="line"><span class="comment">		Message to be hashed.</span></span><br><span class="line"><span class="comment">	binary</span></span><br><span class="line"><span class="comment">		When set to true, outputs raw binary data. false outputs lowercase hexits.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">hash(<span class="string">&quot;sha256&quot;</span>, <span class="string">&#x27;abce&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h4 id="password-hash-x2F-password-verify-雜湊密碼產生與驗證"><a href="#password-hash-x2F-password-verify-雜湊密碼產生與驗證" class="headerlink" title="password_hash()&#x2F;password_verify() - 雜湊密碼產生與驗證"></a>password_hash()&#x2F;password_verify() - 雜湊密碼產生與驗證</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// password_hash ( string $password , mixed $algo , array $options = ? ) : string|false</span></span><br><span class="line"><span class="comment">// PASSWORD_DEFAULT/PASSWORD_BCRYPT/PASSWORD_ARGON2I/PASSWORD_ARGON2ID</span></span><br><span class="line"><span class="keyword">echo</span> password_hash(<span class="string">&quot;rasmuslerdorf&quot;</span>, PASSWORD_DEFAULT);</span><br><span class="line"><span class="comment">// password_verify ( string $password , string $hash ) : bool</span></span><br><span class="line"><span class="keyword">if</span> (password_verify(<span class="string">&#x27;rasmuslerdorf&#x27;</span>, <span class="variable">$hash</span>)) &#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;Password is valid!&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="htmlentities-和-htmlspecialchars"><a href="#htmlentities-和-htmlspecialchars" class="headerlink" title="htmlentities 和 htmlspecialchars"></a>htmlentities 和 htmlspecialchars</h4><p>htmlspecialchars 只轉化一些特殊html程式碼，而 htmlentities 卻會轉化所有的html程式碼，連同裡面的它無法識別的中文字元也給轉化,所以有時會讓中文變成亂碼,所以<code>最好用 htmlspecialchars</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">htmlspecialchars(string,flags,character-set,double_encode)</span></span><br><span class="line"><span class="comment">flags 規定如何處理引號</span></span><br><span class="line"><span class="comment">	ENT_COMPAT - 預設,僅編碼雙引號。</span></span><br><span class="line"><span class="comment">	ENT_QUOTES - 編碼雙引號和單引號。</span></span><br><span class="line"><span class="comment">	ENT_NOQUOTES - 不編碼任何引號。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$str</span> = <span class="string">&quot;Bill &amp; &#x27;Steve&#x27;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> htmlspecialchars(<span class="variable">$str</span>, ENT_COMPAT); <span class="comment">//只轉換雙引號</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> htmlspecialchars(<span class="variable">$str</span>, ENT_QUOTES); <span class="comment">//轉換雙引號和單引號</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> htmlspecialchars(<span class="variable">$str</span>, ENT_NOQUOTES); <span class="comment">//不轉換任何引號</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">// htmlentities ( string $string , int $flags = ENT_COMPAT , string|null $encoding = null , bool $double_encode = true ) : string</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$str</span> = <span class="string">&quot;A &#x27;quote&#x27; is &lt;b&gt;bold&lt;/b&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> htmlentities(<span class="variable">$str</span>); 						 <span class="comment">//  A &#x27;quote&#x27; is &amp;lt;b&amp;gt;bold&amp;lt;/b&amp;gt;</span></span><br><span class="line"><span class="keyword">echo</span> htmlentities(<span class="variable">$str</span>, ENT_QUOTES); <span class="comment">// A &amp;#039;quote&amp;#039; is &amp;lt;b&amp;gt;bold&amp;lt;/b&amp;gt;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="require-x2F-require-once-and-include-x2F-include-once"><a href="#require-x2F-require-once-and-include-x2F-include-once" class="headerlink" title="require()&#x2F;require_once() and include()&#x2F;include_once()"></a>require()&#x2F;require_once() and include()&#x2F;include_once()</h4><ul>
<li>require 通常放在 PHP 程式的最前面，PHP 程式在執行前，就會先讀入 require 所指定引入的檔案，使它變成 PHP 程式網頁的一部份。常用的函式，亦可以這個方法將它引入網頁中。引入是無條件的，發生在程式執行前，不管條件是否成立都要導入（可能不執行）</li>
<li>include 一般是放在流程控制的處理區段中。PHP 程式網頁在讀到 include 的檔案時，才將它讀進來。這種方式，可以把程式執行時的流程簡單化。可以是有條件的，發生在程式執行時，只有條件成立時才導入（可以簡化編譯生成的代碼）。</li>
<li>require_once()&#x2F;include_once() 會檢查檔案是否已匯入,若已匯入則不重覆匯入</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">require_once</span>(<span class="string">&#x27;conn.php&#x27;</span>);</span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">&#x27;header.php&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="echo-print-r-and-var-var-dump"><a href="#echo-print-r-and-var-var-dump" class="headerlink" title="echo , print_r() and var var_dump()"></a>echo , print_r() and var var_dump()</h3><ul>
<li>echo  用於輸出數值變數或者是字串<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 雙引號可加變數</span></span><br><span class="line"><span class="variable">$user</span> = <span class="string">&#x27;Robert&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;Hello <span class="subst">$user</span>!&lt;br&gt;&quot;</span>	;  <span class="comment">// Hello Robert!</span></span><br></pre></td></tr></table></figure></li>
<li>print_r() 用於輸出一個陣列</li>
<li>var_dump() 用於輸出&lt;變數型別，變數值，變數長度&gt;,可以是各種變數型別</li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/database/" rel="tag"># database</a>
              <a href="/tags/mysql/" rel="tag"># mysql</a>
              <a href="/tags/php/" rel="tag"># php</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/05/29/js-4/" rel="prev" title="JavaScript tricky">
                  <i class="fa fa-chevron-left"></i> JavaScript tricky
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/06/03/db-1/" rel="next" title="DATABASE">
                  DATABASE <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    
  <div class="comments" id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Robert Kao</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="總字數">2.7m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="所需總閱讀時間">41:16</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 強力驅動
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="/js/local-search.js"></script>






  




  


<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://hot5656-blog.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://hot5656.github.io/2021/05/31/php-1/";
    this.page.identifier = "2021/05/31/php-1/";
    this.page.title = "PHP 說明";
    };
  NexT.utils.loadComments('#disqus_thread', () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://hot5656-blog.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
