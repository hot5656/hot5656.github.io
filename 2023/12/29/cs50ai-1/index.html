<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hot5656.github.io","root":"/","images":"/images","scheme":"Gemini","version":"8.2.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜尋...","empty":"我們無法找到任何有關 ${query} 的搜索結果","hits_time":"${hits} 找到 ${time} 個結果","hits":"找到 ${hits} 個結果"},"path":"/search.json","localsearch":{"enable":"enable","trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false}};
  </script>
<meta name="description" content="SearchTerm">
<meta property="og:type" content="article">
<meta property="og:title" content="CS50AI">
<meta property="og:url" content="https://hot5656.github.io/2023/12/29/cs50ai-1/index.html">
<meta property="og:site_name" content="Robert 雜記">
<meta property="og:description" content="SearchTerm">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://hot5656.github.io/2023/12/29/cs50ai-1/pic01.png">
<meta property="og:image" content="https://hot5656.github.io/2023/12/29/cs50ai-1/pic02.png">
<meta property="og:image" content="https://hot5656.github.io/2023/12/29/cs50ai-1/pic02-2.png">
<meta property="og:image" content="https://hot5656.github.io/2023/12/29/cs50ai-1/pic03.png">
<meta property="og:image" content="https://hot5656.github.io/2023/12/29/cs50ai-1/pic04.png">
<meta property="og:image" content="https://hot5656.github.io/2023/12/29/cs50ai-1/pic05.png">
<meta property="og:image" content="https://hot5656.github.io/2023/12/29/cs50ai-1/pic06.png">
<meta property="og:image" content="https://hot5656.github.io/2023/12/29/cs50ai-1/pic07.png">
<meta property="og:image" content="https://hot5656.github.io/2023/12/29/cs50ai-1/pic08.png">
<meta property="og:image" content="https://hot5656.github.io/2023/12/29/cs50ai-1/pic11.png">
<meta property="og:image" content="https://hot5656.github.io/2023/12/29/cs50ai-1/pic12.png">
<meta property="og:image" content="https://hot5656.github.io/2023/12/29/cs50ai-1/pic13.png">
<meta property="og:image" content="https://hot5656.github.io/2023/12/29/cs50ai-1/pic14.png">
<meta property="og:image" content="https://hot5656.github.io/2023/12/29/cs50ai-1/pic15.png">
<meta property="og:image" content="https://hot5656.github.io/2023/12/29/cs50ai-1/pic16.png">
<meta property="og:image" content="https://hot5656.github.io/2023/12/29/cs50ai-1/pic17.png">
<meta property="og:image" content="https://hot5656.github.io/2023/12/29/cs50ai-1/pic18.png">
<meta property="og:image" content="https://hot5656.github.io/2023/12/29/cs50ai-1/pic19.png">
<meta property="article:published_time" content="2023-12-29T00:31:34.000Z">
<meta property="article:modified_time" content="2024-04-11T04:09:01.982Z">
<meta property="article:author" content="Robert Kao">
<meta property="article:tag" content="cs50">
<meta property="article:tag" content="python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hot5656.github.io/2023/12/29/cs50ai-1/pic01.png">


<link rel="canonical" href="https://hot5656.github.io/2023/12/29/cs50ai-1/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-TW'
  };
</script>
<title>CS50AI | Robert 雜記</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切換導航欄" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Robert 雜記</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首頁</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>標籤</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分類</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>歸檔列表</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜尋
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜尋..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目錄
        </li>
        <li class="sidebar-nav-overview">
          本站概要
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Search"><span class="nav-number">1.</span> <span class="nav-text">Search</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Term"><span class="nav-number">1.1.</span> <span class="nav-text">Term</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#shell"><span class="nav-number">1.2.</span> <span class="nav-text">shell</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#project-submit"><span class="nav-number">1.3.</span> <span class="nav-text">project submit</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#put-to-github"><span class="nav-number">1.3.1.</span> <span class="nav-text">put to github</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#submit"><span class="nav-number">1.3.2.</span> <span class="nav-text">submit</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#modify-then-submit"><span class="nav-number">1.3.3.</span> <span class="nav-text">modify then submit</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#update-my-repository"><span class="nav-number">1.3.4.</span> <span class="nav-text">update my repository</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#knowledge"><span class="nav-number">2.</span> <span class="nav-text">knowledge</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Term-1"><span class="nav-number">2.1.</span> <span class="nav-text">Term</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#example-code"><span class="nav-number">2.2.</span> <span class="nav-text">example code</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#rain"><span class="nav-number">2.2.1.</span> <span class="nav-text">rain?</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#clue"><span class="nav-number">2.2.2.</span> <span class="nav-text">clue</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Inference-Rules-%E6%8E%A8%E7%90%86%E8%A6%8F%E5%89%87"><span class="nav-number">2.3.</span> <span class="nav-text">Inference Rules(推理規則)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Theorem-Proving-%E5%AE%9A%E7%90%86%E8%AD%89%E6%98%8E"><span class="nav-number">2.4.</span> <span class="nav-text">Theorem Proving(定理證明)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Resolution-%E6%AD%B8%E7%B5%90%E5%8E%9F%E7%90%86"><span class="nav-number">2.5.</span> <span class="nav-text">Resolution(歸結原理)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Conversion-to-CNF"><span class="nav-number">2.6.</span> <span class="nav-text">Conversion to CNF</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Inference-by-Resolution"><span class="nav-number">2.7.</span> <span class="nav-text">Inference by Resolution</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#First-Order-Logic"><span class="nav-number">2.8.</span> <span class="nav-text">First-Order Logic</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Uncertainty"><span class="nav-number">3.</span> <span class="nav-text">Uncertainty</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Conditional-Probability-%E6%A2%9D%E4%BB%B6%E6%A9%9F%E7%8E%87"><span class="nav-number">3.1.</span> <span class="nav-text">Conditional Probability 條件機率</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Bayes%E2%80%99-Rule-%E8%B2%9D%E8%91%89%E6%96%AF%E6%B3%95%E5%89%87"><span class="nav-number">3.2.</span> <span class="nav-text">Bayes’ Rule(貝葉斯法則)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Joint-Probability-%E8%81%AF%E5%90%88%E6%A9%9F%E7%8E%87"><span class="nav-number">3.3.</span> <span class="nav-text">Joint Probability(聯合機率)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Probability-Rules-%E6%A9%9F%E7%8E%87%E8%A6%8F%E5%89%87"><span class="nav-number">3.4.</span> <span class="nav-text">Probability Rules(機率規則)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Bayesian-Networks-%E8%B2%9D%E8%91%89%E6%96%AF%E7%B6%B2%E7%B5%A1"><span class="nav-number">3.5.</span> <span class="nav-text">Bayesian Networks(貝葉斯網絡)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Inference"><span class="nav-number">3.6.</span> <span class="nav-text">Inference</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Bayesian-Networks"><span class="nav-number">3.7.</span> <span class="nav-text">Bayesian Networks</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#inastall-pomegranate-need-correct-version"><span class="nav-number">3.7.1.</span> <span class="nav-text">inastall pomegranate (need correct version)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Inference-by-Enumeration%E5%88%97%E8%88%89-1-give-condition-%E2%80%93-gt-attend-x2F-miss-probability"><span class="nav-number">3.7.2.</span> <span class="nav-text">Inference by Enumeration列舉 #1 - give condition –&gt; attend&#x2F;miss probability</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#model-py"><span class="nav-number">3.7.2.1.</span> <span class="nav-text">model.py</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#likelihood-py"><span class="nav-number">3.7.2.2.</span> <span class="nav-text">likelihood.py</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#result"><span class="nav-number">3.7.2.3.</span> <span class="nav-text">result</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Inference-by-Enumeration-2-train-delayed-%E2%80%93-gt-predict-attend-x2F-miss-probability"><span class="nav-number">3.7.3.</span> <span class="nav-text">Inference by Enumeration #2 - train delayed –&gt; predict attend&#x2F;miss probability</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#inference-py"><span class="nav-number">3.7.3.1.</span> <span class="nav-text">inference.py</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Sampling%E5%8F%96%E6%A8%A3-approximate-inference-%E8%BF%91%E4%BC%BC%E6%8E%A8%E7%90%86"><span class="nav-number">3.7.4.</span> <span class="nav-text">Sampling取樣 - approximate inference 近似推理</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#sample-py"><span class="nav-number">3.7.4.1.</span> <span class="nav-text">sample.py</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#result-1"><span class="nav-number">3.7.4.2.</span> <span class="nav-text">result</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Likelihood-Weighting-%E5%8F%AF%E8%83%BD%E6%80%A7%E5%8A%A0%E6%AC%8A"><span class="nav-number">3.7.5.</span> <span class="nav-text">Likelihood Weighting 可能性加權</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Markov-Model"><span class="nav-number">3.8.</span> <span class="nav-text">Markov Model</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#model-py-1"><span class="nav-number">3.8.1.</span> <span class="nav-text">model.py</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#result-2"><span class="nav-number">3.8.2.</span> <span class="nav-text">result</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Markov-Models-2"><span class="nav-number">3.9.</span> <span class="nav-text">Markov Models #2</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#model-py-2"><span class="nav-number">3.9.1.</span> <span class="nav-text">model.py</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#sequence-py"><span class="nav-number">3.9.2.</span> <span class="nav-text">sequence.py</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#result-3"><span class="nav-number">3.9.3.</span> <span class="nav-text">result</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Optimization"><span class="nav-number">4.</span> <span class="nav-text">Optimization</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Term-2"><span class="nav-number">4.1.</span> <span class="nav-text">Term</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Learning"><span class="nav-number">5.</span> <span class="nav-text">Learning</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Term-3"><span class="nav-number">5.1.</span> <span class="nav-text">Term</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#banknotes0-py"><span class="nav-number">5.2.</span> <span class="nav-text">banknotes0.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#banknotes1-py"><span class="nav-number">5.3.</span> <span class="nav-text">banknotes1.py</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Neural-Networks"><span class="nav-number">6.</span> <span class="nav-text">Neural Networks</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Term-4"><span class="nav-number">6.1.</span> <span class="nav-text">Term</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#content"><span class="nav-number">6.2.</span> <span class="nav-text">content</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Neural-Network-Structure"><span class="nav-number">6.2.1.</span> <span class="nav-text">Neural Network Structure</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Multilayer-Neural-Networks"><span class="nav-number">6.2.2.</span> <span class="nav-text">Multilayer Neural Networks</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Overfitting"><span class="nav-number">6.2.3.</span> <span class="nav-text">Overfitting</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Image-Convolution"><span class="nav-number">6.2.4.</span> <span class="nav-text">Image Convolution</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#max-pooling"><span class="nav-number">6.2.5.</span> <span class="nav-text">max-pooling</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Convolutional-Neural-Networks"><span class="nav-number">6.2.6.</span> <span class="nav-text">Convolutional Neural Networks</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#recurrent-neural-network"><span class="nav-number">6.2.7.</span> <span class="nav-text">recurrent neural network</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#CaptionBot"><span class="nav-number">6.2.7.1.</span> <span class="nav-text">CaptionBot</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Youtub"><span class="nav-number">6.2.7.2.</span> <span class="nav-text">Youtub</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#google-%E7%BF%BB%E8%AD%AF"><span class="nav-number">6.2.7.3.</span> <span class="nav-text">google 翻譯</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#code"><span class="nav-number">6.3.</span> <span class="nav-text">code</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#banknotes-py"><span class="nav-number">6.3.1.</span> <span class="nav-text">banknotes.py</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#filter-py"><span class="nav-number">6.3.2.</span> <span class="nav-text">filter.py</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#handwriting-py"><span class="nav-number">6.3.3.</span> <span class="nav-text">handwriting.py</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Python"><span class="nav-number">7.</span> <span class="nav-text">Python</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#setup"><span class="nav-number">7.1.</span> <span class="nav-text">setup</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#package"><span class="nav-number">7.2.</span> <span class="nav-text">package</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#list"><span class="nav-number">7.2.1.</span> <span class="nav-text">list</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#csv"><span class="nav-number">7.2.2.</span> <span class="nav-text">csv</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#syntax"><span class="nav-number">7.3.</span> <span class="nav-text">syntax</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#anonymous-functions"><span class="nav-number">7.3.1.</span> <span class="nav-text">anonymous functions</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#class-print-function-string"><span class="nav-number">7.3.2.</span> <span class="nav-text">class print function : string</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#classmethod"><span class="nav-number">7.3.3.</span> <span class="nav-text">@classmethod</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#dict-key-by-tuple"><span class="nav-number">7.3.4.</span> <span class="nav-text">dict - key by tuple</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#function"><span class="nav-number">7.4.</span> <span class="nav-text">function</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#sorted"><span class="nav-number">7.4.1.</span> <span class="nav-text">sorted</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#zip"><span class="nav-number">7.4.2.</span> <span class="nav-text">zip</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#copy"><span class="nav-number">7.4.3.</span> <span class="nav-text">copy</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#items"><span class="nav-number">7.5.</span> <span class="nav-text">items</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#tuple-list-%E2%80%93-gt-tuple"><span class="nav-number">7.6.</span> <span class="nav-text">tuple - list –&gt; tuple</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ref"><span class="nav-number">8.</span> <span class="nav-text">Ref</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Robert Kao"
      src="/images/head.png">
  <p class="site-author-name" itemprop="name">Robert Kao</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">170</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">分類</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">66</span>
        <span class="site-state-item-name">標籤</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
        <div class="back-to-top animated" role="button">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-TW">
    <link itemprop="mainEntityOfPage" href="https://hot5656.github.io/2023/12/29/cs50ai-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/head.png">
      <meta itemprop="name" content="Robert Kao">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Robert 雜記">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          CS50AI
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">發表於</span>

      <time title="創建時間：2023-12-29 08:31:34" itemprop="dateCreated datePublished" datetime="2023-12-29T08:31:34+08:00">2023-12-29</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新於</span>
        <time title="修改時間：2024-04-11 12:09:01" itemprop="dateModified" datetime="2024-04-11T12:09:01+08:00">2024-04-11</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分類於</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Coding/" itemprop="url" rel="index"><span itemprop="name">Coding</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus：</span>
    
    <a title="disqus" href="/2023/12/29/cs50ai-1/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2023/12/29/cs50ai-1/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="文章字數">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">文章字數：</span>
      <span>30k</span>
    </span>
    <span class="post-meta-item" title="所需閱讀時間">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">所需閱讀時間 &asymp;</span>
      <span>27 分鐘</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h3 id="Search"><a href="#Search" class="headerlink" title="Search"></a>Search</h3><h4 id="Term"><a href="#Term" class="headerlink" title="Term"></a>Term</h4><span id="more"></span>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">agent</span><br><span class="line">state</span><br><span class="line">initial state</span><br><span class="line">actions</span><br><span class="line">  (s)</span><br><span class="line">transition model</span><br><span class="line">  result(s,a)</span><br><span class="line">path cost</span><br><span class="line">solution</span><br><span class="line"> potional solution</span><br><span class="line"></span><br><span class="line">search problems:</span><br><span class="line"> initiation state</span><br><span class="line"> action</span><br><span class="line"> transition model </span><br><span class="line"> goal <span class="built_in">test</span> </span><br><span class="line"> path cost <span class="keyword">function</span></span><br><span class="line"></span><br><span class="line">node :</span><br><span class="line"> a dat structure that keeps track of</span><br><span class="line"> -  a state</span><br><span class="line"> - a parent (node that generate this node)</span><br><span class="line"> - a action (action applied to parent to get node)</span><br><span class="line"> - a path cost(from initial state to node)</span><br><span class="line"></span><br><span class="line">depth-first search (stack)</span><br><span class="line">breadth-first search (queue)</span><br><span class="line"></span><br><span class="line">uninformed search</span><br><span class="line">infomed search</span><br><span class="line">  greedy best-first search</span><br><span class="line">  A* search</span><br><span class="line"></span><br><span class="line">adversarial search : 對抗性搜索</span><br><span class="line">Minimax</span><br><span class="line"> Max(X) aims to maximize score</span><br><span class="line"> MIN(O)  aimes to minize score</span><br><span class="line">Alpha-Beta Pruning:不要找完下層所有</span><br><span class="line">Depth-Limited Minimax:預估最大深度</span><br><span class="line">  evaluation <span class="keyword">function</span></span><br></pre></td></tr></table></figure>

<h4 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># install</span></span><br><span class="line">pip3 install -r requirements.txt</span><br><span class="line">python.exe -m pip install --upgrade pip</span><br><span class="line"></span><br><span class="line"><span class="comment"># select python</span></span><br><span class="line">Ctrl+Shift+P --&gt; python interpreter --&gt; select ...</span><br></pre></td></tr></table></figure>

<h4 id="project-submit"><a href="#project-submit" class="headerlink" title="project submit"></a>project submit</h4><h5 id="put-to-github"><a href="#put-to-github" class="headerlink" title="put to github"></a>put to github</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># degress git</span></span><br><span class="line">git init</span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;first version&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># github create repository</span></span><br><span class="line"><span class="comment"># push to github</span></span><br><span class="line">D:\work\run\me50-ai50\degrees&gt;git remote add origin https://github.com/hot5656/cs50ai-degrees.git</span><br><span class="line">git push -u origin master</span><br><span class="line"><span class="comment"># add brench ai50/projects/2024/x/degrees from github</span></span><br></pre></td></tr></table></figure>

<div style="max-width:1000px">
  <img src="/2023/12/29/cs50ai-1/pic01.png" class="" title="pic01">
</div>

<h5 id="submit"><a href="#submit" class="headerlink" title="submit"></a>submit</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># switch to new brance</span></span><br><span class="line">git fetch</span><br><span class="line">	From https://github.com/hot5656/cs50ai-p4-nim</span><br><span class="line">	 * [new branch]      ai50/projects/2024/x/nim -&gt; origin/ai50/projects/2024/x/nim</span><br><span class="line"></span><br><span class="line">git checkout ai50/projects/2024/x/nim</span><br><span class="line">	Switched to a new branch <span class="string">&#x27;ai50/projects/2024/x/nim&#x27;</span></span><br><span class="line">	branch <span class="string">&#x27;ai50/projects/2024/x/nim&#x27;</span> <span class="built_in">set</span> up to track <span class="string">&#x27;origin/ai50/projects/2024/x/nim&#x27;</span>.</span><br><span class="line"></span><br><span class="line">git branch -r</span><br><span class="line">  origin/ai50/projects/2024/x/nim</span><br><span class="line">  origin/master</span><br><span class="line"></span><br><span class="line"><span class="comment"># push for submit</span></span><br><span class="line">git push -u https://github.com/me50/hot5656 ai50/projects/2024/x/degrees</span><br><span class="line">    Username <span class="keyword">for</span> <span class="string">&#x27;https://github.com&#x27;</span>: hot5656</span><br><span class="line">    Password <span class="keyword">for</span> <span class="string">&#x27;https://hot5656@github.com&#x27;</span>:</span><br><span class="line">    Enumerating objects: 9, <span class="keyword">done</span>.</span><br><span class="line">    Counting objects: 100% (9/9), <span class="keyword">done</span>.</span><br><span class="line">    Delta compression using up to 8 threads</span><br><span class="line">    Compressing objects: 100% (8/8), <span class="keyword">done</span>.</span><br><span class="line">    Writing objects: 100% (9/9), 3.04 KiB | 445.00 KiB/s, <span class="keyword">done</span>.</span><br><span class="line">    Total 9 (delta 0), reused 0 (delta 0), pack-reused 0</span><br><span class="line">    remote:</span><br><span class="line">    remote: Create a pull request <span class="keyword">for</span> <span class="string">&#x27;ai50/projects/2024/x/degrees&#x27;</span> on GitHub by visiting:</span><br><span class="line">    remote:      https://github.com/me50/hot5656/pull/new/ai50/projects/2024/x/degrees</span><br><span class="line">    remote:</span><br><span class="line">    To https://github.com/me50/hot5656</span><br><span class="line">    * [new branch]      ai50/projects/2024/x/degrees -&gt; ai50/projects/2024/x/degrees</span><br><span class="line">    branch <span class="string">&#x27;ai50/projects/2024/x/degrees&#x27;</span> <span class="built_in">set</span> up to track <span class="string">&#x27;https://github.com/me50/hot5656/ai50/projects/2024/x/degrees&#x27;</span>.</span><br><span class="line"><span class="comment"># check submit status</span></span><br></pre></td></tr></table></figure>

<div style="max-width:1000px">
  <img src="/2023/12/29/cs50ai-1/pic02.png" class="" title="pic02">
</div>

<div style="max-width:1000px">
  <img src="/2023/12/29/cs50ai-1/pic02-2.png" class="" title="pic02-2">
</div>

<h5 id="modify-then-submit"><a href="#modify-then-submit" class="headerlink" title="modify then submit"></a>modify then submit</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tictactoe</span></span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;add action exception&quot;</span></span><br><span class="line">git push -u https://github.com/me50/hot5656 ai50/projects/2024/x/tictactoe</span><br></pre></td></tr></table></figure>

<h5 id="update-my-repository"><a href="#update-my-repository" class="headerlink" title="update my repository"></a>update my repository</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># push to my repository</span></span><br><span class="line">git push -u https://github.com/me50/hot5656 ai50/projects/2024/x/tictactoe</span><br></pre></td></tr></table></figure>

<h3 id="knowledge"><a href="#knowledge" class="headerlink" title="knowledge"></a>knowledge</h3><h4 id="Term-1"><a href="#Term-1" class="headerlink" title="Term"></a>Term</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Entailment (語義蘊涵也叫做邏輯蘊涵⊨)</span></span><br><span class="line">α ⊨ β : In every model <span class="keyword">in</span> <span class="built_in">which</span> sentence α is <span class="literal">true</span>, sentence β is also <span class="literal">true</span>.</span><br><span class="line"></span><br><span class="line"><span class="comment"># inference 推論</span></span><br><span class="line">P: It is a Tuesday.</span><br><span class="line">Q: It is raining.</span><br><span class="line">R: Harry will go <span class="keyword">for</span> a run.</span><br><span class="line">KB: (P ∧ ¬Q) --&gt; R </span><br><span class="line">Inference: R</span><br><span class="line"></span><br><span class="line"><span class="comment"># Inference Algorithms (推理演算法)</span></span><br><span class="line"><span class="comment">#Model Checking(列舉所有)</span></span><br><span class="line">• To determine <span class="keyword">if</span> KB ⊨ α:</span><br><span class="line">	• Enumerate all possible models.</span><br><span class="line">	• If <span class="keyword">in</span> every model <span class="built_in">where</span> KB is <span class="literal">true</span>, α is <span class="literal">true</span>, <span class="keyword">then</span></span><br><span class="line">	KB entails α.</span><br><span class="line">	• Otherwise, KB does not entail α.</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># →</span></span><br><span class="line">P     Q     P → Q</span><br><span class="line"><span class="literal">false</span> <span class="literal">false</span> <span class="literal">true</span></span><br><span class="line"><span class="literal">false</span> <span class="literal">true</span> 	<span class="literal">true</span></span><br><span class="line"><span class="literal">true</span> 	<span class="literal">false</span> <span class="literal">false</span></span><br><span class="line"><span class="literal">true</span> 	<span class="literal">true</span> 	<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ↔</span></span><br><span class="line">P  		Q  		P ↔ Q</span><br><span class="line"><span class="literal">false</span> <span class="literal">false</span>	<span class="literal">true</span></span><br><span class="line"><span class="literal">false</span> <span class="literal">true</span>  <span class="literal">false</span></span><br><span class="line"><span class="literal">true</span> 	<span class="literal">false</span> <span class="literal">false</span></span><br><span class="line"><span class="literal">true</span>	<span class="literal">true</span> 	<span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h4 id="example-code"><a href="#example-code" class="headerlink" title="example code"></a>example code</h4><h5 id="rain"><a href="#rain" class="headerlink" title="rain?"></a>rain?</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> logic <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">rain = Symbol(<span class="string">&quot;rain&quot;</span>)</span><br><span class="line">hargrid = Symbol(<span class="string">&quot;hagrid&quot;</span>)</span><br><span class="line">dombledore = Symbol(<span class="string">&quot;dombledore&quot;</span>)</span><br><span class="line"></span><br><span class="line">sentence = And(rain, hargrid)</span><br><span class="line"><span class="built_in">print</span>(sentence.formula())	<span class="comment"># rain ∧ hagrid</span></span><br><span class="line"></span><br><span class="line">knowledge = Implication(Not(rain), hargrid)</span><br><span class="line"><span class="built_in">print</span>(knowledge.formula()) <span class="comment"># (¬rain) =&gt; hagrid</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># chaeck rain</span></span><br><span class="line">knowledge = And(</span><br><span class="line">    Implication(Not(rain), hargrid),</span><br><span class="line">    Or(hargrid, dumbledore),</span><br><span class="line">    Not(And(hargrid, dumbledore)),</span><br><span class="line">    dumbledore</span><br><span class="line">)</span><br><span class="line"><span class="comment"># print(knowledge.formula())</span></span><br><span class="line"><span class="built_in">print</span>(model_check(knowledge, rain)) <span class="comment"># True</span></span><br><span class="line"><span class="comment"># print(model_check(knowledge, hargrid)) # False</span></span><br><span class="line"><span class="comment"># print(model_check(knowledge, dumbledore)) # True</span></span><br></pre></td></tr></table></figure>

<h5 id="clue"><a href="#clue" class="headerlink" title="clue"></a>clue</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> termcolor</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> logic <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">mustard = Symbol(<span class="string">&quot;ColMustard&quot;</span>)</span><br><span class="line">plum = Symbol(<span class="string">&quot;ProfPlum&quot;</span>)</span><br><span class="line">scarlet = Symbol(<span class="string">&quot;MsScarlet&quot;</span>)</span><br><span class="line">characters = [mustard, plum, scarlet]</span><br><span class="line"></span><br><span class="line">ballroom = Symbol(<span class="string">&quot;ballroom&quot;</span>)</span><br><span class="line">kitchen = Symbol(<span class="string">&quot;kitchen&quot;</span>)</span><br><span class="line">library = Symbol(<span class="string">&quot;library&quot;</span>)</span><br><span class="line">rooms = [ballroom, kitchen, library]</span><br><span class="line"></span><br><span class="line">knife = Symbol(<span class="string">&quot;knife&quot;</span>)</span><br><span class="line">revolver = Symbol(<span class="string">&quot;revolver&quot;</span>)</span><br><span class="line">wrench = Symbol(<span class="string">&quot;wrench&quot;</span>)</span><br><span class="line">weapons = [knife, revolver, wrench]</span><br><span class="line"></span><br><span class="line">symbols = characters + rooms + weapons</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check_knowledge</span>(<span class="params">knowledge</span>):</span></span><br><span class="line">    <span class="keyword">for</span> symbol <span class="keyword">in</span> symbols:</span><br><span class="line">        <span class="keyword">if</span> model_check(knowledge, symbol):</span><br><span class="line">            termcolor.cprint(<span class="string">f&quot;<span class="subst">&#123;symbol&#125;</span>: YES&quot;</span>, <span class="string">&quot;green&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="keyword">not</span> model_check(knowledge, Not(symbol)):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;symbol&#125;</span>: MAYBE&quot;</span>)</span><br><span class="line"></span><br><span class="line">knowledge = And(</span><br><span class="line">    Or(mustard, plum, scarlet),</span><br><span class="line">    Or(ballroom, kitchen, library),</span><br><span class="line">    Or(knife, revolver, wrench),</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(knowledge.formula())</span></span><br><span class="line"></span><br><span class="line">knowledge.add(Not(mustard))</span><br><span class="line">knowledge.add(Not(kitchen))</span><br><span class="line">knowledge.add(Not(revolver))</span><br><span class="line"></span><br><span class="line">knowledge.add(Or(</span><br><span class="line">    Not(scarlet), Not(library), Not(wrench)</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">knowledge.add(Not(plum))</span><br><span class="line">knowledge.add(Not(ballroom))</span><br><span class="line"></span><br><span class="line">check_knowledge(knowledge)</span><br></pre></td></tr></table></figure>

<h4 id="Inference-Rules-推理規則"><a href="#Inference-Rules-推理規則" class="headerlink" title="Inference Rules(推理規則)"></a>Inference Rules(推理規則)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># modus ponens 正向思維律</span></span><br><span class="line">a → B  --&gt; a <span class="literal">true</span> so B <span class="literal">true</span></span><br><span class="line"><span class="comment"># and Elimination 和消除</span></span><br><span class="line">a∧B --&gt; a <span class="literal">true</span>, B <span class="literal">true</span></span><br><span class="line"><span class="comment"># double negation Elimination 雙重否定</span></span><br><span class="line">¬(¬α)  --&gt; α</span><br><span class="line"><span class="comment"># Implication Elimination 暗示消除</span></span><br><span class="line">α → β --&gt; ¬α ∨ β</span><br><span class="line"><span class="comment"># Bicoditional Elimination</span></span><br><span class="line">α ↔ β --&gt; (α → β) ∧ (β → α)</span><br><span class="line"><span class="comment"># De morgan&#x27;s Law</span></span><br><span class="line">¬(α ∧ β) --&gt; ¬α ∨ ¬β</span><br><span class="line">¬(α ∨ β) --&gt; ¬α ∧ ¬β</span><br><span class="line"><span class="comment"># Distributive Property 分配律</span></span><br><span class="line">(α ∧ (β ∨ γ)) --&gt; (α ∧ β) ∨ (α ∧ γ)</span><br><span class="line">(α ∨ (β ∧ γ)) --&gt; (α ∨ β) ∧ (α ∨ γ)</span><br></pre></td></tr></table></figure>

<h4 id="Theorem-Proving-定理證明"><a href="#Theorem-Proving-定理證明" class="headerlink" title="Theorem Proving(定理證明)"></a>Theorem Proving(定理證明)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">• initial state: starting knowledge base</span><br><span class="line">• actions: inference rules</span><br><span class="line">• transition model: new knowledge base after inference</span><br><span class="line">• goal <span class="built_in">test</span>: check statement we<span class="string">&#x27;re trying to prove</span></span><br><span class="line"><span class="string">• path cost function: number of steps in proof</span></span><br></pre></td></tr></table></figure>

<h4 id="Resolution-歸結原理"><a href="#Resolution-歸結原理" class="headerlink" title="Resolution(歸結原理)"></a>Resolution(歸結原理)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(P ∨ Q) (¬P) --&gt; Q</span><br><span class="line">(P ∨ Q1 ∨ Q2 ∨ ...∨ Qn) (¬P) --&gt; Q1 ∨ Q2 ∨ ...∨ Qn</span><br><span class="line">(P ∨ Q) (¬P ∨ R) --&gt; Q ∨ R</span><br><span class="line">(P ∨ Q1 ∨ Q2 ∨ ...∨ Qn) (¬P ∨ R1 ∨ R2 ∨ ...∨ Rm) --&gt; Q1 ∨ Q2 ∨ ...∨ Qn ∨ R1 ∨ R2 ∨ ...∨ Rm</span><br></pre></td></tr></table></figure>

<h4 id="Conversion-to-CNF"><a href="#Conversion-to-CNF" class="headerlink" title="Conversion to CNF"></a>Conversion to CNF</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Clauses allow us to convert any logical statement into a Conjunctive Normal Form (CNF), which is a conjunction of clauses, for example: (A ∨ B ∨ C) ∧ (D ∨ ¬E) ∧ (F ∨ G).</span></span><br><span class="line"><span class="comment"># example </span></span><br><span class="line">Conversion to CNF</span><br><span class="line">(P ∨ Q) → R</span><br><span class="line">¬(P ∨ Q) ∨ R					<span class="comment"># eliminate implication</span></span><br><span class="line">(¬P ∧ ¬Q) ∨ R					<span class="comment"># De Morgan&#x27;s Law</span></span><br><span class="line">(¬P ∨ R) ∧ (¬Q ∨ R)	  <span class="comment"># distributive law</span></span><br></pre></td></tr></table></figure>

<h4 id="Inference-by-Resolution"><a href="#Inference-by-Resolution" class="headerlink" title="Inference by Resolution"></a>Inference by Resolution</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">(P ∨ Q) (¬P ∨ R) --&gt; (Q ∨ R)</span><br><span class="line">(P ∨ Q ∨ S) (¬P ∨ R ∨ S) --&gt; (Q ∨ S ∨ R)</span><br><span class="line">P ¬P --&gt; Flase</span><br><span class="line"></span><br><span class="line">• To determine <span class="keyword">if</span> KB ⊨ α:</span><br><span class="line">	• Check <span class="keyword">if</span> (KB ∧ ¬α) is a contradiction?</span><br><span class="line">	• If so, <span class="keyword">then</span> KB ⊨ α.</span><br><span class="line">	• Otherwise, no entailment.</span><br><span class="line"></span><br><span class="line">• To determine <span class="keyword">if</span> KB ⊨ α:</span><br><span class="line">	• Convert (KB ∧ ¬α) to Conjunctive Normal Form.</span><br><span class="line">	• Keep checking to see <span class="keyword">if</span> we can use resolution to</span><br><span class="line">	produce a new clause.</span><br><span class="line">	• If ever we produce the empty clause (equivalent</span><br><span class="line">	to False), we have a contradiction, and KB ⊨ α.</span><br><span class="line">	• Otherwise, <span class="keyword">if</span> we can<span class="string">&#x27;t add new clauses, no</span></span><br><span class="line"><span class="string">	entailment.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># Does (A ∨ B) ∧ (¬B ∨ C) ∧ (¬C) entail A?</span></span><br></pre></td></tr></table></figure>

<h4 id="First-Order-Logic"><a href="#First-Order-Logic" class="headerlink" title="First-Order Logic"></a>First-Order Logic</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">First-Order Logic </span><br><span class="line">Constant Symbol Predicate Symbol</span><br><span class="line">Minerva					Person</span><br><span class="line">Pomona					House</span><br><span class="line">Horace					BelongsTo</span><br><span class="line">Gilderoy</span><br><span class="line">Gryffindor</span><br><span class="line">Hufflepuff</span><br><span class="line">Ravenclaw</span><br><span class="line">Slytherin</span><br><span class="line">Person(Minerva) 									Minerva is a person.</span><br><span class="line">House(Gryffindor) 								Gryffindor is a house.</span><br><span class="line">¬House(Minerva) 									Minerva is not a house.</span><br><span class="line">BelongsTo(Minerva, Gryffindor)		Minerva belongs to Gryffindor</span><br><span class="line"><span class="comment"># Universal Quantification</span></span><br><span class="line"><span class="comment"># ∀表所有人</span></span><br><span class="line">∀x. BelongsTo(x, Gryffindor) →  ¬BelongsTo(x, Hufflepuff)</span><br><span class="line"><span class="comment"># Existential Quantification</span></span><br><span class="line"><span class="comment"># ∃任一存在</span></span><br><span class="line">∃x. House(x) ∧ BelongsTo(Minerva, x)</span><br><span class="line">∀x. Person(x) → (∃y. House(y) ∧ BelongsTo(x, y)</span><br></pre></td></tr></table></figure>

<h3 id="Uncertainty"><a href="#Uncertainty" class="headerlink" title="Uncertainty"></a>Uncertainty</h3><h4 id="Conditional-Probability-條件機率"><a href="#Conditional-Probability-條件機率" class="headerlink" title="Conditional Probability 條件機率"></a>Conditional Probability 條件機率</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">P(a|b) = P(a∧b)/P(b)</span><br><span class="line">	a=red-6, b=blue-6</span><br><span class="line">	P(a∧b) = 1/36</span><br><span class="line">	P(b) = 1/6</span><br><span class="line">	P(a|b) = 1/6</span><br><span class="line"></span><br><span class="line">P(a^b) = P(b) * P(a|b)</span><br><span class="line">P(a^b) = P(a) * P(b|a)</span><br><span class="line">P(a) * P(b|a) = P(b) * P(a|b)</span><br></pre></td></tr></table></figure>

<h4 id="Bayes’-Rule-貝葉斯法則"><a href="#Bayes’-Rule-貝葉斯法則" class="headerlink" title="Bayes’ Rule(貝葉斯法則)"></a>Bayes’ Rule(貝葉斯法則)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">	P(a|b) = P(a∧b)/P(b)</span><br><span class="line"></span><br><span class="line">	P(a^b) = P(b) * P(a|b)</span><br><span class="line">	P(a^b) = P(a) * P(b|a)</span><br><span class="line">	P(a) * P(b|a) = P(b) * P(a|b)</span><br><span class="line">	P(b|a) = P(b) * P(a|b)/P(a)</span><br><span class="line"></span><br><span class="line">- 80% of rainy afternoons start with cloudy mornings, or P(clouds | rain).</span><br><span class="line">- 40% of days have cloudy mornings, or P(clouds).</span><br><span class="line">- 10% of days have rainy afternoons, or P(rain).</span><br><span class="line"></span><br><span class="line">P(rain|clouds) = P(clouds|rain) * P(rain)/P(cloud)</span><br><span class="line">               = (.8)(.1)/.4 = 0.2</span><br><span class="line"></span><br><span class="line">Knowing </span><br><span class="line">  P(visible effect | unknow cause)</span><br><span class="line">We can calculate </span><br><span class="line">  P(unknow cause | visible effect)</span><br><span class="line"></span><br><span class="line">Knowing </span><br><span class="line">  P(medical <span class="built_in">test</span> result | disease)</span><br><span class="line">We can calculate </span><br><span class="line">  P(disease |  medical <span class="built_in">test</span> resul)</span><br></pre></td></tr></table></figure>

<h4 id="Joint-Probability-聯合機率"><a href="#Joint-Probability-聯合機率" class="headerlink" title="Joint Probability(聯合機率)"></a>Joint Probability(聯合機率)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">C = cloud C = ¬cloud</span><br><span class="line">0.4				0.6</span><br><span class="line">R = rain 	R = ¬rain</span><br><span class="line">0.1				0.9</span><br><span class="line"> </span><br><span class="line">						R = rain 	R = ¬rain</span><br><span class="line">C = cloud		0.08			0.32</span><br><span class="line">C = ¬cloud	0.02			0.58</span><br><span class="line"></span><br><span class="line"><span class="comment"># , = and </span></span><br><span class="line"><span class="comment"># p(rain) constant</span></span><br><span class="line">P(C|rain) = P(C,rain)/P(rain)</span><br><span class="line">					= αP(C, rain)</span><br><span class="line">          = α&lt;0.08, 0.02&gt; = &lt;0.8 0.2&gt;</span><br></pre></td></tr></table></figure>

<h4 id="Probability-Rules-機率規則"><a href="#Probability-Rules-機率規則" class="headerlink" title="Probability Rules(機率規則)"></a>Probability Rules(機率規則)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Negation: P(¬a) = 1 - P(a). </span><br><span class="line">Inclusion-Exclusion: P(a ∨ b) = P(a) + P(b) - P(a ∧ b). </span><br><span class="line">Marginalization: P(a) = P(a, b) + P(a, ¬b). </span><br><span class="line"></span><br><span class="line"><span class="comment"># Marginalization formula</span></span><br><span class="line">P(X = xi) = ∑P(X = xi, Y = yj)</span><br><span class="line">            j</span><br><span class="line"> P(C = cloud) = P(C = cloud, R = rain) + P(C = cloud, R = ¬rain) </span><br><span class="line">              = 0.08 + 0.32 = 0.4</span><br></pre></td></tr></table></figure>

<h4 id="Bayesian-Networks-貝葉斯網絡"><a href="#Bayesian-Networks-貝葉斯網絡" class="headerlink" title="Bayesian Networks(貝葉斯網絡)"></a>Bayesian Networks(貝葉斯網絡)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">- They are directed graphs.</span><br><span class="line">- Each node on the graph represent a random variable.</span><br><span class="line">- An arrow from X to Y represents that X is a parent of Y. That is, the probability distribution of Y depends on the value of X.</span><br><span class="line">- Each node X has probability distribution P(X | Parents(X)).</span><br><span class="line"></span><br><span class="line"><span class="comment"># Rain </span></span><br><span class="line">none 	light heavy</span><br><span class="line">0.7		0.2		0.1</span><br><span class="line"></span><br><span class="line"><span class="comment"># Maintenance </span></span><br><span class="line">R    	yes 	no</span><br><span class="line">none	0.4		0.6</span><br><span class="line">light	0.2		0.8</span><br><span class="line">heavy	0.1		0.9</span><br><span class="line"></span><br><span class="line"><span class="comment"># Train </span></span><br><span class="line">R 		M 	on time delayed</span><br><span class="line">none	yes	0.8			0.2</span><br><span class="line">none	no	0.9			0.1</span><br><span class="line">light	yes	0.6			0.4</span><br><span class="line">light	no	0.7			0.3</span><br><span class="line">heavy	yes	0.4			0.6</span><br><span class="line">heavy	no	0.5			0.5</span><br><span class="line"></span><br><span class="line"><span class="comment"># Appointment is a random variable </span></span><br><span class="line">T				attend	miss</span><br><span class="line">on time	0.9			0.1</span><br><span class="line">delayed	0.6			0.4</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="Inference"><a href="#Inference" class="headerlink" title="Inference"></a>Inference</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- Query X: the variable <span class="keyword">for</span> <span class="built_in">which</span> we want to compute the probability distribution.</span><br><span class="line">- Evidence variables E: one or more variables that have been observed <span class="keyword">for</span> event e. For example, we might have observed that there is </span><br><span class="line">	light rain, and this observation helps us compute the probability that the train is delayed.</span><br><span class="line">- Hidden variables Y: variables that aren’t the query and also haven’t been observed. For example, standing at the train station, we </span><br><span class="line">	can observe whether there is rain, but we can’t know <span class="keyword">if</span> there is maintenance on the track further down the road. Thus, Maintenance </span><br><span class="line">	would be a hidden variable <span class="keyword">in</span> this situation.</span><br><span class="line">- The goal: calculate P(X | e). For example, compute the probability distribution of the Train variable (the query) based on the </span><br><span class="line">	evidence e that we know there is light rain.</span><br></pre></td></tr></table></figure>


<h4 id="Bayesian-Networks"><a href="#Bayesian-Networks" class="headerlink" title="Bayesian Networks"></a>Bayesian Networks</h4><div style="max-width:500px">
  <img src="/2023/12/29/cs50ai-1/pic03.png" class="" title="pic03">
</div>
<div style="max-width:500px">
  <img src="/2023/12/29/cs50ai-1/pic04.png" class="" title="pic04">
</div>

<h5 id="inastall-pomegranate-need-correct-version"><a href="#inastall-pomegranate-need-correct-version" class="headerlink" title="inastall pomegranate (need correct version)"></a>inastall pomegranate (need correct version)</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install pomegranate==v0.14.9</span><br></pre></td></tr></table></figure>
<h5 id="Inference-by-Enumeration列舉-1-give-condition-–-gt-attend-x2F-miss-probability"><a href="#Inference-by-Enumeration列舉-1-give-condition-–-gt-attend-x2F-miss-probability" class="headerlink" title="Inference by Enumeration列舉 #1 - give condition –&gt; attend&#x2F;miss probability"></a>Inference by Enumeration列舉 #1 - give condition –&gt; attend&#x2F;miss probability</h5><h6 id="model-py"><a href="#model-py" class="headerlink" title="model.py"></a>model.py</h6><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pomegranate <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># Rain node has no parents</span></span><br><span class="line">rain = Node(DiscreteDistribution(&#123;</span><br><span class="line">    <span class="string">&quot;none&quot;</span>: <span class="number">0.7</span>,</span><br><span class="line">    <span class="string">&quot;light&quot;</span>: <span class="number">0.2</span>,</span><br><span class="line">    <span class="string">&quot;heavy&quot;</span>: <span class="number">0.1</span></span><br><span class="line">&#125;), name=<span class="string">&quot;rain&quot;</span>)</span><br><span class="line"></span><br><span class="line">......</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a Bayesian Network and add states</span></span><br><span class="line">model = BayesianNetwork()</span><br><span class="line">model.add_states(rain, maintenance, train, appointment)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add edges connecting nodes</span></span><br><span class="line">model.add_edge(rain, maintenance)</span><br><span class="line">model.add_edge(rain, train)</span><br><span class="line">model.add_edge(maintenance, train)</span><br><span class="line">model.add_edge(train, appointment)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Finalize model</span></span><br><span class="line">model.bake()</span><br></pre></td></tr></table></figure>

<h6 id="likelihood-py"><a href="#likelihood-py" class="headerlink" title="likelihood.py"></a>likelihood.py</h6><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> model <span class="keyword">import</span> model</span><br><span class="line"></span><br><span class="line"><span class="comment"># Calculate probability for a given observation</span></span><br><span class="line">probability = model.probability([[<span class="string">&quot;none&quot;</span>, <span class="string">&quot;no&quot;</span>, <span class="string">&quot;on time&quot;</span>, <span class="string">&quot;attend&quot;</span>]])</span><br><span class="line">probability_miss = model.probability([[<span class="string">&quot;none&quot;</span>, <span class="string">&quot;no&quot;</span>, <span class="string">&quot;on time&quot;</span>, <span class="string">&quot;miss&quot;</span>]])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;normal attend &quot;</span>, probability)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;normal miss &quot;</span>, probability_miss)</span><br></pre></td></tr></table></figure>

<h6 id="result"><a href="#result" class="headerlink" title="result"></a>result</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python .\likelihood.py</span><br><span class="line">	normal attend  0.34019999999999995</span><br><span class="line">	normal miss  0.037800000000000014</span><br></pre></td></tr></table></figure>

<h5 id="Inference-by-Enumeration-2-train-delayed-–-gt-predict-attend-x2F-miss-probability"><a href="#Inference-by-Enumeration-2-train-delayed-–-gt-predict-attend-x2F-miss-probability" class="headerlink" title="Inference by Enumeration #2 - train delayed –&gt; predict attend&#x2F;miss probability"></a>Inference by Enumeration #2 - train delayed –&gt; predict attend&#x2F;miss probability</h5><h6 id="inference-py"><a href="#inference-py" class="headerlink" title="inference.py"></a>inference.py</h6><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> model <span class="keyword">import</span> model</span><br><span class="line"></span><br><span class="line"><span class="comment"># Calculate predictions</span></span><br><span class="line"><span class="comment"># predictions = model.predict_proba(&#123;</span></span><br><span class="line"><span class="comment">#     &quot;train&quot;: &quot;delayed&quot;</span></span><br><span class="line"><span class="comment"># &#125;)</span></span><br><span class="line"><span class="comment"># rain</span></span><br><span class="line"><span class="comment">#     none: 0.4583</span></span><br><span class="line"><span class="comment">#     light: 0.3069</span></span><br><span class="line"><span class="comment">#     heavy: 0.2348</span></span><br><span class="line"><span class="comment"># maintenance</span></span><br><span class="line"><span class="comment">#     no: 0.6432</span></span><br><span class="line"><span class="comment">#     yes: 0.3568</span></span><br><span class="line"><span class="comment"># train: delayed</span></span><br><span class="line"><span class="comment"># appointment</span></span><br><span class="line"><span class="comment">#     miss: 0.4000</span></span><br><span class="line"><span class="comment">#     attend: 0.6000</span></span><br><span class="line"></span><br><span class="line">predictions = model.predict_proba(&#123;</span><br><span class="line">    <span class="string">&quot;rain&quot;</span>:<span class="string">&quot;heavy&quot;</span>,</span><br><span class="line">    <span class="string">&quot;train&quot;</span>: <span class="string">&quot;delayed&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment"># rain: heavy</span></span><br><span class="line"><span class="comment"># maintenance</span></span><br><span class="line"><span class="comment">#     yes: 0.1176</span></span><br><span class="line"><span class="comment">#     no: 0.8824</span></span><br><span class="line"><span class="comment"># train: delayed</span></span><br><span class="line"><span class="comment"># appointment</span></span><br><span class="line"><span class="comment">#     attend: 0.6000</span></span><br><span class="line"><span class="comment">#     miss: 0.4000</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Print predictions for each node</span></span><br><span class="line"><span class="keyword">for</span> node, prediction <span class="keyword">in</span> <span class="built_in">zip</span>(model.states, predictions):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(prediction, <span class="built_in">str</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;node.name&#125;</span>: <span class="subst">&#123;prediction&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;node.name&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> value, probability <span class="keyword">in</span> prediction.parameters[<span class="number">0</span>].items():</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;    <span class="subst">&#123;value&#125;</span>: <span class="subst">&#123;probability:<span class="number">.4</span>f&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h5 id="Sampling取樣-approximate-inference-近似推理"><a href="#Sampling取樣-approximate-inference-近似推理" class="headerlink" title="Sampling取樣 - approximate inference 近似推理"></a>Sampling取樣 - approximate inference 近似推理</h5><h6 id="sample-py"><a href="#sample-py" class="headerlink" title="sample.py"></a>sample.py</h6><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pomegranate</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> Counter</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> model <span class="keyword">import</span> model</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generate_sample</span>():</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Mapping of random variable name to sample generated</span></span><br><span class="line">    sample = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Mapping of distribution to sample generated</span></span><br><span class="line">    parents = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Loop over all states, assuming topological order</span></span><br><span class="line">    <span class="keyword">for</span> state <span class="keyword">in</span> model.states:</span><br><span class="line"></span><br><span class="line">        <span class="comment"># If we have a non-root node, sample conditional on parents</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(state.distribution, pomegranate.ConditionalProbabilityTable):</span><br><span class="line">            sample[state.name] = state.distribution.sample(parent_values=parents)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Otherwise, just sample from the distribution alone</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            sample[state.name] = state.distribution.sample()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Keep track of the sampled value in the parents mapping</span></span><br><span class="line">        parents[state.distribution] = sample[state.name]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Return generated sample</span></span><br><span class="line">    <span class="keyword">return</span> sample</span><br><span class="line"></span><br><span class="line"><span class="comment"># Rejection sampling</span></span><br><span class="line"><span class="comment"># Compute distribution of Appointment given that train is delayed</span></span><br><span class="line">N = <span class="number">10000</span></span><br><span class="line">data = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(N):</span><br><span class="line">    sample = generate_sample()</span><br><span class="line">    <span class="keyword">if</span> sample[<span class="string">&quot;train&quot;</span>] == <span class="string">&quot;delayed&quot;</span>:</span><br><span class="line">        data.append(sample[<span class="string">&quot;appointment&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(Counter(data))</span><br></pre></td></tr></table></figure>

<h6 id="result-1"><a href="#result-1" class="headerlink" title="result"></a>result</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python .\sample.py</span><br><span class="line">	Counter(&#123;<span class="string">&#x27;attend&#x27;</span>: 1321, <span class="string">&#x27;miss&#x27;</span>: 868&#125;)</span><br><span class="line">python .\sample.py</span><br><span class="line">	Counter(&#123;<span class="string">&#x27;attend&#x27;</span>: 1244, <span class="string">&#x27;miss&#x27;</span>: 867&#125;)</span><br></pre></td></tr></table></figure>

<h5 id="Likelihood-Weighting-可能性加權"><a href="#Likelihood-Weighting-可能性加權" class="headerlink" title="Likelihood Weighting 可能性加權"></a>Likelihood Weighting 可能性加權</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- Start by fixing the values <span class="keyword">for</span> evidence variables.</span><br><span class="line">- Sample the non-evidence variables using conditional probabilities <span class="keyword">in</span> the Bayesian network.</span><br><span class="line">- Weight each sample by its likelihood: the probability of all the evidence occurring.</span><br></pre></td></tr></table></figure>

<h4 id="Markov-Model"><a href="#Markov-Model" class="headerlink" title="Markov Model"></a>Markov Model</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- Markov Assumption 馬卡夫假設</span><br><span class="line">	the assumption that the current state depends on only a finite fixed number of previous states</span><br><span class="line">- Markov Chain</span><br><span class="line">	a sequence of random variables <span class="built_in">where</span> the distribution of each variable follows the Markov assumption</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2023/12/29/cs50ai-1/pic05.png" class="" title="pic05">
</div>
<div style="max-width:500px">
  <img src="/2023/12/29/cs50ai-1/pic06.png" class="" title="pic06">
</div>

<h5 id="model-py-1"><a href="#model-py-1" class="headerlink" title="model.py"></a>model.py</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pomegranate <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define starting probabilities</span></span><br><span class="line">start = DiscreteDistribution(&#123;</span><br><span class="line">    <span class="string">&quot;sun&quot;</span>: <span class="number">0.5</span>,</span><br><span class="line">    <span class="string">&quot;rain&quot;</span>: <span class="number">0.5</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define transition model</span></span><br><span class="line">transitions = ConditionalProbabilityTable([</span><br><span class="line">    [<span class="string">&quot;sun&quot;</span>, <span class="string">&quot;sun&quot;</span>, <span class="number">0.8</span>],</span><br><span class="line">    [<span class="string">&quot;sun&quot;</span>, <span class="string">&quot;rain&quot;</span>, <span class="number">0.2</span>],</span><br><span class="line">    [<span class="string">&quot;rain&quot;</span>, <span class="string">&quot;sun&quot;</span>, <span class="number">0.3</span>],</span><br><span class="line">    [<span class="string">&quot;rain&quot;</span>, <span class="string">&quot;rain&quot;</span>, <span class="number">0.7</span>]</span><br><span class="line">], [start])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create Markov chain</span></span><br><span class="line">model = MarkovChain([start, transitions])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sample 50 states from chain</span></span><br><span class="line"><span class="built_in">print</span>(model.sample(<span class="number">50</span>))</span><br></pre></td></tr></table></figure>

<h5 id="result-2"><a href="#result-2" class="headerlink" title="result"></a>result</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python .\model.py</span><br><span class="line">	[<span class="string">&#x27;rain&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;rain&#x27;</span>, <span class="string">&#x27;rain&#x27;</span>, <span class="string">&#x27;rain&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;rain&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;rain&#x27;</span>, <span class="string">&#x27;rain&#x27;</span>, <span class="string">&#x27;rain&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;rain&#x27;</span>, <span class="string">&#x27;rain&#x27;</span>, <span class="string">&#x27;rain&#x27;</span>, <span class="string">&#x27;rain&#x27;</span>, <span class="string">&#x27;rain&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;rain&#x27;</span>, <span class="string">&#x27;rain&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;rain&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;rain&#x27;</span>, <span class="string">&#x27;rain&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>, <span class="string">&#x27;sun&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h4 id="Markov-Models-2"><a href="#Markov-Models-2" class="headerlink" title="Markov Models #2"></a>Markov Models #2</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- Hidden Markov Models</span><br><span class="line">  a Markov model <span class="keyword">for</span> a system with hidden states that generate some observed event</span><br><span class="line">- Sensor Markov Assumption</span><br><span class="line">	the assumption that the evidence variable depends only the corresponding state</span><br></pre></td></tr></table></figure>

<div style="max-width:500px">
  <img src="/2023/12/29/cs50ai-1/pic07.png" class="" title="pic07">
</div>

<div style="max-width:500px">
  <img src="/2023/12/29/cs50ai-1/pic08.png" class="" title="pic08">
</div>

<h5 id="model-py-2"><a href="#model-py-2" class="headerlink" title="model.py"></a>model.py</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pomegranate <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># Observation model for each state</span></span><br><span class="line">sun = DiscreteDistribution(&#123;</span><br><span class="line">    <span class="string">&quot;umbrella&quot;</span>: <span class="number">0.2</span>,</span><br><span class="line">    <span class="string">&quot;no umbrella&quot;</span>: <span class="number">0.8</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">rain = DiscreteDistribution(&#123;</span><br><span class="line">    <span class="string">&quot;umbrella&quot;</span>: <span class="number">0.9</span>,</span><br><span class="line">    <span class="string">&quot;no umbrella&quot;</span>: <span class="number">0.1</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">states = [sun, rain]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Transition model</span></span><br><span class="line">transitions = numpy.array(</span><br><span class="line">    [[<span class="number">0.8</span>, <span class="number">0.2</span>], <span class="comment"># Tomorrow&#x27;s predictions if today = sun</span></span><br><span class="line">     [<span class="number">0.3</span>, <span class="number">0.7</span>]] <span class="comment"># Tomorrow&#x27;s predictions if today = rain</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Starting probabilities</span></span><br><span class="line">starts = numpy.array([<span class="number">0.5</span>, <span class="number">0.5</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create the model</span></span><br><span class="line">model = HiddenMarkovModel.from_matrix(</span><br><span class="line">    transitions, states, starts,</span><br><span class="line">    state_names=[<span class="string">&quot;sun&quot;</span>, <span class="string">&quot;rain&quot;</span>]</span><br><span class="line">)</span><br><span class="line">model.bake()</span><br></pre></td></tr></table></figure>

<h5 id="sequence-py"><a href="#sequence-py" class="headerlink" title="sequence.py"></a>sequence.py</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> model <span class="keyword">import</span> model</span><br><span class="line"></span><br><span class="line"><span class="comment"># Observed data</span></span><br><span class="line">observations = [</span><br><span class="line">    <span class="string">&quot;umbrella&quot;</span>,</span><br><span class="line">    <span class="string">&quot;umbrella&quot;</span>,</span><br><span class="line">    <span class="string">&quot;no umbrella&quot;</span>,</span><br><span class="line">    <span class="string">&quot;umbrella&quot;</span>,</span><br><span class="line">    <span class="string">&quot;umbrella&quot;</span>,</span><br><span class="line">    <span class="string">&quot;umbrella&quot;</span>,</span><br><span class="line">    <span class="string">&quot;umbrella&quot;</span>,</span><br><span class="line">    <span class="string">&quot;no umbrella&quot;</span>,</span><br><span class="line">    <span class="string">&quot;no umbrella&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Predict underlying states</span></span><br><span class="line">predictions = model.predict(observations)</span><br><span class="line"><span class="keyword">for</span> prediction <span class="keyword">in</span> predictions:</span><br><span class="line">    <span class="built_in">print</span>(model.states[prediction].name)</span><br></pre></td></tr></table></figure>

<h5 id="result-3"><a href="#result-3" class="headerlink" title="result"></a>result</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">python .\sequence.py</span><br><span class="line">	rain</span><br><span class="line">	rain</span><br><span class="line">	sun</span><br><span class="line">	rain</span><br><span class="line">	rain</span><br><span class="line">	rain</span><br><span class="line">	rain</span><br><span class="line">	sun</span><br><span class="line">	sun</span><br></pre></td></tr></table></figure>


<h3 id="Optimization"><a href="#Optimization" class="headerlink" title="Optimization"></a>Optimization</h3><h4 id="Term-2"><a href="#Term-2" class="headerlink" title="Term"></a>Term</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Local search</span><br><span class="line">Hill Climbing</span><br><span class="line"></span><br><span class="line">Simulated Annealing</span><br><span class="line"></span><br><span class="line">Traveling Salesman Problem</span><br><span class="line"></span><br><span class="line">Linear Programming</span><br><span class="line"></span><br><span class="line">Constraint Satisfaction</span><br><span class="line"></span><br><span class="line">unary constraint 單元</span><br><span class="line">binary constraint 雙元</span><br><span class="line">node consistenc節點一致性 - unary constraint</span><br><span class="line">arc consistency 弧一致性 - 符合 binary constraint</span><br><span class="line"></span><br><span class="line">backtracking serach 回溯搜尋</span><br><span class="line"></span><br><span class="line">Inference</span><br><span class="line">maintaining arc -consistency</span><br></pre></td></tr></table></figure>

<h3 id="Learning"><a href="#Learning" class="headerlink" title="Learning"></a>Learning</h3><h4 id="Term-3"><a href="#Term-3" class="headerlink" title="Term"></a>Term</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">Learning </span><br><span class="line">	1. Supervised Learning 監督學習 (have label)</span><br><span class="line">	2. reinforcement learning 強化學習</span><br><span class="line">	3. unspervised learnin 無監督學習(no label)</span><br><span class="line"></span><br><span class="line">1. Supervised Learning 監督學習</span><br><span class="line">nearest-neighbor classification 鄰近分類</span><br><span class="line">k-nearest-neighbor classification :   k nearest data point  鄰近分類</span><br><span class="line"></span><br><span class="line">perceptron learning rule 感知器學習規則</span><br><span class="line"></span><br><span class="line">Support Vector Machine 支持向量</span><br><span class="line">maximum margin separator 最大邊距分隔</span><br><span class="line"></span><br><span class="line">regression 回歸</span><br><span class="line">Evaluating Hypotheses 評估假設</span><br><span class="line">loss <span class="keyword">function</span> </span><br><span class="line"></span><br><span class="line">L1 loss <span class="keyword">function</span> </span><br><span class="line">L(actial, predicted) = | actual - predicted|</span><br><span class="line">L2 loss <span class="keyword">function</span></span><br><span class="line">L(actial, predicted) = (actual - predicted)^2</span><br><span class="line"></span><br><span class="line">Overfitting 過度吻合</span><br><span class="line"></span><br><span class="line">regularization 正規化</span><br><span class="line">cost(h) = lost(h) + r complexity(h)</span><br><span class="line"></span><br><span class="line">holdout cross-validation 保留交叉驗證</span><br><span class="line">k-fold cross validation Y折交叉驗證</span><br><span class="line"></span><br><span class="line">python lib: scikit-learn(nearest neighbor)</span><br><span class="line">perceptron  感知機</span><br><span class="line"></span><br><span class="line">2. reinforcement learning 強化學習</span><br><span class="line">Markov Decision Process</span><br><span class="line">Q-learning : Q(s,a)</span><br><span class="line">	Q(s, a) &lt;- Q(s, a) + alpha * (new value estimate - old value estimate)</span><br><span class="line"></span><br><span class="line">Greedy Decision-Making</span><br><span class="line"></span><br><span class="line">Explore vs. Exploit 探索與利用</span><br><span class="line"></span><br><span class="line">e-Greedy</span><br><span class="line">Nim game</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> approximation</span><br><span class="line"></span><br><span class="line">3. unspervised learnin 無監督學習(no label)</span><br><span class="line">Clustering 群聚</span><br><span class="line"> </span><br><span class="line">Some Clustering Applications 一些叢集應用</span><br><span class="line">- Genetic research  基因研究</span><br><span class="line">- image segmentation 影像分割</span><br><span class="line">- market research 市場調查</span><br><span class="line">- medical imaging 醫學影像</span><br><span class="line">- social network analysis 社會網絡分析</span><br><span class="line"></span><br><span class="line">k-means clustering</span><br></pre></td></tr></table></figure>

<h4 id="banknotes0-py"><a href="#banknotes0-py" class="headerlink" title="banknotes0.py"></a>banknotes0.py</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> svm</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> Perceptron</span><br><span class="line"><span class="keyword">from</span> sklearn.naive_bayes <span class="keyword">import</span> GaussianNB</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line"></span><br><span class="line"><span class="comment"># model = Perceptron()</span></span><br><span class="line"><span class="comment"># Results for model Perceptron</span></span><br><span class="line"><span class="comment"># Correct: 541</span></span><br><span class="line"><span class="comment"># Incorrect: 7</span></span><br><span class="line"><span class="comment"># Accuracy: 98.72%</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># model = svm.SVC()</span></span><br><span class="line"><span class="comment"># Results for model SVC</span></span><br><span class="line"><span class="comment"># Correct: 545</span></span><br><span class="line"><span class="comment"># Incorrect: 3</span></span><br><span class="line"><span class="comment"># Accuracy: 99.45%</span></span><br><span class="line"></span><br><span class="line">model = KNeighborsClassifier(n_neighbors=<span class="number">1</span>)</span><br><span class="line"><span class="comment"># model = KNeighborsClassifier(n_neighbors=1)</span></span><br><span class="line"><span class="comment"># holdout = int(0.40 * len(data))</span></span><br><span class="line"><span class="comment"># Results for model KNeighborsClassifier</span></span><br><span class="line"><span class="comment"># Correct: 548</span></span><br><span class="line"><span class="comment"># Incorrect: 0</span></span><br><span class="line"><span class="comment"># Accuracy: 100.00%</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># model = KNeighborsClassifier(n_neighbors=1)</span></span><br><span class="line"><span class="comment"># holdout = int(0.50 * len(data))</span></span><br><span class="line"><span class="comment"># Results for model KNeighborsClassifier</span></span><br><span class="line"><span class="comment"># Correct: 685</span></span><br><span class="line"><span class="comment"># Incorrect: 1</span></span><br><span class="line"><span class="comment"># Accuracy: 99.85%</span></span><br><span class="line"><span class="comment"># can set : model = KNeighborsClassifier(n_neighbors= 3)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># model = GaussianNB()</span></span><br><span class="line"><span class="comment"># Results for model GaussianNB</span></span><br><span class="line"><span class="comment"># Correct: 466</span></span><br><span class="line"><span class="comment"># Incorrect: 82</span></span><br><span class="line"><span class="comment"># Accuracy: 85.04%</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Read data in from file</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;banknotes.csv&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    reader = csv.reader(f)</span><br><span class="line">    <span class="built_in">next</span>(reader)</span><br><span class="line"></span><br><span class="line">    data = []</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        data.append(&#123;</span><br><span class="line">            <span class="string">&quot;evidence&quot;</span>: [<span class="built_in">float</span>(cell) <span class="keyword">for</span> cell <span class="keyword">in</span> row[:<span class="number">4</span>]],</span><br><span class="line">            <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Authentic&quot;</span> <span class="keyword">if</span> row[<span class="number">4</span>] == <span class="string">&quot;0&quot;</span> <span class="keyword">else</span> <span class="string">&quot;Counterfeit&quot;</span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Separate data into training and testing groups</span></span><br><span class="line"><span class="comment"># holdout = int(0.40 * len(data))</span></span><br><span class="line">holdout = <span class="built_in">int</span>(<span class="number">0.50</span> * <span class="built_in">len</span>(data))</span><br><span class="line">random.shuffle(data)</span><br><span class="line">testing = data[:holdout]</span><br><span class="line">training = data[holdout:]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Train model on training set</span></span><br><span class="line">X_training = [row[<span class="string">&quot;evidence&quot;</span>] <span class="keyword">for</span> row <span class="keyword">in</span> training]</span><br><span class="line">y_training = [row[<span class="string">&quot;label&quot;</span>] <span class="keyword">for</span> row <span class="keyword">in</span> training]</span><br><span class="line">model.fit(X_training, y_training)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Make predictions on the testing set</span></span><br><span class="line">X_testing = [row[<span class="string">&quot;evidence&quot;</span>] <span class="keyword">for</span> row <span class="keyword">in</span> testing]</span><br><span class="line">y_testing = [row[<span class="string">&quot;label&quot;</span>] <span class="keyword">for</span> row <span class="keyword">in</span> testing]</span><br><span class="line">predictions = model.predict(X_testing)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Compute how well we performed</span></span><br><span class="line">correct = <span class="number">0</span></span><br><span class="line">incorrect = <span class="number">0</span></span><br><span class="line">total = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> actual, predicted <span class="keyword">in</span> <span class="built_in">zip</span>(y_testing, predictions):</span><br><span class="line">    total += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> actual == predicted:</span><br><span class="line">        correct += <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        incorrect += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Print results</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Results for model <span class="subst">&#123;<span class="built_in">type</span>(model).__name__&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Correct: <span class="subst">&#123;correct&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Incorrect: <span class="subst">&#123;incorrect&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Accuracy: <span class="subst">&#123;<span class="number">100</span> * correct / total:<span class="number">.2</span>f&#125;</span>%&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="banknotes1-py"><a href="#banknotes1-py" class="headerlink" title="banknotes1.py"></a>banknotes1.py</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> svm</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> Perceptron</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.naive_bayes <span class="keyword">import</span> GaussianNB</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line"></span><br><span class="line">model = Perceptron()</span><br><span class="line"><span class="comment"># model = svm.SVC()</span></span><br><span class="line"><span class="comment"># model = KNeighborsClassifier(n_neighbors=1)</span></span><br><span class="line"><span class="comment"># model = GaussianNB()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Read data in from file</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;banknotes.csv&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    reader = csv.reader(f)</span><br><span class="line">    <span class="built_in">next</span>(reader)</span><br><span class="line"></span><br><span class="line">    data = []</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        data.append(&#123;</span><br><span class="line">            <span class="string">&quot;evidence&quot;</span>: [<span class="built_in">float</span>(cell) <span class="keyword">for</span> cell <span class="keyword">in</span> row[:<span class="number">4</span>]],</span><br><span class="line">            <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Authentic&quot;</span> <span class="keyword">if</span> row[<span class="number">4</span>] == <span class="string">&quot;0&quot;</span> <span class="keyword">else</span> <span class="string">&quot;Counterfeit&quot;</span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Separate data into training and testing groups</span></span><br><span class="line">evidence = [row[<span class="string">&quot;evidence&quot;</span>] <span class="keyword">for</span> row <span class="keyword">in</span> data]</span><br><span class="line">labels = [row[<span class="string">&quot;label&quot;</span>] <span class="keyword">for</span> row <span class="keyword">in</span> data]</span><br><span class="line"></span><br><span class="line"><span class="comment"># train_test_split 自動分組</span></span><br><span class="line">X_training, X_testing, y_training, y_testing = train_test_split(</span><br><span class="line">    evidence, labels, test_size=<span class="number">0.4</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fit model</span></span><br><span class="line">model.fit(X_training, y_training)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Make predictions on the testing set</span></span><br><span class="line">predictions = model.predict(X_testing)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Compute how well we performed</span></span><br><span class="line">correct = (y_testing == predictions).<span class="built_in">sum</span>()</span><br><span class="line">incorrect = (y_testing != predictions).<span class="built_in">sum</span>()</span><br><span class="line">total = <span class="built_in">len</span>(predictions)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Print results</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Results for model <span class="subst">&#123;<span class="built_in">type</span>(model).__name__&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Correct: <span class="subst">&#123;correct&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Incorrect: <span class="subst">&#123;incorrect&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Accuracy: <span class="subst">&#123;<span class="number">100</span> * correct / total:<span class="number">.2</span>f&#125;</span>%&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Neural-Networks"><a href="#Neural-Networks" class="headerlink" title="Neural Networks"></a>Neural Networks</h3><h4 id="Term-4"><a href="#Term-4" class="headerlink" title="Term"></a>Term</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">artificial neural network(ANN)人工神經網路</span><br><span class="line">gradient descent梯度下降</span><br><span class="line">stochastic gradient descent隨機梯度下降</span><br><span class="line">Mini-batch gradient descent小批量梯度下降</span><br><span class="line">Perceptron 感知器</span><br><span class="line">multilayer neural network多層神經網路</span><br><span class="line">backpropagation 反向傳播</span><br><span class="line">deep neural network深度神經網絡</span><br><span class="line">overfitting 過度擬合</span><br><span class="line"></span><br><span class="line">dropout 輟學技術 - random remove some unit</span><br><span class="line"></span><br><span class="line">TensorFlow</span><br><span class="line"></span><br><span class="line">computer vision </span><br><span class="line">image convolution 影像卷積(filter)</span><br><span class="line">pooling 池化 - reduce</span><br><span class="line">max-pooling最大值池化</span><br><span class="line"></span><br><span class="line">convolutional neural network(CNN) 卷積神經網路</span><br><span class="line">convolution  --&gt; pooling</span><br><span class="line"></span><br><span class="line">feed-forward neural network 前饋神經網路</span><br><span class="line">Recurrent Neural Networks 循環神經網路</span><br></pre></td></tr></table></figure>

<h4 id="content"><a href="#content" class="headerlink" title="content"></a>content</h4><h5 id="Neural-Network-Structure"><a href="#Neural-Network-Structure" class="headerlink" title="Neural Network Structure"></a>Neural Network Structure</h5><div style="max-width:500px">
  <img src="/2023/12/29/cs50ai-1/pic11.png" class="" title="pic11">
</div>

<h5 id="Multilayer-Neural-Networks"><a href="#Multilayer-Neural-Networks" class="headerlink" title="Multilayer Neural Networks"></a>Multilayer Neural Networks</h5><div style="max-width:500px">
  <img src="/2023/12/29/cs50ai-1/pic12.png" class="" title="pic12">
</div>

<h5 id="Overfitting"><a href="#Overfitting" class="headerlink" title="Overfitting"></a>Overfitting</h5><div style="max-width:500px">
  <img src="/2023/12/29/cs50ai-1/pic13.png" class="" title="pic13">
</div>

<h5 id="Image-Convolution"><a href="#Image-Convolution" class="headerlink" title="Image Convolution"></a>Image Convolution</h5><div style="max-width:500px">
  <img src="/2023/12/29/cs50ai-1/pic14.png" class="" title="pic14">
</div>

<h5 id="max-pooling"><a href="#max-pooling" class="headerlink" title="max-pooling"></a>max-pooling</h5><div style="max-width:500px">
  <img src="/2023/12/29/cs50ai-1/pic15.png" class="" title="pic15">
</div>

<h5 id="Convolutional-Neural-Networks"><a href="#Convolutional-Neural-Networks" class="headerlink" title="Convolutional Neural Networks"></a>Convolutional Neural Networks</h5><div style="max-width:500px">
  <img src="/2023/12/29/cs50ai-1/pic16.png" class="" title="pic16">
</div>

<h5 id="recurrent-neural-network"><a href="#recurrent-neural-network" class="headerlink" title="recurrent neural network"></a>recurrent neural network</h5><h6 id="CaptionBot"><a href="#CaptionBot" class="headerlink" title="CaptionBot"></a><a target="_blank" rel="noopener" href="https://captionbotui.azurewebsites.net/">CaptionBot</a></h6><div style="max-width:500px">
  <img src="/2023/12/29/cs50ai-1/pic17.png" class="" title="pic17">
</div>

<h6 id="Youtub"><a href="#Youtub" class="headerlink" title="Youtub"></a><a target="_blank" rel="noopener" href="https://www.youtube.com/">Youtub</a></h6><div style="max-width:500px">
  <img src="/2023/12/29/cs50ai-1/pic18.png" class="" title="pic18">
</div>

<h6 id="google-翻譯"><a href="#google-翻譯" class="headerlink" title="google 翻譯"></a><a target="_blank" rel="noopener" href="https://chromewebstore.google.com/detail/google-%E7%BF%BB%E8%AD%AF/aapbdbdomjkkjkaonfhkkikfgjllcleb">google 翻譯</a></h6><div style="max-width:500px">
  <img src="/2023/12/29/cs50ai-1/pic19.png" class="" title="pic19">
</div>

<h4 id="code"><a href="#code" class="headerlink" title="code"></a>code</h4><h5 id="banknotes-py"><a href="#banknotes-py" class="headerlink" title="banknotes.py"></a>banknotes.py</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line"><span class="comment"># Read data in from file</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;banknotes.csv&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    reader = csv.reader(f)</span><br><span class="line">    <span class="built_in">next</span>(reader)</span><br><span class="line"></span><br><span class="line">    data = []</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        data.append(&#123;</span><br><span class="line">            <span class="string">&quot;evidence&quot;</span>: [<span class="built_in">float</span>(cell) <span class="keyword">for</span> cell <span class="keyword">in</span> row[:<span class="number">4</span>]],</span><br><span class="line">            <span class="string">&quot;label&quot;</span>: <span class="number">1</span> <span class="keyword">if</span> row[<span class="number">4</span>] == <span class="string">&quot;0&quot;</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Separate data into training and testing groups</span></span><br><span class="line">evidence = [row[<span class="string">&quot;evidence&quot;</span>] <span class="keyword">for</span> row <span class="keyword">in</span> data]</span><br><span class="line">labels = [row[<span class="string">&quot;label&quot;</span>] <span class="keyword">for</span> row <span class="keyword">in</span> data]</span><br><span class="line">X_training, X_testing, y_training, y_testing = train_test_split(</span><br><span class="line">    evidence, labels, test_size=<span class="number">0.4</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a neural network</span></span><br><span class="line"><span class="comment"># models : one API</span></span><br><span class="line"><span class="comment"># Sequential : 多層</span></span><br><span class="line">model = tf.keras.models.Sequential()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add a hidden layer with 8 units, with ReLU activation</span></span><br><span class="line"><span class="comment"># 8 : 8 hide unit</span></span><br><span class="line"><span class="comment"># 4 : 4 input data</span></span><br><span class="line"><span class="comment"># relu : active function</span></span><br><span class="line">model.add(tf.keras.layers.Dense(<span class="number">8</span>, input_shape=(<span class="number">4</span>,), activation=<span class="string">&quot;relu&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add output layer with 1 unit, with sigmoid activation</span></span><br><span class="line"><span class="comment"># 1 : 1 output</span></span><br><span class="line">model.add(tf.keras.layers.Dense(<span class="number">1</span>, activation=<span class="string">&quot;sigmoid&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Train neural network</span></span><br><span class="line"><span class="comment"># optimizer=&quot;adam&quot; :　select optimizer model</span></span><br><span class="line"><span class="comment"># loss=&quot;binary_crossentropy&quot; : select loss model</span></span><br><span class="line"><span class="comment"># metrics=[&quot;accuracy&quot;] : 評估準確性</span></span><br><span class="line">model.<span class="built_in">compile</span>(</span><br><span class="line">    optimizer=<span class="string">&quot;adam&quot;</span>,</span><br><span class="line">    loss=<span class="string">&quot;binary_crossentropy&quot;</span>,</span><br><span class="line">    metrics=[<span class="string">&quot;accuracy&quot;</span>]</span><br><span class="line">)</span><br><span class="line"><span class="comment"># training 20 times</span></span><br><span class="line">model.fit(X_training, y_training, epochs=<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Evaluate how well model performs</span></span><br><span class="line">model.evaluate(X_testing, y_testing, verbose=<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<h5 id="filter-py"><a href="#filter-py" class="headerlink" title="filter.py"></a>filter.py</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageFilter</span><br><span class="line"></span><br><span class="line"><span class="comment"># Ensure correct usage</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">2</span>:</span><br><span class="line">    sys.exit(<span class="string">&quot;Usage: python filter.py filename&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Open image</span></span><br><span class="line">image = Image.<span class="built_in">open</span>(sys.argv[<span class="number">1</span>]).convert(<span class="string">&quot;RGB&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Filter image according to edge detection kernel</span></span><br><span class="line"><span class="comment"># 3*3 Kernel for filter</span></span><br><span class="line">filtered = image.<span class="built_in">filter</span>(ImageFilter.Kernel(</span><br><span class="line">    size=(<span class="number">3</span>, <span class="number">3</span>),</span><br><span class="line">    kernel=[-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">8</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>],</span><br><span class="line">    scale=<span class="number">1</span></span><br><span class="line">))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Show resulting image</span></span><br><span class="line">filtered.show()</span><br></pre></td></tr></table></figure>

<h5 id="handwriting-py"><a href="#handwriting-py" class="headerlink" title="handwriting.py"></a>handwriting.py</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use MNIST handwriting dataset</span></span><br><span class="line">mnist = tf.keras.datasets.mnist</span><br><span class="line"></span><br><span class="line"><span class="comment"># Prepare data for training</span></span><br><span class="line">(x_train, y_train), (x_test, y_test) = mnist.load_data()</span><br><span class="line">x_train, x_test = x_train / <span class="number">255.0</span>, x_test / <span class="number">255.0</span></span><br><span class="line">y_train = tf.keras.utils.to_categorical(y_train)</span><br><span class="line">y_test = tf.keras.utils.to_categorical(y_test)</span><br><span class="line">x_train = x_train.reshape(</span><br><span class="line">    x_train.shape[<span class="number">0</span>], x_train.shape[<span class="number">1</span>], x_train.shape[<span class="number">2</span>], <span class="number">1</span></span><br><span class="line">)</span><br><span class="line">x_test = x_test.reshape(</span><br><span class="line">    x_test.shape[<span class="number">0</span>], x_test.shape[<span class="number">1</span>], x_test.shape[<span class="number">2</span>], <span class="number">1</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a convolutional neural network</span></span><br><span class="line">model = tf.keras.models.Sequential([</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Convolutional layer. Learn 32 filters using a 3x3 kernel</span></span><br><span class="line">    tf.keras.layers.Conv2D(</span><br><span class="line">        <span class="number">32</span>, (<span class="number">3</span>, <span class="number">3</span>), activation=<span class="string">&quot;relu&quot;</span>, input_shape=(<span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>)</span><br><span class="line">    ),</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Max-pooling layer, using 2x2 pool size</span></span><br><span class="line">    tf.keras.layers.MaxPooling2D(pool_size=(<span class="number">2</span>, <span class="number">2</span>)),</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Flatten units</span></span><br><span class="line">    tf.keras.layers.Flatten(),</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Add a hidden layer with dropout</span></span><br><span class="line">    tf.keras.layers.Dense(<span class="number">128</span>, activation=<span class="string">&quot;relu&quot;</span>),</span><br><span class="line">    <span class="comment"># 刪掉一半</span></span><br><span class="line">    tf.keras.layers.Dropout(<span class="number">0.5</span>),</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Add an output layer with output units for all 10 digits</span></span><br><span class="line">    tf.keras.layers.Dense(<span class="number">10</span>, activation=<span class="string">&quot;softmax&quot;</span>)</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Train neural network</span></span><br><span class="line">model.<span class="built_in">compile</span>(</span><br><span class="line">    optimizer=<span class="string">&quot;adam&quot;</span>,</span><br><span class="line">    loss=<span class="string">&quot;categorical_crossentropy&quot;</span>,</span><br><span class="line">    metrics=[<span class="string">&quot;accuracy&quot;</span>]</span><br><span class="line">)</span><br><span class="line">model.fit(x_train, y_train, epochs=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Evaluate neural network performance</span></span><br><span class="line">model.evaluate(x_test,  y_test, verbose=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Save model to file</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) == <span class="number">2</span>:</span><br><span class="line">    filename = sys.argv[<span class="number">1</span>]</span><br><span class="line">    model.save(filename)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Model saved to <span class="subst">&#123;filename&#125;</span>.&quot;</span>)</span><br></pre></td></tr></table></figure>


<h3 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h3><h4 id="setup"><a href="#setup" class="headerlink" title="setup"></a>setup</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># check which python </span></span><br><span class="line">python -c <span class="string">&quot;import sys; print(sys.executable)&quot;</span></span><br><span class="line">	D:\app\Python310\python.exe</span><br><span class="line"></span><br><span class="line"><span class="comment"># chick install package </span></span><br><span class="line">pip3 list  </span><br><span class="line">	Package            Version</span><br><span class="line">	------------------ ------------</span><br><span class="line">	apricot-select     0.6.1</span><br><span class="line">	attrs              20.3.0</span><br><span class="line">	....</span><br><span class="line">	</span><br><span class="line"><span class="comment"># change env for python</span></span><br><span class="line"><span class="comment"># run by cmd</span></span><br><span class="line">D:\app\python_env\myenv11_01\Scripts\activate.bat</span><br></pre></td></tr></table></figure>

<h4 id="package"><a href="#package" class="headerlink" title="package"></a>package</h4><h5 id="list"><a href="#list" class="headerlink" title="list"></a>list</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># SciPy Python : 演算法庫和數學工具包</span></span><br><span class="line">pip3 install scipy</span><br><span class="line"><span class="comment"># python-constraint : 實現對有限域上處理 CSPs（(Constraint Solving Problems -約束求解問題）的支持</span></span><br><span class="line">pip3 install python-constraint</span><br><span class="line"><span class="comment"># scikit-learn : Scikit-learn是用於Python程式語言的自由軟體機器學習庫。它包含了各種分類、回歸和聚類算法，包括多層感知器、支持向量機、隨機森林、梯度提升、k-平均聚類和DBSCAN，它被設計協同於Python數值庫NumPy和和科學庫SciPy。</span></span><br><span class="line">pip3 install scikit-learn</span><br><span class="line"><span class="comment"># TensorFlow : 是一個開源軟體庫，用於各種感知和語言理解任務的機器學習。目前廣泛地用於研究和生產中，比如Google商業產品，如語音辨識、Gmail、Google 相簿和搜尋</span></span><br><span class="line">pip3 install tensorflow</span><br><span class="line"></span><br><span class="line">pip3 install pygame</span><br></pre></td></tr></table></figure>

<h5 id="csv"><a href="#csv" class="headerlink" title="csv"></a>csv</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line">evidence = []</span><br><span class="line">labels = []</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(filename) <span class="keyword">as</span> f:</span><br><span class="line">    reader = csv.reader(f)</span><br><span class="line">		<span class="comment"># jump 1st row</span></span><br><span class="line">    <span class="built_in">next</span>(reader)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        evidence.append([</span><br><span class="line">            <span class="built_in">int</span>(row[<span class="number">0</span>]),</span><br><span class="line">            <span class="built_in">float</span>(row[<span class="number">1</span>]),</span><br><span class="line">            <span class="built_in">int</span>(row[<span class="number">2</span>]),</span><br><span class="line">            <span class="built_in">float</span>(row[<span class="number">3</span>]),</span><br><span class="line">            <span class="built_in">int</span>(row[<span class="number">4</span>]),</span><br><span class="line">            <span class="built_in">float</span>(row[<span class="number">5</span>]),</span><br><span class="line">            <span class="built_in">float</span>(row[<span class="number">6</span>]),</span><br><span class="line">            <span class="built_in">float</span>(row[<span class="number">7</span>]),</span><br><span class="line">            <span class="built_in">float</span>(row[<span class="number">8</span>]),</span><br><span class="line">            <span class="built_in">float</span>(row[<span class="number">9</span>]),</span><br><span class="line">            abbreviated_month_to_int(row[<span class="number">10</span>]),</span><br><span class="line">            <span class="built_in">int</span>(row[<span class="number">11</span>]),</span><br><span class="line">            <span class="built_in">int</span>(row[<span class="number">12</span>]),</span><br><span class="line">            <span class="built_in">int</span>(row[<span class="number">13</span>]),</span><br><span class="line">            <span class="built_in">int</span>(row[<span class="number">14</span>]),</span><br><span class="line">            <span class="number">1</span> <span class="keyword">if</span> row[<span class="number">15</span>] == <span class="string">&#x27;Returning_Visitor&#x27;</span> <span class="keyword">else</span> <span class="number">0</span>,</span><br><span class="line">            <span class="number">1</span> <span class="keyword">if</span> row[<span class="number">16</span>] == <span class="string">&#x27;TRUE&#x27;</span> <span class="keyword">else</span> <span class="number">0</span>,</span><br><span class="line">        ])</span><br><span class="line">        labels.append(<span class="number">1</span> <span class="keyword">if</span> row[-<span class="number">1</span>] == <span class="string">&#x27;TRUE&#x27;</span> <span class="keyword">else</span> <span class="number">0</span>)</span><br></pre></td></tr></table></figure>


<h4 id="syntax"><a href="#syntax" class="headerlink" title="syntax"></a>syntax</h4><h5 id="anonymous-functions"><a href="#anonymous-functions" class="headerlink" title="anonymous functions"></a>anonymous functions</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">testGreedy(foods, maxUnits,</span><br><span class="line">           <span class="keyword">lambda</span> x: <span class="number">1</span>/Food.getCost(x))</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; f1 = lambda x: x</span><br><span class="line">&gt;&gt;&gt; f1(2)</span><br><span class="line">2</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; f2 = lambda x,y: x + y</span><br><span class="line">&gt;&gt;&gt; f2(<span class="string">&quot;Jery&quot;</span>, <span class="string">&quot;Tom&quot;</span>)</span><br><span class="line"><span class="string">&#x27;JeryTom&#x27;</span></span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; f3 = lambda x,y: <span class="string">&#x27;factor&#x27;</span> <span class="keyword">if</span> (x%y ==0) <span class="keyword">else</span> <span class="string">&#x27;not factor&#x27;</span></span><br><span class="line">&gt;&gt;&gt; f3(4,2)</span><br><span class="line"><span class="string">&#x27;factor&#x27;</span></span><br><span class="line">&gt;&gt;&gt; f3(4,3) </span><br><span class="line"><span class="string">&#x27;not factor&#x27;</span></span><br></pre></td></tr></table></figure>

<h5 id="class-print-function-string"><a href="#class-print-function-string" class="headerlink" title="class print function : string"></a>class print function : <strong>string</strong></h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Food</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, n, v, w</span>):</span></span><br><span class="line">        self.name = n</span><br><span class="line">        self.value = v</span><br><span class="line">        self.calories = w</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getValue</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.value</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getCost</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.calories</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">density</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.getValue()/self.getCost()</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.name + <span class="string">&#x27;: &lt;&#x27;</span> + <span class="built_in">str</span>(self.value)\</span><br><span class="line">                 + <span class="string">&#x27;, &#x27;</span> + <span class="built_in">str</span>(self.calories) + <span class="string">&#x27;&gt;&#x27;</span></span><br></pre></td></tr></table></figure>

<h5 id="classmethod"><a href="#classmethod" class="headerlink" title="@classmethod"></a>@classmethod</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span>:</span></span><br><span class="line">    class_variable = <span class="string">&quot;I am a class variable&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, instance_variable</span>):</span></span><br><span class="line">        self.instance_variable = instance_variable</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Regular instance method</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">instance_method</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Instance method called with instance variable: <span class="subst">&#123;self.instance_variable&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Class method decorated with @classmethod</span></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">class_method</span>(<span class="params">cls</span>):</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Class method called with class variable: <span class="subst">&#123;cls.class_variable&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Creating an instance of MyClass</span></span><br><span class="line">obj = MyClass(<span class="string">&quot;I am an instance variable&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Calling the instance method</span></span><br><span class="line">obj.instance_method()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Calling the class method</span></span><br><span class="line">MyClass.class_method()</span><br><span class="line"></span><br><span class="line"><span class="comment"># class_method is a class method decorated with @classmethod. It can only access class variables, not instance variables. The first parameter, conventionally named cls, refers to the class itself.</span></span><br></pre></td></tr></table></figure>

<h5 id="dict-key-by-tuple"><a href="#dict-key-by-tuple" class="headerlink" title="dict - key by tuple"></a>dict - key by tuple</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">self.q = <span class="built_in">dict</span>()</span><br><span class="line">self.q[<span class="built_in">tuple</span>(state), action] = new_q</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_q_value</span>(<span class="params">self, state, action</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Return the Q-value for the state `state` and the action `action`.</span></span><br><span class="line"><span class="string">    If no Q-value exists yet in `self.q`, return 0.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> self.q[<span class="built_in">tuple</span>(state), action]</span><br><span class="line">    <span class="keyword">except</span> KeyError:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># other exception</span></span><br><span class="line"><span class="keyword">for</span> move <span class="keyword">in</span> moves:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        q = self.q[<span class="built_in">tuple</span>(state), move]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        q = <span class="number">0</span></span><br></pre></td></tr></table></figure>

<h4 id="function"><a href="#function" class="headerlink" title="function"></a>function</h4><h5 id="sorted"><a href="#sorted" class="headerlink" title="sorted"></a>sorted</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">buildMenu</span>(<span class="params">names, values, calories</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;names, values, calories lists of same length.</span></span><br><span class="line"><span class="string">       name a list of strings</span></span><br><span class="line"><span class="string">       values and calories lists of numbers</span></span><br><span class="line"><span class="string">       returns list of Foods&quot;&quot;&quot;</span></span><br><span class="line">    menu = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(values)):</span><br><span class="line">        item = Food(names[i], values[i], calories[i])</span><br><span class="line">        menu.append(Food(names[i], values[i],</span><br><span class="line">                          calories[i]))</span><br><span class="line">    <span class="keyword">return</span> menu</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">greedy</span>(<span class="params">items, maxCost, keyFunction</span>):</span></span><br><span class="line">    itemsCopy = <span class="built_in">sorted</span>(items, key = keyFunction,</span><br><span class="line">                       reverse = <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">names = [<span class="string">&#x27;wine&#x27;</span>, <span class="string">&#x27;beer&#x27;</span>, <span class="string">&#x27;pizza&#x27;</span>, <span class="string">&#x27;burger&#x27;</span>, <span class="string">&#x27;fries&#x27;</span>,</span><br><span class="line">         <span class="string">&#x27;cola&#x27;</span>, <span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;donut&#x27;</span>, <span class="string">&#x27;cake&#x27;</span>]</span><br><span class="line">values = [<span class="number">89</span>,<span class="number">90</span>,<span class="number">95</span>,<span class="number">100</span>,<span class="number">90</span>,<span class="number">79</span>,<span class="number">50</span>,<span class="number">10</span>]</span><br><span class="line">calories = [<span class="number">123</span>,<span class="number">154</span>,<span class="number">258</span>,<span class="number">354</span>,<span class="number">365</span>,<span class="number">150</span>,<span class="number">95</span>,<span class="number">195</span>]</span><br><span class="line">foods = buildMenu(names, values, calories)</span><br><span class="line">testGreedy(foods, <span class="number">1000</span>, Food.getValue)</span><br></pre></td></tr></table></figure>

<h5 id="zip"><a href="#zip" class="headerlink" title="zip"></a>zip</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># example </span></span><br><span class="line">a = (<span class="string">&quot;John&quot;</span>, <span class="string">&quot;Charles&quot;</span>, <span class="string">&quot;Mike&quot;</span>)</span><br><span class="line">b = (<span class="string">&quot;Jenny&quot;</span>, <span class="string">&quot;Christy&quot;</span>, <span class="string">&quot;Monica&quot;</span>)</span><br><span class="line">x = <span class="built_in">zip</span>(a, b)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">tuple</span>(x))</span><br><span class="line"><span class="comment"># ((&#x27;John&#x27;, &#x27;Jenny&#x27;), (&#x27;Charles&#x27;, &#x27;Christy&#x27;), (&#x27;Mike&#x27;, &#x27;Monica&#x27;))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># run</span></span><br><span class="line"><span class="keyword">for</span> actual, predicted <span class="keyword">in</span> <span class="built_in">zip</span>(y_testing, predictions):</span><br><span class="line">    ....</span><br></pre></td></tr></table></figure>

<h5 id="copy"><a href="#copy" class="headerlink" title="copy"></a>copy</h5><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># copy to new variable</span></span><br><span class="line">state = game.piles.copy()</span><br></pre></td></tr></table></figure>

<h4 id="items"><a href="#items" class="headerlink" title="items"></a>items</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># self.q.items() returns a view of the dictionary&#x27;s key-value pairs,</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># Assume self.q is a dictionary</span></span><br><span class="line">        self.q = &#123;<span class="string">&#x27;key1&#x27;</span>: <span class="string">&#x27;value1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>: <span class="string">&#x27;value2&#x27;</span>, <span class="string">&#x27;key3&#x27;</span>: <span class="string">&#x27;value3&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">iterate_dictionary</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># Using .items() to iterate over keys and values</span></span><br><span class="line">        <span class="keyword">for</span> key, value <span class="keyword">in</span> self.q.items():</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;Key: <span class="subst">&#123;key&#125;</span>, Value: <span class="subst">&#123;value&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Creating an instance of MyClass</span></span><br><span class="line">obj = MyClass()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Calling the method to iterate over the dictionary</span></span><br><span class="line">obj.iterate_dictionary()</span><br></pre></td></tr></table></figure>

<h4 id="tuple-list-–-gt-tuple"><a href="#tuple-list-–-gt-tuple" class="headerlink" title="tuple - list –&gt; tuple"></a>tuple - list –&gt; tuple</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">q = self.q[<span class="built_in">tuple</span>(state), move]</span><br></pre></td></tr></table></figure>


<h3 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h3><ul>
<li><a target="_blank" rel="noopener" href="https://docs.python.org/3/library/exceptions.html">Python Exception</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/wbsth/cs50ai/blob/master/week4/nim/nim.py">nim source</a></li>
<li><a target="_blank" rel="noopener" href="https://playground.tensorflow.org/">TensorFlow</a></li>
<li><a target="_blank" rel="noopener" href="https://captionbotui.azurewebsites.net/">CaptionBot</a></li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/cs50/" rel="tag"># cs50</a>
              <a href="/tags/python/" rel="tag"># python</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/12/06/cs50-0/" rel="prev" title="CS50 notes">
                  <i class="fa fa-chevron-left"></i> CS50 notes
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/01/04/wolfram-1/" rel="next" title="wolfram-1">
                  wolfram-1 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    
  <div class="comments" id="disqus_thread">
    <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Robert Kao</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="總字數">2.7m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="所需總閱讀時間">40:58</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 強力驅動
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="/js/local-search.js"></script>






  




  


<script>
  function loadCount() {
    var d = document, s = d.createElement('script');
    s.src = 'https://hot5656-blog.disqus.com/count.js';
    s.id = 'dsq-count-scr';
    (d.head || d.body).appendChild(s);
  }
  // defer loading until the whole page loading is completed
  window.addEventListener('load', loadCount, false);
</script>
<script>
  var disqus_config = function() {
    this.page.url = "https://hot5656.github.io/2023/12/29/cs50ai-1/";
    this.page.identifier = "2023/12/29/cs50ai-1/";
    this.page.title = "CS50AI";
    };
  NexT.utils.loadComments('#disqus_thread', () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://hot5656-blog.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

</body>
</html>
